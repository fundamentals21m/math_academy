import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as t,C as s,D as r,E as a}from"./Callout-Bm0ChKkk.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(t,{sectionId:58,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-322: Generic Message Signing"}),e.jsx("p",{className:"mb-4",children:'BIP-322 defines a generic standard for signing messages with Bitcoin addresses. It extends the legacy "sign message" functionality to work with all address types, including SegWit and Taproot.'}),e.jsx(s,{type:"info",title:"Proof of Control",children:e.jsx("p",{children:"Message signing proves you control an address without spending from it. BIP-322 enables this for modern address types that legacy signing doesn't support."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem"}),e.jsx("p",{className:"mb-4",children:"Legacy message signing only works with P2PKH addresses:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Legacy Signing Supports"}),e.jsx("ul",{className:"text-sm text-dark-300 space-y-1",children:e.jsx("li",{children:"P2PKH (1...)"})})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Legacy Signing Doesn't Support"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"P2SH (3...)"}),e.jsx("li",{children:"P2SH-P2WPKH (3...)"}),e.jsx("li",{children:"P2WPKH (bc1q...)"}),e.jsx("li",{children:"P2WSH (bc1q...)"}),e.jsx("li",{children:"P2TR (bc1p...)"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Solution"}),e.jsxs(r,{title:"BIP-322 Generic Signing",children:[e.jsx("p",{children:'BIP-322 signs messages using a "virtual transaction" that would spend the address. If the witness/scriptSig can spend the address, it proves control over that address.'}),e.jsx("p",{className:"mt-2 text-dark-400",children:"This works for ANY script type, even complex ones like multisig."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Virtual Transaction"}),e.jsx("p",{className:"mb-4",children:"The signing process creates two virtual transactions:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Transaction to_spend (never broadcast):"}),e.jsx("p",{className:"text-dark-300",children:"Input: OP_0 OP_PUSH32 <hash(message)>"}),e.jsx("p",{className:"text-dark-300",children:"Output: address_to_prove (0 satoshis)"}),e.jsx("p",{className:"text-dark-400 mt-4 mb-2",children:"# Transaction to_sign (the signature):"}),e.jsx("p",{className:"text-dark-300",children:"Input: spends to_spend output"}),e.jsx("p",{className:"text-amber-400",children:"Witness/ScriptSig: proof of address control"}),e.jsx("p",{className:"text-dark-300",children:"Output: OP_RETURN (0 satoshis)"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Signature Format"}),e.jsx(a,{title:"BIP-322 Signature Structure",children:e.jsxs("div",{className:"space-y-3 text-dark-300",children:[e.jsx("p",{children:"The signature is the witness stack from to_sign:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs mt-3",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# For P2WPKH:"}),e.jsx("p",{className:"text-dark-300",children:"<signature> <pubkey>"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-1",children:"# For P2TR (key path):"}),e.jsx("p",{className:"text-dark-300",children:"<schnorr_signature>"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-1",children:"# For P2SH-P2WPKH:"}),e.jsx("p",{className:"text-dark-300",children:"<signature> <pubkey> | <witness_program>"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Encoding"}),e.jsx("p",{className:"mb-4",children:"BIP-322 supports multiple encoding levels:"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Level"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Contents"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Use Case"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 text-amber-400",children:"Simple"}),e.jsx("td",{children:"Witness stack only (Base64)"}),e.jsx("td",{children:"Single-sig P2WPKH/P2TR"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 text-amber-400",children:"Full"}),e.jsx("td",{children:"Complete to_sign transaction"}),e.jsx("td",{children:"Complex scripts, multisig"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 text-amber-400",children:"Legacy"}),e.jsx("td",{children:"65-byte signature (backward compat)"}),e.jsx("td",{children:"P2PKH only"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Use Cases"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Proof of Reserves"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Exchanges prove they control addresses holding user funds without moving them."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Login/Authentication"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Sign a challenge message to prove identity. Used by some Bitcoin services."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Timestamping"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Prove you controlled an address at a specific time by signing a dated message."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Cold Wallet Verification"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Prove a cold wallet address belongs to you during setup without making a transaction."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Verification Process"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Verifier steps:"}),e.jsx("p",{className:"text-dark-300",children:"1. Reconstruct to_spend from message + address"}),e.jsx("p",{className:"text-dark-300",children:"2. Parse signature into to_sign transaction"}),e.jsx("p",{className:"text-dark-300",children:"3. Verify to_sign input spends to_spend output"}),e.jsx("p",{className:"text-dark-300",children:"4. Run script verification (same as node validation)"}),e.jsx("p",{className:"text-emerald-400 mt-2",children:"5. If valid â†’ signer controls the address"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Multisig Support"}),e.jsx(s,{type:"info",title:"Threshold Signatures",children:e.jsx("p",{children:'BIP-322 supports multisig addresses. For 2-of-3 multisig, the "full" encoding includes the complete witness with required signatures and redeemScript/witnessScript.'})}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-3",children:"For multisig signing:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Signers create partial signatures (like PSBT workflow)"}),e.jsx("li",{children:"Signatures combined into final witness"}),e.jsx("li",{children:"Full encoding includes complete spending witness"}),e.jsx("li",{children:"Verifier checks multisig requirements are satisfied"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Wallet Support"}),e.jsx("p",{className:"mb-4",children:"BIP-322 adoption is growing:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Sparrow Wallet:"})," Full BIP-322 support for all address types"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Bitcoin Core:"})," Implementation in progress"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Hardware wallets:"})," Varying support levels"]})]})}),e.jsx(s,{type:"success",title:"Universal Proof of Control",children:e.jsx("p",{children:"BIP-322 finally brings message signing to the modern Bitcoin ecosystem. Whether you use SegWit, Taproot, or complex scripts, you can now prove address control without making a transaction. This is essential infrastructure for proof-of-reserves, authentication, and many other use cases."})})]})}export{p as default};
