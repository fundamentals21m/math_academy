import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as t,C as s,D as l,E as a}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(t,{sectionId:61,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-35: Mempool Message"}),e.jsx("p",{className:"mb-4",children:"BIP-35 introduced the mempool message, allowing nodes to request the full list of transactions in a peer's memory pool. This is essential for lightweight clients and nodes catching up after being offline."}),e.jsx(s,{type:"info",title:"Transaction Discovery",children:e.jsx("p",{children:"The mempool message lets nodes discover unconfirmed transactions they might have missed, ensuring consistent views of pending transactions across the network."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem"}),e.jsx("p",{className:"mb-4",children:"Before BIP-35, nodes reconnecting to the network had limited options:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-rose-500/30 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Wait for new transaction announcements (inv messages)"}),e.jsx("li",{children:"Miss transactions that were already propagated"}),e.jsx("li",{children:'No way to request "all unconfirmed transactions"'}),e.jsx("li",{children:"SPV clients couldn't efficiently learn about pending transactions"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Mempool Message"}),e.jsx(l,{title:"mempool Command",children:e.jsx("p",{children:"A simple command with no payload. When received, a node responds with inv messages for all transactions in its mempool."})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Message exchange:"}),e.jsx("p",{className:"text-dark-300",children:"Node A → Node B: mempool (empty payload)"}),e.jsx("p",{className:"text-dark-300 mt-2",children:"Node B → Node A: inv (type=TX, hash1, hash2, ...)"}),e.jsx("p",{className:"text-dark-300",children:"Node B → Node A: inv (type=TX, hash1001, ...)"}),e.jsx("p",{className:"text-dark-500 mt-3",children:"Response may be split across multiple inv messages"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Protocol Flow"}),e.jsx(a,{title:"Mempool Synchronization",children:e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 1. Request mempool contents:"}),e.jsx("p",{className:"text-dark-300",children:"Client: mempool"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 2. Peer sends inventory:"}),e.jsx("p",{className:"text-dark-300",children:"Server: inv [txid1, txid2, ..., txid1000]"}),e.jsx("p",{className:"text-dark-300",children:"Server: inv [txid1001, txid1002, ...]"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 3. Client requests needed transactions:"}),e.jsx("p",{className:"text-dark-300",children:"Client: getdata [txid5, txid47, txid892, ...]"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 4. Server sends transaction data:"}),e.jsx("p",{className:"text-dark-300",children:"Server: tx [full transaction 5]"}),e.jsx("p",{className:"text-dark-300",children:"Server: tx [full transaction 47]"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Use Cases"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Node Startup"}),e.jsx("p",{className:"text-sm text-dark-300",children:"After restart, quickly populate mempool from peers instead of waiting for new announcements."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"SPV Clients"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Lightweight clients can check for unconfirmed transactions to their addresses using Bloom filters (BIP-37)."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Network Analysis"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Research tools can sample mempool contents across multiple peers to understand transaction propagation."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Bloom Filter Integration"}),e.jsx("p",{className:"mb-4",children:"When combined with BIP-37 Bloom filters:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"filterload:"})," Client sets Bloom filter for addresses of interest"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"mempool:"})," Client requests mempool inventory"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"inv:"})," Server sends only matching transaction IDs"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Efficiency:"})," Client gets relevant unconfirmed transactions quickly"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Resource Considerations"}),e.jsxs(s,{type:"warning",title:"Potential Abuse",children:[e.jsx("p",{children:"Mempool messages can be bandwidth-intensive:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Large mempools may contain thousands of transactions"}),e.jsx("li",{children:"Repeated requests could consume significant bandwidth"}),e.jsx("li",{children:"Some nodes limit mempool response frequency"}),e.jsx("li",{children:"May be restricted or deprioritized for untrusted peers"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Protocol Version"}),e.jsx("p",{className:"mb-4",children:"BIP-35 was added in protocol version 60002:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Version check:"}),e.jsx("p",{className:"text-dark-300",children:"if peer.version >= 60002:"}),e.jsx("p",{className:"text-dark-500 ml-4",children:"mempool message supported"}),e.jsx("p",{className:"text-dark-300",children:"else:"}),e.jsx("p",{className:"text-dark-500 ml-4",children:"message may be ignored or connection dropped"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Modern Relevance"}),e.jsx("p",{className:"mb-4",children:"While still supported, mempool message usage has evolved:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Still Used For"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Initial mempool synchronization"}),e.jsx("li",{children:"Research/monitoring tools"}),e.jsx("li",{children:"Testing and development"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Alternatives"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"BIP-157/158 for light clients"}),e.jsx("li",{children:"REST API for mempool queries"}),e.jsx("li",{children:"Erlay for efficient relay"})]})]})]}),e.jsx(s,{type:"success",title:"Foundation Feature",children:e.jsx("p",{children:"BIP-35's mempool message filled an important gap in the P2P protocol. While newer approaches exist for specific use cases, the ability to request full mempool contents remains a useful tool for network synchronization and analysis."})})]})}export{p as default};
