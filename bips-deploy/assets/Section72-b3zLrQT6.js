import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as t,C as s,D as i,E as n}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(t,{sectionId:72,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-330: Erlay"}),e.jsx("p",{className:"mb-4",children:"BIP-330 proposes Erlay, a transaction relay protocol using set reconciliation to dramatically reduce bandwidth for transaction announcements. Instead of flooding transactions to all peers, nodes periodically reconcile their mempools."}),e.jsx(s,{type:"info",title:"Bandwidth Savings",children:e.jsx("p",{children:"Erlay can reduce transaction relay bandwidth by ~40%, enabling more peer connections without proportional bandwidth increase."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Current Transaction Relay"}),e.jsx("p",{className:"mb-4",children:'The current "flooding" approach is inefficient:'}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-rose-500/30 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"New transaction → send inv to ALL peers"}),e.jsx("li",{children:"Each peer typically already has it from another peer"}),e.jsx("li",{children:"~44% of inv messages are redundant"}),e.jsx("li",{children:"Bandwidth scales O(peers × transactions)"}),e.jsx("li",{children:"Limits practical number of peer connections"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Erlay Approach"}),e.jsx(i,{title:"Set Reconciliation",children:e.jsx("p",{children:"Instead of announcing every transaction, nodes periodically compare their mempool sets and exchange only the differences. This is far more efficient when sets are mostly similar."})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Erlay vs Flooding:"}),e.jsx("p",{className:"text-dark-300",children:"Flooding: Send inv for tx to 8 peers = 8 invs"}),e.jsx("p",{className:"text-amber-400",children:"Erlay: Reconcile with 8 peers = ~1-2 invs equivalent"}),e.jsx("p",{className:"text-dark-500 mt-3",children:"Most peers already have the transaction → reconciliation finds no difference"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Hybrid Model"}),e.jsx("p",{className:"mb-4",children:"Erlay uses both flooding and reconciliation:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Outbound Peers (Flooding)"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"~8 outbound connections"}),e.jsx("li",{children:"Flood new transactions"}),e.jsx("li",{children:"Fast initial propagation"}),e.jsx("li",{children:"Low latency"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Inbound Peers (Reconciliation)"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Many inbound connections"}),e.jsx("li",{children:"Periodic set reconciliation"}),e.jsx("li",{children:"Catch missed transactions"}),e.jsx("li",{children:"Bandwidth efficient"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Minisketch"}),e.jsx("p",{className:"mb-4",children:"Erlay uses PinSketch, a set reconciliation algorithm:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Sketch:"})," Compact representation of a set"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Size:"})," Proportional to set DIFFERENCE, not total size"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"XOR-based:"})," Sketches of similar sets can be combined to find differences"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Efficiency:"})," ~32 bits per different element"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Protocol Messages"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Message"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Purpose"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"sendtxrcncl"}),e.jsx("td",{children:"Negotiate reconciliation support"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"reqtxrcncl"}),e.jsx("td",{children:"Request reconciliation"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"sketch"}),e.jsx("td",{children:"Send set sketch"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"reqsketchext"}),e.jsx("td",{children:"Request sketch extension"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Reconciliation Flow"}),e.jsx(n,{title:"Erlay Reconciliation",children:e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 1. Initiate reconciliation:"}),e.jsx("p",{className:"text-dark-300",children:"A → B: reqtxrcncl(set_size=1500)"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 2. Exchange sketches:"}),e.jsx("p",{className:"text-dark-300",children:"B → A: sketch(B's sketch)"}),e.jsx("p",{className:"text-dark-300",children:"A computes: A_sketch XOR B_sketch = difference_sketch"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 3. Decode differences:"}),e.jsx("p",{className:"text-dark-300",children:"difference_sketch → [txid₁, txid₂, txid₃]"}),e.jsx("p",{className:"text-dark-500",children:"Only 3 transactions different between mempools!"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 4. Request missing:"}),e.jsx("p",{className:"text-dark-300",children:"A → B: getdata(txid₂) // B has, A doesn't"}),e.jsx("p",{className:"text-dark-300",children:"B → A: getdata(txid₁, txid₃) // A has, B doesn't"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Latency Considerations"}),e.jsxs(s,{type:"warning",title:"Speed vs Bandwidth Tradeoff",children:[e.jsx("p",{children:"Reconciliation is slightly slower than flooding for initial propagation:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Flooding: ~milliseconds to reach peers"}),e.jsx("li",{children:"Reconciliation: Periodic (every few seconds)"}),e.jsx("li",{children:"Hybrid ensures fast propagation via flooding subset"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Benefits"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"More Peer Connections"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Lower per-peer bandwidth enables more connections, improving network connectivity and eclipse attack resistance."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Better Compact Blocks"}),e.jsx("p",{className:"text-sm text-dark-300",children:"More synchronized mempools mean compact blocks work better—fewer missing transactions to request."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Network Resilience"}),e.jsx("p",{className:"text-sm text-dark-300",children:"More connections with less bandwidth improves overall network topology and resistance to partitioning."})]})]}),e.jsx(s,{type:"success",title:"Scaling Transaction Relay",children:e.jsx("p",{children:"Erlay represents a fundamental improvement in how Bitcoin propagates transactions. By using set reconciliation instead of naive flooding, the network can scale to more connections while using less bandwidth—a rare win-win in protocol design."})})]})}export{p as default};
