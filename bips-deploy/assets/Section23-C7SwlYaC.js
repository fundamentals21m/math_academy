import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as l,C as t,D as a,E as r}from"./Callout-Bm0ChKkk.js";import{M as i,I as s}from"./MathBlock-fCav0pL3.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function y(){return e.jsxs(l,{sectionId:23,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Hierarchical Deterministic Wallets"}),e.jsxs("p",{className:"mb-4",children:["BIP-32 defines ",e.jsx("strong",{children:"Hierarchical Deterministic (HD) wallets"}),"—a system for deriving an entire tree of key pairs from a single seed. This foundational BIP enables wallet backup with just one secret, organized key management, and privacy-preserving address generation."]}),e.jsx(t,{type:"info",title:"The Foundation",children:e.jsx("p",{children:"BIP-32 is perhaps the most influential wallet BIP. Published in 2012 by Pieter Wuille, it forms the basis for BIP-39 (mnemonics), BIP-44 (account structure), and virtually every modern Bitcoin wallet."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem"}),e.jsx("p",{className:"mb-4",children:"Before HD wallets, each address required a separate private key:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Non-Deterministic Wallets"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Each key generated independently"}),e.jsx("li",{children:"Must backup after every new address"}),e.jsx("li",{children:"Key pool exhaustion risk"}),e.jsx("li",{children:"No way to regenerate keys"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"HD Wallets (BIP-32)"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"All keys derived from one seed"}),e.jsx("li",{children:"Backup once, recover everything"}),e.jsx("li",{children:"Unlimited addresses from one secret"}),e.jsx("li",{children:"Deterministic regeneration"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Extended Keys"}),e.jsxs("p",{className:"mb-4",children:["BIP-32 introduces ",e.jsx("strong",{children:"extended keys"}),"—key pairs augmented with a chain code that enables child derivation:"]}),e.jsxs(a,{title:"Extended Key",children:[e.jsx("p",{children:"An extended key consists of two 256-bit values:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Key data:"})," Private key (xprv) or public key (xpub)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Chain code:"})," Additional entropy for derivation"]})]}),e.jsx("p",{className:"mt-2",children:"Together, these allow deterministic derivation of child keys at any depth."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Extended key structure (512 bits)"}),e.jsxs("p",{className:"text-dark-300",children:["[",e.jsx("span",{className:"text-amber-400",children:"key: 256 bits"}),"] [",e.jsx("span",{className:"text-emerald-400",children:"chain code: 256 bits"}),"]"]}),e.jsx("p",{className:"text-xs text-dark-500 mt-3",children:"Serialized with version bytes, depth, parent fingerprint, child index"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Key Derivation"}),e.jsx("p",{className:"mb-4",children:"Child keys are derived using HMAC-SHA512:"}),e.jsx(i,{children:"I = \\text{HMAC-SHA512}(\\text{chain\\_code}, \\text{data})"}),e.jsxs("p",{className:"mb-4 text-dark-400",children:["Where ",e.jsx(s,{children:"I_L"})," (left 256 bits) modifies the key and ",e.jsx(s,{children:"I_R"})," (right 256 bits) becomes the new chain code."]}),e.jsxs(a,{title:"Child Key Derivation Function (CKD)",children:[e.jsxs("p",{children:["For private parent key ",e.jsxs(s,{children:["k_",par]})," and index ",e.jsx(s,{children:"i"}),":"]}),e.jsx(i,{children:"k_i = k_{par} + I_L \\pmod{n}"}),e.jsxs("p",{className:"mt-2",children:["For public derivation, ",e.jsxs(s,{children:["K_i = K_",par," + I_L \\\\cdot G"]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Normal vs Hardened Derivation"}),e.jsx("p",{className:"mb-4",children:"BIP-32 defines two derivation types with different security properties:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-blue-500/30",children:[e.jsx("p",{className:"text-blue-400 font-bold mb-2",children:"Normal (Non-Hardened)"}),e.jsx("p",{className:"text-sm text-dark-300 mb-2",children:"Index: 0 to 2³¹-1"}),e.jsxs("ul",{className:"text-sm text-dark-400 space-y-1",children:[e.jsx("li",{children:"• Uses public key in HMAC"}),e.jsx("li",{children:"• Enables watch-only wallets"}),e.jsx("li",{children:"• Risk: leaked child key + xpub = parent key"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-purple-500/30",children:[e.jsx("p",{className:"text-purple-400 font-bold mb-2",children:"Hardened"}),e.jsx("p",{className:"text-sm text-dark-300 mb-2",children:"Index: 2³¹ to 2³²-1 (shown as 0' to 2³¹-1')"}),e.jsxs("ul",{className:"text-sm text-dark-400 space-y-1",children:[e.jsx("li",{children:"• Uses private key in HMAC"}),e.jsx("li",{children:"• No public derivation possible"}),e.jsx("li",{children:"• Stronger security isolation"})]})]})]}),e.jsx(t,{type:"warning",title:"Security Consideration",children:e.jsx("p",{children:"If an attacker obtains both an extended public key (xpub) AND any non-hardened child private key, they can compute the parent private key. This is why account-level derivation uses hardened indices."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Derivation Paths"}),e.jsx("p",{className:"mb-4",children:"Keys are identified by their path from the master key:"}),e.jsx(r,{title:"Path Notation",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-sm",children:e.jsx("p",{className:"text-amber-400",children:"m / purpose' / coin_type' / account' / change / index"})}),e.jsxs("ul",{className:"text-dark-300 space-y-1 ml-4",children:[e.jsxs("li",{children:[e.jsx("span",{className:"text-amber-400 font-mono",children:"m"})," — Master key (from seed)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-amber-400 font-mono",children:"/"})," — Derivation step"]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-amber-400 font-mono",children:"'"})," — Hardened derivation"]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-amber-400 font-mono",children:"44'/0'/0'/0/0"})," — First Bitcoin address (BIP-44)"]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Serialization Format"}),e.jsx("p",{className:"mb-4",children:"Extended keys are serialized as Base58Check strings:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-xs mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Extended key serialization (78 bytes)"}),e.jsxs("div",{className:"space-y-1 text-dark-300",children:[e.jsxs("p",{children:["[",e.jsx("span",{className:"text-purple-400",children:"version: 4 bytes"}),"] — xprv/xpub identifier"]}),e.jsxs("p",{children:["[",e.jsx("span",{className:"text-amber-400",children:"depth: 1 byte"}),"] — How many derivations from master"]}),e.jsxs("p",{children:["[",e.jsx("span",{className:"text-amber-400",children:"fingerprint: 4 bytes"}),"] — First 4 bytes of parent's hash160"]}),e.jsxs("p",{children:["[",e.jsx("span",{className:"text-amber-400",children:"child index: 4 bytes"}),"] — Which child this is"]}),e.jsxs("p",{children:["[",e.jsx("span",{className:"text-emerald-400",children:"chain code: 32 bytes"}),"]"]}),e.jsxs("p",{children:["[",e.jsx("span",{className:"text-emerald-400",children:"key: 33 bytes"}),"] — Compressed (public) or 0x00 + private"]})]})]}),e.jsx(r,{title:"Extended Key Example",children:e.jsxs("div",{className:"space-y-2 font-mono text-xs break-all",children:[e.jsx("p",{className:"text-dark-400",children:"# Extended private key (mainnet)"}),e.jsx("p",{className:"text-amber-400",children:"xprv9s21ZrQH143K3QTDL4LXw2F7HEK3wJUD2nW2nRk4stbPy6cq3jPPqjiChkVvvNKmPGJxWUtg6LnF5kejMRNNU3TGtRBeJgk33yuGBxrMPHi"}),e.jsx("p",{className:"text-dark-400 mt-2",children:"# Corresponding extended public key"}),e.jsx("p",{className:"text-emerald-400",children:"xpub661MyMwAqRbcFtXgS5sYJABqqG9YLmC4Q1Rdap9gSE8NqtwybGhePY2gZ29ESFjqJoCu1Rupje8YtGqsefD265TMg7usUDFdp6W1EGMcet8"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Master Key Generation"}),e.jsx("p",{className:"mb-4",children:"The master extended key is generated from a seed (typically from BIP-39):"}),e.jsx(i,{children:'I = \\text{HMAC-SHA512}(\\text{"Bitcoin seed"}, \\text{seed})'}),e.jsxs("p",{className:"text-dark-400 mb-6",children:[e.jsx(s,{children:"I_L"})," becomes the master private key, ",e.jsx(s,{children:"I_R"})," becomes the master chain code."]}),e.jsx(t,{type:"success",title:"Universal Compatibility",children:e.jsx("p",{children:"BIP-32 is implemented by virtually every Bitcoin wallet. Extended keys enable powerful features like watch-only wallets (xpub only), hardware wallet integration, and multi-party setups where each party knows only their branch of the tree."})})]})}export{y as default};
