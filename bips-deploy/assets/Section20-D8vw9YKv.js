import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as r,C as a,D as n,E as i}from"./Callout-DTLGvo9K.js";import{I as s,M as t}from"./MathBlock-fCav0pL3.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function j(){return e.jsxs(r,{sectionId:20,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"A Better Signature Scheme"}),e.jsxs("p",{className:"mb-4",children:["BIP-340 introduces ",e.jsx("strong",{children:"Schnorr signatures"})," to Bitcoin—a signature scheme that's simpler, more efficient, and more flexible than ECDSA. After decades of being blocked by patents, Schnorr finally came to Bitcoin with Taproot."]}),e.jsx(a,{type:"info",title:"Activated: November 2021",children:e.jsx("p",{children:"BIP-340 activated as part of Taproot at block 709,632. It applies to SegWit v1 (Taproot) outputs and represents a fundamental improvement to Bitcoin's cryptographic foundation."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why Schnorr?"}),e.jsx("p",{className:"mb-4",children:"Schnorr signatures have several advantages over ECDSA:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Provable Security"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Schnorr has a formal security proof in the random oracle model. ECDSA's security is conjectured but not proven."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Linearity"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Signatures can be combined linearly, enabling key aggregation (MuSig) and batch verification."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Simpler Math"}),e.jsx("p",{className:"text-sm text-dark-300",children:"No modular inverse required for signing. Verification is faster with simpler equations."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Compact"}),e.jsx("p",{className:"text-sm text-dark-300",children:"64 bytes fixed size (32 for R, 32 for s) vs ECDSA's 71-72 byte DER encoding."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Mathematics"}),e.jsxs("p",{className:"mb-4",children:["Schnorr signing uses the secp256k1 curve with generator ",e.jsx(s,{children:"G"}),":"]}),e.jsxs(n,{title:"Schnorr Signature Scheme",children:[e.jsxs("p",{className:"mb-3",children:["Given private key ",e.jsx(s,{children:"d"})," and public key ",e.jsx(s,{children:"P = dG"}),":"]}),e.jsx("p",{className:"text-amber-400 font-semibold mb-2",children:"Signing:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-dark-300 ml-4 mb-4",children:[e.jsxs("li",{children:["Choose random nonce ",e.jsx(s,{children:"k"}),", compute ",e.jsx(s,{children:"R = kG"})]}),e.jsxs("li",{children:["Compute ",e.jsx(s,{children:"e = H(R \\| P \\| m)"})," (challenge)"]}),e.jsxs("li",{children:["Compute ",e.jsx(s,{children:"s = k + e \\cdot d"})]}),e.jsxs("li",{children:["Signature is ",e.jsx(s,{children:"(R, s)"})]})]}),e.jsx("p",{className:"text-amber-400 font-semibold mb-2",children:"Verification:"}),e.jsxs("p",{className:"text-dark-300",children:["Check that ",e.jsx(s,{children:"sG = R + eP"})]})]}),e.jsxs(i,{title:"Why Verification Works",children:[e.jsx(t,{children:"sG = (k + ed)G = kG + edG = R + eP \\quad \\checkmark"}),e.jsx("p",{className:"text-dark-400 text-sm mt-3",children:"The equation holds because scalar multiplication distributes over addition on the curve."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"BIP-340 Specifics"}),e.jsx("p",{className:"mb-4",children:"BIP-340 makes specific design choices for Bitcoin:"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-5 border border-dark-700/50",children:[e.jsx("h4",{className:"text-lg font-semibold text-amber-400 mb-2",children:"X-Only Public Keys"}),e.jsx("p",{className:"text-dark-300",children:"Only the x-coordinate is stored (32 bytes). The y-coordinate is implicitly even. This requires key tweaking during signing if the full key has an odd y."})]}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-5 border border-dark-700/50",children:[e.jsx("h4",{className:"text-lg font-semibold text-amber-400 mb-2",children:"Tagged Hashes"}),e.jsx("p",{className:"text-dark-300",children:"All hashes use domain separation via tags:"}),e.jsx("div",{className:"font-mono text-sm mt-2",children:e.jsx("p",{className:"text-amber-400",children:"hash(tag, data) = SHA256(SHA256(tag) || SHA256(tag) || data)"})}),e.jsx("p",{className:"text-dark-500 text-sm mt-2",children:'Tags: "BIP0340/challenge", "BIP0340/aux", "BIP0340/nonce"'})]}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-5 border border-dark-700/50",children:[e.jsx("h4",{className:"text-lg font-semibold text-amber-400 mb-2",children:"Deterministic Nonces"}),e.jsx("p",{className:"text-dark-300",children:"Nonces are derived from the private key, message, and auxiliary randomness. Prevents catastrophic nonce reuse (which leaks the private key)."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Signature Format"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# BIP-340 signature (64 bytes)"}),e.jsxs("p",{className:"text-dark-300",children:["[",e.jsx("span",{className:"text-amber-400",children:"R.x"}),": 32 bytes] [",e.jsx("span",{className:"text-emerald-400",children:"s"}),": 32 bytes]"]}),e.jsx("p",{className:"text-xs text-dark-500 mt-3",children:"No ASN.1/DER encoding. R is x-only (y is even). Both values are big-endian."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Key Aggregation"}),e.jsxs("p",{className:"mb-4",children:["Schnorr's linearity enables ",e.jsx("strong",{children:"key aggregation"}),"—multiple parties can create a single public key that requires all parties to sign:"]}),e.jsx(i,{title:"Simple Key Aggregation",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-dark-300",children:["Given public keys ",e.jsx(s,{children:"P_1 = d_1G"})," and ",e.jsx(s,{children:"P_2 = d_2G"}),":"]}),e.jsx(t,{children:"P_{agg} = P_1 + P_2 = (d_1 + d_2)G"}),e.jsxs("p",{className:"text-dark-400 text-sm",children:["A signature on ",e.jsxs(s,{children:["P_",{agg}]})," requires both private keys! On-chain, this looks like a single-key spend—perfect privacy."]})]})}),e.jsx(a,{type:"warning",title:"MuSig Required",children:e.jsx("p",{children:"Naive key aggregation is vulnerable to rogue-key attacks. BIP-327 (MuSig2) defines a secure protocol for multi-party signing that prevents these attacks while preserving the single-signature appearance."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Batch Verification"}),e.jsx("p",{className:"mb-4",children:"Multiple Schnorr signatures can be verified together more efficiently than individually:"}),e.jsx(t,{children:"\\sum_i s_i G \\stackrel{?}{=} \\sum_i R_i + \\sum_i e_i P_i"}),e.jsx("p",{className:"mb-4 text-dark-400",children:"This enables faster block validation by verifying all signatures in a transaction (or even a block) with fewer elliptic curve operations."}),e.jsx(a,{type:"success",title:"Foundation for Taproot",children:e.jsx("p",{children:"BIP-340 isn't just about signatures—it's the cryptographic foundation for Taproot's key path spending and script commitments. Understanding Schnorr is essential for understanding how Taproot achieves its privacy and efficiency gains."})})]})}export{j as default};
