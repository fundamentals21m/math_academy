import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as i,C as s,D as t,E as r}from"./Callout-Bm0ChKkk.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function g(){return e.jsxs(i,{sectionId:47,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-327: MuSig2"}),e.jsx("p",{className:"mb-4",children:"BIP-327 specifies MuSig2, a secure two-round multi-signature scheme for Schnorr signatures. It allows multiple parties to collaboratively create a single signature that is indistinguishable from a regular signature, providing both privacy and efficiency."}),e.jsx(s,{type:"info",title:"Building on BIP-340",children:e.jsx("p",{children:"MuSig2 leverages Schnorr signature linearity (BIP-340) to aggregate public keys and signatures. The result looks like an ordinary single-key Taproot spend."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why MuSig?"}),e.jsx("p",{className:"mb-4",children:"Traditional multisig reveals the quorum structure on-chain:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Traditional Multisig"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Multiple public keys visible"}),e.jsx("li",{children:"M-of-N structure revealed"}),e.jsx("li",{children:"Larger transaction size"}),e.jsx("li",{children:"Higher fees"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"MuSig"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Single aggregated key"}),e.jsx("li",{children:"Looks like single-sig"}),e.jsx("li",{children:"Same size as single-sig"}),e.jsx("li",{children:"Minimal fees"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Key Aggregation"}),e.jsx(t,{title:"MuSig Key Aggregation",children:e.jsx("p",{children:"Multiple public keys are combined into a single aggregate key. The aggregation uses a coefficient for each key to prevent rogue key attacks."})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Key aggregation (simplified):"}),e.jsx("p",{className:"text-dark-300",children:"L = H(P₁ || P₂ || ... || Pₙ)  # Key list hash"}),e.jsx("p",{className:"text-dark-300 mt-2",children:"aᵢ = H(L || Pᵢ)  # Coefficient for key i"}),e.jsx("p",{className:"text-amber-400 mt-2",children:"P = a₁·P₁ + a₂·P₂ + ... + aₙ·Pₙ  # Aggregate key"}),e.jsx("p",{className:"text-dark-500 mt-3",children:"The aggregate key P is a valid Taproot public key"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Two-Round Protocol"}),e.jsx("p",{className:"mb-4",children:"MuSig2 requires only two rounds of communication between signers:"}),e.jsx(r,{title:"MuSig2 Signing Rounds",children:e.jsxs("div",{className:"space-y-4 text-dark-300",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Round 1: Nonce Exchange"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Each signer generates two random nonces (R₁, R₂)"}),e.jsx("li",{children:"Broadcast commitment to nonces or nonces directly"}),e.jsx("li",{children:"Collect all nonces, compute aggregate nonce R"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Round 2: Partial Signatures"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Compute challenge e = H(R || P || message)"}),e.jsx("li",{children:"Each signer computes partial signature sᵢ"}),e.jsx("li",{children:"Combine: s = s₁ + s₂ + ... + sₙ"}),e.jsx("li",{children:"Final signature: (R, s)"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why Two Nonces?"}),e.jsx("p",{className:"mb-4",children:"MuSig2 uses two nonces per signer to prevent a specific attack:"}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-3",children:'The "Wagner attack" problem:'}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"With one nonce, a malicious signer could wait for others' nonces, then choose their own to manipulate the aggregate nonce"}),e.jsx("li",{children:"This could let them create a valid signature without the honest signers' cooperation"}),e.jsx("li",{children:"Two nonces with a binding coefficient prevent this manipulation"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Nonce aggregation with binding:"}),e.jsx("p",{className:"text-dark-300",children:"b = H(R₁_all || R₂_all || P || message)"}),e.jsx("p",{className:"text-dark-300 mt-2",children:"Rᵢ = Rᵢ₁ + b·Rᵢ₂  # Each signer's effective nonce"}),e.jsx("p",{className:"text-amber-400 mt-2",children:"R = R₁ + R₂ + ... + Rₙ  # Aggregate nonce"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Nonce Generation"}),e.jsxs(s,{type:"warning",title:"Critical: Nonce Reuse Prevention",children:[e.jsx("p",{children:"Reusing nonces across different signing sessions leaks the private key! BIP-327 specifies deterministic nonce derivation that includes:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Random auxiliary data"}),e.jsx("li",{children:"Secret key material"}),e.jsx("li",{children:"Aggregate public key"}),e.jsx("li",{children:"Message being signed"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Session Management"}),e.jsx("p",{className:"mb-4",children:"MuSig2 requires careful session state management:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Nonce state:"})," Must be stored securely between rounds"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"One-time use:"})," Each nonce pair used exactly once"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Abort handling:"})," New nonces required if session aborts"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Parallel sessions:"})," Each session needs independent nonces"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Use Cases"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Lightning Channel Opens"}),e.jsx("p",{className:"text-sm text-dark-300",children:"2-of-2 funding outputs look like single-sig, improving privacy and reducing on-chain footprint."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Corporate Treasury"}),e.jsx("p",{className:"text-sm text-dark-300",children:"N-of-N multisig for organizational wallets without revealing the number of keyholders."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Taproot Key Path"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Multiple parties can share control of a Taproot output while maintaining the efficiency of key-path spending."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"MuSig vs Threshold Signatures"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Property"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"MuSig2"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"FROST (t-of-n)"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Quorum"}),e.jsx("td",{children:"N-of-N only"}),e.jsx("td",{children:"Any t-of-n"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Rounds"}),e.jsx("td",{children:"2"}),e.jsx("td",{children:"2 (with preprocessing)"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Setup"}),e.jsx("td",{children:"Non-interactive"}),e.jsx("td",{children:"DKG required"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:"Complexity"}),e.jsx("td",{children:"Simpler"}),e.jsx("td",{children:"More complex"})]})]})]})}),e.jsx(s,{type:"success",title:"Privacy Through Aggregation",children:e.jsx("p",{children:"MuSig2 is a cornerstone of Taproot's privacy benefits. By making multi-party spending indistinguishable from single-party spending, it improves fungibility for all Bitcoin users, not just MuSig users."})})]})}export{g as default};
