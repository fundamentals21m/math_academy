import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as t,C as s,D as a,E as r}from"./Callout-Bm0ChKkk.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(t,{sectionId:54,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-350: Bech32m"}),e.jsx("p",{className:"mb-4",children:"BIP-350 introduces Bech32m, a modified version of Bech32 that fixes a subtle flaw discovered after Bech32's deployment. Bech32m is required for SegWit version 1+ addresses (Taproot) while Bech32 remains for version 0."}),e.jsx(s,{type:"info",title:"Taproot Addresses",children:e.jsx("p",{children:`All "bc1p" Taproot addresses use Bech32m encoding. If you see "bc1p...", it's Bech32m. If you see "bc1q...", it's original Bech32.`})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Bech32 Flaw"}),e.jsx("p",{className:"mb-4",children:"Researchers discovered a weakness in Bech32's error detection:"}),e.jsx(a,{title:"The Length Extension Attack",children:e.jsx("p",{children:'Inserting or removing "q" characters at the end of a Bech32 string might not be detected by the checksum. While "q" = 0 in Bech32, appending zeros can create valid-seeming addresses.'})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# The vulnerability:"}),e.jsx("p",{className:"text-dark-300",children:"bc1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t4"}),e.jsx("p",{className:"text-dark-400 mt-2 mb-2",children:"# Adding 'q' before last 6 chars can be undetected:"}),e.jsx("p",{className:"text-rose-400",children:"bc1qw508d6qejxtdg4y5r3zarvary0c5xw7kqv8f3t4"}),e.jsx("p",{className:"text-dark-500 mt-3",children:"Both might pass checksum validation (invalid addresses, but accepted)!"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Impact Assessment"}),e.jsx("p",{className:"mb-4",children:"For SegWit v0, this flaw has limited practical impact:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"P2WPKH:"})," Fixed 20-byte program; wrong length rejected at consensus level"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"P2WSH:"})," Fixed 32-byte program; same protection"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Future versions:"})," Might allow variable-length programs—serious risk!"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Bech32m Fix"}),e.jsx("p",{className:"mb-4",children:"Bech32m uses a different checksum constant:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Checksum constant difference:"}),e.jsx("p",{className:"text-dark-300",children:"Bech32:  constant = 1"}),e.jsx("p",{className:"text-amber-400",children:"Bech32m: constant = 0x2bc830a3"}),e.jsx("p",{className:"text-dark-500 mt-3",children:"Everything else identical—same encoding, same alphabet, same structure"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Version Rules"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Witness Version"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Encoding"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Address Prefix"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Version 0"}),e.jsx("td",{className:"font-mono",children:"Bech32"}),e.jsx("td",{className:"font-mono text-amber-400",children:"bc1q..."})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Version 1 (Taproot)"}),e.jsx("td",{className:"font-mono",children:"Bech32m"}),e.jsx("td",{className:"font-mono text-amber-400",children:"bc1p..."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:"Versions 2-16"}),e.jsx("td",{className:"font-mono",children:"Bech32m"}),e.jsxs("td",{className:"font-mono",children:["bc1","{","r-0","}","..."]})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Wallet Implementation"}),e.jsx(r,{title:"Encoding/Decoding Logic",children:e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Encoding:"}),e.jsx("p",{className:"text-dark-300",children:"if witness_version == 0:"}),e.jsx("p",{className:"text-dark-500 ml-4",children:"use Bech32 (constant = 1)"}),e.jsx("p",{className:"text-dark-300",children:"else:"}),e.jsx("p",{className:"text-dark-500 ml-4",children:"use Bech32m (constant = 0x2bc830a3)"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Decoding:"}),e.jsx("p",{className:"text-dark-300",children:"decode with Bech32m constant"}),e.jsx("p",{className:"text-dark-300",children:"if checksum invalid and version == 0:"}),e.jsx("p",{className:"text-dark-500 ml-4",children:"retry with Bech32 constant"}),e.jsx("p",{className:"text-dark-300",children:"if checksum invalid and version != 0:"}),e.jsx("p",{className:"text-rose-400 ml-4",children:"reject (must be Bech32m)"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why Not Update v0?"}),e.jsxs(s,{type:"warning",title:"Backward Compatibility",children:[e.jsx("p",{children:"Changing v0 addresses to Bech32m would break:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"All existing SegWit addresses in circulation"}),e.jsx("li",{children:"Paper wallets and backup materials"}),e.jsx("li",{children:"Every wallet's address generation code"}),e.jsx("li",{children:"Payment infrastructure expecting Bech32"})]}),e.jsx("p",{className:"mt-2",children:"Since v0 has fixed-length constraints, the flaw isn't practically exploitable."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Address Comparison"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Bech32 (SegWit v0)"}),e.jsx("p",{className:"text-sm text-dark-300 font-mono break-all",children:"bc1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t4"}),e.jsx("p",{className:"text-dark-500 text-xs mt-2",children:"P2WPKH - 42 characters, starts with bc1q"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Bech32m (Taproot v1)"}),e.jsx("p",{className:"text-sm text-dark-300 font-mono break-all",children:"bc1p0xlxvlhemja6c4dqv22uapctqupfhlxm9h8z3k2e72q4k9hcz7vqzk5jj0"}),e.jsx("p",{className:"text-dark-500 text-xs mt-2",children:"P2TR - 62 characters, starts with bc1p"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Checksum Mathematics"}),e.jsx("p",{className:"mb-4",children:"The new constant was carefully chosen:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"0x2bc830a3"})," eliminates the length extension weakness"]}),e.jsx("li",{children:"Maintains all other error detection properties"}),e.jsx("li",{children:"Ensures Bech32 and Bech32m addresses are always distinguishable"}),e.jsx("li",{children:"A v0 address decoded as Bech32m will fail checksum (and vice versa)"})]})}),e.jsx(s,{type:"success",title:"Forward-Looking Design",children:e.jsx("p",{children:"Bech32m ensures all future SegWit versions (v2-v16) will have robust error detection regardless of program length. This proactive fix exemplifies careful protocol evolution—addressing theoretical concerns before they become practical vulnerabilities."})})]})}export{p as default};
