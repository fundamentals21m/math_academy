import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as t,C as s,D as a,E as i}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(t,{sectionId:75,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-30: Duplicate Transactions"}),e.jsx("p",{className:"mb-4",children:"BIP-30 addresses a subtle bug where coinbase transactions could have identical transaction IDs (txids), allowing one to overwrite another in the UTXO set. This rule ensures every transaction has a unique identifier."}),e.jsx(s,{type:"warning",title:"Historical Bug",children:e.jsx("p",{children:"Before BIP-30, it was possible to create coinbase transactions with the same txid as existing ones. This actually happened twice in Bitcoin's early history, resulting in lost coins."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem"}),e.jsx("p",{className:"mb-4",children:"How could two transactions have the same txid?"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Coinbase transaction structure:"}),e.jsx("p",{className:"text-dark-300",children:"input: 00...00 (null input)"}),e.jsx("p",{className:"text-dark-300",children:"scriptSig: arbitrary data (block height, etc.)"}),e.jsx("p",{className:"text-dark-300",children:"output: miner reward to address"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# If miner uses same data:"}),e.jsx("p",{className:"text-rose-400",children:"Identical txid possible!"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Historical Duplicates"}),e.jsx("p",{className:"mb-4",children:"Two pairs of duplicate coinbase transactions exist in Bitcoin:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Duplicate 1:"}),e.jsx("p",{className:"text-dark-300 text-sm",children:"Block 91,812 coinbase matches block 91,722"}),e.jsx("p",{className:"text-dark-500 text-xs font-mono break-all",children:"txid: d5d27987d2a3dfc724e359870c6644b40e497bdc0589a033220fe15429d88599"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Duplicate 2:"}),e.jsx("p",{className:"text-dark-300 text-sm",children:"Block 91,842 coinbase matches block 91,880"}),e.jsx("p",{className:"text-dark-500 text-xs font-mono break-all",children:"txid: e3bf3d07d4b0375638d5f1db5255fe07ba2c4cb067cd81b84ee974b6585fb468"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Consequences"}),e.jsx(a,{title:"UTXO Overwriting",children:e.jsx("p",{children:"When the second transaction with the same txid was included in a block, it overwrote the first in the UTXO set. The original outputs became unspendable— the coins were permanently lost."})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# What happened:"}),e.jsx("p",{className:"text-dark-300",children:"1. Block A: coinbase tx1 → output to miner"}),e.jsx("p",{className:"text-dark-300",children:"2. Later: tx1's output unspent in UTXO set"}),e.jsx("p",{className:"text-dark-300",children:"3. Block B: coinbase tx2 (same txid as tx1)"}),e.jsx("p",{className:"text-rose-400",children:"4. tx2 overwrites tx1 in UTXO set"}),e.jsx("p",{className:"text-rose-400",children:"5. Original tx1 outputs lost forever"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"BIP-30 Rule"}),e.jsx("p",{className:"mb-4",children:"The fix is simple but important:"}),e.jsx(i,{title:"BIP-30 Consensus Rule",children:e.jsxs("div",{className:"space-y-3 text-dark-300",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Rule:"}),e.jsx("p",{children:"Blocks must not contain a transaction whose txid matches any transaction with unspent outputs in the UTXO set."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"In other words:"}),e.jsx("p",{children:"You can't create a transaction with the same txid as one that has UTXOs still available to spend."})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Activation"}),e.jsx("p",{className:"mb-4",children:"BIP-30 was activated at block 91,842:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Implemented in Bitcoin Core 0.6.0"}),e.jsx("li",{children:"Active from block 91,842 onward"}),e.jsx("li",{children:"The existing duplicates are grandfathered (special cases)"}),e.jsx("li",{children:"No new duplicates allowed"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"BIP-34's Role"}),e.jsx("p",{className:"mb-4",children:"BIP-34 effectively makes BIP-30 validation unnecessary for new blocks:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"BIP-30"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Reactive: Check each block for duplicate txids"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"BIP-34"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Proactive: Block height in coinbase makes duplicates impossible"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# BIP-34 requirement:"}),e.jsx("p",{className:"text-dark-300",children:"coinbase scriptSig must start with block height"}),e.jsx("p",{className:"text-dark-400 mt-2 mb-2",children:"# Effect:"}),e.jsx("p",{className:"text-dark-300",children:"Every coinbase has unique height → unique txid"}),e.jsx("p",{className:"text-emerald-400 mt-1",children:"Duplicates structurally impossible"})]}),e.jsx(s,{type:"info",title:"Defense in Depth",children:e.jsx("p",{children:"BIP-30 checks are skipped for blocks after BIP-34 activation (block 227,931) since BIP-34 prevents duplicates by design. However, the rule remains important for validating historical blocks and as a backup safety measure."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Lost Coins"}),e.jsx(s,{type:"warning",title:"Permanent Loss",children:e.jsx("p",{children:"The duplicate coinbase transactions resulted in 100 BTC permanently lost (50 BTC × 2 duplicates). These coins can never be spent because the original UTXOs were overwritten."})}),e.jsx(s,{type:"success",title:"Simple but Crucial",children:e.jsx("p",{children:"BIP-30 is a simple rule that prevents a subtle but serious bug. Combined with BIP-34, it ensures every Bitcoin transaction has a unique identifier, maintaining the integrity of the UTXO set."})})]})}export{p as default};
