import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as a,C as s,D as r,E as t}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function x(){return e.jsxs(a,{sectionId:24,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Passphrase-Protected Private Keys"}),e.jsx("p",{className:"mb-4",children:"BIP-38 defines a method for encrypting private keys with a passphrase. This allows private keys to be safely stored on paper or other media, protected by a password that must be provided to decrypt and use the key."}),e.jsx(s,{type:"info",title:"Physical Backup Security",children:e.jsx("p",{children:'BIP-38 was designed for "paper wallet" use cases—printing a private key that can be stored physically but remains useless without the passphrase. Even if the paper is compromised, funds are safe.'})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why BIP-38?"}),e.jsx("p",{className:"mb-4",children:"Raw private keys are dangerous to store or transmit:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Raw WIF Keys"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Instantly spendable by anyone"}),e.jsx("li",{children:"No protection if discovered"}),e.jsx("li",{children:"Physical storage risky"}),e.jsx("li",{children:"Easy to photograph/copy"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"BIP-38 Encrypted Keys"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Requires passphrase to spend"}),e.jsx("li",{children:"Safe even if key is exposed"}),e.jsx("li",{children:"Suitable for physical backup"}),e.jsx("li",{children:"Two-factor: have key + know password"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Encryption Scheme"}),e.jsx("p",{className:"mb-4",children:"BIP-38 uses scrypt for key derivation and AES-256 for encryption:"}),e.jsx(r,{title:"BIP-38 Encryption Process",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[e.jsx("li",{children:"Compute the Bitcoin address from the private key"}),e.jsx("li",{children:"Take the first 4 bytes of double-SHA256(address) as addresshash"}),e.jsx("li",{children:"Derive encryption key using scrypt(passphrase, addresshash)"}),e.jsx("li",{children:"Split derived key into two halves for AES and XOR operations"}),e.jsx("li",{children:"Encrypt the private key with AES-256-CBC"}),e.jsx("li",{children:"Prepend flag bytes (0x0142 or 0x0143) and encode as Base58Check"})]})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Scrypt parameters (CPU/memory intensive)"}),e.jsxs("div",{className:"space-y-1 text-dark-300",children:[e.jsx("p",{children:"N = 16384 (2¹⁴) — CPU/memory cost"}),e.jsx("p",{children:"r = 8 — Block size"}),e.jsx("p",{children:"p = 8 — Parallelization"}),e.jsx("p",{className:"text-dark-500 mt-2",children:"Designed to be slow to thwart brute-force attacks"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Key Formats"}),e.jsx("p",{className:"mb-4",children:"BIP-38 encrypted keys are identifiable by their prefix:"}),e.jsx(t,{title:"Encrypted Key Prefix",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-mono mb-2",children:"6P..."}),e.jsx("p",{className:"text-sm text-dark-300",children:'All BIP-38 encrypted keys start with "6P" when Base58Check encoded'})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-400 text-sm mb-1",children:"Non-EC-multiplied (0x0142):"}),e.jsx("p",{className:"font-mono text-xs text-emerald-400",children:"6PRN..."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-400 text-sm mb-1",children:"EC-multiplied (0x0143):"}),e.jsx("p",{className:"font-mono text-xs text-purple-400",children:"6PY..."})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"EC-Multiply Mode"}),e.jsx("p",{className:"mb-4",children:"BIP-38 includes a second mode using elliptic curve multiplication, enabling key generation without exposing the private key:"}),e.jsxs(r,{title:"EC-Multiply (Lot/Sequence)",children:[e.jsx("p",{children:`A third party can generate encrypted private keys using only a "passphrase code" derived from the owner's passphrase. The owner can later decrypt with their passphrase. This enables:`}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Delegated key generation (e.g., by a printing service)"}),e.jsx("li",{children:"Lot and sequence numbers for batch generation"}),e.jsx("li",{children:"Confirmation codes to verify key creation"})]})]}),e.jsx(s,{type:"warning",title:"Limited Modern Use",children:e.jsx("p",{children:"EC-multiply mode adds complexity and is rarely used today. Most implementations support only the simpler non-EC-multiplied mode. Modern best practice is to use BIP-39 seed phrases instead of individual encrypted keys."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Decryption Process"}),e.jsx("p",{className:"mb-4",children:"To recover the private key:"}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:[e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Base58Check decode the encrypted key"}),e.jsx("li",{children:"Extract the addresshash from the payload"}),e.jsx("li",{children:"Run scrypt with passphrase and addresshash"}),e.jsx("li",{children:"AES decrypt using the derived key"}),e.jsx("li",{children:"Verify by computing address and checking against addresshash"})]}),e.jsx("p",{className:"text-amber-400 mt-3 text-sm",children:"Wrong passphrase → decrypted key won't match addresshash → error"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Security Considerations"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"✓ Strengths"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Strong encryption (AES-256)"}),e.jsx("li",{children:"Memory-hard key derivation (scrypt)"}),e.jsx("li",{children:"Built-in integrity check (addresshash)"}),e.jsx("li",{children:"Two-factor security model"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-amber-500/30",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"⚠ Considerations"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Passphrase strength is critical"}),e.jsx("li",{children:"Scrypt is slow (intended, but affects UX)"}),e.jsx("li",{children:"Single address only (vs HD wallet backup)"}),e.jsx("li",{children:"Largely superseded by BIP-39 + hardware wallets"})]})]})]}),e.jsx(t,{title:"BIP-38 Encrypted Key",children:e.jsxs("div",{className:"space-y-2 font-mono text-xs break-all",children:[e.jsx("p",{className:"text-dark-400",children:'# Encrypted private key (passphrase: "TestingOneTwoThree")'}),e.jsx("p",{className:"text-amber-400",children:"6PRVWUbkzzsbcVac2qwfssoUJAN1Xhrg6bNk8J7Nzm5H7kxEbn2Nh2ZoGg"}),e.jsx("p",{className:"text-dark-400 mt-2",children:"# Decrypted WIF (compressed)"}),e.jsx("p",{className:"text-emerald-400",children:"KwYgW8gcxj1JWJXhPSu4Fqwzfhp5Yfi42mdYmMa4XqK7NJxXUSK7"})]})}),e.jsx(s,{type:"success",title:"Legacy but Useful",children:e.jsx("p",{children:"While BIP-39 seed phrases have largely replaced BIP-38 for backup purposes, BIP-38 remains useful for securely transmitting individual keys, creating physical gifts (like Casascius coins), or adding password protection to specific addresses."})})]})}export{x as default};
