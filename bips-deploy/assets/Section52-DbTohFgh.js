import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as a,C as s,D as r,E as t}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(a,{sectionId:52,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-72: Payment Protocol URIs"}),e.jsx("p",{className:"mb-4",children:"BIP-72 extended BIP-21 URIs with a parameter for BIP-70 payment request URLs. It allowed merchants to include both a fallback address and a payment protocol endpoint in a single URI. Like BIP-70/71, it's now deprecated."}),e.jsx(s,{type:"warning",title:"Deprecated with BIP-70",children:e.jsx("p",{children:'BIP-72 is deprecated along with BIP-70. The "r" parameter it defined is no longer recommended for use.'})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Extension"}),e.jsxs(r,{title:"The 'r' Parameter",children:[e.jsx("p",{children:'BIP-72 added a single parameter to BIP-21 URIs: the "r" parameter pointing to a payment request URL where wallets could fetch a BIP-70 PaymentRequest.'}),e.jsx("div",{className:"font-mono text-sm text-amber-400 mt-3",children:"bitcoin:address?r=https://merchant.com/pay/invoice123"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"URI Format"}),e.jsx(t,{title:"BIP-72 URI Examples",children:e.jsxs("div",{className:"space-y-4 font-mono text-xs",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# Payment request URL only:"}),e.jsx("p",{className:"text-dark-300 break-all",children:"bitcoin:?r=https://merchant.com/pay/123"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# With fallback address:"}),e.jsx("p",{className:"text-dark-300 break-all",children:"bitcoin:1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa?r=https://merchant.com/pay/123"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# With amount and request URL:"}),e.jsx("p",{className:"text-dark-300 break-all",children:"bitcoin:1A1zP1...?amount=0.001&r=https://merchant.com/pay/123"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Processing Flow"}),e.jsx("p",{className:"mb-4",children:"Wallets processed BIP-72 URIs with specific precedence:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Wallet behavior:"}),e.jsx("p",{className:"text-dark-300",children:'1. If "r" parameter present:'}),e.jsx("p",{className:"text-dark-500 ml-4",children:"a. Fetch PaymentRequest from URL"}),e.jsx("p",{className:"text-dark-500 ml-4",children:"b. Validate signatures and certificates"}),e.jsx("p",{className:"text-dark-500 ml-4",children:"c. Use PaymentRequest details (ignore URI params)"}),e.jsx("p",{className:"text-dark-300 mt-2",children:'2. If fetch fails or "r" absent:'}),e.jsx("p",{className:"text-dark-500 ml-4",children:"Fall back to address/amount from URI"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Backward Compatibility"}),e.jsx("p",{className:"mb-4",children:"BIP-72's design ensured backward compatibility:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"BIP-72 Wallet"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:'Fetches PaymentRequest from "r" URL'}),e.jsx("li",{children:"Gets verified merchant details"}),e.jsx("li",{children:"Uses signed payment instructions"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-amber-500/30",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"BIP-21-Only Wallet"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:'Ignores unknown "r" parameter'}),e.jsx("li",{children:"Uses address from URI"}),e.jsx("li",{children:"Payment still works (less info)"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Security Considerations"}),e.jsxs(s,{type:"warning",title:"HTTPS Required",children:[e.jsx("p",{children:'BIP-72 required the "r" parameter URL to use HTTPS to prevent man-in-the-middle attacks. An attacker intercepting HTTP could substitute malicious PaymentRequests.'}),e.jsxs("div",{className:"font-mono text-sm mt-3",children:[e.jsx("p",{className:"text-emerald-400",children:"✓ r=https://merchant.com/pay"}),e.jsx("p",{className:"text-rose-400",children:"✗ r=http://merchant.com/pay"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Problems Inherited"}),e.jsx("p",{className:"mb-4",children:"BIP-72 inherited all of BIP-70's problems:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Privacy leak:"})," Wallet contacts merchant server before paying"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Availability dependency:"})," Payment fails if server is down"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Complexity:"})," Simple URI now requires HTTP fetching, cert validation"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"CA trust:"})," Still depends on X.509 certificate infrastructure"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Modern Alternatives"}),e.jsx("p",{className:"mb-4",children:"The same goals can be achieved with simpler approaches:"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"BIP-21 + Lightning"}),e.jsxs("p",{className:"text-sm text-dark-300",children:["Include Lightning invoice in URI: ",e.jsx("code",{children:"bitcoin:addr?lightning=lnbc..."})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"BIP-78 Payjoin"}),e.jsxs("p",{className:"text-sm text-dark-300",children:['Uses "pj" parameter: ',e.jsx("code",{children:"bitcoin:addr?pj=https://..."})," for privacy-enhancing interactive payments."]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Static QR + Invoice Server"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Dynamic invoice generation without BIP-70 complexity—used by BTCPay Server and others."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Legacy Usage"}),e.jsx(t,{title:"How BIP-72 Was Used",children:e.jsxs("div",{className:"space-y-3 text-dark-300",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"Typical merchant checkout flow:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 ml-4",children:[e.jsx("li",{children:'Customer clicks "Pay with Bitcoin" button'}),e.jsx("li",{children:"Merchant generates unique payment request URL"}),e.jsx("li",{children:"QR code shown with BIP-72 URI"}),e.jsx("li",{children:'Wallet scans, fetches PaymentRequest from "r" URL'}),e.jsx("li",{children:"Wallet displays verified merchant name and amount"}),e.jsx("li",{children:"Customer confirms, wallet sends Payment to merchant"}),e.jsx("li",{children:"Merchant broadcasts transaction, sends PaymentACK"})]})]})}),e.jsx(s,{type:"success",title:"Design Insight",children:e.jsx("p",{children:"BIP-72 shows good backward-compatible design: wallets that didn't support it could still process the URI. This pattern—adding optional enhancement parameters to existing standards—is widely used in Bitcoin development (see: Lightning parameter in BIP-21, Payjoin parameter in BIP-78)."})})]})}export{p as default};
