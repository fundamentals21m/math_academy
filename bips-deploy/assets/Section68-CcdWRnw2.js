import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as r,C as s,D as d,E as a}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(r,{sectionId:68,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-155: addrv2 Message"}),e.jsx("p",{className:"mb-4",children:"BIP-155 introduced the addrv2 message to support longer network addresses. The original addr message only supported IPv4/IPv6, but addrv2 enables Tor v3 onion addresses, I2P, CJDNS, and future network types."}),e.jsx(s,{type:"info",title:"Future-Proof Addressing",children:e.jsx("p",{children:"Tor upgraded from v2 (16 character) to v3 (56 character) onion addresses. The old addr message couldn't fit them—addrv2 solved this."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem"}),e.jsx("p",{className:"mb-4",children:"The original addr message had limitations:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-rose-500/30 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Fixed 16-byte address field (fits IPv6)"}),e.jsx("li",{children:"Tor v3 addresses are 32 bytes (public key)"}),e.jsx("li",{children:"I2P addresses are also longer"}),e.jsx("li",{children:"No extensibility for new network types"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"addrv2 Format"}),e.jsx(d,{title:"addrv2 Message",children:e.jsx("p",{children:"A variable-length address message that specifies network type and address length, allowing any size address from any network protocol."})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# addrv2 entry format:"}),e.jsx("p",{className:"text-dark-300",children:"time: uint32 (last seen timestamp)"}),e.jsx("p",{className:"text-dark-300",children:"services: compactSize + uint64"}),e.jsx("p",{className:"text-amber-400",children:"networkID: uint8 (network type)"}),e.jsx("p",{className:"text-amber-400",children:"addrLen: compactSize (address length)"}),e.jsx("p",{className:"text-amber-400",children:"addr: [addrLen bytes]"}),e.jsx("p",{className:"text-dark-300",children:"port: uint16"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Network Types"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"ID"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Network"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Address Size"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono",children:"0x01"}),e.jsx("td",{children:"IPv4"}),e.jsx("td",{children:"4 bytes"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono",children:"0x02"}),e.jsx("td",{children:"IPv6"}),e.jsx("td",{children:"16 bytes"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"0x03"}),e.jsx("td",{className:"text-amber-400",children:"Tor v2 (deprecated)"}),e.jsx("td",{children:"10 bytes"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"0x04"}),e.jsx("td",{className:"text-amber-400",children:"Tor v3"}),e.jsx("td",{children:"32 bytes"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono",children:"0x05"}),e.jsx("td",{children:"I2P"}),e.jsx("td",{children:"32 bytes"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-mono",children:"0x06"}),e.jsx("td",{children:"CJDNS"}),e.jsx("td",{children:"16 bytes"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Negotiation"}),e.jsx("p",{className:"mb-4",children:"Nodes signal addrv2 support with a sendaddrv2 message:"}),e.jsx(a,{title:"addrv2 Negotiation",children:e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# During connection setup:"}),e.jsx("p",{className:"text-dark-300",children:"A ↔ B: version/verack"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Signal addrv2 support:"}),e.jsx("p",{className:"text-dark-300",children:"A → B: sendaddrv2"}),e.jsx("p",{className:"text-dark-300",children:"B → A: sendaddrv2"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Both support addrv2:"}),e.jsx("p",{className:"text-amber-400",children:"Use addrv2 for address announcements"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# One doesn't support:"}),e.jsx("p",{className:"text-dark-300",children:"Fall back to old addr messages"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Tor v3 Support"}),e.jsx("p",{className:"mb-4",children:"Tor v3 onion addresses use Ed25519 public keys:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("div",{className:"font-mono text-sm text-dark-300",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Tor v3 onion address:"}),e.jsx("p",{className:"break-all",children:"pg6mmjiyjmcrsslvykfwnntlaru7p5svn6y2ymmju6nubxndf4pscryd.onion"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# Decoded to:"}),e.jsx("p",{children:"32-byte Ed25519 public key"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Backward Compatibility"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Old Nodes"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Don't send sendaddrv2"}),e.jsx("li",{children:"Receive only addr messages"}),e.jsx("li",{children:"Can't learn Tor v3 addresses"}),e.jsx("li",{children:"Still function for IPv4/IPv6"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"New Nodes"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Send sendaddrv2 to all peers"}),e.jsx("li",{children:"Track which peers support it"}),e.jsx("li",{children:"Use appropriate format per peer"}),e.jsx("li",{children:"Full network visibility"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Privacy Benefits"}),e.jsxs(s,{type:"info",title:"Anonymous Networks",children:[e.jsx("p",{children:"Supporting Tor v3 and I2P helps network privacy:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Nodes can run exclusively on Tor v3"}),e.jsx("li",{children:"No IP address exposure possible"}),e.jsx("li",{children:"I2P provides additional anonymity option"}),e.jsx("li",{children:"More diverse network topology"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Extensibility"}),e.jsx("p",{className:"mb-4",children:"addrv2 is designed for future networks:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Network IDs 0x07-0xFF reserved for future use"}),e.jsx("li",{children:"Variable address length accommodates any scheme"}),e.jsx("li",{children:"Unknown network types can be relayed (future-compatible)"}),e.jsx("li",{children:"No protocol changes needed for new networks"})]})}),e.jsx(s,{type:"success",title:"Network Diversity",children:e.jsx("p",{children:"BIP-155 ensures Bitcoin can run on any network layer. As privacy-preserving networks evolve and new addressing schemes emerge, the P2P protocol can accommodate them without further changes."})})]})}export{p as default};
