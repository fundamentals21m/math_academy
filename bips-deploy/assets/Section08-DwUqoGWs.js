import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as i,C as s,D as a,E as t}from"./Callout-DTLGvo9K.js";import{M as l}from"./MathBlock-fCav0pL3.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function b(){return e.jsxs(i,{sectionId:8,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Coordinating Soft Fork Activation"}),e.jsxs("p",{className:"mb-4",children:["How do thousands of independent miners signal their readiness for a protocol upgrade? BIP-9 defines a mechanism using ",e.jsx("strong",{children:"version bits"})," in block headers to coordinate soft fork activation in a decentralized manner."]}),e.jsx(s,{type:"info",title:"Historical Context",children:e.jsx("p",{children:"Before BIP-9, soft forks used the IsSuperMajority (ISM) mechanism, which had limitations. BIP-9 was designed to allow multiple soft forks to be deployed simultaneously and to include timeout mechanisms for failed activations."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem with ISM"}),e.jsx("p",{className:"mb-4",children:"The IsSuperMajority mechanism had several issues:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6 text-dark-300",children:[e.jsx("li",{children:"Only one soft fork could be activated at a time (used the version field directly)"}),e.jsx("li",{children:"No timeout—a failed activation attempt would lock the version number forever"}),e.jsx("li",{children:'No way to signal "against" an activation (only "for" or "abstain")'}),e.jsx("li",{children:"Difficult to coordinate the start of signaling"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"BIP-9 Architecture"}),e.jsxs(a,{title:"Version Bits",children:[e.jsxs("p",{children:["The block header's 32-bit version field is repurposed: the top 3 bits are set to",e.jsx("code",{className:"text-amber-400 mx-1",children:"001"})," to indicate BIP-9 signaling, and the remaining 29 bits can each signal support for different soft forks."]}),e.jsx("p",{className:"mt-2",children:"Bit positions 0-28 can signal 29 parallel deployments. Each soft fork is assigned a unique bit number."})]}),e.jsx(t,{title:"Block Version Bits Layout",children:e.jsxs("div",{className:"font-mono text-sm bg-dark-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"32-bit version field:"}),e.jsxs("p",{className:"mb-1",children:[e.jsx("span",{className:"text-rose-400",children:"[001]"}),e.jsx("span",{className:"text-amber-400",children:"[signal bits 0-28]"})]}),e.jsx("p",{className:"text-xs text-dark-500 mt-2",children:"Example: Version 0x20000001 = BIP-9 base (0x20000000) + bit 0 signaled"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Deployment States"}),e.jsx("p",{className:"mb-4",children:"Each BIP-9 deployment progresses through a state machine:"}),e.jsx("div",{className:"bg-dark-900 rounded-xl p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 text-right text-gray-400 font-mono",children:"DEFINED"}),e.jsx("div",{className:"text-dark-600",children:"→"}),e.jsx("div",{className:"text-dark-300",children:"Deployment parameters set, waiting for start time"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 text-right text-blue-400 font-mono",children:"STARTED"}),e.jsx("div",{className:"text-dark-600",children:"→"}),e.jsx("div",{className:"text-dark-300",children:"Signaling period active, counting support"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 text-right text-purple-400 font-mono",children:"LOCKED_IN"}),e.jsx("div",{className:"text-dark-600",children:"→"}),e.jsx("div",{className:"text-dark-300",children:"Threshold reached, activation pending"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 text-right text-emerald-400 font-mono",children:"ACTIVE"}),e.jsx("div",{className:"text-dark-600",children:"→"}),e.jsx("div",{className:"text-dark-300",children:"New rules enforced"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 text-right text-rose-400 font-mono",children:"FAILED"}),e.jsx("div",{className:"text-dark-600",children:"→"}),e.jsx("div",{className:"text-dark-300",children:"Timeout reached without activation"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Parameters"}),e.jsx("p",{className:"mb-4",children:"Each BIP-9 deployment specifies several parameters:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"name"}),e.jsx("p",{className:"text-sm text-dark-300",children:'Human-readable identifier (e.g., "segwit")'})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"bit"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Position in version field (0-28)"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"starttime"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Unix timestamp when signaling begins"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"timeout"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Unix timestamp when deployment fails if not locked in"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Threshold Calculation"}),e.jsxs("p",{className:"mb-4",children:["BIP-9 uses a ",e.jsx("strong",{children:"retarget period"})," (2016 blocks, ~2 weeks) as the measurement window:"]}),e.jsx(l,{children:"\\text{Threshold} = \\frac{1916}{2016} \\approx 95\\%"}),e.jsx("p",{className:"mb-4",children:"If 1916 or more blocks in a retarget period signal support (set the designated bit), the deployment moves to LOCKED_IN at the end of that period."}),e.jsx(t,{title:"SegWit BIP-9 Deployment",children:e.jsxs("div",{className:"space-y-2 text-dark-300",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Bit:"})," 1"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Start:"})," November 15, 2016 (midnight UTC)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Timeout:"})," November 15, 2017 (midnight UTC)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Threshold:"})," 95% (1916/2016 blocks)"]}),e.jsx("p",{className:"text-amber-400 mt-2",children:"Result: SegWit took 9 months to reach threshold due to political contention"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Limitations of BIP-9"}),e.jsx(s,{type:"warning",title:"The 95% Problem",children:e.jsx("p",{children:"BIP-9's 95% threshold gives significant veto power to a small minority of miners. During the SegWit activation, some miners used this to delay activation for economic reasons. This led to proposals like BIP-8 (with mandatory activation) and UASF."})}),e.jsx("p",{className:"mb-4",children:"Other BIP-9 limitations:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6 text-dark-300",children:[e.jsx("li",{children:"Miners, not users or nodes, control activation timing"}),e.jsx("li",{children:"No way to express opposition (only support or silence)"}),e.jsx("li",{children:"Timeout means starting over with new parameters"}),e.jsx("li",{children:"Fixed 95% threshold may be too high for some changes"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"BIP-9 in Practice"}),e.jsx("p",{className:"mb-4",children:"BIP-9 successfully activated several soft forks:"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"BIP"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Bit"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Feature"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Activated"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"BIP-68/112/113"}),e.jsx("td",{children:"0"}),e.jsx("td",{children:"CSV (relative timelocks)"}),e.jsx("td",{className:"text-emerald-400",children:"July 2016"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"BIP-141/143/144"}),e.jsx("td",{children:"1"}),e.jsx("td",{children:"SegWit"}),e.jsx("td",{className:"text-emerald-400",children:"Aug 2017"})]})]})]})}),e.jsx(s,{type:"success",title:"Legacy and Evolution",children:e.jsx("p",{children:"While BIP-9 showed limitations during SegWit activation, it pioneered the concept of parallel soft fork signaling. Later mechanisms like Speedy Trial (used for Taproot) built on BIP-9's foundations while addressing its weaknesses."})})]})}export{b as default};
