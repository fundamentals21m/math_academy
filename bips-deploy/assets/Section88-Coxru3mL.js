import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as s,C as a,D as t,E as n}from"./Callout-Bm0ChKkk.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(s,{sectionId:88,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Channel Factories"}),e.jsx("p",{className:"mb-4",children:"Channel factories enable multiple parties to share a single on-chain UTXO while opening and closing payment channels between them off-chain. This dramatically reduces Lightning Network's on-chain footprint."}),e.jsx(a,{type:"info",title:"Scaling Lightning's Scaling",children:e.jsx("p",{children:"If Lightning scales Bitcoin, channel factories scale Lightning. A single on-chain transaction can enable thousands of payment channels."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The On-Chain Bottleneck"}),e.jsx("p",{className:"mb-4",children:"Current Lightning has an on-chain requirement problem:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Lightning on-chain requirements:"}),e.jsx("p",{className:"text-dark-300",children:"Each channel: 1 funding tx + 1 close tx minimum"}),e.jsx("p",{className:"text-dark-300",children:"Per user: Multiple channels needed for routing"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# At scale:"}),e.jsx("p",{className:"text-dark-300",children:"8 billion people × 2+ channels each × 2 txs"}),e.jsx("p",{className:"text-rose-400",children:"= 32+ billion on-chain transactions needed"}),e.jsx("p",{className:"text-dark-500 mt-2",children:"At 7 tps, that's ~145 years just for channel operations"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Channel Factory Concept"}),e.jsx(t,{title:"Channel Factory",children:e.jsx("p",{children:"A shared UTXO among N parties that can be subdivided into bilateral payment channels without additional on-chain transactions. Channels can be opened, closed, and rebalanced entirely off-chain."})}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-400 font-bold",children:"Structure"}),e.jsx("p",{className:"text-sm text-dark-300",children:`One N-of-N multisig funding output containing all participants' funds. Off-chain "allocation" transactions determine how funds are split into channels.`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-400 font-bold",children:"Channel Operations"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Participants can create, modify, or close channels between any pair by updating the shared allocation—no on-chain transaction required."})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Factory Architecture"}),e.jsx(n,{title:"Three-Layer Structure",children:e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Layer 1: Funding (on-chain)"}),e.jsx("p",{className:"text-dark-300",children:"N-of-N multisig UTXO"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# Layer 2: Allocation (off-chain)"}),e.jsx("p",{className:"text-dark-300",children:"Divides funds into channels"}),e.jsx("p",{className:"text-dark-300",children:"Alice-Bob: 1 BTC"}),e.jsx("p",{className:"text-dark-300",children:"Bob-Carol: 0.5 BTC"}),e.jsx("p",{className:"text-dark-300",children:"Alice-Carol: 0.3 BTC"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# Layer 3: Channels (off-chain)"}),e.jsx("p",{className:"text-dark-300",children:"Standard Lightning commitment transactions"}),e.jsx("p",{className:"text-dark-300",children:"HTLCs, routing, etc."})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Operations"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Open Channel"}),e.jsx("p",{className:"text-sm text-dark-300",children:"All parties sign new allocation that includes the channel. No on-chain tx."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Close Channel"}),e.jsx("p",{className:"text-sm text-dark-300",children:"All parties sign new allocation without the channel. Funds return to owners' allocations. No on-chain tx."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Rebalance"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Move liquidity between channels by updating allocation. All parties sign."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Exit"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Participant can exit by closing channels and withdrawing their allocation. Can be cooperative or unilateral."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Coordination Challenges"}),e.jsx(a,{type:"warning",title:"N-Party Coordination",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"All N parties must be online to update allocation"}),e.jsx("li",{children:"Unresponsive party blocks factory updates"}),e.jsx("li",{children:"Larger N = higher coordination cost"}),e.jsx("li",{children:"Solutions: Subset updates, Eltoo, timeout mechanisms"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Eltoo for Factories"}),e.jsx("p",{className:"mb-4",children:"BIP-118 (ANYPREVOUT) dramatically improves channel factories:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Without Eltoo (current):"}),e.jsx("p",{className:"text-dark-300",children:"Each update requires new signatures from all N"}),e.jsx("p",{className:"text-dark-300",children:"Revocation secrets grow: O(updates × N)"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# With Eltoo:"}),e.jsx("p",{className:"text-emerald-400",children:"Updates replace previous (no revocation)"}),e.jsx("p",{className:"text-emerald-400",children:"State size: O(1) regardless of updates"}),e.jsx("p",{className:"text-emerald-400",children:"Simpler unilateral close"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Scaling Impact"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Metric"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Traditional LN"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"With Factories"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"On-chain txs per channel"}),e.jsx("td",{children:"2 (open + close)"}),e.jsx("td",{className:"text-emerald-400",children:"2/N (amortized)"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Channel creation time"}),e.jsx("td",{children:"~1 hour (6 confirms)"}),e.jsx("td",{className:"text-emerald-400",children:"Instant (off-chain)"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Channel creation cost"}),e.jsx("td",{children:"On-chain fee"}),e.jsx("td",{className:"text-emerald-400",children:"~Free"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:"Rebalancing"}),e.jsx("td",{children:"Circular routes or splice"}),e.jsx("td",{className:"text-emerald-400",children:"Off-chain update"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Virtual Channels"}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-3",children:'Factories enable "virtual channels" between non-adjacent participants:'}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-300",children:"Factory: [Alice, Bob, Carol, Dave]"}),e.jsx("p",{className:"text-dark-300",children:"Virtual channel: Alice ↔ Dave"}),e.jsx("p",{className:"text-dark-300",children:"Routed through: Alice → Bob → Carol → Dave"}),e.jsx("p",{className:"text-amber-400 mt-2",children:"But appears as direct channel to LN"})]})]}),e.jsx(a,{type:"success",title:"Path to Billions",children:e.jsx("p",{children:"Channel factories are essential for Lightning to serve billions of users. By amortizing on-chain costs across many channels and enabling instant off-chain channel operations, factories transform Lightning from a scaling solution into a truly global payment network."})})]})}export{p as default};
