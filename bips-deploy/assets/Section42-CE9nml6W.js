import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as a,C as s,D as t,E as i}from"./Callout-Bm0ChKkk.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(a,{sectionId:42,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Partially Signed Bitcoin Transactions (PSBT)"}),e.jsx("p",{className:"mb-4",children:"BIP-174 defines the Partially Signed Bitcoin Transaction format—a standardized way to create, pass around, and sign Bitcoin transactions across different wallets and devices. PSBT enables multi-party signing workflows and hardware wallet integration."}),e.jsx(s,{type:"info",title:"Universal Format",children:e.jsx("p",{children:"PSBT is the lingua franca of Bitcoin transaction construction. It allows any wallet to create an unsigned transaction, pass it to any signing device, and have any finalizer broadcast it—all using a single standard format."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem"}),e.jsx("p",{className:"mb-4",children:"Before PSBT, multi-device signing was challenging:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"No standard for passing unsigned transactions between software"}),e.jsx("li",{children:"Hardware wallets needed custom integrations with each software wallet"}),e.jsx("li",{children:"Multisig required manual coordination of partial signatures"}),e.jsx("li",{children:"No way to include metadata needed for signing (UTXO amounts, scripts)"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"PSBT Structure"}),e.jsxs(t,{title:"PSBT Components",children:[e.jsx("p",{children:"A PSBT contains three main sections:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Global:"})," Unsigned transaction, xpubs, version"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Per-Input:"})," UTXO data, partial signatures, scripts, paths"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Per-Output:"})," Scripts, derivation paths for change detection"]})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-xs mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# PSBT binary structure"}),e.jsxs("div",{className:"space-y-1 text-dark-300",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-purple-400",children:'"psbt"'})," - Magic bytes (0x70736274)"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-purple-400",children:"0xff"})," - Separator"]}),e.jsx("p",{children:e.jsx("span",{className:"text-amber-400",children:"<global map>"})}),e.jsxs("p",{children:[e.jsx("span",{className:"text-emerald-400",children:"<input map>"})," × num_inputs"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-blue-400",children:"<output map>"})," × num_outputs"]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Key-Value Maps"}),e.jsx("p",{className:"mb-4",children:"Each section is a map of key-value pairs:"}),e.jsx(i,{title:"Important PSBT Fields",children:e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Global"}),e.jsxs("ul",{className:"space-y-1 text-dark-300",children:[e.jsx("li",{children:"PSBT_GLOBAL_UNSIGNED_TX (0x00): The transaction to sign"}),e.jsx("li",{children:"PSBT_GLOBAL_XPUB (0x01): Extended public keys used"}),e.jsx("li",{children:"PSBT_GLOBAL_VERSION (0xfb): PSBT version number"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Per-Input"}),e.jsxs("ul",{className:"space-y-1 text-dark-300",children:[e.jsx("li",{children:"PSBT_IN_WITNESS_UTXO (0x01): SegWit previous output"}),e.jsx("li",{children:"PSBT_IN_PARTIAL_SIG (0x02): Partial signatures"}),e.jsx("li",{children:"PSBT_IN_BIP32_DERIVATION (0x06): Key derivation paths"}),e.jsx("li",{children:"PSBT_IN_FINAL_SCRIPTSIG (0x07): Finalized scriptSig"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-blue-400 font-bold mb-2",children:"Per-Output"}),e.jsxs("ul",{className:"space-y-1 text-dark-300",children:[e.jsx("li",{children:"PSBT_OUT_REDEEM_SCRIPT (0x00): P2SH redeem script"}),e.jsx("li",{children:"PSBT_OUT_BIP32_DERIVATION (0x02): Key paths (for change)"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"PSBT Workflow"}),e.jsx("p",{className:"mb-4",children:"A typical PSBT moves through these roles:"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border-l-4 border-amber-500",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"1. Creator"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Creates the PSBT with the unsigned transaction. Adds inputs and outputs."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border-l-4 border-emerald-500",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-1",children:"2. Updater"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Adds UTXO data, scripts, and derivation paths needed for signing."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-blue-400 font-bold mb-1",children:"3. Signer(s)"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Adds partial signatures for inputs they can sign. May be multiple parties."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border-l-4 border-purple-500",children:[e.jsx("p",{className:"text-purple-400 font-bold mb-1",children:"4. Combiner"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Merges PSBTs from multiple signers into one with all signatures."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border-l-4 border-rose-500",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-1",children:"5. Finalizer"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Converts partial signatures into final scriptSig/witness. Creates broadcast-ready tx."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Encoding"}),e.jsx("p",{className:"mb-4",children:"PSBTs are typically encoded as Base64 for text transmission:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-xs mb-6 break-all",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Example PSBT (Base64)"}),e.jsx("p",{className:"text-amber-400",children:"cHNidP8BAHUCAAAAASaBcTce3/KF6Tig7cez36M/gAtAqLMIXlJHKr0AAAAAFxZWC..."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Multisig Example"}),e.jsx(i,{title:"2-of-3 Multisig Signing",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Creator:"})," Wallet creates PSBT with unsigned tx"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Updater:"})," Adds UTXOs, redeemScript, and derivation paths"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Signer 1:"})," Hardware wallet A adds partial signature"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Signer 2:"})," Hardware wallet B adds partial signature"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Combiner:"})," Merge both partially-signed PSBTs"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Finalizer:"})," Create final multisig witness"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Broadcast:"})," Submit to network"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Hardware Wallet Integration"}),e.jsxs(s,{type:"success",title:"Universal Compatibility",children:[e.jsx("p",{children:"PSBT enables any wallet to work with any hardware signer:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Sparrow → Coldcard/Ledger/Trezor"}),e.jsx("li",{children:"Bitcoin Core → Any PSBT-compatible device"}),e.jsx("li",{children:"Specter → Multiple hardware wallets simultaneously"})]}),e.jsx("p",{className:"mt-2",children:"The PSBT contains everything the signer needs—no proprietary protocols required."})]}),e.jsx(s,{type:"info",title:"Continued in BIP-370",children:e.jsx("p",{children:"PSBT version 0 (this BIP) has limitations addressed by PSBT version 2 (BIP-370). Version 2 supports transaction modification during the signing process and is better suited for collaborative transactions like CoinJoin."})})]})}export{p as default};
