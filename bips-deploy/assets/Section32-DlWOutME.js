import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as i,C as s,D as a,E as t}from"./Callout-Bm0ChKkk.js";import{M as r,I as d}from"./MathBlock-fCav0pL3.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function u(){return e.jsxs(i,{sectionId:32,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Key Derivation for Taproot Addresses"}),e.jsx("p",{className:"mb-4",children:`BIP-86 defines the derivation path for Taproot (P2TR) single-key addresses. Building on the Taproot upgrade (BIP-341), it specifies how wallets should derive keys for the modern "bc1p..." address format using purpose 86'.`}),e.jsx(s,{type:"info",title:"Taproot Era",children:e.jsx("p",{children:"BIP-86 is the latest in the wallet standard progression: BIP-44 (legacy) → BIP-49 (nested SegWit) → BIP-84 (native SegWit) → BIP-86 (Taproot). It represents the cutting edge of Bitcoin address technology."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why Taproot Addresses?"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Taproot Benefits"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Schnorr signatures (64 bytes)"}),e.jsx("li",{children:"Better privacy for complex scripts"}),e.jsx("li",{children:"Key aggregation potential (MuSig2)"}),e.jsx("li",{children:"Future script upgrade path"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-amber-500/30",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"vs Native SegWit (BIP-84)"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Slightly smaller signatures"}),e.jsx("li",{children:"Script hiding capability"}),e.jsx("li",{children:"Same fee efficiency for simple spends"}),e.jsx("li",{children:"Uses bech32m (improved encoding)"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Derivation Path"}),e.jsxs(a,{title:"BIP-86 Path",children:[e.jsx("div",{className:"font-mono text-lg text-amber-400 mb-4",children:"m / 86' / coin_type' / account' / change / address_index"}),e.jsx("p",{className:"text-dark-300",children:"Follows the standard five-level structure with purpose 86' for Taproot addresses."})]}),e.jsx(t,{title:"Path Progression",children:e.jsxs("div",{className:"space-y-3 font-mono text-sm",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# BIP-44: Legacy P2PKH"}),e.jsx("p",{className:"text-dark-300",children:"m/44'/0'/0'/0/0 → 1..."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# BIP-84: Native SegWit P2WPKH"}),e.jsx("p",{className:"text-dark-300",children:"m/84'/0'/0'/0/0 → bc1q..."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# BIP-86: Taproot P2TR"}),e.jsx("p",{className:"text-amber-400",children:"m/86'/0'/0'/0/0 → bc1p..."})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Key Tweaking"}),e.jsx("p",{className:"mb-4",children:"Unlike P2WPKH, Taproot requires a key tweak even for simple single-key spends:"}),e.jsxs(a,{title:"Taproot Output Key",children:[e.jsx("p",{children:"For a BIP-86 address with no script tree, the output key Q is derived from the internal key P:"}),e.jsx(r,{children:"Q = P + H(P) \\cdot G"}),e.jsxs("p",{className:"mt-2",children:["Where ",e.jsx(d,{children:"H(P)"}),' is the tagged hash of P using "TapTweak". This proves no hidden scripts exist.']})]}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-3",children:"Address derivation steps:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Derive internal private key at m/86'/0'/account'/change/index"}),e.jsx("li",{children:"Compute internal public key P (x-only, 32 bytes)"}),e.jsx("li",{children:'Compute tweak t = tagged_hash("TapTweak", P)'}),e.jsx("li",{children:"Compute output key Q = P + t·G (may require negation)"}),e.jsx("li",{children:"Encode Q as bech32m with witness version 1"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"X-Only Public Keys"}),e.jsx("p",{className:"mb-4",children:"BIP-86 uses 32-byte x-only public keys (BIP-340 format):"}),e.jsxs(t,{title:"X-Only Key Format",children:[e.jsxs("div",{className:"space-y-2 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-400",children:"# Traditional compressed public key (33 bytes)"}),e.jsx("p",{className:"text-dark-300",children:"02 79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"}),e.jsx("p",{className:"text-dark-400 mt-3",children:"# X-only public key (32 bytes)"}),e.jsx("p",{className:"text-amber-400",children:"79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"})]}),e.jsx("p",{className:"text-dark-500 text-sm mt-3",children:"The prefix byte is dropped; y-coordinate is implicitly even"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Bech32m Encoding"}),e.jsx("p",{className:"mb-4",children:"BIP-86 addresses use bech32m (BIP-350), an improved version of bech32:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Address structure"}),e.jsxs("p",{className:"text-dark-300",children:[e.jsx("span",{className:"text-purple-400",children:"bc"}),e.jsx("span",{className:"text-dark-500",children:"1"}),e.jsx("span",{className:"text-amber-400",children:"p"}),e.jsx("span",{className:"text-emerald-400",children:"5d7rjq7g6..."})]}),e.jsxs("div",{className:"text-xs mt-3 space-y-1 text-dark-400",children:[e.jsxs("p",{children:["• ",e.jsx("span",{className:"text-purple-400",children:"bc"})," = mainnet HRP"]}),e.jsxs("p",{children:["• ",e.jsx("span",{className:"text-dark-500",children:"1"})," = separator"]}),e.jsxs("p",{children:["• ",e.jsx("span",{className:"text-amber-400",children:"p"})," = witness version 1"]}),e.jsxs("p",{children:["• ",e.jsx("span",{className:"text-emerald-400",children:"rest"})," = 32-byte x-only key + checksum"]})]})]}),e.jsx(s,{type:"info",title:"Why 'p' Not 'q'?",children:e.jsx("p",{children:`In bech32, 'q' encodes 0 (witness v0 for SegWit) and 'p' encodes 1 (witness v1 for Taproot). This is why SegWit addresses start "bc1q" and Taproot addresses start "bc1p".`})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Spending from BIP-86"}),e.jsx("p",{className:"mb-4",children:"Key path spending requires computing the tweaked private key:"}),e.jsx(r,{children:"d' = d + H(P) \\pmod{n}"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Transaction witness"}),e.jsx("p",{className:"text-amber-400",children:"<64-byte-schnorr-signature>"}),e.jsx("p",{className:"text-xs text-dark-500 mt-3",children:"That's it! Just one element—no pubkey needed (it's in the output)"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Extended Key Prefixes"}),e.jsxs(t,{title:"BIP-86 Extended Key Versions",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 font-mono text-sm",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"Mainnet private:"}),e.jsx("p",{className:"text-amber-400",children:"xprv... (same as BIP-32)"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"Mainnet public:"}),e.jsx("p",{className:"text-emerald-400",children:"xpub... (same as BIP-32)"})]})]}),e.jsx("p",{className:"text-dark-500 text-sm mt-3",children:"BIP-86 uses standard xprv/xpub prefixes. The purpose path indicates Taproot use."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Key-Path Only"}),e.jsx(s,{type:"warning",title:"No Script Tree",children:e.jsx("p",{children:"BIP-86 specifically defines derivation for key-path-only Taproot outputs—no MAST script tree. For complex Taproot scripts (multisig, timelocks, etc.), output descriptors or custom derivation is required."})}),e.jsx(s,{type:"success",title:"The Future Standard",children:e.jsx("p",{children:"BIP-86 represents the most advanced single-signature address format available. As wallet and exchange support expands, Taproot addresses will increasingly become the default, offering the best combination of privacy, efficiency, and future compatibility."})})]})}export{u as default};
