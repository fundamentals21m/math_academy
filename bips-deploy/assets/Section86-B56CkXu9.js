import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as s,C as t,D as a,E as l}from"./Callout-Bm0ChKkk.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(s,{sectionId:86,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-118 Deep Dive: Eltoo Enabling"}),e.jsx("p",{className:"mb-4",children:"BIP-118 (SIGHASH_ANYPREVOUT) enables Eltoo, a simplified channel construction that eliminates the need for complex revocation mechanisms. This section explores how APO transforms payment channels."}),e.jsx(t,{type:"info",title:"Eltoo (L2)",children:e.jsx("p",{children:'Eltoo (pronounced "L2") is a payment channel protocol that uses ANYPREVOUT to create update transactions that can spend any prior state, dramatically simplifying channel management.'})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Current Lightning Complexity"}),e.jsx("p",{className:"mb-4",children:"Current Lightning channels (LN-Penalty) have significant complexity:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-rose-500/30 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Asymmetric states:"})," Each party holds different commitment tx"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Revocation storage:"})," Must store all old revocation secrets"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Watchtower complexity:"})," Watchtowers need breach data for each state"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Penalty transactions:"})," Complex scripts for breach response"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"State growth:"})," More state = more data to manage"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Eltoo Architecture"}),e.jsx(a,{title:"Eltoo Update Mechanism",children:e.jsx("p",{children:'A channel update protocol where each new state can spend any previous state, creating a simple "latest state wins" mechanism. Uses ANYPREVOUT signatures to achieve input-agnostic spending.'})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Eltoo transaction structure:"}),e.jsx("p",{className:"text-dark-300",children:"Funding Tx → Update Tx₁ → Update Tx₂ → ... → Settlement"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# Key property:"}),e.jsx("p",{className:"text-amber-400",children:"Update Txₙ can spend Funding OR any Update Txₘ (m < n)"}),e.jsx("p",{className:"text-dark-500 mt-2",children:"ANYPREVOUT makes signatures valid for any matching script"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"How ANYPREVOUT Enables Eltoo"}),e.jsx(l,{title:"ANYPREVOUT for State Updates",children:e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Without ANYPREVOUT (current Lightning):"}),e.jsx("p",{className:"text-dark-300",children:"Signature commits to specific input txid"}),e.jsx("p",{className:"text-dark-300",children:"Update₂ can ONLY spend Update₁"}),e.jsx("p",{className:"text-rose-400",children:"Can't skip intermediate states"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# With ANYPREVOUT (Eltoo):"}),e.jsx("p",{className:"text-dark-300",children:"Signature doesn't commit to input txid"}),e.jsx("p",{className:"text-dark-300",children:"Update₁₀ can spend Update₅ directly"}),e.jsx("p",{className:"text-emerald-400",children:"Latest update always wins"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Eltoo Channel Lifecycle"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"1."}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-300 font-bold",children:"Funding"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Create 2-of-2 multisig, standard funding tx"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"2."}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-300 font-bold",children:"Update"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Sign new update tx with ANYPREVOUT, includes state number"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"3."}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-300 font-bold",children:"Close (cooperative)"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Directly spend funding to final balances"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"4."}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-300 font-bold",children:"Close (unilateral)"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Broadcast update tx, wait for challenge period, settle"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"State Numbers"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# State number encoding:"}),e.jsx("p",{className:"text-dark-300",children:"Update tx includes: state_number in nSequence or nLockTime"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# Enforcement:"}),e.jsx("p",{className:"text-dark-300",children:"Script checks: new_state > old_state"}),e.jsx("p",{className:"text-amber-400 mt-2",children:"Higher state number can always replace lower"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Benefits Over LN-Penalty"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Aspect"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"LN-Penalty"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Eltoo"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"State storage"}),e.jsx("td",{children:"All revocation secrets"}),e.jsx("td",{className:"text-emerald-400",children:"Only latest state"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Commitment symmetry"}),e.jsx("td",{children:"Asymmetric"}),e.jsx("td",{className:"text-emerald-400",children:"Symmetric"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Watchtower data"}),e.jsx("td",{children:"Per-state breach tx"}),e.jsx("td",{className:"text-emerald-400",children:"Single update tx"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Breach penalty"}),e.jsx("td",{children:"Lose all funds"}),e.jsx("td",{className:"text-amber-400",children:"Just reverted to latest"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:"Multiparty channels"}),e.jsx("td",{children:"Very complex"}),e.jsx("td",{className:"text-emerald-400",children:"Straightforward"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Challenge Period"}),e.jsxs(t,{type:"info",title:"Unilateral Close Process",children:[e.jsx("p",{children:"When broadcasting an update unilaterally:"}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Broadcast update tx (enters mempool/chain)"}),e.jsx("li",{children:"Challenge period begins (e.g., 1 week)"}),e.jsx("li",{children:"Counterparty can broadcast higher-numbered update"}),e.jsx("li",{children:"After challenge period, settlement tx finalizes balances"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Multiparty Channels"}),e.jsx("p",{className:"mb-4",children:"Eltoo's simplicity enables efficient multiparty channels:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# N-party Eltoo channel:"}),e.jsx("p",{className:"text-dark-300",children:"Funding: N-of-N multisig"}),e.jsx("p",{className:"text-dark-300",children:"Updates: All N parties sign with ANYPREVOUT"}),e.jsx("p",{className:"text-dark-300",children:"Settlement: Each party's balance output"}),e.jsx("p",{className:"text-dark-500 mt-3",children:"No exponential blowup like LN-Penalty multiparty"})]}),e.jsx(t,{type:"success",title:"Next-Generation Channels",children:e.jsx("p",{children:"Eltoo represents a significant simplification of payment channel construction. By eliminating revocation complexity and enabling symmetric states, it paves the way for more efficient Lightning implementations and opens possibilities for channel factories and other advanced constructions."})})]})}export{p as default};
