import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as r,C as s,D as t,E as a}from"./Callout-Bm0ChKkk.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function j(){return e.jsxs(r,{sectionId:63,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-61: Reject P2P Message"}),e.jsx("p",{className:"mb-4",children:"BIP-61 introduced the reject message for nodes to communicate why they rejected transactions or blocks. While useful for debugging, it was later deprecated due to fingerprinting concerns and limited practical value."}),e.jsx(s,{type:"warning",title:"Deprecated",children:e.jsx("p",{children:"The reject message was removed from Bitcoin Core in version 0.20.0. Nodes no longer send or process reject messages by default."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Original Purpose"}),e.jsx("p",{className:"mb-4",children:"BIP-61 aimed to improve debugging and user experience:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Tell wallet why a transaction was rejected"}),e.jsx("li",{children:"Help developers debug protocol issues"}),e.jsx("li",{children:"Provide meaningful error messages to users"}),e.jsx("li",{children:"Distinguish between different failure modes"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Message Format"}),e.jsx(t,{title:"Reject Message",children:e.jsx("p",{children:"A structured message containing the rejected command, error code, human-readable reason, and optional data (like the txid for transaction rejections)."})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Reject message fields:"}),e.jsx("p",{className:"text-dark-300",children:'message: "tx"  # What was rejected (tx, block, etc.)'}),e.jsx("p",{className:"text-dark-300",children:"ccode: 0x10    # Error code"}),e.jsx("p",{className:"text-dark-300",children:'reason: "insufficient fee"'}),e.jsx("p",{className:"text-dark-300",children:"data: [txid]   # 32-byte hash (for tx/block)"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Error Codes"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Code"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Name"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Meaning"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono",children:"0x01"}),e.jsx("td",{children:"REJECT_MALFORMED"}),e.jsx("td",{children:"Message couldn't be parsed"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono",children:"0x10"}),e.jsx("td",{children:"REJECT_INVALID"}),e.jsx("td",{children:"Invalid (consensus rules)"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono",children:"0x11"}),e.jsx("td",{children:"REJECT_OBSOLETE"}),e.jsx("td",{children:"Using obsolete version"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono",children:"0x12"}),e.jsx("td",{children:"REJECT_DUPLICATE"}),e.jsx("td",{children:"Already have it"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono",children:"0x40"}),e.jsx("td",{children:"REJECT_NONSTANDARD"}),e.jsx("td",{children:"Not standard (policy)"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono",children:"0x41"}),e.jsx("td",{children:"REJECT_DUST"}),e.jsx("td",{children:"Output below dust threshold"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-mono",children:"0x42"}),e.jsx("td",{children:"REJECT_INSUFFICIENTFEE"}),e.jsx("td",{children:"Fee too low"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Example Usage"}),e.jsx(a,{title:"Transaction Rejection Flow",children:e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Wallet broadcasts transaction:"}),e.jsx("p",{className:"text-dark-300",children:"wallet → node: tx(low_fee_transaction)"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Node rejects due to low fee:"}),e.jsx("p",{className:"text-dark-300",children:"node → wallet: reject("}),e.jsx("p",{className:"text-dark-500 ml-4",children:'message: "tx"'}),e.jsx("p",{className:"text-dark-500 ml-4",children:"ccode: REJECT_INSUFFICIENTFEE"}),e.jsx("p",{className:"text-dark-500 ml-4",children:'reason: "min relay fee not met"'}),e.jsx("p",{className:"text-dark-500 ml-4",children:"data: [txid]"}),e.jsx("p",{className:"text-dark-300",children:")"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Wallet can inform user:"}),e.jsx("p",{className:"text-emerald-400",children:'"Transaction rejected: fee too low"'})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why It Was Removed"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Fingerprinting Risk"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Different node implementations and versions produce different reject messages. This helps attackers identify what software a node runs."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Unreliable Information"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Reject messages are optional and may not be sent. Wallets can't rely on them for confirmation—must check other ways anyway."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Limited Utility"}),e.jsx("p",{className:"text-sm text-dark-300",children:"For transaction propagation, absence of inclusion in a block is the reliable signal. Reject messages from one peer don't guarantee network-wide rejection."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Modern Alternatives"}),e.jsx("p",{className:"mb-4",children:"Without reject messages, wallets determine transaction status by:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Monitor mempool:"})," Check if transaction appears in connected nodes' mempools"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Watch for confirmation:"})," Transaction eventually included in a block"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fee estimation:"})," Use proper fee estimation to avoid rejection"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Local validation:"})," Validate transactions locally before broadcast"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"sendrawtransaction RPC:"})," Returns error codes for local submission"]})]})}),e.jsx(s,{type:"info",title:"Debug Logging",children:e.jsx("p",{children:"While reject messages are gone from P2P, Bitcoin Core still logs rejection reasons locally. Developers can check debug.log to understand why a transaction was rejected by their own node."})}),e.jsx(s,{type:"success",title:"Protocol Simplification",children:e.jsx("p",{children:"Removing the reject message simplified the P2P protocol and reduced fingerprinting surface. It's a good example of removing features that seemed helpful but created more problems than they solved."})})]})}export{j as default};
