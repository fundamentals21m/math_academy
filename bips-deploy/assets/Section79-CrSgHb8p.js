import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as i,C as s,D as l,E as t}from"./Callout-Bm0ChKkk.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function j(){return e.jsxs(i,{sectionId:79,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-145: getblocktemplate for SegWit"}),e.jsx("p",{className:"mb-4",children:"BIP-145 extends the getblocktemplate protocol (BIP-22/23) to support Segregated Witness transactions. It adds new fields and rules for miners to properly include SegWit transactions in block templates."}),e.jsx(s,{type:"info",title:"Mining SegWit Blocks",children:e.jsx("p",{children:"Without BIP-145, mining software couldn't properly construct SegWit blocks. This BIP ensures miners can include witness data and calculate correct weights."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"New Requirements"}),e.jsx("p",{className:"mb-4",children:"SegWit changes block structure in ways that affect mining:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Witness data:"})," Must be included in blocks but not txid"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Weight limit:"})," Replaces size limit (4 million WU)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Witness commitment:"})," Required in coinbase output"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"wtxid:"})," Needed for witness merkle tree"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Requesting SegWit Templates"}),e.jsx(l,{title:"SegWit Capability",children:e.jsx("p",{children:'Miners signal SegWit support by including "segwit" in the rules array when calling getblocktemplate.'})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Request with SegWit support:"}),e.jsxs("p",{className:"text-dark-300",children:["getblocktemplate ","{"]}),e.jsx("p",{className:"text-amber-400 ml-4",children:'"rules": ["segwit"]'}),e.jsx("p",{className:"text-dark-300",children:"}"}),e.jsx("p",{className:"text-dark-500 mt-3",children:"Server includes SegWit transactions and witness data"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"New Transaction Fields"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Field"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Description"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"txid"}),e.jsx("td",{children:"Transaction ID (excludes witness)"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"hash"}),e.jsx("td",{children:"wtxid (includes witness)"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"weight"}),e.jsx("td",{children:"Transaction weight units"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"data"}),e.jsx("td",{children:"Full transaction including witness"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Template Changes"}),e.jsx(t,{title:"SegWit Template Fields",children:e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# New global fields:"}),e.jsx("p",{className:"text-dark-300",children:'"weightlimit": 4000000,  // Max block weight'}),e.jsx("p",{className:"text-dark-300",children:'"sigoplimit": 80000,     // Adjusted for SegWit'})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Witness commitment:"}),e.jsx("p",{className:"text-dark-300",children:'"default_witness_commitment":'}),e.jsx("p",{className:"text-dark-500 ml-4",children:'"6a24aa21a9ed..."  // OP_RETURN commitment'})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Witness Commitment"}),e.jsx("p",{className:"mb-4",children:"SegWit blocks require a commitment in the coinbase:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Coinbase witness commitment output:"}),e.jsx("p",{className:"text-dark-300",children:"OP_RETURN (0x6a)"}),e.jsx("p",{className:"text-dark-300",children:"OP_PUSHBYTES_36 (0x24)"}),e.jsx("p",{className:"text-dark-300",children:"0xaa21a9ed  // Commitment header"}),e.jsx("p",{className:"text-amber-400",children:"witness_root || nonce_commitment  // 32 bytes"}),e.jsx("p",{className:"text-dark-500 mt-3",children:"Commits to all witness data in the block"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Weight Calculation"}),e.jsxs(s,{type:"info",title:"Block Weight",children:[e.jsx("p",{children:"SegWit uses weight instead of raw size:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Base data: 4 WU per byte"}),e.jsx("li",{children:"Witness data: 1 WU per byte"}),e.jsx("li",{children:"Maximum block weight: 4,000,000 WU"}),e.jsx("li",{children:"Equivalent to ~1-4 MB depending on witness ratio"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Weight calculation:"}),e.jsx("p",{className:"text-dark-300",children:"tx_weight = (base_size × 4) + witness_size"}),e.jsx("p",{className:"text-dark-300",children:"block_weight = sum(tx_weights) + header_weight"}),e.jsx("p",{className:"text-dark-400 mt-2 mb-2",children:"# Must satisfy:"}),e.jsx("p",{className:"text-amber-400",children:"block_weight ≤ 4,000,000"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Miner Workflow"}),e.jsx(t,{title:"Building SegWit Block",children:e.jsx("div",{className:"space-y-3 text-dark-300",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2 ml-4",children:[e.jsx("li",{children:'Request template with "segwit" rule'}),e.jsx("li",{children:"Select transactions respecting weight limit"}),e.jsx("li",{children:"Build witness merkle tree from wtxids"}),e.jsx("li",{children:"Create witness commitment for coinbase"}),e.jsx("li",{children:"Build regular merkle tree from txids"}),e.jsx("li",{children:"Construct block header"}),e.jsx("li",{children:"Mine (search for valid nonce)"}),e.jsx("li",{children:"Submit block with full witness data"})]})})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Backward Compatibility"}),e.jsx("p",{className:"mb-4",children:"Mining software handles SegWit gracefully:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:'Without "segwit" rule:'})," Server returns pre-SegWit format"]}),e.jsxs("li",{children:[e.jsx("strong",{children:'With "segwit" rule:'})," Server includes witness data"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Transition:"})," Software can upgrade incrementally"]})]})}),e.jsx(s,{type:"success",title:"Essential for Mining",children:e.jsx("p",{children:"BIP-145 is essential infrastructure for SegWit mining. Without it, miners couldn't properly construct blocks containing SegWit transactions, and the network couldn't take advantage of SegWit's capacity increase."})})]})}export{j as default};
