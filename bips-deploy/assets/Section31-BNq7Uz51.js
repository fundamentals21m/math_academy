import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as r,C as s,D as a,E as t}from"./Callout-Bm0ChKkk.js";import{M as i}from"./MathBlock-fCav0pL3.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function b(){return e.jsxs(r,{sectionId:31,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Deterministic Entropy From BIP32 Keychains"}),e.jsx("p",{className:"mb-4",children:"BIP-85 defines a method for deriving multiple independent seeds from a single master seed. Instead of managing multiple seed phrases, users can derive child seeds for different applications—each with its own complete HD wallet—all from one master backup."}),e.jsx(s,{type:"info",title:"One Seed to Rule Them All",children:e.jsx("p",{children:'BIP-85 solves the "too many seeds" problem. Maintain one highly-secured master seed, and derive application-specific child seeds on demand. Lose a derived seed? Regenerate it from the master.'})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem"}),e.jsx("p",{className:"mb-4",children:"Modern cryptocurrency users often need multiple seeds:"}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:[e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Hot wallet for daily spending"}),e.jsx("li",{children:"Cold storage for long-term savings"}),e.jsx("li",{children:"Hardware wallet(s) for secure signing"}),e.jsx("li",{children:"Lightning node identity"}),e.jsx("li",{children:"Nostr keypair"}),e.jsx("li",{children:"Application-specific keys"})]}),e.jsx("p",{className:"text-rose-400 mt-3 text-sm",children:"Each requires its own backup → complexity and risk"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"BIP-85 Solution"}),e.jsx(a,{title:"Deterministic Entropy",children:e.jsx("p",{children:"BIP-85 uses the master seed to derive independent entropy blobs. Each blob can then be used as a seed for a new HD wallet, mnemonic phrase, or application key. The derivations are one-way—child seeds cannot reveal the master."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Derivation Path"}),e.jsx("p",{className:"mb-4",children:`BIP-85 reserves purpose 83696968' (ASCII for "bip"):`}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# BIP-85 derivation path structure"}),e.jsx("p",{className:"text-amber-400",children:"m / 83696968' / application' / language' / words' / index'"}),e.jsx("p",{className:"text-xs text-dark-500 mt-3",children:"All levels are hardened to prevent child seed exposure from compromising the master"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Application Types"}),e.jsx("p",{className:"mb-4",children:"Different applications use different derivation parameters:"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Application"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Code"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Output"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"BIP-39 Mnemonic"}),e.jsx("td",{className:"font-mono text-amber-400",children:"39'"}),e.jsx("td",{children:"12/18/24 word seed phrase"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"WIF (Raw key)"}),e.jsx("td",{className:"font-mono text-amber-400",children:"2'"}),e.jsx("td",{children:"Single private key (WIF format)"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"XPRV (HD root)"}),e.jsx("td",{className:"font-mono text-amber-400",children:"32'"}),e.jsx("td",{children:"BIP-32 extended private key"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:"Hex entropy"}),e.jsx("td",{className:"font-mono text-amber-400",children:"128169'"}),e.jsx("td",{children:"Raw bytes (variable length)"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Deriving a Child Mnemonic"}),e.jsx(t,{title:"BIP-39 Child Seed Derivation",children:e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-400",children:"# To derive a 12-word English mnemonic at index 0:"}),e.jsx("p",{className:"text-amber-400 mb-3",children:"m / 83696968' / 39' / 0' / 12' / 0'"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"Parameters:"}),e.jsx("p",{className:"text-dark-300",children:"• 39' = BIP-39 mnemonic"}),e.jsx("p",{className:"text-dark-300",children:"• 0' = English language"}),e.jsx("p",{className:"text-dark-300",children:"• 12' = 12 words (128 bits entropy)"}),e.jsx("p",{className:"text-dark-300",children:"• 0' = First child mnemonic"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Entropy Extraction"}),e.jsx("p",{className:"mb-4",children:"The child key is converted to entropy using HMAC-SHA512:"}),e.jsx(i,{children:'\\text{entropy} = \\text{HMAC-SHA512}(\\text{"bip-entropy-from-k"}, k)'}),e.jsx("p",{className:"text-dark-400 mb-6",children:"Where k is the derived private key at the specified path. The output is then truncated to the required entropy length."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Use Cases"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Hardware Wallet Setup"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Derive a child seed for each hardware wallet. If one is lost, regenerate from the master without exposing other devices."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Hot/Cold Separation"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Keep a minimal derived seed on mobile, master seed in cold storage. Compromise of hot wallet doesn't affect cold funds."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Application Keys"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Derive keys for Nostr, Lightning, or other protocols without exposing your main Bitcoin keys."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Backup Simplification"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Back up one master seed with high security. Derived seeds are recoverable and need less rigorous backup."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Security Properties"}),e.jsx(s,{type:"warning",title:"One-Way Derivation",children:e.jsx("p",{children:"BIP-85 derivation is one-way. A compromised child seed reveals nothing about the master or other children. However, the master seed can regenerate ALL children—protect it accordingly!"})}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-3",children:"Security guarantees:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Child seeds are cryptographically independent"}),e.jsx("li",{children:"Compromising child N doesn't help attack child M"}),e.jsx("li",{children:"All hardened derivation prevents public key attacks"}),e.jsx("li",{children:"HMAC extraction adds additional security layer"})]})]}),e.jsx(t,{title:"Practical Workflow",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Generate or use existing 24-word master seed"}),e.jsx("li",{children:"Store master seed with maximum security (metal, vault, etc.)"}),e.jsx("li",{children:"Derive child seed for hardware wallet: m/83696968'/39'/0'/24'/0'"}),e.jsx("li",{children:"Derive child seed for mobile wallet: m/83696968'/39'/0'/12'/1'"}),e.jsx("li",{children:"Each child operates as completely independent wallet"}),e.jsx("li",{children:"If mobile seed compromised, regenerate at index 2"})]})}),e.jsx(s,{type:"success",title:"Future-Proof Backup",children:e.jsx("p",{children:"BIP-85 represents a paradigm shift in key management. Instead of an ever-growing collection of seed phrases, users can maintain a single master with deterministic child derivation for any future application—known or yet to be invented."})})]})}export{b as default};
