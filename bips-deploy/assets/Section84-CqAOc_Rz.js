import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as t,C as s,D as r,E as a}from"./Callout-Bm0ChKkk.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(t,{sectionId:84,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-199: Hashed Time-Locked Contracts"}),e.jsx("p",{className:"mb-4",children:"BIP-199 standardizes Hashed Time-Locked Contracts (HTLCs), the fundamental building block for trustless atomic swaps and payment channel networks like Lightning."}),e.jsx(s,{type:"info",title:"Foundation of Layer 2",children:e.jsx("p",{children:"HTLCs enable conditional payments that either complete atomically or refund safely. This primitive powers cross-chain swaps and multi-hop Lightning payments."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"What is an HTLC?"}),e.jsx(r,{title:"Hashed Time-Locked Contract",children:e.jsx("p",{children:"A conditional payment that can be claimed by revealing a secret (preimage) before a timeout, or refunded to the sender after the timeout expires. Uses hash locks for conditionality and time locks for safety."})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# HTLC conditions:"}),e.jsx("p",{className:"text-dark-300",children:"IF"}),e.jsx("p",{className:"text-amber-400 ml-4",children:"Hash(preimage) == hash AND receiver_sig"}),e.jsx("p",{className:"text-dark-300",children:"ELSE"}),e.jsx("p",{className:"text-amber-400 ml-4",children:"timeout_passed AND sender_sig"}),e.jsx("p",{className:"text-dark-500 mt-3",children:"Receiver must reveal preimage to claim, otherwise sender refunds"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Script Structure"}),e.jsx(a,{title:"BIP-199 HTLC Script",children:e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Redemption path (hashlock):"}),e.jsx("p",{className:"text-dark-300",children:"OP_IF"}),e.jsx("p",{className:"text-dark-300 ml-4",children:"OP_SHA256 <hash> OP_EQUALVERIFY"}),e.jsx("p",{className:"text-dark-300 ml-4",children:"OP_DUP OP_HASH160 <receiver_pubkey_hash>"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# Refund path (timelock):"}),e.jsx("p",{className:"text-dark-300",children:"OP_ELSE"}),e.jsx("p",{className:"text-dark-300 ml-4",children:"<timeout> OP_CHECKLOCKTIMEVERIFY OP_DROP"}),e.jsx("p",{className:"text-dark-300 ml-4",children:"OP_DUP OP_HASH160 <sender_pubkey_hash>"}),e.jsx("p",{className:"text-dark-300",children:"OP_ENDIF"}),e.jsx("p",{className:"text-dark-300",children:"OP_EQUALVERIFY OP_CHECKSIG"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"HTLC Flow"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"1."}),e.jsx("p",{className:"text-dark-300",children:"Receiver generates random preimage, computes hash"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"2."}),e.jsx("p",{className:"text-dark-300",children:"Sender creates HTLC with receiver's hash"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"3."}),e.jsx("p",{className:"text-dark-300",children:"Receiver claims by revealing preimage before timeout"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"4."}),e.jsx("p",{className:"text-dark-300",children:"If unclaimed, sender refunds after timeout"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Atomic Swaps"}),e.jsx("p",{className:"mb-4",children:"HTLCs enable trustless cross-chain exchanges:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Cross-chain atomic swap:"}),e.jsx("p",{className:"text-dark-300",children:"Alice: 1 BTC → Bob (hash H, timeout T1)"}),e.jsx("p",{className:"text-dark-300",children:"Bob: 50 LTC → Alice (same hash H, timeout T2)"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# Requirements:"}),e.jsx("p",{className:"text-amber-400",children:"T1 > T2 (Alice's timeout longer)"}),e.jsx("p",{className:"text-dark-500 mt-2",children:"Both use same hash → revealing preimage claims both"})]}),e.jsx(a,{title:"Atomic Swap Execution",children:e.jsxs("div",{className:"space-y-3 text-dark-300",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 1. Alice creates preimage:"}),e.jsx("p",{className:"text-dark-300",children:"preimage = random_bytes(32)"}),e.jsx("p",{className:"text-dark-300",children:"hash = SHA256(preimage)"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 2. Alice locks BTC with HTLC:"}),e.jsx("p",{className:"text-dark-300",children:"HTLC(1 BTC, hash, Bob, timeout=24h)"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 3. Bob locks LTC with same hash:"}),e.jsx("p",{className:"text-dark-300",children:"HTLC(50 LTC, hash, Alice, timeout=12h)"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 4. Alice claims LTC (reveals preimage):"}),e.jsx("p",{className:"text-emerald-400",children:"claim(preimage) → Alice receives 50 LTC"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# 5. Bob uses revealed preimage:"}),e.jsx("p",{className:"text-emerald-400",children:"claim(preimage) → Bob receives 1 BTC"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Lightning Network Usage"}),e.jsx("p",{className:"mb-4",children:"Lightning uses HTLCs for multi-hop payments:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Multi-hop payment:"}),e.jsx("p",{className:"text-dark-300",children:"Alice → Bob → Carol → Dave"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# HTLC chain (same hash, decreasing timeouts):"}),e.jsx("p",{className:"text-dark-300",children:"Alice→Bob: HTLC(amount+fees, H, T+30)"}),e.jsx("p",{className:"text-dark-300",children:"Bob→Carol: HTLC(amount+fee, H, T+20)"}),e.jsx("p",{className:"text-dark-300",children:"Carol→Dave: HTLC(amount, H, T+10)"}),e.jsx("p",{className:"text-dark-500 mt-2",children:"Dave reveals preimage, unlocking entire chain"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Security Considerations"}),e.jsx(s,{type:"warning",title:"HTLC Security",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Timeout must be sufficient for blockchain confirmation"}),e.jsx("li",{children:"Preimage must be high-entropy (256 bits)"}),e.jsx("li",{children:"Monitor for preimage revelation on-chain"}),e.jsx("li",{children:"Cascading timeouts must decrease toward receiver"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Hash Functions"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Hash"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Use Case"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Notes"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"SHA256"}),e.jsx("td",{children:"Standard HTLCs"}),e.jsx("td",{children:"Most common, Bitcoin native"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"HASH160"}),e.jsx("td",{children:"Compact HTLCs"}),e.jsx("td",{children:"Smaller output, less security margin"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-mono text-amber-400",children:"SHA256²"}),e.jsx("td",{children:"Lightning"}),e.jsx("td",{children:"Double-SHA256 for compatibility"})]})]})]})}),e.jsx(s,{type:"success",title:"Universal Building Block",children:e.jsx("p",{children:"HTLCs are the universal building block for trustless conditional payments. From simple atomic swaps to complex Lightning routes, the hash-and-time-lock pattern ensures either complete execution or safe refund—enabling an entire ecosystem of Layer 2 protocols."})})]})}export{p as default};
