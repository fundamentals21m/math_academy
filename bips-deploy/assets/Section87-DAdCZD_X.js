import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as s,C as t,D as a,E as l}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(s,{sectionId:87,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-119 Deep Dive: Vaults"}),e.jsx("p",{className:"mb-4",children:"BIP-119 (OP_CHECKTEMPLATEVERIFY) enables Bitcoin vaults—self-custodial cold storage with built-in spending restrictions that provide time to respond to theft attempts."}),e.jsx(t,{type:"info",title:"Covenants for Security",children:e.jsx("p",{children:"Vaults use CTV's covenant capability to pre-commit funds to specific spending paths, creating a security model that's resistant to key compromise."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Vault Problem"}),e.jsx("p",{className:"mb-4",children:"Traditional Bitcoin custody has a fundamental tension:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border-r border-dark-700 pr-4",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Hot Wallet Risk"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Keys online for quick access. Attacker with key access can steal instantly."})]}),e.jsxs("div",{className:"pl-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Cold Storage Trade-off"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Keys offline for security. Difficult to access when needed, still vulnerable when signing."})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Vault Architecture"}),e.jsx(a,{title:"Bitcoin Vault",children:e.jsx("p",{children:'A smart contract construction where funds can only be spent through a two-step process: first to an intermediate "unvaulting" state, then to the final destination after a time delay. This delay allows the owner to recover funds if the unvaulting was unauthorized.'})}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Vault spending paths:"}),e.jsx("p",{className:"text-dark-300",children:"Vault UTXO"}),e.jsx("p",{className:"text-dark-300 ml-4",children:"├─ Unvault tx (triggers timelock)"}),e.jsx("p",{className:"text-dark-300 ml-8",children:"├─ Withdraw tx (after delay)"}),e.jsx("p",{className:"text-dark-300 ml-8",children:"└─ Recovery tx (anytime, to cold storage)"}),e.jsx("p",{className:"text-dark-500 mt-3",children:"Recovery path allows stopping theft during delay period"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"CTV-Based Vault"}),e.jsx(l,{title:"Simple CTV Vault",children:e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Vault script:"}),e.jsx("p",{className:"text-dark-300",children:"<unvault_template_hash> OP_CTV"}),e.jsx("p",{className:"text-dark-500 mt-2",children:"Funds can ONLY go to pre-defined unvault output"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Unvault output script:"}),e.jsx("p",{className:"text-dark-300",children:"OP_IF"}),e.jsx("p",{className:"text-dark-300 ml-4",children:"<delay> OP_CSV <hot_key> OP_CHECKSIG"}),e.jsx("p",{className:"text-dark-300",children:"OP_ELSE"}),e.jsx("p",{className:"text-dark-300 ml-4",children:"<recovery_key> OP_CHECKSIG"}),e.jsx("p",{className:"text-dark-300",children:"OP_ENDIF"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Vault Flow"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"1."}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-300 font-bold",children:"Setup"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Create vault output with CTV committing to unvault tx"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"2."}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-300 font-bold",children:"Initiate Withdrawal"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Broadcast unvault tx, starting the timelock"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"3."}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-300 font-bold",children:"Monitoring Period"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Watch for unexpected unvaulting (e.g., 1 week delay)"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-emerald-400 font-bold",children:"4a."}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-300 font-bold",children:"Complete Withdrawal"}),e.jsx("p",{className:"text-sm text-dark-400",children:"After delay, withdraw to destination address"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-rose-400 font-bold",children:"4b."}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-300 font-bold",children:"Recovery (if theft)"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Immediately sweep to recovery address using cold key"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Security Properties"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Protected Against"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Instant theft (delay gives time to react)"}),e.jsx("li",{children:"Hot key compromise alone"}),e.jsx("li",{children:"Coercion without cold key"}),e.jsx("li",{children:"Undetected key leakage"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Requires"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Monitoring for unvault txs"}),e.jsx("li",{children:"Secure recovery key (cold)"}),e.jsx("li",{children:"Ability to broadcast recovery tx"}),e.jsx("li",{children:"Time to respond during delay"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Watchtower Integration"}),e.jsxs(t,{type:"info",title:"Vault Watchtowers",children:[e.jsx("p",{children:"Watchtowers can monitor the blockchain for unauthorized unvault transactions and automatically broadcast recovery transactions:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Only need to store recovery transaction"}),e.jsx("li",{children:"Can't steal funds (recovery goes to your cold storage)"}),e.jsx("li",{children:"Multiple watchtowers for redundancy"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Advanced Vault Patterns"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Tiered vault with rate limiting:"}),e.jsx("p",{className:"text-dark-300",children:"Vault (100 BTC total)"}),e.jsx("p",{className:"text-dark-300 ml-4",children:"├─ Unvault tx commits to:"}),e.jsx("p",{className:"text-dark-300 ml-8",children:"├─ 1 BTC to withdrawal (1 day delay)"}),e.jsx("p",{className:"text-dark-300 ml-8",children:"└─ 99 BTC back to new vault"}),e.jsx("p",{className:"text-dark-500 mt-2",children:"Maximum 1 BTC per day even with hot key compromised"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Comparison with Multisig"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Aspect"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Multisig"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Vault"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Theft protection"}),e.jsx("td",{children:"Need multiple keys"}),e.jsx("td",{className:"text-emerald-400",children:"Time delay + monitoring"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Key loss risk"}),e.jsx("td",{children:"Lose threshold = lost funds"}),e.jsx("td",{className:"text-amber-400",children:"Still need both keys"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Operational complexity"}),e.jsx("td",{children:"Coordinate signers"}),e.jsx("td",{children:"Monitor + wait"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:"Single-user friendly"}),e.jsx("td",{children:"Awkward (same person, multiple keys)"}),e.jsx("td",{className:"text-emerald-400",children:"Designed for it"})]})]})]})}),e.jsx(t,{type:"success",title:"Self-Custody Revolution",children:e.jsx("p",{children:"CTV-based vaults represent a significant advancement in Bitcoin self-custody. By adding time as a security dimension, vaults provide protection against key compromise that was previously impossible without trusted third parties—making secure self-custody accessible to everyone."})})]})}export{p as default};
