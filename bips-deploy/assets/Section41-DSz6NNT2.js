import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as t,C as s,D as n,E as a}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function h(){return e.jsxs(t,{sectionId:41,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Opt-in Full Replace-by-Fee Signaling"}),e.jsx("p",{className:"mb-4",children:'BIP-125 defines how transactions can signal that they may be replaced by higher-fee versions before confirmation. This "Replace-by-Fee" (RBF) mechanism allows users to unstick stuck transactions and enables fee market efficiency.'}),e.jsx(s,{type:"info",title:"Opt-in by Default",children:e.jsx("p",{children:"As of Bitcoin Core 24.0, all transactions are created with RBF signaling enabled by default. BIP-125 defines how this signaling works and how nodes should handle replacement transactions."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem"}),e.jsx("p",{className:"mb-4",children:"Without RBF, a stuck transaction creates problems:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Transaction with too-low fee may never confirm"}),e.jsx("li",{children:'Funds are "stuck" until the tx confirms or is forgotten'}),e.jsx("li",{children:"No way to increase the fee after broadcast"}),e.jsx("li",{children:"Must wait for mempool expiry (typically 2 weeks)"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The RBF Signal"}),e.jsxs(n,{title:"Sequence Number Signaling",children:[e.jsx("p",{children:"A transaction signals RBF opt-in if any of its inputs has a sequence number less than 0xfffffffe (the maximum minus one)."}),e.jsxs("div",{className:"font-mono text-sm mt-3",children:[e.jsx("p",{className:"text-dark-300",children:"Sequence < 0xfffffffe → RBF enabled"}),e.jsx("p",{className:"text-dark-300",children:"Sequence ≥ 0xfffffffe → RBF disabled (final)"})]})]}),e.jsx(a,{title:"Sequence Values",children:e.jsxs("div",{className:"space-y-3 font-mono text-sm",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# RBF enabled (most wallets default)"}),e.jsx("p",{className:"text-amber-400",children:"sequence: 0xfffffffd"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# RBF disabled (final)"}),e.jsx("p",{className:"text-dark-300",children:"sequence: 0xffffffff"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# With relative timelock (also RBF)"}),e.jsx("p",{className:"text-dark-300",children:"sequence: 0x00000001 (1 block)"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Replacement Rules"}),e.jsx("p",{className:"mb-4",children:"For a replacement transaction to be accepted:"}),e.jsx("div",{className:"bg-dark-800 rounded-lg p-5 mb-6",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Original transaction must signal RBF (sequence < 0xfffffffe)"}),e.jsx("li",{children:"Replacement must conflict (spend at least one of the same inputs)"}),e.jsx("li",{children:"Replacement must pay higher absolute fee"}),e.jsx("li",{children:"Replacement must pay for its own bandwidth (additional fee ≥ min relay fee × size)"}),e.jsx("li",{children:"Replacement must not evict more than 100 transactions"}),e.jsx("li",{children:"All directly conflicting transactions must be RBF-signaling"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Fee Bumping"}),e.jsx(a,{title:"RBF Fee Bump",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-dark-400",children:"Original transaction:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-300",children:"Inputs: A (1 BTC)"}),e.jsx("p",{className:"text-dark-300",children:"Output: B (0.9 BTC)"}),e.jsx("p",{className:"text-dark-300",children:"Fee: 0.1 BTC (100,000 sat)"}),e.jsx("p",{className:"text-amber-400",children:"sequence: 0xfffffffd (RBF enabled)"})]}),e.jsx("p",{className:"text-dark-400 mt-3",children:"Replacement transaction:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-300",children:"Inputs: A (1 BTC) ← same input"}),e.jsx("p",{className:"text-dark-300",children:"Output: B (0.85 BTC) ← reduced"}),e.jsx("p",{className:"text-emerald-400",children:"Fee: 0.15 BTC (150,000 sat) ← increased"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Use Cases"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Fee Bumping"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Increase fee on stuck transaction to get faster confirmation."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Payment Cancellation"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Replace a payment with a transaction sending funds back to yourself."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Batching"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Add more recipients to an unconfirmed payment to save fees."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Error Correction"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Fix mistakes in unconfirmed transactions (wrong address, amount)."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Security Considerations"}),e.jsxs(s,{type:"warning",title:"Zero-Conf Risk",children:[e.jsx("p",{children:"RBF means unconfirmed transactions can be replaced. Merchants accepting zero-confirmation payments should:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Check if transaction signals RBF"}),e.jsx("li",{children:"Wait for confirmations for significant amounts"}),e.jsx("li",{children:"Use Lightning for instant finality"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Full RBF"}),e.jsx("p",{className:"mb-4",children:'Bitcoin Core 24.0 introduced optional "full RBF" (mempoolfullrbf=1):'}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-400 font-semibold mb-2",children:"Opt-in RBF (BIP-125)"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Only replace transactions that explicitly signal RBF via sequence number."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-emerald-400 font-semibold mb-2",children:"Full RBF"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Allow replacement of any unconfirmed transaction, regardless of signaling."})]})]})}),e.jsx(s,{type:"success",title:"Best Practices",children:e.jsx("p",{children:"Always enable RBF signaling on outgoing transactions (the default in modern wallets). This preserves your option to fee bump if needed. Only disable RBF if you specifically need to signal finality to a recipient and understand the trade-offs."})})]})}export{h as default};
