import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as t,C as s,D as i,E as a}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function b(){return e.jsxs(t,{sectionId:56,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"BIP-47: Reusable Payment Codes"}),e.jsx("p",{className:"mb-4",children:"BIP-47 defines reusable payment codes—a way to receive payments to unique addresses without interactive address exchange. Payment codes enable address reuse avoidance while maintaining a single, shareable identifier."}),e.jsx(s,{type:"info",title:"Also Known As",children:e.jsx("p",{children:`BIP-47 payment codes are sometimes called "PayNyms" (Samourai Wallet's branding) or "stealth addresses" (though technically distinct from other stealth schemes).`})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem"}),e.jsx("p",{className:"mb-4",children:"Static addresses have a privacy vs. usability tradeoff:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Reusing Addresses"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Easy to share one address"}),e.jsx("li",{children:"All payments visible together"}),e.jsx("li",{children:"Transaction history exposed"}),e.jsx("li",{children:"Terrible for privacy"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-amber-500/30",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Fresh Addresses"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Great privacy"}),e.jsx("li",{children:"Requires interaction each time"}),e.jsx("li",{children:"Can't put in email signature"}),e.jsx("li",{children:"Inconvenient for recurring payments"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Payment Codes"}),e.jsxs(i,{title:"BIP-47 Payment Code",children:[e.jsx("p",{children:"A payment code is derived from an extended public key (like BIP-32) and can be shared publicly. Anyone with your payment code can derive unique addresses for you without further interaction."}),e.jsx("div",{className:"font-mono text-xs text-amber-400 mt-3 break-all",children:"PM8TJTLJbPRGxSbc8EJi42Wrr6QbNSaSSVJ5Y3E4pbCYiTHUskHg13935..."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"How It Works"}),e.jsx(a,{title:"Payment Code Flow",children:e.jsx("div",{className:"space-y-3 text-dark-300",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2 ml-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Alice:"})," Shares her payment code publicly (website, social media)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Bob:"})," Wants to pay Alice for the first time"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Notification TX:"}),` Bob sends a special "notification" transaction to Alice's notification address`]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Shared Secret:"})," Both derive a shared secret from ECDH"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Payments:"})," Bob derives unique addresses for Alice using the shared secret"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Alice scans:"})," Alice checks for payments using the same derivation"]})]})})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Notification Transaction"}),e.jsx("p",{className:"mb-4",children:"The notification transaction establishes a payment channel:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Notification transaction output:"}),e.jsx("p",{className:"text-dark-300",children:"OP_RETURN <blinded_payment_code>"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# Or using designated notification address:"}),e.jsx("p",{className:"text-dark-300",children:"Output to Alice's notification address (derived from payment code)"}),e.jsx("p",{className:"text-dark-500 mt-3",children:"Alice monitors her notification address to discover new payers"})]}),e.jsx(s,{type:"warning",title:"Notification Drawback",children:e.jsx("p",{children:"The notification transaction is a privacy leak—it's a visible on-chain link between sender and receiver. This is BIP-47's main criticism compared to Silent Payments (BIP-352) which requires no notification."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Address Derivation"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Shared secret derivation:"}),e.jsx("p",{className:"text-dark-300",children:"S = bob_private × Alice_pubkey"}),e.jsx("p",{className:"text-dark-300",children:"  = alice_private × Bob_pubkey  (same point!)"}),e.jsx("p",{className:"text-dark-400 mt-3 mb-2",children:"# Payment address derivation:"}),e.jsx("p",{className:"text-dark-300",children:"secret_n = SHA256(S || n)  // n = payment counter"}),e.jsx("p",{className:"text-amber-400",children:"address_n = Alice_address + secret_n × G"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Payment Code Structure"}),e.jsx("p",{className:"mb-4",children:"A version 1 payment code contains:"}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:[e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Version byte:"})," 0x01 for version 1"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Features byte:"})," Capabilities bitfield"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Sign byte:"})," Public key Y coordinate parity"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Public key X:"})," 32 bytes"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Chain code:"})," 32 bytes (for HD derivation)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Reserved:"})," 13 bytes for future use"]})]}),e.jsx("p",{className:"text-dark-500 text-sm mt-3",children:"Total: 80 bytes, Base58Check encoded with version 0x47"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Version 3: SegWit"}),e.jsx("p",{className:"mb-4",children:"BIP-47 version 3 adds SegWit support:"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Native SegWit (P2WPKH)"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Derived addresses are bc1q... format, reducing fees and improving privacy through the SegWit anonymity set."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"Notification via OP_RETURN"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Blinded payment code in OP_RETURN avoids revealing notification address."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Comparison to Alternatives"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Feature"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"BIP-47"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Silent Payments"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Notification TX"}),e.jsx("td",{className:"text-rose-400",children:"Required"}),e.jsx("td",{className:"text-emerald-400",children:"Not needed"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"Scanning cost"}),e.jsx("td",{children:"Monitor notification address"}),e.jsx("td",{children:"Scan all transactions"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"On-chain link"}),e.jsx("td",{className:"text-rose-400",children:"Notification visible"}),e.jsx("td",{className:"text-emerald-400",children:"No link"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:"Wallet support"}),e.jsx("td",{children:"Samourai, Sparrow"}),e.jsx("td",{children:"Newer, growing"})]})]})]})}),e.jsx(s,{type:"success",title:"Practical Privacy Tool",children:e.jsx("p",{children:"Despite the notification transaction drawback, BIP-47 payment codes are widely used and provide real privacy benefits. They're particularly useful for recurring payments between parties who have already established a relationship."})})]})}export{b as default};
