import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as t,C as s,D as i,E as r}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(t,{sectionId:33,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Bitcoin Secure Multisig Setup (BSMS)"}),e.jsx("p",{className:"mb-4",children:"BIP-129 defines a standard protocol for setting up multisig wallets across different devices and software. BSMS solves the coordination problem: how do multiple hardware wallets and software wallets agree on addresses without compromising security?"}),e.jsx(s,{type:"info",title:"Interoperability Standard",children:e.jsx("p",{children:"Before BIP-129, setting up a multisig wallet across different vendors (Coldcard, Ledger, Trezor, etc.) was error-prone and vendor-specific. BSMS provides a universal protocol for secure coordination."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Multisig Setup Problem"}),e.jsx("p",{className:"mb-4",children:"Creating a secure multisig wallet requires careful coordination:"}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-3",children:"Challenges:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Each signer must share their extended public key"}),e.jsx("li",{children:"All signers must agree on the exact script template"}),e.jsx("li",{children:"Keys must be combined in the same order everywhere"}),e.jsx("li",{children:"Each device must verify it's part of the correct quorum"}),e.jsx("li",{children:"MITM attacks during setup could redirect funds"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"BSMS Protocol Overview"}),e.jsxs(i,{title:"BSMS Roles",children:[e.jsx("p",{children:"BIP-129 defines two participant roles:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Coordinator:"})," Initiates setup, collects keys, distributes final config"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Signer:"})," Provides extended public key, verifies and stores final config"]})]}),e.jsx("p",{className:"text-dark-500 text-sm mt-2",children:"The coordinator may also be a signer, but the roles are logically separate."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Protocol Rounds"}),e.jsx("p",{className:"mb-4",children:"BSMS uses a two-round protocol:"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Round 1: Key Collection"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-dark-300",children:[e.jsx("li",{children:"Coordinator creates setup token with parameters"}),e.jsx("li",{children:"Each signer generates SIGNER token with their xpub"}),e.jsx("li",{children:"Signers transmit tokens to coordinator"}),e.jsx("li",{children:"Coordinator verifies all tokens received"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Round 2: Configuration Distribution"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-dark-300",children:[e.jsx("li",{children:"Coordinator builds final descriptor from all xpubs"}),e.jsx("li",{children:"Coordinator creates COORDINATOR token with descriptor"}),e.jsx("li",{children:"Each signer imports and verifies the token"}),e.jsx("li",{children:"Signers confirm their key is included correctly"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Token Format"}),e.jsx(r,{title:"BSMS Token Structure",children:e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsx("p",{className:"text-dark-400",children:"# SIGNER token (Round 1)"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 break-all",children:[e.jsx("p",{className:"text-amber-400",children:"BSMS 1.0"}),e.jsx("p",{className:"text-dark-300",children:"00"}),e.jsx("p",{className:"text-dark-300",children:"[xpub661MyMwAqRbcF...]"}),e.jsx("p",{className:"text-dark-300",children:"/48h/0h/0h/2h"}),e.jsx("p",{className:"text-emerald-400",children:"My Coldcard"})]}),e.jsx("p",{className:"text-dark-400 mt-4",children:"# COORDINATOR token (Round 2)"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 break-all",children:[e.jsx("p",{className:"text-amber-400",children:"BSMS 1.0"}),e.jsx("p",{className:"text-dark-300",children:"00"}),e.jsx("p",{className:"text-dark-300",children:"wsh(sortedmulti(2,[fp1/48h/0h/0h/2h]xpub1,...,[fp2/48h/0h/0h/2h]xpub2,...))"}),e.jsx("p",{className:"text-dark-300",children:"/0/*,/1/*"}),e.jsx("p",{className:"text-emerald-400",children:"Family Vault 2-of-3"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Security Features"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Key Origin Info"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Each xpub includes its derivation path and parent fingerprint, enabling verification of the complete key lineage."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Descriptor Commitment"}),e.jsx("p",{className:"text-sm text-dark-300",children:"The final descriptor is signed/verified by each device, preventing coordinator manipulation."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Human Verification"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Descriptive labels allow users to verify they're joining the correct multisig on each device."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Encryption Option"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Tokens can be encrypted with a shared password for transmission over insecure channels."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Supported Script Types"}),e.jsx("p",{className:"mb-4",children:"BSMS supports modern multisig formats:"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Script"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Address"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Path"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"P2SH"}),e.jsx("td",{className:"font-mono text-xs",children:"3..."}),e.jsx("td",{className:"font-mono text-xs",children:"m/45'/0'/..."})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"P2SH-P2WSH"}),e.jsx("td",{className:"font-mono text-xs",children:"3..."}),e.jsx("td",{className:"font-mono text-xs",children:"m/48'/0'/0'/1'"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 text-amber-400",children:"P2WSH (native)"}),e.jsx("td",{className:"font-mono text-xs",children:"bc1q..."}),e.jsx("td",{className:"font-mono text-xs",children:"m/48'/0'/0'/2'"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 text-emerald-400",children:"P2TR (Taproot)"}),e.jsx("td",{className:"font-mono text-xs",children:"bc1p..."}),e.jsx("td",{className:"font-mono text-xs",children:"TBD"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Practical Workflow"}),e.jsx(r,{title:"2-of-3 Multisig Setup",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Coordinator creates setup:"}),e.jsx("br",{}),e.jsx("span",{className:"text-dark-500",children:"Specifies 2-of-3, P2WSH, and descriptive name"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Each signer exports their token:"}),e.jsx("br",{}),e.jsx("span",{className:"text-dark-500",children:"Via QR code, SD card, or NFC"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Coordinator combines tokens:"}),e.jsx("br",{}),e.jsx("span",{className:"text-dark-500",children:"Creates final sortedmulti descriptor"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Signers import final config:"}),e.jsx("br",{}),e.jsx("span",{className:"text-dark-500",children:"Each device verifies its key is present"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Test receive and sign:"}),e.jsx("br",{}),e.jsx("span",{className:"text-dark-500",children:"Verify all devices show same addresses"})]})]})}),e.jsx(s,{type:"warning",title:"Verify on Device",children:e.jsx("p",{children:"Always verify the multisig configuration on each hardware wallet's screen. The coordinator could be compromisedâ€”only trust what each signing device displays."})}),e.jsx(s,{type:"success",title:"Industry Adoption",children:e.jsx("p",{children:"BSMS is supported by major hardware wallets including Coldcard, Passport, and Keystone, as well as coordinator software like Sparrow and Specter. This enables true vendor-agnostic multisig security."})})]})}export{p as default};
