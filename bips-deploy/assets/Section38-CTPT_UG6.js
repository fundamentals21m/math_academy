import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as t,C as s,D as a,E as d}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(t,{sectionId:38,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Address Format for Pay-to-Script-Hash"}),e.jsx("p",{className:"mb-4",children:'BIP-13 defines the address format for P2SH outputs—the familiar "3..." addresses. This simple BIP established the encoding scheme that allowed users to send to script hash addresses without understanding the underlying scripts.'}),e.jsx(s,{type:"info",title:"Companion to BIP-16",children:e.jsx("p",{children:"BIP-13 defines the address format while BIP-16 defines the script semantics. Together they enabled P2SH, which was revolutionary for making complex scripts user-friendly."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem"}),e.jsx("p",{className:"mb-4",children:"Before P2SH, users sending to complex scripts faced challenges:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Senders needed to understand the script being paid to"}),e.jsx("li",{children:"Wallets had to encode arbitrary scripts—no standard format"}),e.jsx("li",{children:"Users couldn't easily verify they were paying to the right script"}),e.jsx("li",{children:"Complex scripts created large, expensive outputs"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Solution"}),e.jsxs(a,{title:"P2SH Address Format",children:[e.jsx("p",{children:"P2SH addresses encode the hash of a script, not the script itself. Senders pay to the hash; the recipient reveals the script when spending."}),e.jsx("div",{className:"font-mono text-lg text-amber-400 mt-3",children:"Base58Check(0x05 || HASH160(script))"}),e.jsx("p",{className:"text-dark-500 text-sm mt-2",children:'Version byte 0x05 produces addresses starting with "3"'})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Address Encoding"}),e.jsx("p",{className:"mb-4",children:"P2SH addresses use Base58Check encoding like P2PKH, but with a different version:"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Type"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Version"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Prefix"}),e.jsx("th",{className:"text-left py-3 text-dark-300",children:"Example"})]})}),e.jsxs("tbody",{className:"text-dark-400",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"P2PKH (mainnet)"}),e.jsx("td",{className:"font-mono",children:"0x00"}),e.jsx("td",{children:"1"}),e.jsx("td",{className:"font-mono text-xs",children:"1A1zP1eP5QGefi2..."})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3 text-amber-400",children:"P2SH (mainnet)"}),e.jsx("td",{className:"font-mono text-amber-400",children:"0x05"}),e.jsx("td",{className:"text-amber-400",children:"3"}),e.jsx("td",{className:"font-mono text-xs",children:"3J98t1WpEZ73CNm..."})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-3",children:"P2PKH (testnet)"}),e.jsx("td",{className:"font-mono",children:"0x6F"}),e.jsx("td",{children:"m/n"}),e.jsx("td",{className:"font-mono text-xs",children:"mipcBbFg9gMiCh8..."})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:"P2SH (testnet)"}),e.jsx("td",{className:"font-mono",children:"0xC4"}),e.jsx("td",{children:"2"}),e.jsx("td",{className:"font-mono text-xs",children:"2MzQwSSnBHWHqSA..."})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Address Generation"}),e.jsx(d,{title:"Creating a P2SH Address",children:e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# 1. Define the redeemScript:"}),e.jsx("p",{className:"text-dark-300",children:"OP_2 <pk1> <pk2> <pk3> OP_3 OP_CHECKMULTISIG"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# 2. Hash the script:"}),e.jsx("p",{className:"text-dark-300",children:"scriptHash = HASH160(redeemScript)"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# 3. Add version and checksum:"}),e.jsx("p",{className:"text-dark-300",children:"payload = 0x05 || scriptHash"}),e.jsx("p",{className:"text-dark-300",children:"checksum = SHA256(SHA256(payload))[0:4]"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# 4. Base58 encode:"}),e.jsx("p",{className:"text-amber-400",children:"address = Base58(payload || checksum)"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"User Experience"}),e.jsx("p",{className:"mb-4",children:"P2SH addresses dramatically simplified payments to complex scripts:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Before P2SH"}),e.jsx("p",{className:"text-sm text-dark-300",children:'"Please pay to this multisig script: OP_2 <33-byte-key> <33-byte-key> <33-byte-key> OP_3 OP_CHECKMULTISIG"'}),e.jsx("p",{className:"text-rose-400 text-xs mt-2",children:"Confusing and error-prone"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"With P2SH"}),e.jsx("p",{className:"text-sm text-dark-300",children:'"Please pay to: 3J98t1WpEZ73CNmQviecrnyiWrnqRhWNLy"'}),e.jsx("p",{className:"text-emerald-400 text-xs mt-2",children:"Simple and familiar"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Benefits"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Sender Simplicity"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Anyone can pay to a P2SH address using standard wallet software. The complexity is hidden from the sender."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Fixed Output Size"}),e.jsx("p",{className:"text-sm text-dark-300",children:"All P2SH outputs are 23 bytes, regardless of script complexity. The sender pays a consistent fee."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Recipient Pays"}),e.jsx("p",{className:"text-sm text-dark-300",children:"The actual script is revealed when spending. Complex scripts cost the recipient, not the sender."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Validation"}),e.jsx("p",{className:"mb-4",children:"Wallets validate P2SH addresses before sending:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Base58 decode the address"}),e.jsx("li",{children:"Verify version byte is 0x05 (mainnet) or 0xC4 (testnet)"}),e.jsx("li",{children:"Verify checksum matches payload"}),e.jsx("li",{children:"Extract 20-byte script hash"}),e.jsxs("li",{children:["Create scriptPubKey: ",e.jsx("code",{className:"text-amber-400",children:"OP_HASH160 <hash> OP_EQUAL"})]})]})}),e.jsx(s,{type:"warning",title:"P2SH vs Nested SegWit",children:e.jsx("p",{children:`Both P2SH multisig and P2SH-wrapped SegWit (BIP-49) produce "3..." addresses! From the address alone, you can't tell which type of script is inside. The recipient must know which script to provide when spending.`})}),e.jsx(s,{type:"success",title:"Enabling Innovation",children:e.jsx("p",{children:"BIP-13's simple address format enabled P2SH to become wildly successful. By making complex scripts as easy to pay as simple addresses, it unlocked multisig adoption, time-locked contracts, and eventually nested SegWit."})})]})}export{p as default};
