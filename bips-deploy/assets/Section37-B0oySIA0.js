import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BjhgI7Zp.js";import{L as i,C as s,D as a,E as t}from"./Callout-Bm0ChKkk.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function h(){return e.jsxs(i,{sectionId:37,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"M-of-N Standard Transactions"}),e.jsx("p",{className:"mb-4",children:"BIP-11 introduced support for multisignature transactions as a standard transaction type. This early BIP made it possible for nodes to relay and mine transactions requiring multiple signatures, enabling shared custody and trustless escrow."}),e.jsx(s,{type:"info",title:"Historical Context",children:e.jsx("p",{children:"BIP-11 was one of the earliest BIPs, establishing multisig as a standard script type. While largely superseded by P2SH (BIP-16) for practical use, it defined the fundamental OP_CHECKMULTISIG semantics still used today."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"What is Multisig?"}),e.jsxs(a,{title:"M-of-N Multisignature",children:[e.jsx("p",{children:"A multisig script requires M signatures from a set of N public keys to spend. For example, 2-of-3 requires any 2 signatures from 3 possible signers."}),e.jsx("p",{className:"mt-2 text-dark-400",children:"This enables shared control, trustless escrow, backup key schemes, and corporate treasuries."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Script Pattern"}),e.jsx("p",{className:"mb-4",children:'BIP-11 defined the "bare multisig" script structure:'}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# ScriptPubKey (locking script)"}),e.jsx("p",{className:"text-amber-400",children:"OP_M <pubkey1> <pubkey2> ... <pubkeyN> OP_N OP_CHECKMULTISIG"}),e.jsx("p",{className:"text-dark-400 mt-4 mb-2",children:"# ScriptSig (unlocking script)"}),e.jsx("p",{className:"text-emerald-400",children:"OP_0 <sig1> <sig2> ... <sigM>"}),e.jsx("p",{className:"text-xs text-dark-500 mt-3",children:"OP_0 is required due to the famous CHECKMULTISIG bug (off-by-one)"})]}),e.jsxs(t,{title:"2-of-3 Multisig Script",children:[e.jsxs("div",{className:"space-y-3 font-mono text-xs",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# Output script:"}),e.jsx("p",{className:"text-dark-300",children:"OP_2 <pk_alice> <pk_bob> <pk_carol> OP_3 OP_CHECKMULTISIG"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# Spending with Alice + Carol:"}),e.jsx("p",{className:"text-dark-300",children:"OP_0 <sig_alice> <sig_carol>"})]})]}),e.jsx("p",{className:"text-dark-500 text-sm mt-2",children:"Signatures must appear in the same order as their public keys"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Standard Transaction Types"}),e.jsx("p",{className:"mb-4",children:`BIP-11 added multisig to Bitcoin Core's "IsStandard" relay policy:`}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-3",children:"Before BIP-11:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-dark-300",children:[e.jsx("li",{children:"P2PK (pay-to-pubkey)"}),e.jsx("li",{children:"P2PKH (pay-to-pubkey-hash)"})]}),e.jsx("p",{className:"text-dark-400 mt-4 mb-3",children:"After BIP-11:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-dark-300",children:[e.jsx("li",{children:"P2PK"}),e.jsx("li",{children:"P2PKH"}),e.jsx("li",{className:"text-amber-400",children:"Bare multisig (up to 3-of-3)"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Limitations"}),e.jsx("p",{className:"mb-4",children:"Bare multisig has significant drawbacks:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-bold mb-2",children:"Problems"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Public keys visible in output"}),e.jsx("li",{children:"Large output scripts (~35 bytes per key)"}),e.jsx("li",{children:"Limited to 3 keys (standard policy)"}),e.jsx("li",{children:"Reveals quorum structure"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"P2SH Solution (BIP-16)"}),e.jsxs("ul",{className:"text-sm text-dark-300 space-y-1",children:[e.jsx("li",{children:"Script hidden behind hash"}),e.jsx("li",{children:"Fixed output size (23 bytes)"}),e.jsx("li",{children:"Up to 15 keys (policy limit)"}),e.jsx("li",{children:"Better privacy"})]})]})]}),e.jsx(s,{type:"warning",title:"Rarely Used Today",children:e.jsx("p",{children:"Bare multisig (BIP-11) is rarely used in practice. P2SH-wrapped multisig (BIP-16) and native SegWit P2WSH provide better privacy, smaller outputs, and higher key limits. Understanding BIP-11 is valuable for historical context."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Use Cases"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"2-of-3 Shared Custody"}),e.jsx("p",{className:"text-sm text-dark-300",children:"User holds 2 keys, service holds 1. User can spend alone or with service help. Service can't steal funds unilaterally."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"2-of-2 Escrow"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Buyer and seller must both agree to release funds. Neither can act alone."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-1",children:"3-of-5 Corporate Treasury"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Requires majority approval from board. Protects against individual compromise or unavailability."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The CHECKMULTISIG Bug"}),e.jsx("p",{className:"mb-4",children:"OP_CHECKMULTISIG has a well-known bug requiring an extra dummy element:"}),e.jsx(t,{title:"The Dummy Element",children:e.jsxs("div",{className:"space-y-3 text-dark-300",children:[e.jsx("p",{children:"Due to an off-by-one error in the original implementation, CHECKMULTISIG pops one more element than it uses. This extra element must be provided but is ignored."}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-sm",children:[e.jsx("p",{className:"text-dark-400 mb-1",children:"# Correct (with dummy):"}),e.jsx("p",{className:"text-emerald-400",children:"OP_0 <sig1> <sig2>"}),e.jsx("p",{className:"text-dark-400 mt-2 mb-1",children:"# Invalid (without dummy):"}),e.jsx("p",{className:"text-rose-400",children:"<sig1> <sig2>"})]}),e.jsx("p",{className:"text-dark-500 text-sm mt-2",children:"BIP-147 requires the dummy to be OP_0 in SegWit scripts"})]})}),e.jsx(s,{type:"success",title:"Foundation for Shared Custody",children:e.jsx("p",{children:"Despite its limitations, BIP-11 established the fundamental multisig primitives that power Bitcoin's shared custody solutions today. The concepts of M-of-N thresholds, ordered signatures, and OP_CHECKMULTISIG remain central to modern wallet security."})})]})}export{h as default};
