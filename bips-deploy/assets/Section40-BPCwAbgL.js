import{j as e}from"./vendor-animation-CmxkKU9r.js";import"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-CsKt80eB.js";import{L as i,C as s,D as t,E as r}from"./Callout-DTLGvo9K.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-C7tZlcUA.js";function p(){return e.jsxs(i,{sectionId:40,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Lexicographical Indexing of Transaction Inputs and Outputs"}),e.jsx("p",{className:"mb-4",children:"BIP-69 defines a standard ordering for transaction inputs and outputs based on lexicographical sorting. This deterministic ordering improves privacy by preventing ordering-based heuristics and ensures reproducible transaction construction."}),e.jsx(s,{type:"info",title:"Privacy Through Determinism",children:e.jsx("p",{children:"Without standardized ordering, wallet implementation details leak through transaction structure. BIP-69 ordering makes transactions from different wallets look more similar, improving the anonymity set for all users."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem"}),e.jsx("p",{className:"mb-4",children:"Transaction ordering can reveal information about the software used:"}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-6 border border-dark-700/50 mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-3",children:"Without standardization:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsx("li",{children:"Some wallets put change output first, others last"}),e.jsx("li",{children:"Inputs might be ordered by amount, by age, or randomly"}),e.jsx("li",{children:"These patterns fingerprint specific wallet software"}),e.jsx("li",{children:"Chain analysis uses ordering to identify change outputs"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Input Ordering"}),e.jsxs(t,{title:"Input Sort Order",children:[e.jsx("p",{children:"Inputs are sorted by:"}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Previous txid"})," (ascending, lexicographic)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Previous output index"})," (ascending, if txids equal)"]})]}),e.jsx("p",{className:"text-dark-500 text-sm mt-2",children:"Lexicographic = byte-by-byte comparison like sorting strings"})]}),e.jsx(r,{title:"Sorting Inputs",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-dark-400",children:"Given inputs referencing:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs space-y-2",children:[e.jsx("p",{className:"text-dark-300",children:"txid: f5d8...a3b2, vout: 0"}),e.jsx("p",{className:"text-dark-300",children:"txid: a1c4...9e7f, vout: 1"}),e.jsx("p",{className:"text-dark-300",children:"txid: a1c4...9e7f, vout: 0"})]}),e.jsx("p",{className:"text-dark-400 mt-2",children:"BIP-69 order:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs space-y-2",children:[e.jsx("p",{className:"text-amber-400",children:"1. a1c4...9e7f:0 (lowest txid, lowest vout)"}),e.jsx("p",{className:"text-amber-400",children:"2. a1c4...9e7f:1 (same txid, higher vout)"}),e.jsx("p",{className:"text-amber-400",children:"3. f5d8...a3b2:0 (higher txid)"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Output Ordering"}),e.jsxs(t,{title:"Output Sort Order",children:[e.jsx("p",{children:"Outputs are sorted by:"}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Amount"})," (ascending, in satoshis)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"scriptPubKey"})," (ascending, lexicographic, if amounts equal)"]})]})]}),e.jsx(r,{title:"Sorting Outputs",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-dark-400",children:"Given outputs:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs space-y-2",children:[e.jsx("p",{className:"text-dark-300",children:"10000 sat to bc1q...xyz"}),e.jsx("p",{className:"text-dark-300",children:"5000 sat to bc1q...abc"}),e.jsx("p",{className:"text-dark-300",children:"5000 sat to bc1q...def"})]}),e.jsx("p",{className:"text-dark-400 mt-2",children:"BIP-69 order:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 font-mono text-xs space-y-2",children:[e.jsx("p",{className:"text-amber-400",children:"1. 5000 sat to bc1q...abc (lowest amount, lower script)"}),e.jsx("p",{className:"text-amber-400",children:"2. 5000 sat to bc1q...def (same amount, higher script)"}),e.jsx("p",{className:"text-amber-400",children:"3. 10000 sat to bc1q...xyz (highest amount)"})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Privacy Benefits"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Reduced Fingerprinting"}),e.jsx("p",{className:"text-sm text-dark-300",children:"All BIP-69 wallets produce identically-ordered transactions, preventing software identification through ordering patterns."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Change Detection Resistance"}),e.jsx("p",{className:"text-sm text-dark-300",children:`Without "change is always last" patterns, chain analysis can't trivially identify change outputs by position.`})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Limitations and Criticism"}),e.jsxs(s,{type:"warning",title:"Controversy",children:[e.jsx("p",{children:"BIP-69 has been debated within the Bitcoin community:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Deterministic ordering itself becomes a fingerprint"}),e.jsx("li",{children:"Some argue random ordering is better for privacy"}),e.jsx("li",{children:"The ordering may reveal information about UTXO selection"}),e.jsx("li",{children:"Not all wallets implement it, reducing effectiveness"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Implementation Considerations"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-5 font-mono text-sm mb-6",children:[e.jsx("p",{className:"text-dark-400 mb-2",children:"# Pseudocode for output sorting"}),e.jsxs("div",{className:"text-dark-300 space-y-1",children:[e.jsxs("p",{children:["outputs.sort((a, b) => ","{"]}),e.jsx("p",{className:"ml-4",children:"if (a.amount !== b.amount)"}),e.jsx("p",{className:"ml-8",children:"return a.amount - b.amount;"}),e.jsx("p",{className:"ml-4",children:"return compare_bytes(a.scriptPubKey, b.scriptPubKey);"}),e.jsxs("p",{children:["}",");"]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Adoption"}),e.jsx("p",{className:"mb-4",children:"BIP-69 has mixed adoption across the ecosystem:"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Implementing Wallets"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Several wallets use BIP-69 ordering by default, including some popular open-source wallets. PSBT workflows often produce BIP-69 ordered transactions."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Alternative Approaches"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Some wallets prefer random ordering, arguing it provides better privacy by not creating a detectable pattern."})]})]}),e.jsx(s,{type:"success",title:"Best Practices",children:e.jsx("p",{children:"Whether using BIP-69 or random ordering, the key is consistency within your wallet and awareness of the trade-offs. BIP-69 provides reproducibility and broad compatibility, while random ordering may offer better privacy in some threat models."})})]})}export{p as default};
