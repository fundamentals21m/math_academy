import{j as e,A as j,m as b}from"./vendor-animation-6GFvN5rC.js";import{a as w,b as C,e as L,i as M,d as B,s as P,u as N,f as S,C as I,H as E,S as $,X as W,F as n,c as v,h as z}from"./index-CIaFkRw9.js";import{r as p,L as h,N as k}from"./vendor-react-ByzHzWFU.js";import"./vendor-math-ClxlXyPc.js";function H({level:r,showLabel:o=!1}){const{label:l,color:t,symbol:a}=w(r);return r==="none"||!a?null:e.jsxs("div",{className:`flex items-center gap-1.5 ${t}`,children:[e.jsx("span",{className:"text-base font-bold",children:a}),o&&e.jsx("span",{className:"text-xs",children:l})]})}function R({onImportSuccess:r}){const[o,l]=p.useState(!1),[t,a]=p.useState(null),[c,x]=p.useState(!1),m=p.useRef(null),s=C(),i=()=>{L(),a({type:"success",text:"Progress exported! Check your downloads folder."}),setTimeout(()=>a(null),3e3)},d=()=>{m.current?.click()},u=async y=>{const f=y.target.files?.[0];if(!f)return;x(!0),a(null);const g=await M(f);x(!1),a({type:g.success?"success":"error",text:g.message}),g.success&&(r?.(),setTimeout(()=>{window.location.reload()},1500)),m.current&&(m.current.value="")};return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>l(!o),className:"p-2 rounded-lg hover:bg-dark-800 transition-colors","aria-label":"Backup & restore progress",title:"Backup & restore progress",children:e.jsx("svg",{className:"w-5 h-5 text-dark-400 hover:text-dark-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>l(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-72 bg-dark-800 rounded-lg shadow-xl border border-dark-700 z-50 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-dark-100 mb-3",children:"Progress Backup"}),s&&e.jsxs("div",{className:"mb-4 p-3 bg-dark-900 rounded-lg",children:[e.jsx("div",{className:"text-xs text-dark-400 mb-1",children:"Current Progress"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-accent-400 font-semibold",children:[s.totalXP," XP"]}),e.jsxs("span",{className:"text-dark-300",children:["Level ",s.level]}),e.jsxs("span",{className:"text-dark-400",children:[s.sectionsCompleted," sections"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:i,disabled:!s,className:"w-full flex items-center gap-2 px-3 py-2 bg-dark-700 hover:bg-dark-600 rounded-lg text-sm text-dark-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Progress"]}),e.jsxs("button",{onClick:d,disabled:c,className:"w-full flex items-center gap-2 px-3 py-2 bg-dark-700 hover:bg-dark-600 rounded-lg text-sm text-dark-100 transition-colors disabled:opacity-50",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),c?"Importing...":"Import Backup"]}),e.jsx("input",{ref:m,type:"file",accept:".json",onChange:u,className:"hidden"})]}),t&&e.jsx("div",{className:`mt-3 p-2 rounded text-xs ${t.type==="success"?"bg-green-900/50 text-green-300 border border-green-700":"bg-red-900/50 text-red-300 border border-red-700"}`,children:t.text}),e.jsx("p",{className:"mt-3 text-xs text-dark-500",children:"Export your progress regularly to avoid losing your XP. Import to restore from a backup file."})]})]})]})}function F({className:r="",showDisplayName:o=!0}){const{isAuthenticated:l,isConnecting:t,npub:a,displayName:c,hasExtension:x,extensionChecked:m,error:s,connect:i,disconnect:d,clearError:u}=B();return m?l?e.jsxs("div",{className:`flex items-center gap-3 ${r}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary-500 to-purple-500 flex items-center justify-center text-white text-xs font-bold",children:c?.[0]?.toUpperCase()||a?.[5]?.toUpperCase()||"?"}),e.jsxs("div",{className:"flex flex-col",children:[o&&c&&e.jsx("span",{className:"text-sm font-medium text-dark-100",children:c}),e.jsx("span",{className:"text-xs text-dark-400 font-mono",children:a?P(a,6):"..."})]})]}),e.jsx("button",{onClick:d,className:"p-1.5 rounded-lg text-dark-400 hover:text-dark-200 hover:bg-dark-700/50 transition-colors",title:"Disconnect",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]}):e.jsxs("div",{className:`flex flex-col items-center gap-2 ${r}`,children:[e.jsx("button",{onClick:()=>{i()},disabled:t||!x,className:`
            flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm
            transition-all duration-200
            ${x?t?"bg-primary-600 text-white opacity-70 cursor-wait":"bg-primary-600 hover:bg-primary-500 text-white shadow-lg shadow-primary-600/25":"bg-dark-700 text-dark-400 cursor-not-allowed"}
          `,children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Connecting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),"Connect with Nostr"]})}),!x&&e.jsxs("p",{className:"text-xs text-dark-400 text-center max-w-xs",children:["Install a Nostr extension like"," ",e.jsx("a",{href:"https://github.com/nickytonline/nos2x",target:"_blank",rel:"noopener noreferrer",className:"text-primary-400 hover:underline",children:"nos2x"})," ","or"," ",e.jsx("a",{href:"https://getalby.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary-400 hover:underline",children:"Alby"})," ","to connect"]}),s&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-400",children:[e.jsx("span",{children:s}),e.jsx("button",{onClick:u,className:"text-dark-400 hover:text-dark-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}):e.jsxs("div",{className:`flex items-center gap-2 ${r}`,children:[e.jsx("div",{className:"w-4 h-4 border-2 border-dark-400 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-dark-400 text-sm",children:"Checking..."})]})}function _({onToggleSidebar:r,sidebarOpen:o}){const l=N(),t=n.gamification?l:null;return e.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-dark-900/95 backdrop-blur-sm border-b border-dark-800",children:e.jsxs("div",{className:"flex items-center justify-between h-16 px-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-dark-800 transition-colors","aria-label":o?"Close sidebar":"Open sidebar",children:e.jsx("svg",{className:"w-6 h-6 text-dark-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs(h,{to:"/",className:"flex items-center gap-3 hover:opacity-80 transition-opacity",children:[e.jsx("span",{className:"text-2xl",children:S}),e.jsx("h1",{className:"text-lg font-semibold text-dark-100 hidden sm:block",children:I})]})]}),e.jsxs("nav",{className:"hidden md:flex items-center gap-6",children:[e.jsx("a",{href:E,className:"text-dark-400 hover:text-dark-100 transition-colors text-sm font-medium",children:"Hub"}),e.jsx(h,{to:"/",className:"text-dark-400 hover:text-dark-100 transition-colors text-sm font-medium",children:"Home"}),n.theoremIndex&&e.jsx(h,{to:"/theorems",className:"text-dark-400 hover:text-dark-100 transition-colors text-sm font-medium",children:"Theorems"}),n.interactiveModules&&e.jsx(h,{to:"/interactive",className:"text-dark-400 hover:text-dark-100 transition-colors text-sm font-medium",children:"Interactive"}),n.leaderboard&&e.jsx(h,{to:"/leaderboard",className:"text-dark-400 hover:text-dark-100 transition-colors text-sm font-medium",children:"Leaderboard"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[n.gamification&&t&&e.jsxs(e.Fragment,{children:[e.jsx($,{streak:t.state.streak.currentStreak}),e.jsx(W,{xp:t.state.user.totalXP,level:t.state.user.level})]}),n.gamification&&e.jsx(R,{}),n.leaderboard&&e.jsx(F,{showDisplayName:!1})]})]})})}function O({isOpen:r,onClose:o}){const[l,t]=p.useState(()=>new Set(v.map(s=>s.id))),a=N(),c=n.gamification?a:null,x=s=>{t(i=>{const d=new Set(i);return d.has(s)?d.delete(s):d.add(s),d})},m=s=>{if(!c)return"none";const i=`${z}:${s}`;return c.state.sections[i]?.masteryLevel??"none"};return e.jsxs(e.Fragment,{children:[e.jsx(j,{children:r&&e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:o,className:"fixed inset-0 bg-black/50 z-40"})}),e.jsx("aside",{className:`
          fixed top-16 left-0 bottom-0 z-40
          w-72 bg-dark-900 border-r border-dark-800
          transform transition-transform duration-300 ease-in-out
          ${r?"translate-x-0":"-translate-x-full"}
          lg:translate-x-0
          overflow-y-auto
        `,children:e.jsxs("nav",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-gradient-to-br from-amber-500/20 to-orange-500/10 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-amber-400",children:"â˜…"})}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-dark-500",children:"Reference"})]}),e.jsxs("ul",{className:"space-y-0.5",children:[n.theoremIndex&&e.jsx("li",{children:e.jsxs(h,{to:"/theorems",className:"flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-dark-800 transition-colors text-dark-300 hover:text-dark-100",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Theorems"]})}),n.leaderboard&&e.jsx("li",{children:e.jsxs(h,{to:"/leaderboard",className:"flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-dark-800 transition-colors text-dark-300 hover:text-dark-100",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Leaderboard"]})}),n.interactiveModules&&e.jsx("li",{children:e.jsxs(k,{to:"/interactive",className:({isActive:s})=>`flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${s?"bg-primary-500/10 text-primary-400":"text-dark-300 hover:bg-dark-800 hover:text-dark-100"}`,children:[e.jsx("span",{className:"text-lg",children:"ðŸŽ®"}),"Interactive"]})}),n.leaderboard&&e.jsx("li",{children:e.jsxs(k,{to:"/leaderboard",className:({isActive:s})=>`flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${s?"bg-primary-500/10 text-primary-400":"text-dark-300 hover:bg-dark-800 hover:text-dark-100"}`,children:[e.jsx("span",{className:"text-lg",children:"ðŸ†"}),"Leaderboard"]})})]})]}),e.jsx("div",{className:"space-y-2",children:v.map(s=>e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>x(s.id),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-dark-800 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-gradient-to-br from-primary-500/20 to-primary-600/10 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-primary-400",children:s.id})}),e.jsx("span",{className:"text-sm font-medium text-dark-200",children:s.title})]}),e.jsx("svg",{className:`w-4 h-4 text-dark-500 transition-transform ${l.has(s.id)?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx(j,{children:l.has(s.id)&&e.jsx(b.ul,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"ml-4 mt-1 space-y-0.5 overflow-hidden",children:s.sections.map(i=>e.jsx("li",{children:e.jsxs(k,{to:`/section/${i.id}`,onClick:()=>{window.innerWidth<1024&&o()},className:({isActive:d})=>`flex items-center justify-between px-3 py-2 rounded-lg text-sm transition-colors ${d?"bg-primary-500/10 text-primary-400":"text-dark-400 hover:bg-dark-800 hover:text-dark-200"}`,children:[e.jsx("span",{className:"truncate",children:i.title}),n.gamification&&e.jsx(H,{level:m(i.id)})]})},i.id))})})]},s.id))})]})})]})}export{_ as H,F as N,O as S};
