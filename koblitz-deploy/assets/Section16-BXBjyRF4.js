import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as a,D as s,T as n,E as i,C as r}from"./Callout-_WjMxNQI.js";import{M as t}from"./MathBlock-DHMt0FrA.js";import"./vendor-react-Drj8qL0h.js";import"./index-CrtEkn2Z.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-_5rFmvYC.js";function u(){return e.jsxs(a,{sectionId:16,children:[e.jsx("h2",{children:"The Continued Fraction Method"}),e.jsx("p",{children:"The continued fraction method (CFRAC) exploits the relationship between continued fractions and quadratic forms to find smooth values efficiently. It was the first subexponential factoring algorithm to be implemented successfully."}),e.jsx("h3",{children:"Continued Fractions"}),e.jsxs(s,{title:"Continued Fraction",children:["A ",e.jsx("strong",{children:"continued fraction"})," is an expression of the form:",e.jsx(t,{math:"a_0 + \\cfrac{1}{a_1 + \\cfrac{1}{a_2 + \\cfrac{1}{a_3 + \\cdots}}}"}),"Written compactly as ",e.jsx(t,{math:"[a_0; a_1, a_2, a_3, \\ldots]",inline:!0}),"."]}),e.jsxs(n,{title:"CF of √n",proof:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["We prove that the continued fraction expansion of ",e.jsx(t,{math:"\\sqrt{n}",inline:!0})," for non-square ",e.jsx("em",{children:"n"})," is purely periodic after the initial term."]}),e.jsxs("p",{children:["Define the sequence of complete quotients ",e.jsx(t,{math:"\\alpha_k",inline:!0})," by ",e.jsx(t,{math:"\\alpha_0 = \\sqrt{n}",inline:!0})," and:"]}),e.jsx(t,{math:"\\alpha_k = a_k + \\frac{1}{\\alpha_{k+1}}, \\quad a_k = \\lfloor \\alpha_k \\rfloor"}),e.jsxs("p",{children:["One can show that each ",e.jsx(t,{math:"\\alpha_k",inline:!0})," for ",e.jsx(t,{math:"k \\geq 1",inline:!0})," has the form:"]}),e.jsx(t,{math:"\\alpha_k = \\frac{\\sqrt{n} + P_k}{Q_k}"}),e.jsxs("p",{children:["where ",e.jsx(t,{math:"P_k, Q_k",inline:!0})," are integers satisfying the recurrences:"]}),e.jsx(t,{math:"P_{k+1} = a_k Q_k - P_k, \\quad Q_{k+1} = \\frac{n - P_{k+1}^2}{Q_k}"}),e.jsxs("p",{children:["Since ",e.jsx(t,{math:"0 < P_k < \\sqrt{n}",inline:!0})," and ",e.jsx(t,{math:"0 < Q_k < 2\\sqrt{n}",inline:!0}),", there are only finitely many pairs ",e.jsx(t,{math:"(P_k, Q_k)",inline:!0}),". By the pigeonhole principle, the sequence must eventually repeat, establishing periodicity."]}),e.jsxs("p",{children:["The period ends with ",e.jsx(t,{math:"2a_0",inline:!0})," because at the end of each period, we have ",e.jsx(t,{math:"\\alpha_k = \\sqrt{n} + a_0",inline:!0}),", giving ",e.jsx(t,{math:"a_k = \\lfloor \\sqrt{n} + a_0 \\rfloor = 2a_0",inline:!0})," (since ",e.jsx(t,{math:"a_0 = \\lfloor \\sqrt{n} \\rfloor",inline:!0}),")."]})]}),children:["For non-square ",e.jsx("em",{children:"n"}),", the continued fraction of ",e.jsx(t,{math:"\\sqrt{n}",inline:!0})," is eventually periodic:",e.jsx(t,{math:"\\sqrt{n} = [a_0; \\overline{a_1, a_2, \\ldots, a_{r-1}, 2a_0}]"}),"The period ends with ",e.jsx(t,{math:"2a_0",inline:!0}),"."]}),e.jsxs(i,{title:"Continued Fraction of √7",children:[e.jsx(t,{math:"\\sqrt{7} = [2; \\overline{1, 1, 1, 4}]"}),e.jsx("p",{className:"mt-2",children:"The convergents are: 2, 3, 5/2, 8/3, 37/14, ..."})]}),e.jsx("h3",{children:"Convergents and Quadratic Forms"}),e.jsxs(s,{title:"Convergent",children:["The ",e.jsx("em",{children:"k"}),"-th ",e.jsx("strong",{children:"convergent"})," ",e.jsx(t,{math:"p_k/q_k",inline:!0})," of"," ",e.jsx(t,{math:"[a_0; a_1, \\ldots]",inline:!0})," is obtained by truncating after ",e.jsx("em",{children:"k"})," terms. They satisfy:",e.jsx(t,{math:"p_k = a_k p_{k-1} + p_{k-2}, \\quad q_k = a_k q_{k-1} + q_{k-2}"})]}),e.jsxs(n,{title:"Key Property",proof:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["We prove this by induction using the recurrence relations for convergents and the structure of the continued fraction expansion of ",e.jsx(t,{math:"\\sqrt{n}",inline:!0}),"."]}),e.jsxs("p",{children:["The complete quotients satisfy ",e.jsx(t,{math:"\\alpha_k = (\\sqrt{n} + P_k)/Q_k",inline:!0}),", and there is a fundamental identity:"]}),e.jsx(t,{math:"p_k \\alpha_{k+1} - q_k = (-1)^k / (q_k \\alpha_{k+1} + q_{k-1})"}),e.jsxs("p",{children:["Since ",e.jsx(t,{math:"\\alpha_0 = \\sqrt{n}",inline:!0}),", we have for the convergents ",e.jsx(t,{math:"p_k/q_k",inline:!0})," of ",e.jsx(t,{math:"\\sqrt{n}",inline:!0}),":"]}),e.jsx(t,{math:"p_k - q_k \\sqrt{n} = \\frac{(-1)^k}{q_k + q_{k-1}/\\sqrt{n}} \\cdot \\frac{1}{\\alpha_{k+1}/\\sqrt{n}}"}),e.jsxs("p",{children:["Using the relation ",e.jsx(t,{math:"(p_k - q_k\\sqrt{n})(p_k + q_k\\sqrt{n}) = p_k^2 - n q_k^2",inline:!0})," and the continued fraction structure, one derives:"]}),e.jsx(t,{math:"p_k^2 - n q_k^2 = (-1)^{k+1} Q_{k+1}"}),e.jsxs("p",{children:["where ",e.jsx(t,{math:"Q_{k+1}",inline:!0})," is the denominator appearing in ",e.jsx(t,{math:"\\alpha_{k+1} = (\\sqrt{n} + P_{k+1})/Q_{k+1}",inline:!0}),"."]}),e.jsxs("p",{children:["The bound ",e.jsx(t,{math:"|Q_k| < 2\\sqrt{n}",inline:!0})," follows from the theory of reduced quadratic irrationals: for ",e.jsx(t,{math:"k \\geq 1",inline:!0}),", the complete quotient ",e.jsx(t,{math:"\\alpha_k > 1",inline:!0})," and its conjugate ",e.jsx(t,{math:"\\bar{\\alpha}_k = (P_k - \\sqrt{n})/Q_k",inline:!0})," satisfies ",e.jsx(t,{math:"-1 < \\bar{\\alpha}_k < 0",inline:!0}),", which implies ",e.jsx(t,{math:"0 < Q_k < 2\\sqrt{n}",inline:!0}),"."]})]}),children:["For the continued fraction of ",e.jsx(t,{math:"\\sqrt{n}",inline:!0}),", the convergents satisfy:",e.jsx(t,{math:"p_k^2 - n q_k^2 = (-1)^{k+1} Q_{k+1}"}),"where ",e.jsx(t,{math:"Q_k",inline:!0})," are small integers related to the CF expansion. Crucially, ",e.jsx(t,{math:"|Q_k| < 2\\sqrt{n}",inline:!0}),"."]}),e.jsxs("p",{children:["This gives us: ",e.jsx(t,{math:"p_k^2 \\equiv (-1)^{k+1} Q_{k+1} \\pmod{n}",inline:!0}),", producing small residues automatically!"]}),e.jsx("h3",{children:"The CFRAC Algorithm"}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-4 border border-dark-700 my-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-primary-400 mb-3",children:"Continued Fraction Factoring"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:["Compute CF expansion of ",e.jsx(t,{math:"\\sqrt{n}",inline:!0})]}),e.jsxs("li",{children:["For each convergent ",e.jsx(t,{math:"p_k/q_k",inline:!0}),", compute ",e.jsx(t,{math:"Q_{k+1}",inline:!0})]}),e.jsxs("li",{children:["Check if ",e.jsx(t,{math:"|Q_{k+1}|",inline:!0})," is smooth over factor base"]}),e.jsx("li",{children:"Collect enough smooth relations"}),e.jsx("li",{children:"Use linear algebra to find square product"}),e.jsx("li",{children:"Compute GCD to extract factor"})]})]}),e.jsxs(i,{title:"CFRAC Example",children:[e.jsxs("p",{children:["Factor ",e.jsx(t,{math:"n = 9509",inline:!0})]}),e.jsxs("p",{className:"mt-2",children:[e.jsx(t,{math:"\\sqrt{9509} \\approx 97.5",inline:!0}),", so ",e.jsx(t,{math:"a_0 = 97",inline:!0})]}),e.jsxs("p",{className:"mt-2",children:["CF expansion: ",e.jsx(t,{math:"[97; 2, 6, 1, \\ldots]",inline:!0})]}),e.jsxs("table",{className:"w-full mt-2 text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"py-1 text-left",children:"k"}),e.jsx("th",{className:"py-1 text-left",children:"p_k"}),e.jsx("th",{className:"py-1 text-left",children:"Q_{k+1}"}),e.jsx("th",{className:"py-1 text-left",children:"Factorization"})]})}),e.jsxs("tbody",{className:"text-dark-300",children:[e.jsxs("tr",{children:[e.jsx("td",{children:"0"}),e.jsx("td",{children:"97"}),e.jsx("td",{children:"-100"}),e.jsx("td",{children:"-2² × 5²"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"1"}),e.jsx("td",{children:"195"}),e.jsx("td",{children:"109"}),e.jsx("td",{children:"prime"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"2"}),e.jsx("td",{children:"1267"}),e.jsx("td",{children:"-75"}),e.jsx("td",{children:"-3 × 5²"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"..."}),e.jsx("td",{children:"..."}),e.jsx("td",{children:"..."}),e.jsx("td",{children:"..."})]})]})]})]}),e.jsx("h3",{children:"Why CFRAC is Efficient"}),e.jsxs(n,{title:"CFRAC Advantage",proof:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"We establish the smoothness probability advantage of CFRAC."}),e.jsxs("p",{children:["The bound ",e.jsx(t,{math:"|Q_k| < 2\\sqrt{n}",inline:!0})," was established in the Key Property theorem. For random ",e.jsx(t,{math:"x",inline:!0}),", the value ",e.jsx(t,{math:"x^2 \\bmod n",inline:!0})," is uniformly distributed in ",e.jsx(t,{math:"[0, n-1]",inline:!0}),", so residues can be as large as ",e.jsx(t,{math:"n",inline:!0}),"."]}),e.jsxs("p",{children:["By the Canfield-Erdos-Pomerance theorem, the probability that an integer ",e.jsx(t,{math:"x",inline:!0})," is ",e.jsx("em",{children:"B"}),"-smooth is approximately:"]}),e.jsx(t,{math:"\\Psi(x, B) / x \\approx u^{-u} \\quad \\text{where } u = \\frac{\\log x}{\\log B}"}),e.jsxs("p",{children:["For CFRAC, we have ",e.jsx(t,{math:"x \\approx 2\\sqrt{n}",inline:!0}),", so:"]}),e.jsx(t,{math:"u_{\\text{CFRAC}} = \\frac{\\log(2\\sqrt{n})}{\\log B} \\approx \\frac{\\log n}{2\\log B}"}),e.jsxs("p",{children:["For random squaring, ",e.jsx(t,{math:"x \\approx n",inline:!0}),", giving:"]}),e.jsx(t,{math:"u_{\\text{random}} = \\frac{\\log n}{\\log B}"}),e.jsxs("p",{children:["Since ",e.jsx(t,{math:"u_{\\text{CFRAC}} \\approx u_{\\text{random}}/2",inline:!0}),", and smoothness probability decays like ",e.jsx(t,{math:"u^{-u}",inline:!0}),", the halved exponent in CFRAC yields dramatically higher smoothness probability."]})]}),children:["The values ",e.jsx(t,{math:"Q_k",inline:!0})," are bounded by ",e.jsx(t,{math:"2\\sqrt{n}",inline:!0}),", much smaller than random ",e.jsx(t,{math:"x^2 \\bmod n",inline:!0})," (which can be up to ",e.jsx("em",{children:"n"}),"). Smaller values are more likely to be smooth:",e.jsx(t,{math:"P(\\text{smooth}) \\propto (\\log n)^{-u} \\text{ where } u = \\frac{\\log x}{\\log B}"})]}),e.jsxs("p",{children:["Since ",e.jsx(t,{math:"Q_k \\approx \\sqrt{n}",inline:!0})," instead of ",e.jsx("em",{children:"n"}),", we have"," ",e.jsx(t,{math:"u \\approx \\frac{\\log \\sqrt{n}}{\\log B}",inline:!0}),", halving the exponent and dramatically increasing smoothness probability."]}),e.jsx("h3",{children:"Complexity"}),e.jsxs(n,{title:"CFRAC Complexity",proof:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"We sketch the complexity analysis following the standard approach for subexponential factoring algorithms."}),e.jsxs("p",{children:["Define ",e.jsx(t,{math:"L(n) = e^{\\sqrt{\\ln n \\ln \\ln n}}",inline:!0}),". The algorithm has two main costs:"]}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Relation collection:"})," We need ",e.jsx(t,{math:"\\pi(B) + 1 \\approx B/\\ln B",inline:!0})," smooth values, where ",e.jsx("em",{children:"B"})," is the smoothness bound."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Smoothness probability:"})," Values ",e.jsx(t,{math:"Q_k \\approx \\sqrt{n}",inline:!0})," are ",e.jsx("em",{children:"B"}),"-smooth with probability approximately ",e.jsx(t,{math:"u^{-u}",inline:!0})," where ",e.jsx(t,{math:"u = \\ln\\sqrt{n}/\\ln B",inline:!0}),"."]})]}),e.jsxs("p",{className:"mt-2",children:["The expected number of convergents needed is ",e.jsx(t,{math:"B/\\ln B \\cdot u^u",inline:!0}),". Each convergent requires ",e.jsx(t,{math:"O(\\log n)",inline:!0})," operations."]}),e.jsxs("p",{children:["Optimizing over ",e.jsx("em",{children:"B"}),": set ",e.jsx(t,{math:"B = L(n)^{1/2+o(1)}",inline:!0}),". Then ",e.jsx(t,{math:"u = \\sqrt{\\ln n / \\ln \\ln n} / (1/2) = \\sqrt{\\ln n \\ln \\ln n}",inline:!0}),", giving:"]}),e.jsx(t,{math:"u^u = e^{u \\ln u} = e^{\\sqrt{\\ln n \\ln \\ln n} \\cdot (1/2)\\ln(\\ln n / \\ln \\ln n)} = L(n)^{1/2+o(1)}"}),e.jsxs("p",{children:["Total cost: ",e.jsx(t,{math:"B \\cdot u^u = L(n)^{1/2} \\cdot L(n)^{1/2} = L(n)^{1+o(1)}",inline:!0}),"."]}),e.jsxs("p",{children:["The linear algebra phase (Gaussian elimination mod 2) costs ",e.jsx(t,{math:"O(B^3)",inline:!0})," naively, but sparse methods reduce this to ",e.jsx(t,{math:"O(B^2)",inline:!0}),", which is ",e.jsx(t,{math:"L(n)^{1+o(1)}",inline:!0}),"."]})]}),children:["The continued fraction method factors ",e.jsx("em",{children:"n"})," in time:",e.jsx(t,{math:"L(n)^{1 + o(1)} = e^{(1 + o(1))\\sqrt{\\ln n \\ln \\ln n}}"}),"This is the same as Dixon's method but with better constants in practice due to smaller residues."]}),e.jsx("h3",{children:"Multiple Polynomials"}),e.jsx("p",{children:"A key improvement (leading to MPQS) uses multiple quadratic polynomials:"}),e.jsxs(s,{title:"Quadratic Polynomial",children:["For chosen ",e.jsx("em",{children:"A, B"})," with ",e.jsx(t,{math:"B^2 \\equiv n \\pmod{A}",inline:!0}),", the polynomial:",e.jsx(t,{math:"Q(x) = (Ax + B)^2 - n"}),"satisfies ",e.jsx(t,{math:"Q(x) \\equiv (Ax + B)^2 \\pmod{n}",inline:!0})," with values around ",e.jsx(t,{math:"\\sqrt{n}/A",inline:!0})," near ",e.jsx(t,{math:"x = 0",inline:!0}),"."]}),e.jsxs(r,{type:"info",children:[e.jsx("strong",{children:"Historical Note:"})," CFRAC was implemented by Morrison and Brillhart in 1975 to factor the seventh Fermat number ",e.jsx(t,{math:"F_7 = 2^{128} + 1",inline:!0}),". It remained the fastest general-purpose algorithm until the Quadratic Sieve."]}),e.jsx("h3",{children:"Comparison with Other Methods"}),e.jsx("div",{className:"bg-dark-800/50 rounded-xl p-4 border border-dark-700 my-4",children:e.jsxs("table",{className:"w-full text-dark-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-2",children:"Method"}),e.jsx("th",{className:"text-left py-2",children:"Residue Size"}),e.jsx("th",{className:"text-left py-2",children:"Parallelizable"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("td",{className:"py-2",children:"Dixon"}),e.jsx("td",{className:"py-2",children:"~n"}),e.jsx("td",{className:"py-2",children:"Yes"})]}),e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("td",{className:"py-2",children:"CFRAC"}),e.jsx("td",{className:"py-2",children:"~√n"}),e.jsx("td",{className:"py-2",children:"No (sequential)"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"QS"}),e.jsx("td",{className:"py-2",children:"~√n"}),e.jsx("td",{className:"py-2",children:"Yes (via MPQS)"})]})]})]})}),e.jsxs(r,{type:"success",children:[e.jsx("strong",{children:"Legacy:"})," While superseded by the Quadratic Sieve, CFRAC introduced the crucial insight that structured sequences produce smaller residues, a principle that underlies all modern sieve-based factoring algorithms."]})]})}export{u as default};
