import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as i,C as n,T as t,E as c}from"./Callout-CQOyP6I7.js";import{I as s,M as r}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-DuspoTuy.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-ySXQbKre.js";function p(){return e.jsxs(i,{sectionId:8,children:[e.jsx("h2",{children:"The Nonce Catastrophe"}),e.jsx("p",{children:"There is one critical rule in Schnorr signatures that, if violated, completely destroys security:"}),e.jsxs(n,{type:"warning",children:[e.jsx("strong",{children:"CRITICAL RULE:"})," NEVER reuse a nonce ",e.jsx(s,{children:"k"}),". A single nonce reuse allows an attacker to extract your private key."]}),e.jsx("h3",{children:"The Attack"}),e.jsxs("p",{children:["Suppose you sign two different messages with the same nonce ",e.jsx(s,{children:"k"}),":"]}),e.jsxs("div",{className:"p-4 rounded-xl bg-red-900/20 border border-red-700/50 my-6",children:[e.jsx("h4",{className:"font-semibold text-red-400 mb-3",children:"Two Signatures, Same Nonce"}),e.jsxs("div",{className:"space-y-2 font-mono text-sm",children:[e.jsxs("p",{children:["Signature 1 for message ",e.jsx(s,{children:"m_1"}),":"]}),e.jsx(r,{children:"\\sigma_1 = (R, z_1) \\text{ where } z_1 = k + s \\cdot c_1"}),e.jsxs("p",{className:"mt-3",children:["Signature 2 for message ",e.jsx(s,{children:"m_2"}),":"]}),e.jsx(r,{children:"\\sigma_2 = (R, z_2) \\text{ where } z_2 = k + s \\cdot c_2"}),e.jsxs("p",{className:"mt-3 text-red-300",children:["Note: Same ",e.jsx(s,{children:"R"})," means same ",e.jsx(s,{children:"k"}),"!"]})]})]}),e.jsx(t,{title:"Nonce Reuse Attack",children:e.jsxs("p",{children:["Given two signatures with the same nonce but different messages, an attacker can extract the private key ",e.jsx(s,{children:"s"}),"."]})}),e.jsx("h3",{children:"The Extraction"}),e.jsx("p",{children:"The attacker computes:"}),e.jsx(r,{children:"z_1 - z_2 = (k + s \\cdot c_1) - (k + s \\cdot c_2)"}),e.jsx(r,{children:"z_1 - z_2 = s \\cdot (c_1 - c_2)"}),e.jsx(r,{children:"s = \\frac{z_1 - z_2}{c_1 - c_2}"}),e.jsxs(n,{type:"important",children:[e.jsx("strong",{children:"Game Over:"})," With ",e.jsx(s,{children:"s"})," extracted, the attacker can forge any signature and steal all funds controlled by that key."]}),e.jsxs(c,{title:"Concrete Numbers",children:[e.jsx("p",{children:"Let's see this with actual numbers:"}),e.jsxs("div",{className:"mt-3 space-y-2 font-mono text-sm",children:[e.jsxs("p",{children:["Secret: ",e.jsx(s,{children:"s = 7"})]}),e.jsxs("p",{children:["Nonce: ",e.jsx(s,{children:"k = 13"})]}),e.jsxs("p",{children:["Challenge 1: ",e.jsx(s,{children:"c_1 = 5"})]}),e.jsxs("p",{children:["Challenge 2: ",e.jsx(s,{children:"c_2 = 3"})]}),e.jsxs("p",{className:"mt-2",children:["Response 1: ",e.jsx(s,{children:"z_1 = 13 + 7 \\cdot 5 = 48"})]}),e.jsxs("p",{children:["Response 2: ",e.jsx(s,{children:"z_2 = 13 + 7 \\cdot 3 = 34"})]}),e.jsxs("p",{className:"mt-2 text-red-400",children:["Attacker computes: ",e.jsx(s,{children:"s = (48 - 34)/(5 - 3) = 14/2 = 7"})]})]})]}),e.jsx("h3",{children:"Real-World Incidents"}),e.jsxs("div",{className:"space-y-4 my-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-2",children:"PlayStation 3 Hack (2010)"}),e.jsx("p",{className:"text-sm",children:"Sony used a constant nonce for all ECDSA signatures on PS3. Hackers extracted Sony's private key and could sign any code to run on PS3."})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-2",children:"Android Bitcoin Wallets (2013)"}),e.jsx("p",{className:"text-sm",children:"A bug in Android's random number generator caused nonce reuse. Multiple Bitcoin thefts resulted from the vulnerability."})]})]}),e.jsx("h3",{children:"Implications for FROST"}),e.jsx("p",{children:"In FROST, each participant must ensure their nonce contribution is never reused:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 my-4",children:[e.jsxs("li",{children:["Each participant generates ",e.jsx(s,{children:"(d_i, e_i)"})," pairs in preprocessing"]}),e.jsxs("li",{children:["Each pair is used ",e.jsx("strong",{children:"exactly once"})]}),e.jsxs("li",{children:["After use, the nonces must be ",e.jsx("strong",{children:"securely deleted"})]}),e.jsx("li",{children:"State management ensures no reuse even across restarts"})]}),e.jsxs(n,{type:"info",children:[e.jsx("strong",{children:"Defense in Depth:"})," FROST uses two nonce components",e.jsx(s,{children:"d_i"})," and ",e.jsx(s,{children:"e_i"})," combined with binding values. This provides extra protection, but the fundamental rule remains: each commitment pair must be used at most once."]}),e.jsx("h3",{children:"Best Practices"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 my-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-emerald-900/20 border border-emerald-700/50",children:[e.jsx("h4",{className:"font-semibold text-emerald-400 mb-2",children:"Do"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsx("li",{children:"Use cryptographic RNG for nonces"}),e.jsx("li",{children:"Delete nonces immediately after use"}),e.jsx("li",{children:"Track used nonces persistently"}),e.jsx("li",{children:"Use deterministic nonces (RFC 6979)"})]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-red-900/20 border border-red-700/50",children:[e.jsx("h4",{className:"font-semibold text-red-400 mb-2",children:"Don't"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsx("li",{children:"Use predictable RNG"}),e.jsx("li",{children:"Reuse nonces across messages"}),e.jsx("li",{children:"Store nonces without encryption"}),e.jsx("li",{children:"Ignore nonce management in threshold schemes"})]})]})]})]})}export{p as default};
