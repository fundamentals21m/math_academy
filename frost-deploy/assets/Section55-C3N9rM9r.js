import{j as i}from"./vendor-animation-0o8UKZ_1.js";import{L as n,D as r,T as c,E as s,C as a}from"./Callout-CQOyP6I7.js";import{I as e,M as t}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-DuspoTuy.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-ySXQbKre.js";function f(){return i.jsxs(n,{sectionId:55,children:[i.jsx("h2",{children:"Signature Share Verification"}),i.jsx("p",{children:"Before aggregating signature shares, the coordinator (or each participant) must verify that each share is valid. This verification prevents malicious participants from corrupting the final signature."}),i.jsx("h3",{children:"The Verification Equation"}),i.jsxs(r,{title:"Share Verification",children:[i.jsxs("p",{children:["For participant ",i.jsx(e,{children:"i"})," with signature share"," ",i.jsx(e,{children:"z_i"}),", commitment ",i.jsx(e,{children:"R_i"}),", and public verification share ",i.jsx(e,{children:"Y_i"}),":"]}),i.jsx(t,{children:"[z_i]G \\stackrel{?}{=} R_i + [\\lambda_i \\cdot c]Y_i"}),i.jsxs("p",{className:"mt-4",children:["This equation verifies that ",i.jsx(e,{children:"z_i"})," was computed correctly using the participant's secret share."]})]}),i.jsx("h3",{children:"Why Verification Works"}),i.jsxs(c,{title:"Verification Correctness",children:[i.jsxs("p",{children:["If participant ",i.jsx(e,{children:"i"})," computed their share correctly:"]}),i.jsx(t,{children:"z_i = d_{ij} + e_{ij} \\cdot \\rho_i + \\lambda_i \\cdot s_i \\cdot c"}),i.jsx("p",{className:"mt-3",children:"Then:"}),i.jsx(t,{children:"[z_i]G = [d_{ij}]G + [e_{ij} \\cdot \\rho_i]G + [\\lambda_i \\cdot s_i \\cdot c]G"}),i.jsx(t,{children:"= D_{ij} + [\\rho_i]E_{ij} + [\\lambda_i \\cdot c]Y_i"}),i.jsx(t,{children:"= R_i + [\\lambda_i \\cdot c]Y_i \\quad \\checkmark"})]}),i.jsx("h3",{children:"Common Implementation Bug"}),i.jsxs(s,{title:"Timing-Vulnerable Comparison",children:[i.jsx("pre",{className:"bg-gray-800 p-4 rounded text-sm overflow-x-auto",children:`# WRONG: Direct point comparison can leak timing info
L = z_i * G
R = R_i + (lambda_i * c) * Y_i
if L == R:
    valid = True`}),i.jsx("p",{className:"mt-3 text-red-400",children:"Problem: Point comparison may take different time depending on the values, potentially leaking information about the points."})]}),i.jsxs(s,{title:"Constant-Time Verification",children:[i.jsx("pre",{className:"bg-gray-800 p-4 rounded text-sm overflow-x-auto",children:`# CORRECT: Check if difference is identity
L = z_i * G
R = R_i + (lambda_i * c) * Y_i
diff = L - R
if diff.is_identity():
    valid = True`}),i.jsx("p",{className:"mt-3",children:"Even better: Use the cryptographic library's constant-time point comparison function."})]}),i.jsxs(a,{type:"warning",children:[i.jsx("strong",{children:"Security Note:"})," While the values being compared in verification are typically public, using constant-time operations consistently helps prevent subtle timing attacks and is good practice."]}),i.jsx("h3",{children:"Batch Verification"}),i.jsx("p",{children:"When verifying multiple shares, batch verification provides significant speedup:"}),i.jsxs(r,{title:"Batch Verification",children:[i.jsxs("p",{children:["Instead of verifying each share individually, combine them with random weights",i.jsx(e,{children:"r_i"}),":"]}),i.jsx(t,{children:"[\\sum_i r_i \\cdot z_i]G \\stackrel{?}{=} \\sum_i r_i \\cdot (R_i + [\\lambda_i \\cdot c]Y_i)"}),i.jsx("p",{className:"mt-4",children:"If this equation holds, all individual shares are valid (with overwhelming probability)."})]}),i.jsx("h3",{children:"Performance Comparison"}),i.jsxs(s,{title:"Batch vs Individual Verification",children:[i.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Individual verification:"})," ",i.jsx(e,{children:"t"})," scalar multiplications"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Batch verification:"})," approximately 2 scalar multiplications (using multi-scalar multiplication)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Speedup:"})," approximately ",i.jsx(e,{children:"t/2"})," times faster"]})]}),i.jsx("p",{className:"mt-3",children:"For a 5-of-9 threshold, batch verification is roughly 2.5x faster."})]}),i.jsx("h3",{children:"Handling Invalid Shares"}),i.jsxs(a,{type:"info",children:[i.jsx("strong",{children:"On Verification Failure:"})," If any share fails verification:",i.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[i.jsx("li",{children:"Identify the misbehaving participant"}),i.jsx("li",{children:"Abort the current signing session"}),i.jsx("li",{children:"Optionally exclude the participant from future sessions"}),i.jsx("li",{children:"Never aggregate with invalid shares"})]})]})]})}export{f as default};
