import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as n,D as r,E as s,C as t,T as a}from"./Callout-CQOyP6I7.js";import{I as i}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-DuspoTuy.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-ySXQbKre.js";function u(){return e.jsxs(n,{sectionId:56,children:[e.jsx("h2",{children:"State Management and Nonce Deletion"}),e.jsx("p",{children:"Proper state management is critical for FROST security. Each participant must carefully track the lifecycle of nonces and ensure they are securely deleted after use."}),e.jsx("h3",{children:"Participant State Machine"}),e.jsxs(r,{title:"State Transitions",children:[e.jsx("p",{children:"Each FROST participant operates as a state machine:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"KEY_GENERATED:"})," After DKG completes, holds secret share"," ",e.jsx(i,{children:"s_i"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PREPROCESSED:"})," After generating commitment pairs"," ",e.jsx(i,{children:"(d_{ij}, e_{ij})"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"SIGNING:"})," During signature share computation"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"COMPLETED:"})," After signature share sent, nonces deleted"]})]})]}),e.jsx("h3",{children:"Preprocessing State"}),e.jsxs(s,{title:"After Preprocessing",children:[e.jsx("p",{children:"Each participant stores:"}),e.jsx("pre",{className:"bg-gray-800 p-4 rounded text-sm overflow-x-auto mt-2",children:`Store: (d_ij, e_ij) encrypted at rest
Track: Used/unused status for each pair
Index: Which commitment pair corresponds to which public (D_ij, E_ij)`}),e.jsx("p",{className:"mt-3",children:"The nonces must be stored securely (encrypted) but also accessible for the signing operation."})]}),e.jsx("h3",{children:"Signing State Transitions"}),e.jsx("p",{children:"The signing phase involves critical state transitions:"}),e.jsx(s,{title:"Signing State Protocol",children:e.jsx("pre",{className:"bg-gray-800 p-4 rounded text-sm overflow-x-auto",children:`1. Mark (d_ij, e_ij) as "in use"
2. Compute z_i = d_ij + e_ij * rho_i + lambda_i * s_i * c
3. Securely erase (d_ij, e_ij)
4. Mark commitment pair as "used" (never reuse)
5. Send z_i to coordinator`})}),e.jsxs(t,{type:"warning",children:[e.jsx("strong",{children:"Critical Rule:"})," Step 3 (secure erasure) must happen"," ",e.jsx("em",{children:"before"})," step 5 (sending the signature share). If the nonces are not deleted and the share is sent, a later compromise could extract the secret share."]}),e.jsx("h3",{children:"Secure Erasure Protocol"}),e.jsxs(r,{title:"Memory Zeroization",children:[e.jsx("p",{children:"Proper secure deletion requires multiple steps:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-4",children:[e.jsx("li",{children:"Overwrite memory with zeros"}),e.jsx("li",{children:"Overwrite memory with random data"}),e.jsx("li",{children:"Overwrite memory with zeros again"}),e.jsx("li",{children:"Flush CPU caches if applicable"}),e.jsx("li",{children:"On hardware wallets: erase the flash sector"})]})]}),e.jsxs("p",{children:["Simple deallocation (",e.jsx("code",{children:"free()"})," in C, or letting a variable go out of scope) is ",e.jsx("em",{children:"not"})," sufficient - the data may remain in memory until overwritten by other operations."]}),e.jsx("h3",{children:"Concurrent Signing Sessions"}),e.jsxs(t,{type:"info",children:[e.jsx("strong",{children:"Important:"})," Each signing session must use a different commitment pair. If a participant is involved in multiple concurrent signing sessions, they must maintain separate state for each:",e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"Track which commitment pair is used for which session"}),e.jsx("li",{children:"Never use the same pair for two sessions"}),e.jsx("li",{children:"Handle session failures gracefully (mark pair as used anyway)"})]})]}),e.jsx("h3",{children:"Recovery from Failures"}),e.jsxs(s,{title:"Failure Scenarios",children:[e.jsx("p",{children:e.jsx("strong",{children:"Scenario 1: Network failure during signing"})}),e.jsx("p",{className:"mt-2",children:'If the signature share was computed but not sent, the nonces are already deleted. The commitment pair is "burned" and cannot be reused.'}),e.jsx("p",{className:"mt-4",children:e.jsx("strong",{children:"Scenario 2: Participant crash during signing"})}),e.jsx("p",{className:"mt-2",children:'On restart, mark all "in use" commitment pairs as "used" (conservatively assume they may have been exposed).'}),e.jsx("p",{className:"mt-4",children:e.jsx("strong",{children:"Scenario 3: Coordinator misbehavior"})}),e.jsx("p",{className:"mt-2",children:"If the coordinator requests the same commitment twice, detect and abort. Each commitment should only appear in one signing request."})]}),e.jsx("h3",{children:"State Persistence"}),e.jsxs(a,{title:"State Requirements",children:[e.jsx("p",{children:"Participant state must satisfy:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Durability:"})," Secret share"," ",e.jsx(i,{children:"s_i"})," survives restarts"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Confidentiality:"})," All secrets encrypted at rest"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Consistency:"})," Used/unused status never regresses"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Atomicity:"})," State transitions complete fully or not at all"]})]})]})]})}export{u as default};
