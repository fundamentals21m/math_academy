import{j as e,m as P}from"./vendor-animation-0o8UKZ_1.js";import{L}from"./LessonLayout-MHc1mXdO.js";import{T as W,D as A,E as z,C as B}from"./Callout-D6GJ8KQY.js";import{I as n,M as y}from"./MathBlock-uz1iP4cD.js";import{r as i}from"./vendor-react-Drj8qL0h.js";import{c as D,C as R}from"./CoordinateGrid-DHacsy1H.js";import"./index-Dwb7rnsM.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function C(r,d){return r.reduce((l,m,a)=>l+m*Math.pow(d,a),0)}function F(r,d,l,m,a,g=100){const c=[],N=(l-d)/g;for(let o=0;o<=g;o++){const f=d+o*N,t=C(r,f),k=m(f),j=a(t);c.push(`${o===0?"M":"L"} ${k} ${j}`)}return c.join(" ")}function G(){const[r,d]=i.useState(42),[l,m]=i.useState(17),[a,g]=i.useState(8),[c,N]=i.useState(!0),[o,f]=i.useState(!0),[t,k]=i.useState(3),j=500,v=400,_=50,S=-.5,w=6,M=i.useMemo(()=>{const s=C([r,l,a],5);return Math.max(400,Math.ceil(s/50)*50+50)},[r,l,a]),$=-20,{toSvgX:h,toSvgY:x}=i.useMemo(()=>D(j,v,_,S,w,$,M),[M]),b=i.useMemo(()=>{const s=[r];return t>=2&&s.push(l),t>=3&&s.push(a),s},[r,l,a,t]),q=i.useMemo(()=>F(b,S,w,h,x),[b,h,x]),T=i.useMemo(()=>{const s=["#10b981","#3b82f6","#8b5cf6","#f59e0b","#ef4444"];return[1,2,3,4,5].map((u,E)=>({x:u,y:C(b,u),label:`P${u}`,color:s[E]}))},[b]),p=i.useMemo(()=>({x:0,y:r,label:"s",color:"#fbbf24"}),[r]),I=i.useMemo(()=>{let s=`f(x) = ${r}`;return t>=2&&(s+=` + ${l}x`),t>=3&&(s+=` + ${a}x²`),s},[r,l,a,t]);return e.jsxs("div",{className:"p-4 bg-dark-900/80 rounded-xl border border-dark-700/50",children:[e.jsx("h4",{className:"text-lg font-semibold text-indigo-400 mb-4",children:"Interactive Polynomial Visualizer"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-dark-300 mb-1",children:["Secret (f(0)): ",e.jsx("span",{className:"text-amber-400 font-mono",children:r})]}),e.jsx("input",{type:"range",min:1,max:100,value:r,onChange:s=>d(Number(s.target.value)),className:"w-full h-2 bg-dark-700 rounded-lg appearance-none cursor-pointer accent-amber-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-dark-300 mb-1",children:["Threshold (t): ",e.jsx("span",{className:"text-indigo-400 font-mono",children:t})]}),e.jsx("input",{type:"range",min:2,max:3,value:t,onChange:s=>k(Number(s.target.value)),className:"w-full h-2 bg-dark-700 rounded-lg appearance-none cursor-pointer accent-indigo-500"})]})]}),e.jsxs("div",{className:"space-y-3",children:[t>=2&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-dark-300 mb-1",children:["a₁ (linear): ",e.jsx("span",{className:"text-emerald-400 font-mono",children:l})]}),e.jsx("input",{type:"range",min:0,max:30,value:l,onChange:s=>m(Number(s.target.value)),className:"w-full h-2 bg-dark-700 rounded-lg appearance-none cursor-pointer accent-emerald-500"})]}),t>=3&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-dark-300 mb-1",children:["a₂ (quadratic): ",e.jsx("span",{className:"text-blue-400 font-mono",children:a})]}),e.jsx("input",{type:"range",min:0,max:20,value:a,onChange:s=>g(Number(s.target.value)),className:"w-full h-2 bg-dark-700 rounded-lg appearance-none cursor-pointer accent-blue-500"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsx("button",{onClick:()=>f(!o),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${o?"bg-amber-500/20 text-amber-400 border border-amber-500/50":"bg-dark-800 text-dark-400 border border-dark-700"}`,children:"Secret Point"}),e.jsx("button",{onClick:()=>N(!c),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${c?"bg-indigo-500/20 text-indigo-400 border border-indigo-500/50":"bg-dark-800 text-dark-400 border border-dark-700"}`,children:"Share Points"})]}),e.jsx("div",{className:"mb-4 p-3 bg-dark-800/50 rounded-lg border border-dark-700/50",children:e.jsx("p",{className:"text-center font-mono text-lg text-dark-100",children:I})}),e.jsxs("svg",{viewBox:`0 0 ${j} ${v}`,className:"w-full bg-dark-950 rounded-lg",style:{maxHeight:"400px"},children:[e.jsx(R,{width:j,height:v,padding:_,xMin:S,xMax:w,yMin:$,yMax:M,yLabel:"f(x)"}),e.jsx(P.path,{d:q,fill:"none",stroke:"#818cf8",strokeWidth:2.5,initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.8,ease:"easeInOut"}}),o&&e.jsxs(P.g,{initial:{scale:0},animate:{scale:1},transition:{delay:.3,type:"spring"},children:[e.jsx("circle",{cx:h(p.x),cy:x(p.y),r:10,fill:p.color,stroke:"#fef3c7",strokeWidth:2}),e.jsxs("text",{x:h(p.x)-16,y:x(p.y)+4,fill:"#fbbf24",fontSize:14,fontWeight:"bold",children:["s=",r]})]}),c&&T.map((s,u)=>e.jsxs(P.g,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.4+u*.1,type:"spring"},children:[e.jsx("circle",{cx:h(s.x),cy:x(s.y),r:7,fill:s.color,stroke:"white",strokeWidth:1.5}),e.jsxs("text",{x:h(s.x)+10,y:x(s.y)-10,fill:s.color,fontSize:11,fontWeight:"bold",children:["(",s.x,", ",Math.round(s.y),")"]})]},s.label))]}),c&&e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-dark-400 border-b border-dark-700",children:[e.jsx("th",{className:"py-2 px-3 text-left",children:"Participant"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"x"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Share f(x)"})]})}),e.jsx("tbody",{children:T.map(s=>e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsxs("td",{className:"py-2 px-3",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-full mr-2",style:{backgroundColor:s.color}}),s.label]}),e.jsx("td",{className:"py-2 px-3 font-mono",children:s.x}),e.jsx("td",{className:"py-2 px-3 font-mono",children:Math.round(s.y)})]},s.label))})]})}),e.jsx("div",{className:"mt-4 p-3 bg-indigo-500/10 rounded-lg border border-indigo-500/30",children:e.jsxs("p",{className:"text-sm text-indigo-200",children:[e.jsx("strong",{children:"Key Insight:"})," Any ",t," points uniquely determine this degree-",t-1," polynomial. With fewer than ",t," points, infinitely many polynomials are possible, so the secret remains hidden."]})})]})}function ee(){return e.jsxs(L,{sectionId:9,children:[e.jsx("h2",{children:"Polynomial Encoding"}),e.jsxs("p",{children:["Shamir's secret sharing encodes a secret as the constant term of a polynomial. The key insight: a polynomial of degree ",e.jsx(n,{children:"t-1"})," is uniquely determined by ",e.jsx(n,{children:"t"})," points."]}),e.jsxs(W,{title:"Polynomial Uniqueness",children:[e.jsxs("p",{children:["A polynomial of degree ",e.jsx(n,{children:"t-1"})," is uniquely determined by ",e.jsx(n,{children:"t"})," points."]}),e.jsxs("p",{className:"mt-2 text-sm text-dark-300",children:["Conversely, ",e.jsx(n,{children:"t-1"})," points leave infinitely many degree ",e.jsx(n,{children:"t-1"})," polynomials consistent with them."]})]}),e.jsx("h3",{children:"The Sharing Scheme"}),e.jsxs("p",{children:["To share secret ",e.jsx(n,{children:"s"})," among ",e.jsx(n,{children:"n"})," people where ",e.jsx(n,{children:"t"})," are needed to reconstruct:"]}),e.jsx(A,{title:"Shamir Secret Sharing",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-3 mt-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Choose random coefficients:"}),e.jsx(y,{children:"a_1, a_2, \\ldots, a_{t-1} \\xleftarrow{\\$} \\mathbb{Z}_q"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Define polynomial:"}),e.jsx(y,{children:"f(x) = s + a_1 x + a_2 x^2 + \\cdots + a_{t-1} x^{t-1}"}),e.jsxs("p",{className:"text-sm mt-1",children:["Note: ",e.jsx(n,{children:"f(0) = s"})," (the secret!)"]})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Generate shares:"}),e.jsx(y,{children:"\\text{Share}_i = (i, f(i)) \\text{ for } i = 1, 2, \\ldots, n"})]})]})}),e.jsxs(z,{title:"Concrete Example (t=3, n=5)",children:[e.jsxs("p",{children:["Share secret ",e.jsx(n,{children:"s = 42"})," among 5 people, threshold 3:"]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-dark-800/50",children:[e.jsx("p",{className:"font-semibold text-indigo-400 mb-2",children:"Step 1: Random coefficients"}),e.jsxs("p",{className:"font-mono text-sm",children:[e.jsx(n,{children:"a_1 = 17, a_2 = 8"})," (chosen randomly)"]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-dark-800/50",children:[e.jsx("p",{className:"font-semibold text-indigo-400 mb-2",children:"Step 2: Define polynomial"}),e.jsx(y,{children:"f(x) = 42 + 17x + 8x^2"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-dark-800/50",children:[e.jsx("p",{className:"font-semibold text-indigo-400 mb-2",children:"Step 3: Generate shares"}),e.jsxs("div",{className:"font-mono text-sm space-y-1",children:[e.jsxs("p",{children:["Share 1: ",e.jsx(n,{children:"(1, f(1)) = (1, 42 + 17 + 8) = (1, 67)"})]}),e.jsxs("p",{children:["Share 2: ",e.jsx(n,{children:"(2, f(2)) = (2, 42 + 34 + 32) = (2, 108)"})]}),e.jsxs("p",{children:["Share 3: ",e.jsx(n,{children:"(3, f(3)) = (3, 42 + 51 + 72) = (3, 165)"})]}),e.jsxs("p",{children:["Share 4: ",e.jsx(n,{children:"(4, f(4)) = (4, 42 + 68 + 128) = (4, 238)"})]}),e.jsxs("p",{children:["Share 5: ",e.jsx(n,{children:"(5, f(5)) = (5, 42 + 85 + 200) = (5, 327)"})]})]})]})]})]}),e.jsx("h3",{children:"Key Property"}),e.jsxs(B,{type:"important",children:[e.jsx("strong",{children:"The Magic:"})," Any 3 shares can reconstruct ",e.jsx(n,{children:"f"}),", and therefore ",e.jsx(n,{children:"s = f(0)"}),". But any 2 shares reveal",e.jsx("strong",{children:" nothing"})," about ",e.jsx(n,{children:"s"}),"."]}),e.jsx("h3",{children:"Why It Works"}),e.jsx("p",{children:"A degree-2 polynomial (like our example) is determined by exactly 3 points:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 my-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"3 points:"})," Uniquely determine the polynomial → can find ",e.jsx(n,{children:"f(0)"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"2 points:"})," Infinitely many degree-2 polynomials pass through them"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"1 point:"})," Even more ambiguity"]})]}),e.jsx(G,{}),e.jsx("h3",{children:"For FROST"}),e.jsxs("p",{children:["In FROST, we'll use this to share the secret key ",e.jsx(n,{children:"s"}),":"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 my-4",children:[e.jsxs("li",{children:["Secret key ",e.jsx(n,{children:"s"})," encoded as ",e.jsx(n,{children:"f(0)"})]}),e.jsxs("li",{children:["Each participant gets share ",e.jsx(n,{children:"(i, s_i)"})," where ",e.jsx(n,{children:"s_i = f(i)"})]}),e.jsxs("li",{children:["Any ",e.jsx(n,{children:"t"})," participants can sign (using Lagrange interpolation)"]}),e.jsxs("li",{children:["But they never actually reconstruct ",e.jsx(n,{children:"s"}),"!"]})]})]})}export{ee as default};
