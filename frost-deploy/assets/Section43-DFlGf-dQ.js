import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as c}from"./LessonLayout-WO30R0_w.js";import{D as i,E as r,T as n,C as l}from"./Callout-D6GJ8KQY.js";import{M as s,I as t}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-CKqQQJMA.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function g(){return e.jsxs(c,{sectionId:43,children:[e.jsx("h2",{children:"Hierarchical Threshold (Nested FROST)"}),e.jsx("p",{children:"FROST can be nested to create hierarchical authorization structures. This enables complex organizational policies where different levels have different threshold requirements."}),e.jsx("h3",{children:"The Scenario"}),e.jsxs(i,{title:"Organizational Hierarchy",children:[e.jsx("p",{children:"Consider a company structure:"}),e.jsx("pre",{className:"bg-gray-800 p-4 rounded mt-2 text-sm",children:`Board of Directors (3-of-5)
  |-- CEO (1-of-1)
  |-- CFO (2-of-3 deputies)
  |-- CTO (2-of-3 deputies)
  |-- COO (1-of-1)
  |-- General Counsel (1-of-1)`}),e.jsx("p",{className:"mt-3",children:"Spending requires 3 of 5 board members, but some board members (CFO, CTO) are themselves threshold groups."})]}),e.jsx("h3",{children:"Mathematical Encoding"}),e.jsxs(i,{title:"Top-Level FROST",children:[e.jsx("p",{children:"The board operates as a 3-of-5 FROST group:"}),e.jsx(s,{children:"t_1 = 3, \\quad n_1 = 5"}),e.jsx(s,{children:"s_1, s_2, s_3, s_4, s_5 \\quad \\text{(shares for 5 board positions)}"})]}),e.jsxs(i,{title:"Nested FROST (CFO's Deputies)",children:[e.jsx("p",{children:"The CFO's share is itself threshold-shared:"}),e.jsx(s,{children:"t_2 = 2, \\quad n_2 = 3"}),e.jsx(s,{children:"s_{21}, s_{22}, s_{23} \\quad \\text{(shares for 3 deputies)}"}),e.jsxs("p",{className:"mt-3",children:["These shares reconstruct to ",e.jsx(t,{children:"s_2"}),", the CFO's board-level share."]})]}),e.jsx("h3",{children:"Signing Protocol"}),e.jsxs(r,{title:"Nested Signing",children:[e.jsxs("p",{children:["To sign, need 3 board members. Suppose the signing set is"," ",e.jsx(t,{children:"\\{\\text{CEO}, \\text{CFO}, \\text{CTO}\\} = \\{1, 2, 3\\}"}),"."]}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"CEO (position 1):"})," Signs directly with share"," ",e.jsx(t,{children:"s_1"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"CFO (position 2):"})," 2-of-3 deputies sign internally to produce position 2's contribution"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"CTO (position 3):"})," 2-of-3 deputies sign internally to produce position 3's contribution"]})]})]}),e.jsx("h3",{children:"Lagrange Nesting"}),e.jsxs(n,{title:"Nested Lagrange Coefficients",children:[e.jsx("p",{children:"The effective contribution from a nested participant involves two levels:"}),e.jsx(s,{children:"\\text{Top level: } \\lambda_i^{(0)} \\text{ for board member } i"}),e.jsx(s,{children:"\\text{Sub-level: } \\lambda_j^{(i)} \\text{ for deputy } j \\text{ of member } i"}),e.jsx("p",{className:"mt-3",children:"A deputy's effective contribution to the signature share is:"}),e.jsx(s,{children:"s_{ij} \\cdot \\lambda_j^{(i)} \\cdot \\lambda_i^{(0)}"})]}),e.jsxs(r,{title:"Concrete Calculation",children:[e.jsx("p",{children:"Suppose CFO's deputies 1 and 2 (of 3) are signing. Their Lagrange coefficients within the CFO group:"}),e.jsx(s,{children:"\\lambda_1^{(2)} = \\frac{0-2}{1-2} = 2"}),e.jsx(s,{children:"\\lambda_2^{(2)} = \\frac{0-1}{2-1} = -1"}),e.jsxs("p",{className:"mt-3",children:["If the board-level Lagrange coefficient for CFO (position 2) is"," ",e.jsx(t,{children:"\\lambda_2^{(0)} = 3"}),":"]}),e.jsx(s,{children:"\\text{Deputy 1's contribution: } s_{21} \\cdot 2 \\cdot 3 = 6 \\cdot s_{21}"}),e.jsx(s,{children:"\\text{Deputy 2's contribution: } s_{22} \\cdot (-1) \\cdot 3 = -3 \\cdot s_{22}"})]}),e.jsx("h3",{children:"Verification of Correctness"}),e.jsxs(n,{title:"Reconstruction Correctness",children:[e.jsx("p",{children:"The nested structure correctly reconstructs the secret:"}),e.jsx(s,{children:"s = \\sum_{i \\in S_0} s_i \\cdot \\lambda_i^{(0)}"}),e.jsx("p",{className:"mt-3",children:"For nested members:"}),e.jsx(s,{children:"s_i = \\sum_{j \\in S_i} s_{ij} \\cdot \\lambda_j^{(i)}"}),e.jsx("p",{className:"mt-3",children:"Therefore:"}),e.jsx(s,{children:"s = \\sum_{i \\in S_0} \\left( \\sum_{j \\in S_i} s_{ij} \\cdot \\lambda_j^{(i)} \\right) \\cdot \\lambda_i^{(0)}"}),e.jsx(s,{children:"= \\sum_{i \\in S_0} \\sum_{j \\in S_i} s_{ij} \\cdot \\lambda_j^{(i)} \\cdot \\lambda_i^{(0)}"})]}),e.jsx("h3",{children:"Practical Considerations"}),e.jsxs(i,{title:"Coordination Complexity",children:[e.jsx("p",{children:"Nested FROST requires coordination at each level:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"Each nested group must run its internal FROST protocol"}),e.jsx("li",{children:"The results feed into the parent-level protocol"}),e.jsx("li",{children:"Communication increases with nesting depth"})]})]}),e.jsxs(i,{title:"Key Generation",children:[e.jsx("p",{children:"DKG can be done top-down or bottom-up:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Top-down:"})," Generate board shares, then re-share nested positions"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Bottom-up:"})," Deputies generate their shares, aggregate to board level"]})]})]}),e.jsxs(l,{type:"info",children:[e.jsx("strong",{children:"Efficiency:"})," Despite the nesting, computation per level is still"," ",e.jsx(t,{children:"O(t)"}),". The total work scales with the sum of all thresholds, not their product."]}),e.jsx("h3",{children:"Use Cases"}),e.jsx(r,{title:"Enterprise Treasury",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Level 1:"})," 2-of-3 executive committee"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Level 2:"})," Each executive backed by 2-of-3 authorized signers"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Result:"})," Flexible authority delegation with clear accountability"]})]})}),e.jsx(r,{title:"DAO Governance",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Level 1:"})," m-of-n working groups"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Level 2:"})," Each working group is threshold-controlled"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Result:"})," Decentralized control with structured authorization"]})]})}),e.jsx("h3",{children:"On-Chain Appearance"}),e.jsxs(l,{type:"success",children:[e.jsx("strong",{children:"Still Indistinguishable:"})," Despite the complex hierarchical structure, the final signature is still a standard Schnorr signature. On-chain observers see:",e.jsxs("ul",{className:"list-disc list-inside mt-2",children:[e.jsx("li",{children:"One public key"}),e.jsx("li",{children:"One 64-byte signature"}),e.jsx("li",{children:"No indication of nesting depth or structure"})]})]}),e.jsx("p",{children:"Hierarchical FROST enables organizational policies that match real-world authority structures while maintaining the privacy and efficiency of standard Schnorr signatures."})]})}export{g as default};
