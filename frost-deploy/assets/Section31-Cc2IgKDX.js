import{j as e,A as h,m as o}from"./vendor-animation-0o8UKZ_1.js";import{L as S}from"./LessonLayout-WO30R0_w.js";import{C as j,D as l,T as _,E as N}from"./Callout-D6GJ8KQY.js";import{I as r,M as n}from"./MathBlock-uz1iP4cD.js";import{r as m}from"./vendor-react-Drj8qL0h.js";import"./index-CKqQQJMA.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";const c=[{id:1,title:"Select Commitments",description:"Coordinator selects next unused commitment (Dᵢ, Eᵢ) from each signer",actor:"coordinator"},{id:2,title:"Broadcast Data",description:"Coordinator sends (B, m) to all signers, where B = list of commitments",actor:"coordinator",formula:"B = [(1, D₁, E₁), (2, D₂, E₂), ...]"},{id:3,title:"Compute Binding",description:"Each signer computes their binding factor ρᵢ from the hash",actor:"signers",formula:"ρᵢ = H₁(i, m, B)"},{id:4,title:"Compute Nonce Point",description:"Each signer computes their individual nonce commitment Rᵢ",actor:"signers",formula:"Rᵢ = Dᵢ + [ρᵢ]Eᵢ"},{id:5,title:"Aggregate R",description:"Compute the group nonce commitment R by summing all Rᵢ",actor:"all",formula:"R = ΣRᵢ"},{id:6,title:"Compute Challenge",description:"Compute the Schnorr challenge c from the group nonce, key, and message",actor:"all",formula:"c = H₂(R, Y, m)"},{id:7,title:"Compute Signature Share",description:"Each signer computes their signature share zᵢ",actor:"signers",formula:"zᵢ = dᵢ + eᵢ·ρᵢ + λᵢ·sᵢ·c"},{id:8,title:"Return Shares",description:"Each signer sends their share zᵢ back to the coordinator",actor:"signers"},{id:9,title:"Aggregate Signature",description:"Coordinator sums all shares to produce final signature (R, z)",actor:"coordinator",formula:"z = Σzᵢ → Signature: (R, z)"}],u=[{id:1,label:"Signer 1",color:"#ef4444",x:100},{id:2,label:"Signer 2",color:"#10b981",x:200},{id:3,label:"Signer 3",color:"#3b82f6",x:300}];function C(){const[t,a]=m.useState(0),[d,x]=m.useState(!1),g=m.useCallback(()=>{t<c.length?a(i=>i+1):x(!1)},[t]);m.useEffect(()=>{if(d&&t<c.length){const i=setTimeout(g,2e3);return()=>clearTimeout(i)}},[d,t,g]);const f=()=>{a(1),x(!0)},b=()=>{a(0),x(!1)},y=()=>{t>1&&a(t-1)},k=()=>{t<c.length&&a(t+1)},s=c[t-1];return e.jsxs("div",{className:"p-4 bg-dark-900/80 rounded-xl border border-dark-700/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-indigo-400",children:"FROST Signing (Single Round)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:d?()=>x(!1):f,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${d?"bg-amber-500/20 text-amber-400 border border-amber-500/50":"bg-indigo-500/20 text-indigo-400 border border-indigo-500/50"}`,children:t===0?"Start Signing":d?"Pause":t>=c.length?"Restart":"Resume"}),e.jsx("button",{onClick:b,className:"px-4 py-2 bg-dark-800 text-dark-300 rounded-lg text-sm font-medium hover:bg-dark-700 transition-colors border border-dark-700",children:"Reset"})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[e.jsx("button",{onClick:y,disabled:t<=1,className:"p-2 rounded-lg bg-dark-800 text-dark-300 hover:bg-dark-700 disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M15 18l-6-6 6-6"})})}),e.jsx("div",{className:"flex gap-1",children:c.map(i=>e.jsx("button",{onClick:()=>a(i.id),className:`w-8 h-8 rounded-full text-xs font-medium transition-all ${t===i.id?"bg-indigo-500 text-white scale-110":t>i.id?"bg-emerald-500/50 text-emerald-200":"bg-dark-700 text-dark-400"}`,children:i.id},i.id))}),e.jsx("button",{onClick:k,disabled:t>=c.length,className:"p-2 rounded-lg bg-dark-800 text-dark-300 hover:bg-dark-700 disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})})]}),e.jsx(h,{mode:"wait",children:s&&e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-4 bg-dark-800/50 rounded-lg border border-dark-700/50",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"font-semibold text-dark-100 flex items-center gap-2",children:[e.jsxs("span",{className:"text-indigo-400",children:["Step ",t,":"]}),s.title]}),e.jsx("p",{className:"text-sm text-dark-300 mt-1",children:s.description})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.actor==="coordinator"?"bg-amber-500/20 text-amber-400":s.actor==="signers"?"bg-blue-500/20 text-blue-400":"bg-violet-500/20 text-violet-400"}`,children:s.actor==="coordinator"?"Coordinator":s.actor==="signers"?"Signers":"All"})]}),s.formula&&e.jsx("div",{className:"mt-3 p-2 bg-dark-900 rounded font-mono text-sm text-indigo-300",children:s.formula})]},t)}),e.jsxs("svg",{viewBox:"0 0 400 280",className:"w-full bg-dark-950 rounded-lg",style:{maxHeight:"280px"},children:[e.jsxs(o.g,{animate:{scale:(s==null?void 0:s.actor)==="coordinator"?1.05:1},children:[e.jsx("rect",{x:150,y:20,width:100,height:50,rx:8,fill:(s==null?void 0:s.actor)==="coordinator"?"#fbbf24":"#374151",opacity:(s==null?void 0:s.actor)==="coordinator"?.3:.2}),e.jsx("rect",{x:155,y:25,width:90,height:40,rx:6,fill:"#1f2937",stroke:(s==null?void 0:s.actor)==="coordinator"?"#fbbf24":"#4b5563",strokeWidth:2}),e.jsx("text",{x:200,y:50,textAnchor:"middle",fill:"#fbbf24",fontSize:12,fontWeight:"bold",children:"Coordinator"})]}),u.map(i=>e.jsxs("g",{children:[e.jsx(h,{children:t===2&&e.jsxs(o.g,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx("line",{x1:200,y1:70,x2:i.x,y2:150,stroke:"#fbbf24",strokeWidth:2,strokeDasharray:"4,4"}),e.jsx(o.circle,{cx:200,cy:70,r:4,fill:"#fbbf24",animate:{cx:[200,i.x],cy:[70,150]},transition:{duration:1,repeat:1/0}})]})}),e.jsx(h,{children:t===8&&e.jsxs(o.g,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx("line",{x1:i.x,y1:150,x2:200,y2:70,stroke:i.color,strokeWidth:2,strokeDasharray:"4,4"}),e.jsx(o.circle,{cx:i.x,cy:150,r:4,fill:i.color,animate:{cx:[i.x,200],cy:[150,70]},transition:{duration:1,repeat:1/0}})]})}),e.jsx("line",{x1:200,y1:70,x2:i.x,y2:150,stroke:"#374151",strokeWidth:1,opacity:.3})]},`line-${i.id}`)),u.map(i=>e.jsxs(o.g,{animate:{scale:(s==null?void 0:s.actor)==="signers"||(s==null?void 0:s.actor)==="all"?1.05:1},children:[e.jsx("rect",{x:i.x-40,y:150,width:80,height:60,rx:8,fill:i.color,opacity:.2}),e.jsx("rect",{x:i.x-35,y:155,width:70,height:50,rx:6,fill:"#1f2937",stroke:i.color,strokeWidth:2}),e.jsx("text",{x:i.x,y:175,textAnchor:"middle",fill:i.color,fontSize:11,fontWeight:"bold",children:i.label}),e.jsx(h,{children:t>=3&&t<=7&&e.jsx(o.text,{x:i.x,y:195,textAnchor:"middle",fill:"#9ca3af",fontSize:9,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:t===3?`ρ${i.id}`:t===4?`R${i.id}`:t>=7?`z${i.id}`:""})})]},i.id)),e.jsx(h,{children:t>=9&&e.jsxs(o.g,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},children:[e.jsx("rect",{x:125,y:230,width:150,height:40,rx:8,fill:"#10b981",opacity:.2}),e.jsx("rect",{x:130,y:235,width:140,height:30,rx:6,fill:"#1f2937",stroke:"#10b981",strokeWidth:2}),e.jsx("text",{x:200,y:255,textAnchor:"middle",fill:"#10b981",fontSize:12,fontWeight:"bold",children:"Signature: (R, z)"})]})}),e.jsx("text",{x:380,y:20,textAnchor:"end",fill:"#6b7280",fontSize:10,children:"Message: m"})]}),e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-dark-400 border-b border-dark-700",children:[e.jsx("th",{className:"py-2 px-2 text-left",children:"Step"}),e.jsx("th",{className:"py-2 px-2 text-left",children:"Action"}),e.jsx("th",{className:"py-2 px-2 text-left",children:"Actor"}),e.jsx("th",{className:"py-2 px-2 text-left",children:"Output"})]})}),e.jsx("tbody",{children:c.map(i=>{var p;return e.jsxs("tr",{className:`border-b border-dark-800 ${t===i.id?"bg-indigo-500/10":""}`,children:[e.jsx("td",{className:"py-1.5 px-2",children:e.jsx("span",{className:`inline-flex w-5 h-5 rounded-full items-center justify-center text-xs ${t>i.id?"bg-emerald-500/50 text-white":t===i.id?"bg-indigo-500 text-white":"bg-dark-700 text-dark-400"}`,children:i.id})}),e.jsx("td",{className:"py-1.5 px-2 text-dark-300",children:i.title}),e.jsx("td",{className:"py-1.5 px-2",children:e.jsx("span",{className:`text-xs ${i.actor==="coordinator"?"text-amber-400":i.actor==="signers"?"text-blue-400":"text-violet-400"}`,children:i.actor})}),e.jsx("td",{className:"py-1.5 px-2 font-mono text-dark-400",children:((p=i.formula)==null?void 0:p.split("→")[0])||"-"})]},i.id)})})]})}),e.jsx("div",{className:"mt-4 p-3 bg-blue-500/10 rounded-lg border border-blue-500/30",children:e.jsxs("p",{className:"text-sm text-blue-200",children:[e.jsx("strong",{children:"Key Insight:"})," All 9 steps happen in a single communication round! The coordinator broadcasts once, signers compute and respond once. This is FROST's main efficiency advantage over traditional threshold schemes requiring 3+ rounds."]})})]})}function G(){return e.jsxs(S,{sectionId:31,children:[e.jsx("h2",{children:"Phase 3: Signing (Single Round!)"}),e.jsxs("p",{children:["With key generation complete and preprocessing done in advance, FROST achieves its remarkable efficiency: ",e.jsx("strong",{children:"single-round signing"}),". This is where all the mathematical machinery comes together to produce a threshold signature."]}),e.jsxs(j,{type:"info",children:[e.jsx("strong",{children:"The Goal:"})," Given a message ",e.jsx(r,{children:"m"})," and a signing set ",e.jsx(r,{children:"S \\subseteq \\{1, \\ldots, n\\}"})," with"," ",e.jsx(r,{children:"|S| = t"}),", produce a valid Schnorr signature in one communication round."]}),e.jsx(C,{}),e.jsx("h3",{children:"Input Requirements"}),e.jsx("p",{children:"The signing phase requires:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 my-4",children:[e.jsxs("li",{children:["Message ",e.jsx(r,{children:"m"})," to sign"]}),e.jsxs("li",{children:["Signing set ",e.jsx(r,{children:"S \\subseteq \\{1, \\ldots, n\\}"})," with"," ",e.jsx(r,{children:"|S| = t"})]}),e.jsxs("li",{children:["Unused commitment pair ",e.jsx(r,{children:"(D_{ij}, E_{ij})"})," from each participant"]})]}),e.jsx("h3",{children:"Coordinator Actions"}),e.jsxs(l,{title:"Commitment List Construction",children:[e.jsx("p",{children:"The coordinator (any participant) performs:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-4",children:[e.jsxs("li",{children:["Select next unused commitment from each participant in ",e.jsx(r,{children:"S"}),": take next unused ",e.jsx(r,{children:"(D_{ij}, E_{ij})"})," for each"," ",e.jsx(r,{children:"i \\in S"})]}),e.jsxs("li",{children:["Construct commitment list:",e.jsx(n,{children:"B = [(i, D_{ij}, E_{ij}) : i \\in S]"})]}),e.jsxs("li",{children:["Send ",e.jsx(r,{children:"(m, B)"})," to all signers in ",e.jsx(r,{children:"S"})]})]})]}),e.jsx("h3",{children:"Each Signer's Computation"}),e.jsxs("p",{children:["Each signer ",e.jsx(r,{children:"P_i \\in S"})," performs the following steps:"]}),e.jsx(l,{title:"Step 1: Message Verification",children:e.jsxs("p",{children:["Verify message ",e.jsx(r,{children:"m"})," is acceptable (policy check, not crypto)."]})}),e.jsxs(l,{title:"Step 2: Binding Value",children:[e.jsx("p",{children:"Compute the binding value:"}),e.jsx(n,{children:"\\rho_i = H_1(i, m, B)"}),e.jsx("p",{className:"mt-2",children:"This binds the signer's contribution to the message and all commitments."})]}),e.jsxs(l,{title:"Step 3: Own Commitment Contribution",children:[e.jsx("p",{children:"Compute own commitment contribution:"}),e.jsx(n,{children:"R_i = D_{ij} + [\\rho_i]E_{ij}"})]}),e.jsxs(l,{title:"Step 4: Group Commitment",children:[e.jsx("p",{children:"Compute group commitment:"}),e.jsx(n,{children:"R = \\sum_{k \\in S} R_k"})]}),e.jsxs(l,{title:"Step 5: Challenge",children:[e.jsx("p",{children:"Compute challenge:"}),e.jsx(n,{children:"c = H_2(R, Y, m)"})]}),e.jsxs(l,{title:"Step 6: Lagrange Coefficient",children:[e.jsxs("p",{children:["Compute Lagrange coefficient for participant ",e.jsx(r,{children:"i"}),":"]}),e.jsx(n,{children:"\\lambda_i = \\prod_{k \\in S, k \\neq i} \\frac{0 - k}{i - k}"})]}),e.jsxs(l,{title:"Step 7: Signature Share",children:[e.jsx("p",{children:"Compute signature share:"}),e.jsx(n,{children:"z_i = d_{ij} + e_{ij} \\cdot \\rho_i + \\lambda_i \\cdot s_i \\cdot c"})]}),e.jsxs(j,{type:"warning",children:[e.jsx("strong",{children:"Step 8: CRITICAL - Secure Deletion"}),e.jsxs("p",{className:"mt-2",children:["Securely delete ",e.jsx(r,{children:"(d_{ij}, e_{ij})"})," immediately! These nonces must never be reused."]})]}),e.jsx(l,{title:"Step 9: Send Share",children:e.jsxs("p",{children:["Send ",e.jsx(r,{children:"z_i"})," to coordinator."]})}),e.jsx("h3",{children:"Coordinator Verification and Aggregation"}),e.jsxs(_,{title:"Share Verification Equation",children:[e.jsxs("p",{children:["For each ",e.jsx(r,{children:"i \\in S"}),", verify the signature share:"]}),e.jsx(n,{children:"[z_i]G \\stackrel{?}{=} R_i + [\\lambda_i \\cdot c]Y_i"})]}),e.jsx("p",{children:"If all shares are valid, aggregate:"}),e.jsx(n,{children:"z = \\sum_{i \\in S} z_i"}),e.jsx("p",{children:"Output the final signature:"}),e.jsx(n,{children:"\\sigma = (R, z)"}),e.jsx("h3",{children:"Why Verification Works"}),e.jsxs(N,{title:"Share Verification Proof",children:[e.jsx("p",{children:"Starting from the signature share formula:"}),e.jsx(n,{children:"z_i = d_{ij} + e_{ij} \\cdot \\rho_i + \\lambda_i \\cdot s_i \\cdot c"}),e.jsx("p",{className:"mt-3",children:"Multiply both sides by G:"}),e.jsx(n,{children:"[z_i]G = [d_{ij}]G + [e_{ij} \\cdot \\rho_i]G + [\\lambda_i \\cdot s_i \\cdot c]G"}),e.jsx("p",{className:"mt-3",children:"Substitute known values:"}),e.jsx(n,{children:"[z_i]G = D_{ij} + [\\rho_i]E_{ij} + [\\lambda_i \\cdot c]Y_i"}),e.jsxs("p",{className:"mt-3",children:["Since ",e.jsx(r,{children:"R_i = D_{ij} + [\\rho_i]E_{ij}"}),":"]}),e.jsx(n,{children:"[z_i]G = R_i + [\\lambda_i \\cdot c]Y_i \\quad \\checkmark"})]}),e.jsxs(j,{type:"info",children:[e.jsx("strong",{children:"Single Round Achievement:"})," After preprocessing, signing requires only one round of communication: coordinator sends ",e.jsx(r,{children:"(m, B)"}),", each signer responds with ",e.jsx(r,{children:"z_i"}),". No back-and-forth!"]}),e.jsx("h3",{children:"The Complete Picture"}),e.jsx("p",{children:"The signature share combines three critical elements:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 my-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Nonce contribution:"})," ",e.jsx(r,{children:"d_{ij} + e_{ij} \\cdot \\rho_i"})," (from preprocessing)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Secret share:"})," ",e.jsx(r,{children:"s_i"})," (from DKG)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Lagrange weighting:"})," ",e.jsx(r,{children:"\\lambda_i"})," (enables reconstruction)"]})]}),e.jsxs("p",{children:["The binding value ",e.jsx(r,{children:"\\rho_i"})," ensures that each participant's contribution is tied to this specific signing session, preventing the parallel session attacks we discussed earlier."]})]})}export{G as default};
