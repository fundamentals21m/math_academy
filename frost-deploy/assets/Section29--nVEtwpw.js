import{j as e,A as l,m as n}from"./vendor-animation-0o8UKZ_1.js";import{L as S,D as f,C as y,E as G,T as C}from"./Callout-CQOyP6I7.js";import{I as i,M as r}from"./MathBlock-uz1iP4cD.js";import{r as o}from"./vendor-react-Drj8qL0h.js";import"./index-DuspoTuy.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-ySXQbKre.js";const h=[{id:1,label:"P₁",color:"#ef4444",x:200,y:40},{id:2,label:"P₂",color:"#f59e0b",x:350,y:130},{id:3,label:"P₃",color:"#10b981",x:300,y:300},{id:4,label:"P₄",color:"#3b82f6",x:100,y:300},{id:5,label:"P₅",color:"#8b5cf6",x:50,y:130}],m=200,x=180,w={idle:'Click "Start DKG" to begin the protocol',"round1-sample":"Round 1: Each participant samples a random polynomial fᵢ(x)","round1-commit":"Round 1: Compute Feldman commitments Cᵢ = [aᵢ,ₖ]G for each coefficient","round1-broadcast":"Round 1: Broadcast commitments and proof of knowledge σᵢ","round2-verify":"Round 2: Verify all received proofs σⱼ","round2-send":"Round 2: Send share sᵢ,ⱼ = fᵢ(j) to each participant Pⱼ","round2-receive":"Round 2: Receive and verify shares from all other participants","compute-share":"Computing: sᵢ = Σⱼ sⱼ,ᵢ (sum all received shares)","compute-key":"Computing: Y = Σⱼ Cⱼ,₀ (group public key)",complete:"DKG Complete! Each participant has their share, all share the public key Y"};function P(){const[t,p]=o.useState("idle"),[c,d]=o.useState(!1),[R,u]=o.useState([]),[g,j]=o.useState(null),b=o.useCallback(()=>{const s=["round1-sample","round1-commit","round1-broadcast","round2-verify","round2-send","round2-receive","compute-share","compute-key","complete"],a=s.indexOf(t);a<s.length-1?p(s[a+1]):d(!1)},[t]);o.useEffect(()=>{if(c&&t!=="complete"){const s=setTimeout(b,1500);return()=>clearTimeout(s)}},[c,t,b]);const _=()=>{p("round1-sample"),d(!0),u([])},v=()=>{p("idle"),d(!1),u([]),j(null)},k=()=>{t==="complete"||t==="idle"?_():d(!c)},N={hidden:{scale:0,opacity:0},visible:{scale:[0,1.5,1],opacity:[0,.8,0],transition:{duration:1.2}}};return e.jsxs("div",{className:"p-4 bg-dark-900/80 rounded-xl border border-dark-700/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-indigo-400",children:"Distributed Key Generation (DKG)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:k,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${c?"bg-amber-500/20 text-amber-400 border border-amber-500/50":"bg-indigo-500/20 text-indigo-400 border border-indigo-500/50"}`,children:t==="idle"||t==="complete"?"Start DKG":c?"Pause":"Resume"}),e.jsx("button",{onClick:v,className:"px-4 py-2 bg-dark-800 text-dark-300 rounded-lg text-sm font-medium hover:bg-dark-700 transition-colors border border-dark-700",children:"Reset"})]})]}),e.jsx("div",{className:"mb-4 p-3 bg-dark-800/50 rounded-lg border border-dark-700/50",children:e.jsx("p",{className:"text-sm text-dark-200",children:w[t]})}),e.jsxs("svg",{viewBox:"0 0 400 360",className:"w-full bg-dark-950 rounded-lg",style:{maxHeight:"360px"},children:[e.jsx(l,{children:(t==="compute-key"||t==="complete")&&e.jsxs(n.g,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},children:[e.jsx("circle",{cx:m,cy:x,r:35,fill:"#fbbf24",opacity:.2}),e.jsx("circle",{cx:m,cy:x,r:25,fill:"#fbbf24",stroke:"#fef3c7",strokeWidth:2}),e.jsx("text",{x:m,y:x+5,textAnchor:"middle",fill:"#1f2937",fontSize:14,fontWeight:"bold",children:"Y"})]})}),e.jsx(l,{children:(t==="round2-send"||t==="round2-receive")&&h.map(s=>h.filter(a=>a.id!==s.id).map(a=>e.jsx(n.line,{x1:s.x,y1:s.y,x2:a.x,y2:a.y,stroke:s.color,strokeWidth:1.5,strokeDasharray:"4,4",initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:.5},exit:{opacity:0},transition:{duration:.8,delay:s.id*.1}},`share-${s.id}-${a.id}`)))}),e.jsx(l,{children:t==="compute-key"&&h.map(s=>e.jsx(n.line,{x1:s.x,y1:s.y,x2:m,y2:x,stroke:s.color,strokeWidth:2,initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.6,delay:s.id*.1}},`key-${s.id}`))}),h.map(s=>e.jsxs(n.g,{onMouseEnter:()=>j(s.id),onMouseLeave:()=>j(null),style:{cursor:"pointer"},children:[e.jsx(l,{children:t==="round1-broadcast"&&e.jsx(n.circle,{cx:s.x,cy:s.y,r:60,fill:"none",stroke:s.color,strokeWidth:2,variants:N,initial:"hidden",animate:"visible"})}),e.jsx(n.circle,{cx:s.x,cy:s.y,r:28,fill:s.color,stroke:g===s.id?"white":"transparent",strokeWidth:3,animate:{scale:t==="round1-sample"||t==="round1-commit"||t==="compute-share"?[1,1.1,1]:1},transition:{duration:.5,repeat:t==="round1-sample"?1/0:0}}),e.jsx("text",{x:s.x,y:s.y+5,textAnchor:"middle",fill:"white",fontSize:14,fontWeight:"bold",children:s.label}),e.jsx(l,{children:t==="round1-sample"&&e.jsxs(n.text,{x:s.x,y:s.y-40,textAnchor:"middle",fill:s.color,fontSize:10,initial:{opacity:0,y:-30},animate:{opacity:1,y:-40},exit:{opacity:0},children:["f",s.id,"(x)"]})}),e.jsx(l,{children:t==="round1-commit"&&e.jsxs(n.text,{x:s.x,y:s.y-40,textAnchor:"middle",fill:s.color,fontSize:10,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:["C",s.id]})}),e.jsx(l,{children:t==="compute-share"&&e.jsxs(n.text,{x:s.x,y:s.y+45,textAnchor:"middle",fill:s.color,fontSize:11,fontWeight:"bold",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0},children:["s",s.id," ✓"]})}),e.jsx(l,{children:t==="complete"&&e.jsx(n.g,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs("text",{x:s.x,y:s.y+45,textAnchor:"middle",fill:s.color,fontSize:10,children:["Y",s.id," = [s",s.id,"]G"]})})})]},s.id)),e.jsx("text",{x:10,y:25,fill:"#6b7280",fontSize:12,children:t.startsWith("round1")?"Round 1":t.startsWith("round2")?"Round 2":t.startsWith("compute")?"Computation":t==="complete"?"Complete":""})]}),e.jsxs("div",{className:"mt-4 grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:`p-3 rounded-lg border ${t.startsWith("round1")?"bg-violet-500/10 border-violet-500/50":"bg-dark-800/50 border-dark-700/50"}`,children:[e.jsx("h5",{className:"text-sm font-semibold text-violet-400 mb-2",children:"Round 1: Commitments"}),e.jsxs("ul",{className:"text-xs text-dark-300 space-y-1",children:[e.jsx("li",{children:"• Sample random polynomial fᵢ(x)"}),e.jsx("li",{children:"• Compute Feldman commitments"}),e.jsx("li",{children:"• Broadcast with proof of knowledge"})]})]}),e.jsxs("div",{className:`p-3 rounded-lg border ${t.startsWith("round2")?"bg-emerald-500/10 border-emerald-500/50":"bg-dark-800/50 border-dark-700/50"}`,children:[e.jsx("h5",{className:"text-sm font-semibold text-emerald-400 mb-2",children:"Round 2: Shares"}),e.jsxs("ul",{className:"text-xs text-dark-300 space-y-1",children:[e.jsx("li",{children:"• Verify received proofs"}),e.jsx("li",{children:"• Send share fᵢ(j) to each Pⱼ"}),e.jsx("li",{children:"• Verify received shares"})]})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-violet-500/10 rounded-lg border border-violet-500/30",children:e.jsxs("p",{className:"text-sm text-violet-200",children:[e.jsx("strong",{children:"Key Insight:"})," No single participant ever knows the complete secret s = Σᵢ aᵢ,₀. Each only knows their polynomial fᵢ(x) and their final share sᵢ. The group key Y is computed from public commitments without revealing the secret."]})})]})}function F(){return e.jsxs(S,{sectionId:29,children:[e.jsx("h2",{children:"Phase 1: Distributed Key Generation (DKG)"}),e.jsx("p",{children:"The Distributed Key Generation protocol creates the group key and individual shares without any single party ever knowing the complete secret. This is the foundation of FROST's security."}),e.jsx(P,{}),e.jsx("h3",{children:"DKG Goal"}),e.jsxs(f,{title:"DKG Objectives",children:[e.jsxs("p",{children:["Generate shares of a secret key ",e.jsx(i,{children:"s"})," such that:"]}),e.jsxs("ul",{className:"space-y-2 mt-3",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Group public key:"})," ",e.jsx(i,{children:"Y = [s]G"})," is computable by all"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Share correctness:"})," Each participant gets ",e.jsx(i,{children:"s_i"}),"where ",e.jsx(i,{children:"s = f(0)"})," for some degree ",e.jsx(i,{children:"t-1"})," polynomial"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"No reconstruction:"})," No single party ever knows ",e.jsx(i,{children:"s"})]})]})]}),e.jsx("h3",{children:"Round 1: Commitment Generation"}),e.jsxs("p",{children:["Each participant ",e.jsx(i,{children:"P_i"})," independently performs the following steps:"]}),e.jsxs("div",{className:"space-y-4 my-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-indigo-500/30",children:[e.jsx("h4",{className:"font-semibold text-indigo-400 mb-2",children:"Step 1: Sample Polynomial"}),e.jsxs("p",{className:"text-sm mb-3",children:["Sample random coefficients ",e.jsx(i,{children:"a_{i,0}, a_{i,1}, \\ldots, a_{i,t-1}"}),"from ",e.jsx(i,{children:"\\mathbb{Z}_q"}),":"]}),e.jsx(r,{children:"f_i(x) = a_{i,0} + a_{i,1} \\cdot x + a_{i,2} \\cdot x^2 + \\cdots + a_{i,t-1} \\cdot x^{t-1}"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-emerald-500/30",children:[e.jsx("h4",{className:"font-semibold text-emerald-400 mb-2",children:"Step 2: Compute Commitments"}),e.jsx("p",{className:"text-sm mb-3",children:"Compute and broadcast Feldman commitments to the coefficients:"}),e.jsx(r,{children:"C_i = ([a_{i,0}]G, [a_{i,1}]G, \\ldots, [a_{i,t-1}]G)"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-amber-500/30",children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-2",children:"Step 3: Proof of Knowledge"}),e.jsxs("p",{className:"text-sm mb-3",children:["Compute and broadcast a Schnorr proof of knowledge for ",e.jsx(i,{children:"a_{i,0}"}),":"]}),e.jsx(r,{children:"\\sigma_i = (R_i, \\mu_i) \\text{ where } R_i = [k_i]G, \\mu_i = k_i + a_{i,0} \\cdot c_i"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[e.jsx(i,{children:"c_i = H(i, \\Phi, [a_{i,0}]G, R_i)"})," where ",e.jsx(i,{children:"\\Phi"})," is context string"]})]})]}),e.jsxs(y,{type:"info",children:[e.jsx("strong",{children:"Why Proof of Knowledge?"})," The proof ",e.jsx(i,{children:"\\sigma_i"}),"ensures each participant actually knows their contribution ",e.jsx(i,{children:"a_{i,0}"}),"and isn't just copying others' commitments."]}),e.jsx("h3",{children:"Round 2: Share Distribution"}),e.jsxs("p",{children:["After Round 1, each participant ",e.jsx(i,{children:"P_i"}),":"]}),e.jsxs("div",{className:"space-y-4 my-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-indigo-500/30",children:[e.jsx("h4",{className:"font-semibold text-indigo-400 mb-2",children:"Step 1: Verify Proofs"}),e.jsxs("p",{className:"text-sm",children:["For each ",e.jsx(i,{children:"P_j"}),", verify the proof ",e.jsx(i,{children:"\\sigma_j"}),":"]}),e.jsx(r,{children:"[\\mu_j]G \\stackrel{?}{=} R_j + [c_j] \\cdot C_{j,0}"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Reject participants with invalid proofs"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-emerald-500/30",children:[e.jsx("h4",{className:"font-semibold text-emerald-400 mb-2",children:"Step 2: Compute and Send Shares"}),e.jsxs("p",{className:"text-sm mb-3",children:["Send to each ",e.jsx(i,{children:"P_j"})," their share of your polynomial:"]}),e.jsx(r,{children:"s_{i,j} = f_i(j) = a_{i,0} + a_{i,1} \\cdot j + \\cdots + a_{i,t-1} \\cdot j^{t-1}"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"This is sent privately (encrypted channel or secure messaging)"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-amber-500/30",children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-2",children:"Step 3: Verify Received Shares"}),e.jsxs("p",{className:"text-sm mb-3",children:["For each share ",e.jsx(i,{children:"s_{j,i}"})," received from ",e.jsx(i,{children:"P_j"}),", verify against their commitments:"]}),e.jsx(r,{children:"[s_{j,i}]G \\stackrel{?}{=} C_{j,0} + [i]C_{j,1} + [i^2]C_{j,2} + \\cdots + [i^{t-1}]C_{j,t-1}"})]})]}),e.jsx("h3",{children:"Computing Final Values"}),e.jsxs("p",{children:["After verification, each participant ",e.jsx(i,{children:"P_i"})," computes:"]}),e.jsx(G,{title:"Final Computations",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-indigo-400 mb-2",children:"Own secret share:"}),e.jsx(r,{children:"s_i = \\sum_{j=1}^{n} s_{j,i} = \\sum_{j=1}^{n} f_j(i)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-emerald-400 mb-2",children:"Own verification share:"}),e.jsx(r,{children:"Y_i = [s_i]G"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-amber-400 mb-2",children:"Group public key:"}),e.jsx(r,{children:"Y = \\sum_{j=1}^{n} C_{j,0} = [\\sum_{j=1}^{n} a_{j,0}]G = [s]G"})]})]})}),e.jsx("h3",{children:"Why This Works"}),e.jsxs(C,{title:"DKG Correctness",children:[e.jsx("p",{children:"The combined polynomial is:"}),e.jsx(r,{children:"f(x) = \\sum_{i=1}^{n} f_i(x)"}),e.jsx("p",{className:"mt-3",children:"The group secret is:"}),e.jsx(r,{children:"s = f(0) = \\sum_{i=1}^{n} f_i(0) = \\sum_{i=1}^{n} a_{i,0}"}),e.jsx("p",{className:"mt-3",children:"Each participant's share is:"}),e.jsx(r,{children:"s_j = f(j) = \\sum_{i=1}^{n} f_i(j)"}),e.jsxs("p",{className:"mt-3",children:["These are valid Shamir shares of ",e.jsx(i,{children:"s"})," on a degree ",e.jsx(i,{children:"t-1"})," polynomial."]})]}),e.jsx("h3",{children:"Security Properties"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 my-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-emerald-500/30",children:[e.jsx("h4",{className:"font-semibold text-emerald-400 mb-2",children:"What's Guaranteed"}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{children:["No party knows ",e.jsx(i,{children:"s"})," (only their contribution)"]}),e.jsx("li",{children:"All shares are verifiable via Feldman commitments"}),e.jsx("li",{children:"Invalid shares are detected and attributed"}),e.jsx("li",{children:'Proofs ensure participants "know" their values'})]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-rose-500/30",children:[e.jsx("h4",{className:"font-semibold text-rose-400 mb-2",children:"Adversary Limitations"}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{children:["Cannot bias ",e.jsx(i,{children:"s"})," without detection"]}),e.jsxs("li",{children:["Cannot learn ",e.jsx(i,{children:"s"})," from their shares"]}),e.jsx("li",{children:"Cannot forge commitments (discrete log hard)"}),e.jsx("li",{children:"Cannot repudiate their contributions"})]})]})]}),e.jsxs(y,{type:"warning",children:[e.jsx("strong",{children:"Robustness Note:"})," Basic FROST DKG aborts if any participant misbehaves. More robust variants exist that can continue with honest participants, but they require additional complexity."]}),e.jsx("h3",{children:"DKG Summary"}),e.jsxs(f,{title:"DKG Output",children:[e.jsxs("p",{children:["After successful DKG, each participant ",e.jsx(i,{children:"P_i"})," has:"]}),e.jsxs("ul",{className:"space-y-2 mt-3",children:[e.jsxs("li",{children:["Secret share ",e.jsx(i,{children:"s_i"})," (keep private)"]}),e.jsxs("li",{children:["Verification share ",e.jsx(i,{children:"Y_i = [s_i]G"})," (public)"]}),e.jsxs("li",{children:["Group public key ",e.jsx(i,{children:"Y = [s]G"})," (public)"]})]}),e.jsx("p",{className:"mt-3",children:"The protocol can now proceed to preprocessing and signing phases."})]})]})}export{F as default};
