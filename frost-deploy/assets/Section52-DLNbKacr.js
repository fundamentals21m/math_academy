import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as n}from"./LessonLayout-WO30R0_w.js";import{D as t,C as r,E as a,T as c}from"./Callout-D6GJ8KQY.js";import{I as s,M as i}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-CKqQQJMA.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function g(){return e.jsxs(n,{sectionId:52,children:[e.jsx("h2",{children:"Random Number Generation"}),e.jsxs("p",{children:["The security of FROST critically depends on high-quality random number generation. The nonces ",e.jsx(s,{children:"d_i"})," and ",e.jsx(s,{children:"e_i"})," used in preprocessing must be truly random and unique for each signing operation."]}),e.jsx("h3",{children:"Sources of Randomness"}),e.jsx(t,{title:"Entropy Sources",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Hardware RNG:"})," CPU instructions like RDRAND provide hardware-based random number generation"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"OS Entropy:"})," ",e.jsx("code",{children:"/dev/urandom"})," on Unix/Linux systems collects environmental noise"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cryptographic DRBG:"})," Deterministic Random Bit Generators expand a seed into a stream of pseudorandom bits"]})]})}),e.jsx("h3",{children:"Hedged Nonce Generation"}),e.jsx("p",{children:"The recommended approach combines multiple entropy sources with secret material for defense-in-depth:"}),e.jsx(i,{children:"\\text{seed} = H(\\text{secret\\_key} \\| \\text{timestamp} \\| \\text{hardware\\_entropy})"}),e.jsx(i,{children:"(d_i, e_i) = \\text{DRBG}(\\text{seed})"}),e.jsxs(r,{type:"info",children:[e.jsx("strong",{children:"Why Hedged?"})," Even if the random number generator fails or is compromised, an attacker still needs the secret key to exploit the weakness. This provides defense-in-depth against RNG failures."]}),e.jsx("h3",{children:"The Catastrophic Failure Mode"}),e.jsxs(r,{type:"warning",children:[e.jsx("strong",{children:"Critical Security Rule:"})," If ",e.jsx(s,{children:"d_i"})," or"," ",e.jsx(s,{children:"e_i"})," is ever reused across two signatures, the secret share ",e.jsx(s,{children:"s_i"})," can be extracted!"]}),e.jsxs(a,{title:"Nonce Reuse Attack",children:[e.jsx("p",{children:"Given two signatures with the same nonce but different messages:"}),e.jsx(i,{children:"\\sigma_1 = (R, z_1) \\text{ for } m_1: \\quad z_1 = k + s \\cdot c_1"}),e.jsx(i,{children:"\\sigma_2 = (R, z_2) \\text{ for } m_2: \\quad z_2 = k + s \\cdot c_2"}),e.jsx("p",{className:"mt-3",children:"An attacker computes:"}),e.jsx(i,{children:"z_1 - z_2 = s \\cdot (c_1 - c_2)"}),e.jsx(i,{children:"s = \\frac{z_1 - z_2}{c_1 - c_2}"}),e.jsx("p",{className:"mt-3",children:"The secret is completely recovered from two signatures sharing the same nonce!"})]}),e.jsx("h3",{children:"Prevention Strategies"}),e.jsx("p",{children:"To prevent nonce reuse:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 my-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Stateful counter:"})," Maintain a monotonically increasing counter in secure storage"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Immediate deletion:"})," Erase used nonces immediately after signature computation"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Uniqueness verification:"})," Check that each nonce has never been used before"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Single-use tokens:"})," Generate commitment pairs as single-use tokens that are invalidated after use"]})]}),e.jsxs(c,{title:"Nonce Security Requirement",children:[e.jsxs("p",{children:["For FROST to maintain its security guarantees, each pair"," ",e.jsx(s,{children:"(d_{ij}, e_{ij})"})," must satisfy:"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-4",children:[e.jsx("li",{children:"Generated from a cryptographically secure source"}),e.jsx("li",{children:"Used in exactly one signing operation"}),e.jsx("li",{children:"Securely deleted immediately after the signature share is computed"}),e.jsx("li",{children:"Never stored in a way that allows recovery after deletion"})]})]})]})}export{g as default};
