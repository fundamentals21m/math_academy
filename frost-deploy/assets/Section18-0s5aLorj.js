import{j as s}from"./vendor-animation-0o8UKZ_1.js";import{L as n}from"./LessonLayout-WO30R0_w.js";import{D as c,T as d,C as r,E as l}from"./Callout-D6GJ8KQY.js";import{I as e,M as i}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-CKqQQJMA.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function _(){return s.jsxs(n,{sectionId:18,children:[s.jsx("h2",{children:"Application to Schnorr Response"}),s.jsxs("p",{children:["Now we can finally see how share conversion enables distributed computation of the Schnorr signature response ",s.jsx(e,{children:"z = k + s \\cdot c"})," without ever reconstructing the secret key ",s.jsx(e,{children:"s"})," or the nonce",s.jsx(e,{children:"k"}),"."]}),s.jsx("h3",{children:"Recall the Components"}),s.jsx(c,{title:"What Each Participant Has",children:s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Polynomial share of secret key:"}),s.jsx(e,{children:"s_i"})," where ",s.jsx(e,{children:"s = \\sum_i s_i \\cdot \\lambda_i"})]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Additive share of nonce:"}),s.jsx(e,{children:"k_i"})," where ",s.jsx(e,{children:"k = \\sum_i k_i"})]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Public challenge:"}),s.jsx(e,{children:"c = H(R \\| Y \\| m)"})]})]})}),s.jsx("h3",{children:"The Single-Party Formula"}),s.jsx("p",{children:"In standard Schnorr, the signer computes:"}),s.jsx(i,{children:"z = k + s \\cdot c"}),s.jsxs("p",{children:["We need to compute this same ",s.jsx(e,{children:"z"})," using only shares."]}),s.jsx("h3",{children:"The FROST Computation"}),s.jsxs(d,{title:"Distributed Schnorr Response",children:[s.jsxs("p",{children:["Each participant ",s.jsx(e,{children:"i"})," computes their signature share:"]}),s.jsx(i,{children:"z_i = k_i + (s_i \\cdot \\lambda_i) \\cdot c"}),s.jsx("p",{className:"mt-3",children:"The final response is simply:"}),s.jsx(i,{children:"z = \\sum_{i \\in S} z_i"})]}),s.jsx("h3",{children:"Why This Works"}),s.jsx("p",{children:"Let's verify that aggregating the shares produces the correct result:"}),s.jsx(i,{children:"z = \\sum_{i \\in S} z_i = \\sum_{i \\in S} \\left( k_i + s_i \\cdot \\lambda_i \\cdot c \\right)"}),s.jsx("p",{children:"Separating the sums:"}),s.jsx(i,{children:"z = \\sum_{i \\in S} k_i + \\sum_{i \\in S} s_i \\cdot \\lambda_i \\cdot c"}),s.jsxs("p",{children:["The first sum is the additive reconstruction of ",s.jsx(e,{children:"k"}),":"]}),s.jsx(i,{children:"\\sum_{i \\in S} k_i = k"}),s.jsxs("p",{children:["The second sum is the polynomial reconstruction of ",s.jsx(e,{children:"s"})," multiplied by",s.jsx(e,{children:"c"}),":"]}),s.jsx(i,{children:"\\sum_{i \\in S} s_i \\cdot \\lambda_i \\cdot c = c \\cdot \\sum_{i \\in S} s_i \\cdot \\lambda_i = c \\cdot s = s \\cdot c"}),s.jsx("p",{children:"Therefore:"}),s.jsx(i,{children:"z = k + s \\cdot c \\quad \\checkmark"}),s.jsxs(r,{type:"success",children:[s.jsx("strong",{children:"The Magic Revealed:"})," The Lagrange coefficients naturally convert the polynomial shares to additive form during the summation! We get:",s.jsxs("ul",{className:"list-disc list-inside mt-2",children:[s.jsxs("li",{children:[s.jsx(e,{children:"k"})," from adding the additive nonce shares"]}),s.jsxs("li",{children:[s.jsx(e,{children:"s \\cdot c"})," from the weighted sum of key shares"]})]})]}),s.jsxs(l,{title:"Complete Numerical Example",children:[s.jsxs("p",{className:"mb-4",children:["Using our running example with participants ","{1, 2, 3}",":"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"font-semibold mb-2",children:"Given values:"}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[s.jsxs("div",{className:"p-2 rounded bg-dark-800/50",children:["Nonce shares: ",s.jsx(e,{children:"k_1=100, k_2=200, k_3=150"})]}),s.jsxs("div",{className:"p-2 rounded bg-dark-800/50",children:["Key shares: ",s.jsx(e,{children:"s_1=42, s_2=67, s_3=31"})]}),s.jsxs("div",{className:"p-2 rounded bg-dark-800/50",children:["Challenge: ",s.jsx(e,{children:"c = 5"})]})]})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-semibold mb-2",children:"Lagrange coefficients:"}),s.jsx(i,{children:"\\lambda_1 = 3, \\quad \\lambda_2 = -3, \\quad \\lambda_3 = 1"})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-semibold text-indigo-400 mb-2",children:"Participant 1 computes:"}),s.jsx(i,{children:"z_1 = k_1 + s_1 \\cdot \\lambda_1 \\cdot c = 100 + 42 \\cdot 3 \\cdot 5 = 100 + 630 = 730"})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-semibold text-emerald-400 mb-2",children:"Participant 2 computes:"}),s.jsx(i,{children:"z_2 = k_2 + s_2 \\cdot \\lambda_2 \\cdot c = 200 + 67 \\cdot (-3) \\cdot 5 = 200 - 1005 = -805"})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-semibold text-amber-400 mb-2",children:"Participant 3 computes:"}),s.jsx(i,{children:"z_3 = k_3 + s_3 \\cdot \\lambda_3 \\cdot c = 150 + 31 \\cdot 1 \\cdot 5 = 150 + 155 = 305"})]}),s.jsxs("div",{className:"border-t border-dark-700 pt-4",children:[s.jsx("h5",{className:"font-semibold mb-2",children:"Aggregation:"}),s.jsx(i,{children:"z = z_1 + z_2 + z_3 = 730 + (-805) + 305 = 230"})]}),s.jsxs("div",{className:"border-t border-dark-700 pt-4",children:[s.jsx("h5",{className:"font-semibold mb-2",children:"Verification:"}),s.jsxs("p",{className:"text-sm mb-2",children:["The secret is ",s.jsx(e,{children:"s = 42 \\cdot 3 + 67 \\cdot (-3) + 31 \\cdot 1 = 126 - 201 + 31 = -44"})]}),s.jsxs("p",{className:"text-sm mb-2",children:["The nonce is ",s.jsx(e,{children:"k = 100 + 200 + 150 = 450"})]}),s.jsx(i,{children:"z = k + s \\cdot c = 450 + (-44) \\cdot 5 = 450 - 220 = 230 \\quad \\checkmark"})]})]})]}),s.jsx("h3",{children:"What Each Participant Knows"}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4 my-6",children:[s.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-emerald-500/30",children:[s.jsx("h4",{className:"font-semibold text-emerald-400 mb-2",children:"Participant i Knows"}),s.jsxs("ul",{className:"space-y-1 text-sm",children:[s.jsxs("li",{children:["Their own ",s.jsx(e,{children:"s_i"})," and ",s.jsx(e,{children:"k_i"})]}),s.jsxs("li",{children:["The Lagrange coefficient ",s.jsx(e,{children:"\\lambda_i"})]}),s.jsxs("li",{children:["The public challenge ",s.jsx(e,{children:"c"})]}),s.jsxs("li",{children:["Their computed share ",s.jsx(e,{children:"z_i"})]})]})]}),s.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-rose-500/30",children:[s.jsx("h4",{className:"font-semibold text-rose-400 mb-2",children:"Participant i Does NOT Know"}),s.jsxs("ul",{className:"space-y-1 text-sm",children:[s.jsxs("li",{children:["Other participants' shares ",s.jsx(e,{children:"s_j, k_j"})]}),s.jsxs("li",{children:["The full secret ",s.jsx(e,{children:"s"})]}),s.jsxs("li",{children:["The full nonce ",s.jsx(e,{children:"k"})]}),s.jsxs("li",{children:["Other participants' ",s.jsx(e,{children:"z_j"})," values"]})]})]})]}),s.jsxs(r,{type:"info",children:[s.jsx("strong",{children:"Security Property:"})," Each ",s.jsx(e,{children:"z_i"})," looks random because it's masked by the random nonce share ",s.jsx(e,{children:"k_i"}),". An observer seeing ",s.jsx(e,{children:"z_i"})," learns nothing about ",s.jsx(e,{children:"s_i"}),"."]}),s.jsx("h3",{children:"Summary: The FROST Response Formula"}),s.jsxs(c,{title:"FROST Signature Share",children:[s.jsxs("p",{children:["Each participant ",s.jsx(e,{children:"i"})," in signing set ",s.jsx(e,{children:"S"}),"computes:"]}),s.jsx(i,{children:"z_i = k_i + s_i \\cdot \\lambda_i \\cdot c"}),s.jsxs("p",{className:"mt-3",children:["This is the participant's contribution to the final signature response",s.jsx(e,{children:"z = \\sum_i z_i"}),"."]})]})]})}export{_ as default};
