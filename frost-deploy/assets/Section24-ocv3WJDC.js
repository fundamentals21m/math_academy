import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as c,D as r,T as n,E as a,C as t}from"./Callout-CQOyP6I7.js";import{I as s,M as i}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-DuspoTuy.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-ySXQbKre.js";function g(){return e.jsxs(c,{sectionId:24,children:[e.jsx("h2",{children:"Complete FROST Signing Formula"}),e.jsx("p",{children:"We now have all the components to understand the complete FROST signing formula. This is where the binding mechanism, share conversion, and Schnorr structure all come together."}),e.jsx("h3",{children:"The Full Participant Computation"}),e.jsxs(r,{title:"FROST Signature Share",children:[e.jsxs("p",{children:["Each participant ",e.jsx(s,{children:"i \\in S"})," (the signing set) computes their signature share:"]}),e.jsx(i,{children:"z_i = d_i + e_i \\cdot \\rho_i + \\lambda_i \\cdot s_i \\cdot c"})]}),e.jsx("p",{children:"Let's break down each component:"}),e.jsxs("div",{className:"space-y-4 my-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsxs("h4",{className:"font-semibold text-indigo-400 mb-2",children:[e.jsx(s,{children:"d_i + e_i \\cdot \\rho_i"})," — Nonce Contribution"]}),e.jsxs("p",{className:"text-sm",children:["The effective nonce ",e.jsx(s,{children:"k_i"})," from the modified nonce generation. This is bound to the session via ",e.jsx(s,{children:"\\rho_i"}),"."]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsxs("h4",{className:"font-semibold text-emerald-400 mb-2",children:[e.jsx(s,{children:"\\lambda_i"})," — Lagrange Coefficient"]}),e.jsxs("p",{className:"text-sm",children:["The Lagrange coefficient for participant ",e.jsx(s,{children:"i"})," in the signing set ",e.jsx(s,{children:"S"}),":"]}),e.jsx(i,{children:"\\lambda_i = \\prod_{j \\in S, j \\neq i} \\frac{0 - j}{i - j} = \\prod_{j \\in S, j \\neq i} \\frac{j}{j - i}"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsxs("h4",{className:"font-semibold text-amber-400 mb-2",children:[e.jsx(s,{children:"s_i"})," — Secret Share"]}),e.jsxs("p",{className:"text-sm",children:["Participant ",e.jsx(s,{children:"i"}),"'s Shamir share of the group secret key. This never leaves the participant's device."]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsxs("h4",{className:"font-semibold text-rose-400 mb-2",children:[e.jsx(s,{children:"c"})," — Challenge"]}),e.jsx("p",{className:"text-sm",children:"The Schnorr challenge hash:"}),e.jsx(i,{children:"c = H_2(R, Y, m)"})]})]}),e.jsx("h3",{children:"How the Components Fit Together"}),e.jsxs(n,{title:"Structure of FROST Response",children:[e.jsx("p",{children:"The FROST signature share has the form:"}),e.jsx(i,{children:"z_i = \\underbrace{d_i + e_i \\cdot \\rho_i}_{\\text{bound nonce } k_i} + \\underbrace{\\lambda_i \\cdot s_i}_{\\text{weighted secret share}} \\cdot c"}),e.jsxs("p",{className:"mt-3",children:["This mirrors the single-party Schnorr response ",e.jsx(s,{children:"z = k + s \\cdot c"}),", but distributed across participants."]})]}),e.jsx("h3",{children:"The Challenge Computation"}),e.jsx("p",{children:"Before computing their share, all participants must agree on:"}),e.jsx(i,{children:"R = \\sum_{i \\in S} R_i = \\sum_{i \\in S} (D_i + [\\rho_i]E_i)"}),e.jsx("p",{children:"Then the challenge is:"}),e.jsx(i,{children:"c = H_2(R, Y, m)"}),e.jsxs(a,{title:"Complete Signing Computation",children:[e.jsx("p",{className:"mb-4",children:"Participant 2 in a 2-of-3 signing (participants 1 and 2 active):"}),e.jsxs("div",{className:"space-y-4 font-mono text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 mb-1",children:"Given values:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsxs("li",{children:[e.jsx("span",{className:"text-indigo-400",children:"d₂ = "}),"17389 (secret nonce component)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-emerald-400",children:"e₂ = "}),"28451 (secret nonce component)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-amber-400",children:"s₂ = "}),"94728 (secret share)"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 mb-1",children:"Computed values:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsxs("li",{children:[e.jsx("span",{className:"text-rose-400",children:"ρ₂ = "}),"H₁(2, m, B)"]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-purple-400",children:"λ₂ = "}),"1·(1-2)⁻¹ = -1 (for S = ","{1,2}",")"]}),e.jsxs("li",{children:[e.jsx("span",{className:"text-cyan-400",children:"c = "}),"H₂(R, Y, m)"]})]})]}),e.jsxs("div",{className:"pt-3 border-t border-dark-700",children:[e.jsx("p",{className:"text-gray-400 mb-1",children:"Signature share:"}),e.jsx("p",{className:"text-white",children:"z₂ = d₂ + e₂·ρ₂ + λ₂·s₂·c"}),e.jsx("p",{className:"text-white",children:"z₂ = 17389 + 28451·ρ₂ + (-1)·94728·c (mod q)"})]})]})]}),e.jsx("h3",{children:"Signature Aggregation"}),e.jsx("p",{children:"Once all participants compute their shares, the coordinator aggregates:"}),e.jsx(i,{children:"z = \\sum_{i \\in S} z_i"}),e.jsxs(r,{title:"Final Signature",children:[e.jsx("p",{children:"The FROST threshold signature is the pair:"}),e.jsx(i,{children:"\\sigma = (R, z)"}),e.jsxs("p",{className:"mt-3",children:["This is a standard Schnorr signature that verifies against the group public key",e.jsx(s,{children:"Y"}),"."]})]}),e.jsx("h3",{children:"Why This Works"}),e.jsx("p",{children:"Expanding the aggregated response:"}),e.jsx(i,{children:"z = \\sum_{i \\in S} z_i = \\sum_{i \\in S} (d_i + e_i \\cdot \\rho_i + \\lambda_i \\cdot s_i \\cdot c)"}),e.jsx("p",{children:"Rearranging:"}),e.jsx(i,{children:"z = \\underbrace{\\sum_{i \\in S} (d_i + e_i \\cdot \\rho_i)}_{= k} + c \\cdot \\underbrace{\\sum_{i \\in S} \\lambda_i \\cdot s_i}_{= s}"}),e.jsxs(n,{title:"FROST Correctness",children:[e.jsx("p",{children:"By the share conversion theorem:"}),e.jsx(i,{children:"\\sum_{i \\in S} \\lambda_i \\cdot s_i = s"}),e.jsx("p",{className:"mt-3",children:"And by construction of the group nonce:"}),e.jsx(i,{children:"\\sum_{i \\in S} (d_i + e_i \\cdot \\rho_i) = k"}),e.jsx("p",{className:"mt-3",children:"Therefore:"}),e.jsx(i,{children:"z = k + s \\cdot c"}),e.jsx("p",{className:"mt-3",children:"This is exactly the Schnorr response formula!"})]}),e.jsxs(t,{type:"success",children:[e.jsx("strong",{children:"The Magic:"})," Even though no single party ever knows ",e.jsx(s,{children:"s"}),"or ",e.jsx(s,{children:"k"}),", the combined shares produce a valid Schnorr signature. The group has computed ",e.jsx(s,{children:"z = k + s \\cdot c"})," without any participant reconstructing the secrets."]}),e.jsx("h3",{children:"Summary of the Complete Formula"}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-indigo-500/30 my-6",children:[e.jsx("h4",{className:"font-semibold text-center text-indigo-400 mb-4",children:"FROST Signature Share"}),e.jsx(i,{children:"z_i = d_i + e_i \\cdot \\rho_i + \\lambda_i \\cdot s_i \\cdot c"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx(s,{children:"d_i, e_i"}),": Preprocessed nonces"]}),e.jsxs("p",{children:[e.jsx(s,{children:"\\rho_i"}),": Session binding"]})]}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx(s,{children:"\\lambda_i"}),": Lagrange coefficient"]}),e.jsxs("p",{children:[e.jsx(s,{children:"s_i"}),": Secret share, ",e.jsx(s,{children:"c"}),": Challenge"]})]})]})]})]})}export{g as default};
