import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as l,C as n,D as d,T as r,E as c}from"./Callout-CQOyP6I7.js";import{I as i,M as s}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-DuspoTuy.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-ySXQbKre.js";function u(){return e.jsxs(l,{sectionId:23,children:[e.jsx("h2",{children:"Modified Nonce Generation"}),e.jsx("p",{children:"FROST's binding mechanism requires modifying how participants compute their nonce contributions. Instead of simple additive shares, each participant uses a formula that incorporates the binding value."}),e.jsx("h3",{children:"The Traditional Approach (Insecure)"}),e.jsxs("p",{children:["In naive threshold Schnorr, each participant would simply contribute their random nonce share ",e.jsx(i,{children:"k_i"}),":"]}),e.jsx(s,{children:"k = \\sum_i k_i"}),e.jsxs(n,{type:"error",children:[e.jsx("strong",{children:"Problem:"})," This additive structure is exactly what the Drijvers attack exploits. The attacker can combine nonce shares across sessions using Wagner's algorithm."]}),e.jsx("h3",{children:"FROST's Modified Formula"}),e.jsxs(d,{title:"FROST Nonce Generation",children:[e.jsxs("p",{children:["Each participant ",e.jsx(i,{children:"i"})," computes their effective nonce as:"]}),e.jsx(s,{children:"k_i = d_i + e_i \\cdot \\rho_i"}),e.jsx("p",{className:"mt-3",children:"where:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsxs("li",{children:[e.jsx(i,{children:"d_i"}),": First random scalar (secret)"]}),e.jsxs("li",{children:[e.jsx(i,{children:"e_i"}),": Second random scalar (secret)"]}),e.jsxs("li",{children:[e.jsx(i,{children:"\\rho_i = H_1(i, m, B)"}),": Binding value (public after commitment phase)"]})]})]}),e.jsx("h3",{children:"Why Two Random Values?"}),e.jsxs("p",{children:["The structure ",e.jsx(i,{children:"k_i = d_i + e_i \\cdot \\rho_i"})," is deliberate:"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 my-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsxs("h4",{className:"font-semibold text-indigo-400 mb-2",children:["Role of ",e.jsx(i,{children:"d_i"})]}),e.jsxs("p",{className:"text-sm",children:["Provides base randomness independent of the session. Even if ",e.jsx(i,{children:"\\rho_i"}),"is known, ",e.jsx(i,{children:"d_i"})," ensures unpredictability."]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsxs("h4",{className:"font-semibold text-emerald-400 mb-2",children:["Role of ",e.jsx(i,{children:"e_i"})]}),e.jsxs("p",{className:"text-sm",children:["Multiplied by ",e.jsx(i,{children:"\\rho_i"})," to bind the nonce to the session. Different ",e.jsx(i,{children:"\\rho_i"})," values give different effective nonces."]})]})]}),e.jsxs(r,{title:"Nonce Binding Property",children:[e.jsxs("p",{children:["The effective nonce ",e.jsx(i,{children:"k_i"})," is uniquely determined by:"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-3",children:[e.jsxs("li",{children:["The pre-committed values ",e.jsx(i,{children:"(d_i, e_i)"})]}),e.jsxs("li",{children:["The session-specific binding ",e.jsx(i,{children:"\\rho_i"})]})]}),e.jsxs("p",{className:"mt-3",children:["Changing any session parameter changes ",e.jsx(i,{children:"\\rho_i"}),", which changes ",e.jsx(i,{children:"k_i"}),"."]})]}),e.jsx("h3",{children:"Public vs Private Components"}),e.jsx(c,{title:"What Is Public vs Secret",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-emerald-900/20 border border-emerald-500/30",children:[e.jsx("p",{className:"text-emerald-400 font-semibold mb-2",children:"Public (published in preprocessing):"}),e.jsxs("ul",{className:"space-y-1 text-sm",children:[e.jsxs("li",{children:[e.jsx(i,{children:"D_i = [d_i]G"})," - commitment to first scalar"]}),e.jsxs("li",{children:[e.jsx(i,{children:"E_i = [e_i]G"})," - commitment to second scalar"]})]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-rose-900/20 border border-rose-500/30",children:[e.jsx("p",{className:"text-rose-400 font-semibold mb-2",children:"Secret (stored securely, then deleted):"}),e.jsxs("ul",{className:"space-y-1 text-sm",children:[e.jsxs("li",{children:[e.jsx(i,{children:"d_i"})," - first random scalar"]}),e.jsxs("li",{children:[e.jsx(i,{children:"e_i"})," - second random scalar"]})]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-amber-900/20 border border-amber-500/30",children:[e.jsx("p",{className:"text-amber-400 font-semibold mb-2",children:"Computed during signing:"}),e.jsxs("ul",{className:"space-y-1 text-sm",children:[e.jsxs("li",{children:[e.jsx(i,{children:"\\rho_i = H_1(i, m, B)"})," - binding value"]}),e.jsxs("li",{children:[e.jsx(i,{children:"k_i = d_i + e_i \\cdot \\rho_i"})," - effective nonce"]})]})]})]})}),e.jsx("h3",{children:"The Public Commitment Point"}),e.jsxs("p",{children:["The group commitment ",e.jsx(i,{children:"R"})," can be computed publicly:"]}),e.jsx(s,{children:"R_i = [k_i]G = [d_i + e_i \\cdot \\rho_i]G = [d_i]G + [e_i \\cdot \\rho_i]G"}),e.jsx("p",{children:"Using the public commitments:"}),e.jsx(s,{children:"R_i = D_i + [\\rho_i]E_i"}),e.jsx("p",{children:"This is verifiable by anyone with the public values!"}),e.jsx("h3",{children:"Group Nonce Aggregation"}),e.jsx("p",{children:"The effective group nonce is the sum:"}),e.jsx(s,{children:"k = \\sum_{i \\in S} k_i = \\sum_{i \\in S} (d_i + e_i \\cdot \\rho_i)"}),e.jsx("p",{children:"And the group commitment:"}),e.jsx(s,{children:"R = [k]G = \\sum_{i \\in S} (D_i + [\\rho_i]E_i)"}),e.jsxs(n,{type:"info",children:[e.jsx("strong",{children:"Key Property:"})," While no single party knows ",e.jsx(i,{children:"k"}),", everyone can compute ",e.jsx(i,{children:"R = [k]G"})," from the public commitments. This is the essence of threshold computation."]}),e.jsx("h3",{children:"Numerical Example"}),e.jsxs(c,{title:"Concrete Nonce Computation",children:[e.jsx("p",{className:"mb-4",children:"Participant 2 in a signing session:"}),e.jsxs("div",{className:"space-y-4 font-mono text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 mb-1",children:"Secret scalars (from preprocessing):"}),e.jsx("p",{className:"text-indigo-400",children:"d₂ = 17389"}),e.jsx("p",{className:"text-emerald-400",children:"e₂ = 28451"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 mb-1",children:"Binding value (computed from hash):"}),e.jsx("p",{className:"text-amber-400",children:"ρ₂ = H₁(2, m, B) = 42561..."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 mb-1",children:"Effective nonce:"}),e.jsx("p",{className:"text-rose-400",children:"k₂ = 17389 + 28451 · 42561... mod q"})]})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-400",children:"In practice, these are 256-bit numbers mod q."})]}),e.jsx("h3",{children:"Security Implication"}),e.jsxs(r,{title:"Cross-Session Prevention",children:[e.jsxs("p",{children:["The formula ",e.jsx(i,{children:"k_i = d_i + e_i \\cdot \\rho_i"})," prevents cross-session attacks because:"]}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-3",children:[e.jsxs("li",{children:[e.jsx(i,{children:"\\rho_i"})," depends on ALL commitments from all participants"]}),e.jsxs("li",{children:["Changing any commitment changes ",e.jsx(i,{children:"\\rho_i"})," for everyone"]}),e.jsxs("li",{children:["The adversary cannot know ",e.jsx(i,{children:"\\rho_i"})," until after committing to ",e.jsx(i,{children:"D_i, E_i"})]})]})]}),e.jsx("h3",{children:"Summary"}),e.jsx("p",{children:"The modified nonce formula is the mathematical heart of FROST's binding:"}),e.jsx(s,{children:"k_i = d_i + e_i \\cdot \\rho_i"}),e.jsx("p",{children:"This transforms independent random values into session-specific contributions that cannot be combined across parallel signing sessions."})]})}export{u as default};
