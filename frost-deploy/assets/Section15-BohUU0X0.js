import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as d}from"./LessonLayout-sKo1Ukyt.js";import{D as i,E as l,C as n}from"./Callout-D6GJ8KQY.js";import{I as s,M as r}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-LWQys88K.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-ySXQbKre.js";function f(){return e.jsxs(d,{sectionId:15,children:[e.jsx("h2",{children:"Two Types of Secret Sharing"}),e.jsx("p",{children:"Understanding the distinction between polynomial (Shamir) shares and additive shares is essential for grasping how FROST works. These two approaches have different properties, and FROST cleverly uses both."}),e.jsx("h3",{children:"Shamir (Polynomial) Shares"}),e.jsxs(i,{title:"Shamir Secret Sharing",children:[e.jsxs("p",{children:["Given a secret ",e.jsx(s,{children:"s"})," and threshold ",e.jsx(s,{children:"t"}),":"]}),e.jsx(r,{children:"f(x) = s + a_1 x + a_2 x^2 + \\cdots + a_{t-1} x^{t-1}"}),e.jsx("p",{className:"mt-3",children:"Shares are points on the polynomial:"}),e.jsx(r,{children:"(1, f(1)), \\, (2, f(2)), \\, \\ldots, \\, (n, f(n))"}),e.jsx("p",{className:"mt-3",children:"Reconstruction uses Lagrange coefficients:"}),e.jsx(r,{children:"s = \\sum_{i \\in S} s_i \\cdot \\lambda_i"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-emerald-500/30 my-6",children:[e.jsx("h4",{className:"font-semibold text-emerald-400 mb-3",children:"Key Properties of Shamir Shares"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Threshold flexibility:"})," Any ",e.jsx(s,{children:"t"})," of",e.jsx(s,{children:"n"})," shares suffice"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Information-theoretic security:"})," ",e.jsx(s,{children:"t-1"}),"shares reveal nothing"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Requires coordination:"})," A dealer or DKG protocol is needed"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Weighted reconstruction:"})," Lagrange coefficients depend on which participants are involved"]})]})]}),e.jsx("h3",{children:"Additive Shares"}),e.jsxs(i,{title:"Additive Secret Sharing",children:[e.jsxs("p",{children:["Given a secret ",e.jsx(s,{children:"k"})," and ",e.jsx(s,{children:"t"})," participants:"]}),e.jsx(r,{children:"k = k_1 + k_2 + \\cdots + k_t"}),e.jsxs("p",{className:"mt-3",children:["where each ",e.jsx(s,{children:"k_i"})," is a share. Reconstruction is simply:"]}),e.jsx(r,{children:"k = \\sum_{i=1}^{t} k_i"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-amber-500/30 my-6",children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-3",children:"Key Properties of Additive Shares"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"All-or-nothing:"})," ALL ",e.jsx(s,{children:"t"})," shares are needed (",e.jsx(s,{children:"t"}),"-of-",e.jsx(s,{children:"t"}),")"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Non-interactive generation:"})," Each party generates their own",e.jsx(s,{children:"k_i"})," independently"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Simple reconstruction:"})," Just add the shares"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Equal weighting:"})," Each share contributes equally (weight = 1)"]})]})]}),e.jsx("h3",{children:"Side-by-Side Comparison"}),e.jsx("div",{className:"overflow-x-auto my-6",children:e.jsxs("table",{className:"w-full border-collapse text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left p-3",children:"Aspect"}),e.jsx("th",{className:"text-left p-3 text-emerald-400",children:"Shamir (Polynomial)"}),e.jsx("th",{className:"text-left p-3 text-amber-400",children:"Additive"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-dark-700/50",children:[e.jsx("td",{className:"p-3",children:"Structure"}),e.jsx("td",{className:"p-3",children:"Points on polynomial"}),e.jsx("td",{className:"p-3",children:"Random values that sum to secret"})]}),e.jsxs("tr",{className:"border-b border-dark-700/50",children:[e.jsx("td",{className:"p-3",children:"Threshold"}),e.jsxs("td",{className:"p-3",children:[e.jsx(s,{children:"t"}),"-of-",e.jsx(s,{children:"n"})]}),e.jsxs("td",{className:"p-3",children:[e.jsx(s,{children:"t"}),"-of-",e.jsx(s,{children:"t"})]})]}),e.jsxs("tr",{className:"border-b border-dark-700/50",children:[e.jsx("td",{className:"p-3",children:"Generation"}),e.jsx("td",{className:"p-3",children:"Dealer or DKG required"}),e.jsx("td",{className:"p-3",children:"Each party generates independently"})]}),e.jsxs("tr",{className:"border-b border-dark-700/50",children:[e.jsx("td",{className:"p-3",children:"Reconstruction"}),e.jsx("td",{className:"p-3",children:e.jsx(s,{children:"\\sum s_i \\cdot \\lambda_i"})}),e.jsx("td",{className:"p-3",children:e.jsx(s,{children:"\\sum k_i"})})]}),e.jsxs("tr",{className:"border-b border-dark-700/50",children:[e.jsx("td",{className:"p-3",children:"Flexibility"}),e.jsxs("td",{className:"p-3",children:["Any subset of size ",e.jsx(s,{children:"t"})]}),e.jsxs("td",{className:"p-3",children:["Fixed set of ",e.jsx(s,{children:"t"})," parties"]})]}),e.jsxs("tr",{className:"border-b border-dark-700/50",children:[e.jsx("td",{className:"p-3",children:"Use in FROST"}),e.jsxs("td",{className:"p-3",children:["Long-term key ",e.jsx(s,{children:"s"})]}),e.jsxs("td",{className:"p-3",children:["Ephemeral nonce ",e.jsx(s,{children:"k"})]})]})]})]})}),e.jsxs(l,{title:"Generating Both Types of Shares",children:[e.jsx("p",{className:"mb-4",children:"Consider a 3-of-5 threshold scheme:"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-emerald-400 mb-2",children:"Shamir shares of s = 100:"}),e.jsxs("p",{className:"text-sm mb-2",children:["Dealer chooses polynomial ",e.jsx(s,{children:"f(x) = 100 + 25x + 7x^2"})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2 font-mono text-sm",children:[e.jsx("div",{className:"p-2 rounded bg-dark-800/50",children:e.jsx(s,{children:"s_1 = 132"})}),e.jsx("div",{className:"p-2 rounded bg-dark-800/50",children:e.jsx(s,{children:"s_2 = 178"})}),e.jsx("div",{className:"p-2 rounded bg-dark-800/50",children:e.jsx(s,{children:"s_3 = 238"})}),e.jsx("div",{className:"p-2 rounded bg-dark-800/50",children:e.jsx(s,{children:"s_4 = 312"})}),e.jsx("div",{className:"p-2 rounded bg-dark-800/50",children:e.jsx(s,{children:"s_5 = 400"})})]}),e.jsx("p",{className:"text-sm mt-2 text-gray-400",children:"Any 3 can reconstruct; shares differ widely"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-amber-400 mb-2",children:"Additive shares of k (participants 1, 2, 3):"}),e.jsx("p",{className:"text-sm mb-2",children:"Each generates random value independently"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 font-mono text-sm",children:[e.jsx("div",{className:"p-2 rounded bg-dark-800/50",children:e.jsx(s,{children:"k_1 = 47"})}),e.jsx("div",{className:"p-2 rounded bg-dark-800/50",children:e.jsx(s,{children:"k_2 = 83"})}),e.jsx("div",{className:"p-2 rounded bg-dark-800/50",children:e.jsx(s,{children:"k_3 = 120"})})]}),e.jsxs("p",{className:"text-sm mt-2 text-gray-400",children:[e.jsx(s,{children:"k = 47 + 83 + 120 = 250"}),"; all 3 shares needed"]})]})]})]}),e.jsx("h3",{children:"Why FROST Uses Both"}),e.jsxs(n,{type:"info",children:[e.jsx("strong",{children:"The FROST Strategy:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsxs("strong",{children:["Long-term secret ",e.jsx(s,{children:"s"}),":"]})," Use Shamir sharing for t-of-n flexibility (any subset can sign)"]}),e.jsxs("li",{children:[e.jsxs("strong",{children:["Ephemeral nonce ",e.jsx(s,{children:"k"}),":"]})," Use additive sharing for efficiency (no coordination needed)"]})]})]}),e.jsxs("p",{children:["For the nonce, we already know which ",e.jsx(s,{children:"t"})," participants are signing. Each can generate their own random ",e.jsx(s,{children:"k_i"})," without communication. The additive structure is perfect for this use case."]}),e.jsx("p",{children:"For the long-term secret, we need flexibility - different subsets might sign different messages at different times. Shamir's threshold property provides this flexibility."}),e.jsx("h3",{children:"The Combining Challenge"}),e.jsx("p",{children:"Recall the Schnorr response formula:"}),e.jsx(r,{children:"z = k + s \\cdot c"}),e.jsx("p",{children:"We have:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 my-4",children:[e.jsxs("li",{children:[e.jsx(s,{children:"k"})," additively shared: ",e.jsx(s,{children:"k = \\sum k_i"})]}),e.jsxs("li",{children:[e.jsx(s,{children:"s"})," polynomially shared: ",e.jsx(s,{children:"s = \\sum s_i \\cdot \\lambda_i"})]})]}),e.jsx("p",{children:"How do we add these together when they have different structures? The answer lies in a beautiful mathematical transformation that we'll explore next."}),e.jsxs(n,{type:"warning",children:[e.jsx("strong",{children:"Key Question:"})," Can we convert additive shares to polynomial shares (or vice versa) so that they can be combined? The answer is yes, using Lagrange coefficients - and this is the heart of FROST's mathematical elegance."]})]})}export{f as default};
