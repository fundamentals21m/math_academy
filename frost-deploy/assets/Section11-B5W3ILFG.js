import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as a}from"./LessonLayout-MHc1mXdO.js";import{E as n,C as i,T as c,D as t}from"./Callout-D6GJ8KQY.js";import{M as s,I as r}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-Dwb7rnsM.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function g(){return e.jsxs(a,{sectionId:11,children:[e.jsx("h2",{children:"Concrete Reconstruction Example"}),e.jsx("p",{children:"Let's walk through a complete example of reconstructing a secret from Shamir shares using Lagrange interpolation. This will solidify your understanding of the mathematical machinery we've built."}),e.jsx("h3",{children:"Setup: The Shares"}),e.jsx("p",{children:"Recall from our polynomial encoding example, we created shares from the polynomial:"}),e.jsx(s,{children:"f(x) = 42 + 17x + 8x^2"}),e.jsxs("p",{children:["where the secret is ",e.jsx(r,{children:"s = f(0) = 42"}),". The shares for participants 1, 2, and 3 were:"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 my-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 text-center",children:[e.jsx("h4",{className:"font-semibold text-indigo-400 mb-2",children:"Participant 1"}),e.jsx(s,{children:"(x_1, y_1) = (1, 67)"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 text-center",children:[e.jsx("h4",{className:"font-semibold text-emerald-400 mb-2",children:"Participant 2"}),e.jsx(s,{children:"(x_2, y_2) = (2, 108)"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 text-center",children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-2",children:"Participant 3"}),e.jsx(s,{children:"(x_3, y_3) = (3, 165)"})]})]}),e.jsx("h3",{children:"Step 1: Compute Lagrange Coefficients"}),e.jsxs("p",{children:["For a 3-of-5 threshold scheme, we need 3 shares to reconstruct. Using shares from participants 1, 2, and 3, we compute the Lagrange coefficients at ",e.jsx(r,{children:"x = 0"}),":"]}),e.jsx(n,{title:"Computing Lagrange Coefficients",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-dark-800/50",children:[e.jsx("p",{className:"text-indigo-400 font-semibold mb-2",children:"For participant 1:"}),e.jsx(s,{children:"\\lambda_1 = \\frac{(0 - x_2)(0 - x_3)}{(x_1 - x_2)(x_1 - x_3)} = \\frac{(0-2)(0-3)}{(1-2)(1-3)}"}),e.jsx(s,{children:"= \\frac{(-2)(-3)}{(-1)(-2)} = \\frac{6}{2} = 3"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-dark-800/50",children:[e.jsx("p",{className:"text-emerald-400 font-semibold mb-2",children:"For participant 2:"}),e.jsx(s,{children:"\\lambda_2 = \\frac{(0 - x_1)(0 - x_3)}{(x_2 - x_1)(x_2 - x_3)} = \\frac{(0-1)(0-3)}{(2-1)(2-3)}"}),e.jsx(s,{children:"= \\frac{(-1)(-3)}{(1)(-1)} = \\frac{3}{-1} = -3"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-dark-800/50",children:[e.jsx("p",{className:"text-amber-400 font-semibold mb-2",children:"For participant 3:"}),e.jsx(s,{children:"\\lambda_3 = \\frac{(0 - x_1)(0 - x_2)}{(x_3 - x_1)(x_3 - x_2)} = \\frac{(0-1)(0-2)}{(3-1)(3-2)}"}),e.jsx(s,{children:"= \\frac{(-1)(-2)}{(2)(1)} = \\frac{2}{2} = 1"})]})]})}),e.jsxs(i,{type:"info",children:[e.jsx("strong",{children:"Quick Check:"})," The Lagrange coefficients should sum to 1:",e.jsx(s,{children:"\\lambda_1 + \\lambda_2 + \\lambda_3 = 3 + (-3) + 1 = 1 \\checkmark"}),"This is a useful sanity check during implementation."]}),e.jsx("h3",{children:"Step 2: Reconstruct the Secret"}),e.jsx("p",{children:"Now we combine the shares with their Lagrange coefficients:"}),e.jsx(c,{title:"Secret Reconstruction",children:e.jsx(s,{children:"s = \\sum_{i=1}^{t} y_i \\cdot \\lambda_i"})}),e.jsx("p",{children:"Substituting our values:"}),e.jsx(s,{children:"s = y_1 \\cdot \\lambda_1 + y_2 \\cdot \\lambda_2 + y_3 \\cdot \\lambda_3"}),e.jsx(s,{children:"s = 67 \\cdot 3 + 108 \\cdot (-3) + 165 \\cdot 1"}),e.jsx(s,{children:"s = 201 - 324 + 165"}),e.jsx(s,{children:"s = 42 \\checkmark"}),e.jsxs(i,{type:"success",children:[e.jsx("strong",{children:"Success!"})," We've recovered the original secret ",e.jsx(r,{children:"s = 42"}),"using only 3 of the 5 shares, without ever needing to know the polynomial coefficients",e.jsx(r,{children:"a_1 = 17"})," or ",e.jsx(r,{children:"a_2 = 8"}),"."]}),e.jsx("h3",{children:"Using a Different Subset"}),e.jsx("p",{children:"Let's verify that any 3 shares work by using participants 1, 3, and 4 instead. The share for participant 4 was:"}),e.jsx(s,{children:"(x_4, y_4) = (4, 238)"}),e.jsxs(n,{title:"Reconstruction with Different Shares",children:[e.jsx("p",{className:"mb-4",children:"Using shares 1, 3, and 4:"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-400 font-semibold",children:"Lagrange coefficient for participant 1:"}),e.jsx(s,{children:"\\lambda_1 = \\frac{(0-3)(0-4)}{(1-3)(1-4)} = \\frac{12}{6} = 2"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-emerald-400 font-semibold",children:"Lagrange coefficient for participant 3:"}),e.jsx(s,{children:"\\lambda_3 = \\frac{(0-1)(0-4)}{(3-1)(3-4)} = \\frac{4}{-2} = -2"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-400 font-semibold",children:"Lagrange coefficient for participant 4:"}),e.jsx(s,{children:"\\lambda_4 = \\frac{(0-1)(0-3)}{(4-1)(4-3)} = \\frac{3}{3} = 1"})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-700",children:[e.jsx("p",{className:"font-semibold",children:"Reconstruction:"}),e.jsx(s,{children:"s = 67 \\cdot 2 + 165 \\cdot (-2) + 238 \\cdot 1 = 134 - 330 + 238 = 42 \\checkmark"})]})]})]}),e.jsx("h3",{children:"Key Observations"}),e.jsx(t,{title:"Properties of Lagrange Reconstruction",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-3",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Subset independence:"})," Any ",e.jsx(r,{children:"t"})," shares work, not just a specific set"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Coefficients depend on the set:"})," The Lagrange coefficients",e.jsx(r,{children:"\\lambda_i"})," change based on which participants are involved"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Linear combination:"})," The secret is a weighted sum of shares, where weights are the Lagrange coefficients"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Exact threshold:"})," Fewer than ",e.jsx(r,{children:"t"})," shares yield no information (we'll prove this next)"]})]})}),e.jsxs(i,{type:"warning",children:[e.jsx("strong",{children:"For FROST:"})," This reconstruction technique is foundational, but in FROST we ",e.jsx("em",{children:"never"})," actually reconstruct the secret ",e.jsx(r,{children:"s"}),". Instead, we use the Lagrange coefficients to compute with shares directly. This is the key insight that makes threshold signing possible without exposing the private key."]})]})}export{g as default};
