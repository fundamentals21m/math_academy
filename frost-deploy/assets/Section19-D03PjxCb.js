import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as t}from"./LessonLayout-WO30R0_w.js";import{T as r,C as n,D as a,E as l}from"./Callout-D6GJ8KQY.js";import{I as s,M as i}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-CKqQQJMA.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function g(){return e.jsxs(t,{sectionId:19,children:[e.jsx("h2",{children:"Why This Matters"}),e.jsxs("p",{children:["We've now seen the mathematical heart of FROST: the share conversion trick that allows distributed computation of ",e.jsx(s,{children:"z = k + s \\cdot c"}),". Let's step back and appreciate why this is so powerful."]}),e.jsx("h3",{children:"The Beautiful Mathematics"}),e.jsxs(r,{title:"The FROST Elegance",children:[e.jsx("p",{children:"FROST achieves four seemingly contradictory goals simultaneously:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-3",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"No secret reconstruction:"})," Neither ",e.jsx(s,{children:"s"}),"nor ",e.jsx(s,{children:"k"})," is ever computed in one place"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Non-interactive nonces:"})," Each participant generates",e.jsx(s,{children:"k_i"})," independently"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Threshold flexibility:"})," Any ",e.jsx(s,{children:"t"})," of",e.jsx(s,{children:"n"})," can sign"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Valid signatures:"})," Output is indistinguishable from single-party Schnorr"]})]})]}),e.jsx("h3",{children:"1. No Secret Reconstruction"}),e.jsx("p",{children:"In traditional threshold approaches, shares are brought together to reconstruct the secret before signing. This creates a single point of failure - whichever computer performs the reconstruction temporarily holds the full private key."}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 my-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-rose-500/30",children:[e.jsx("h4",{className:"font-semibold text-rose-400 mb-2",children:"Naive Approach"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[e.jsxs("li",{children:["Collect shares ",e.jsx(s,{children:"s_1, s_2, s_3"})]}),e.jsxs("li",{children:["Reconstruct ",e.jsx(s,{children:"s = \\sum s_i \\cdot \\lambda_i"})]}),e.jsxs("li",{children:["Compute ",e.jsx(s,{children:"z = k + s \\cdot c"})]}),e.jsx("li",{className:"text-rose-400",children:"Secret exposed at step 2!"})]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-emerald-500/30",children:[e.jsx("h4",{className:"font-semibold text-emerald-400 mb-2",children:"FROST Approach"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[e.jsxs("li",{children:["Each computes ",e.jsx(s,{children:"z_i = k_i + s_i \\cdot \\lambda_i \\cdot c"})]}),e.jsxs("li",{children:["Aggregate ",e.jsx(s,{children:"z = \\sum z_i"})]}),e.jsx("li",{className:"text-emerald-400",children:"Secret never exposed!"})]})]})]}),e.jsxs(n,{type:"success",children:[e.jsx("strong",{children:"Key Insight:"}),' Lagrange coefficients let us "weight" shares before aggregation, achieving the same result as reconstruction without ever computing the secret itself.']}),e.jsx("h3",{children:"2. Non-Interactive Nonce Generation"}),e.jsxs("p",{children:["The nonce ",e.jsx(s,{children:"k"})," must be fresh for every signature. Running a full DKG for each signature would be impractical. FROST's solution is elegant:"]}),e.jsxs(a,{title:"Additive Nonce Sharing",children:[e.jsxs("p",{children:["Each participant ",e.jsx(s,{children:"i"})," generates random ",e.jsx(s,{children:"k_i"}),"independently. No coordination required!"]}),e.jsx(i,{children:"k = \\sum_{i \\in S} k_i"}),e.jsx("p",{className:"mt-3",children:"The group nonce exists implicitly but is never computed by anyone."})]}),e.jsx("h3",{children:"3. Threshold Flexibility"}),e.jsxs("p",{children:["Unlike schemes that require all ",e.jsx(s,{children:"n"})," participants or a fixed subset, FROST allows ",e.jsx("em",{children:"any"})," ",e.jsx(s,{children:"t"})," participants to sign:"]}),e.jsxs(l,{title:"Threshold Flexibility in Practice",children:[e.jsx("p",{className:"mb-4",children:"In a 3-of-5 setup, all these combinations work:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:["Participants ","{1, 2, 3}"," with their Lagrange coefficients"]}),e.jsxs("li",{children:["Participants ","{1, 3, 5}"," with different Lagrange coefficients"]}),e.jsxs("li",{children:["Participants ","{2, 4, 5}"," with yet different coefficients"]})]}),e.jsxs("p",{className:"mt-4 text-sm text-gray-400",children:["Each subset computes different ",e.jsx(s,{children:"\\lambda_i"})," values, but the final signature is always valid!"]})]}),e.jsx("h3",{children:"4. Indistinguishable Signatures"}),e.jsxs("p",{children:["The output signature ",e.jsx(s,{children:"\\sigma = (R, z)"})," is mathematically identical to a single-party Schnorr signature:"]}),e.jsx(i,{children:"[z]G = R + [c]Y"}),e.jsx("p",{children:"This means:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 my-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Privacy:"})," On-chain observers can't tell it was threshold-signed"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Compatibility:"})," Standard Schnorr verification works unchanged"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Efficiency:"})," Same signature size (64 bytes) regardless of threshold"]})]}),e.jsx("h3",{children:"Security Properties"}),e.jsxs("div",{className:"space-y-4 my-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsx("h4",{className:"font-semibold text-indigo-400 mb-2",children:"Each z_i Reveals Nothing"}),e.jsxs("p",{className:"text-sm",children:["The random nonce share ",e.jsx(s,{children:"k_i"})," masks the key share contribution. An attacker seeing ",e.jsx(s,{children:"z_i"})," learns nothing about",e.jsx(s,{children:"s_i"}),"."]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsx("h4",{className:"font-semibold text-emerald-400 mb-2",children:"t-1 Shares Are Useless"}),e.jsxs("p",{className:"text-sm",children:["Even with ",e.jsx(s,{children:"t-1"})," shares of both ",e.jsx(s,{children:"s"}),"and ",e.jsx(s,{children:"k"}),", an attacker cannot forge signatures. The information-theoretic security of Shamir sharing applies."]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-2",children:"Fresh Nonces Per Signature"}),e.jsxs("p",{className:"text-sm",children:["Each signature uses independently generated ",e.jsx(s,{children:"k_i"})," values. No nonce reuse means no key extraction attacks."]})]})]}),e.jsx("h3",{children:"The Remaining Challenge"}),e.jsxs(n,{type:"warning",children:[e.jsx("strong",{children:"But Wait..."})," We've solved the share conversion problem, but there's still a security challenge. What if a malicious participant manipulates their nonce contribution across multiple parallel signing sessions?"]}),e.jsxs("p",{children:["The Drijvers attack exploits this vulnerability. FROST's response is a clever",e.jsx("em",{children:"binding mechanism"})," that ties each participant's nonce to the specific signing session. We'll explore this critical security feature next."]}),e.jsx("h3",{children:"Summary: The Mathematical Heart of FROST"}),e.jsxs(r,{title:"FROST's Core Innovation",children:[e.jsx("p",{children:"The Lagrange coefficient transformation enables:"}),e.jsx(i,{children:"z_i = k_i + s_i \\cdot \\lambda_i \\cdot c"}),e.jsx("p",{className:"mt-3",children:"where additive nonce shares combine naturally with weighted key shares to produce a valid Schnorr response without reconstruction."})]}),e.jsx("p",{children:"This single formula encapsulates years of cryptographic research and represents a beautiful synthesis of:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 my-4",children:[e.jsx("li",{children:"Shamir's secret sharing (1979)"}),e.jsx("li",{children:"Schnorr signatures (1989)"}),e.jsx("li",{children:"Feldman's verifiable secret sharing (1987)"}),e.jsx("li",{children:"Modern threshold signature research (2000s-2020)"})]}),e.jsx("p",{children:"FROST ties these together into a practical, efficient, and secure threshold signature scheme ready for real-world Bitcoin deployment."})]})}export{g as default};
