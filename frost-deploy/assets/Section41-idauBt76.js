import{j as i}from"./vendor-animation-0o8UKZ_1.js";import{L as t}from"./LessonLayout-WO30R0_w.js";import{D as n,E as r,T as l,C as a}from"./Callout-D6GJ8KQY.js";import{I as e,M as s}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-CKqQQJMA.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function p(){return i.jsxs(t,{sectionId:41,children:[i.jsx("h2",{children:"Signature Aggregation (MuSig-style)"}),i.jsx("p",{children:"FROST can be combined with MuSig-style signature aggregation to create powerful hybrid constructions. This enables multiple independent signers, each using their own threshold scheme, to produce a single aggregate signature."}),i.jsx("h3",{children:"The Scenario"}),i.jsxs(n,{title:"Multi-Signer Setup",children:[i.jsx("p",{children:"Multiple independent signers, each with their own FROST-shared key, want to produce a single signature:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[i.jsxs("li",{children:["Signer 1: FROST key with threshold ",i.jsx(e,{children:"(t_1, n_1)"}),", public key"," ",i.jsx(e,{children:"Y_1"})]}),i.jsxs("li",{children:["Signer 2: FROST key with threshold ",i.jsx(e,{children:"(t_2, n_2)"}),", public key"," ",i.jsx(e,{children:"Y_2"})]}),i.jsx("li",{children:"..."}),i.jsxs("li",{children:["Signer m: FROST key with threshold ",i.jsx(e,{children:"(t_m, n_m)"}),", public key"," ",i.jsx(e,{children:"Y_m"})]})]})]}),i.jsx("h3",{children:"Aggregate Public Key"}),i.jsxs(n,{title:"Key Aggregation",children:[i.jsx("p",{children:"The aggregate public key is formed by combining individual keys:"}),i.jsx(s,{children:"Y_{\\text{agg}} = \\sum_{i=1}^{m} a_i \\cdot Y_i"}),i.jsxs("p",{className:"mt-3",children:["where ",i.jsx(e,{children:"a_i"})," are key aggregation coefficients computed as:"]}),i.jsx(s,{children:"a_i = H_{\\text{agg}}(Y_i, \\{Y_1, \\ldots, Y_m\\})"}),i.jsx("p",{className:"mt-3",children:"The coefficients prevent rogue key attacks where a malicious signer chooses a key that cancels out honest signers' contributions."})]}),i.jsx("h3",{children:"Aggregate Signature Process"}),i.jsxs(r,{title:"Step 1: Each Signer Produces FROST Partial Signature",children:[i.jsxs("p",{children:["Each signer ",i.jsx(e,{children:"i"})," runs their internal FROST protocol:"]}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[i.jsxs("li",{children:["Select ",i.jsx(e,{children:"t_i"})," participants from their"," ",i.jsx(e,{children:"n_i"})," parties"]}),i.jsx("li",{children:"Each participant contributes their signature share"}),i.jsxs("li",{children:["Aggregator combines shares to form signer ",i.jsx(e,{children:"i"}),"'s partial signature: ",i.jsx(e,{children:"\\sigma_i = (R_i, z_i)"})]})]})]}),i.jsxs(r,{title:"Step 2: Combine Using MuSig Aggregation",children:[i.jsx("p",{children:"Aggregate the commitments:"}),i.jsx(s,{children:"R = \\sum_{i=1}^{m} R_i"}),i.jsx("p",{className:"mt-3",children:"Compute aggregate challenge:"}),i.jsx(s,{children:"c = H_2(R, Y_{\\text{agg}}, m)"}),i.jsx("p",{className:"mt-3",children:"Aggregate the responses:"}),i.jsx(s,{children:"z = \\sum_{i=1}^{m} a_i \\cdot z_i"}),i.jsx("p",{className:"mt-3",children:"Final aggregate signature:"}),i.jsx(s,{children:"\\sigma = (R, z)"})]}),i.jsx("h3",{children:"Verification"}),i.jsxs(l,{title:"Aggregate Signature Verification",children:[i.jsx("p",{children:"The verifier checks:"}),i.jsx(s,{children:"[z]G \\stackrel{?}{=} R + [c]Y_{\\text{agg}}"}),i.jsx("p",{className:"mt-3",children:"This is identical to standard Schnorr verification! The aggregate signature is indistinguishable from a single-party signature."})]}),i.jsx("h3",{children:"Mathematical Elegance"}),i.jsxs(r,{title:"Why Aggregation Works",children:[i.jsx("p",{children:"Each signer's response satisfies:"}),i.jsx(s,{children:"z_i = k_i + s_i \\cdot c_i"}),i.jsxs("p",{className:"mt-3",children:["where ",i.jsx(e,{children:"c_i"})," is the challenge seen by signer"," ",i.jsx(e,{children:"i"}),"."]}),i.jsx("p",{className:"mt-3",children:"In the MuSig framework, all signers use the aggregate challenge:"}),i.jsx(s,{children:"z = \\sum_i a_i \\cdot z_i = \\sum_i a_i(k_i + s_i \\cdot c)"}),i.jsx(s,{children:"= \\sum_i a_i \\cdot k_i + c \\cdot \\sum_i a_i \\cdot s_i"}),i.jsx(s,{children:"= k + c \\cdot s_{\\text{agg}}"}),i.jsxs("p",{className:"mt-3",children:["where ",i.jsx(e,{children:"k = \\sum_i a_i \\cdot k_i"})," and"," ",i.jsx(e,{children:"s_{\\text{agg}} = \\sum_i a_i \\cdot s_i"}),"."]})]}),i.jsx("h3",{children:"Use Cases"}),i.jsxs(n,{title:"Multi-Organization Custody",children:[i.jsx("p",{children:"Example: Three companies jointly control funds:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[i.jsx("li",{children:"Company A: 2-of-3 FROST internally"}),i.jsx("li",{children:"Company B: 3-of-5 FROST internally"}),i.jsx("li",{children:"Company C: 2-of-4 FROST internally"})]}),i.jsx("p",{className:"mt-3",children:"All three must sign (3-of-3 at the organization level), but each organization uses its own threshold internally."})]}),i.jsxs(n,{title:"Layered Security",children:[i.jsx("p",{children:"Combine organizational and individual thresholds:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Outer layer:"})," 2-of-3 organizations (MuSig)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Inner layer:"})," Each organization uses FROST"]})]}),i.jsx("p",{className:"mt-3",children:"On-chain: Still just one public key and one signature!"})]}),i.jsxs(a,{type:"success",children:[i.jsx("strong",{children:"The Power of Composition:"}),i.jsxs("ul",{className:"list-disc list-inside mt-2",children:[i.jsx("li",{children:"FROST within each signer (threshold security)"}),i.jsx("li",{children:"MuSig between signers (multi-party authorization)"}),i.jsx("li",{children:"Final signature indistinguishable from single-party"}),i.jsx("li",{children:"Maximum flexibility with minimal on-chain footprint"})]})]}),i.jsx("h3",{children:"Coordination Requirements"}),i.jsxs(n,{title:"Communication Pattern",children:[i.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[i.jsx("li",{children:"Each signer internally runs FROST preprocessing (can be done in advance)"}),i.jsxs("li",{children:["Signers exchange nonce commitments ",i.jsx(e,{children:"R_i"})," (1 round)"]}),i.jsx("li",{children:"Each signer internally computes their signature share"}),i.jsxs("li",{children:["Signers exchange signature shares ",i.jsx(e,{children:"z_i"})," (1 round)"]}),i.jsx("li",{children:"Aggregator combines into final signature"})]}),i.jsx("p",{className:"mt-3",children:"Total: 2 rounds between organizations (same as MuSig2), plus internal FROST operations."})]}),i.jsx("p",{children:"This hybrid construction demonstrates FROST's composability - it works seamlessly with other Schnorr-based protocols to build sophisticated authorization schemes."})]})}export{p as default};
