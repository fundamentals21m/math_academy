import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as l}from"./LessonLayout-MHc1mXdO.js";import{D as r,E as t,T as a,C as n}from"./Callout-D6GJ8KQY.js";import{I as i,M as s}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-Dwb7rnsM.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function f(){return e.jsxs(l,{sectionId:45,children:[e.jsx("h2",{children:"Threshold Changes (Dynamic Thresholds)"}),e.jsxs("p",{children:["What if you need to change the threshold structure without changing the public key? Perhaps you want to add new participants, remove old ones, or adjust the threshold value. FROST supports this through ",e.jsx("strong",{children:"share redistribution"}),"."]}),e.jsx("h3",{children:"The Scenario"}),e.jsxs(r,{title:"Threshold Change",children:[e.jsxs("p",{children:["Transform a ",e.jsx(i,{children:"(t_1, n_1)"}),"-threshold scheme to a"," ",e.jsx(i,{children:"(t_2, n_2)"}),"-threshold scheme:"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:["Secret ",e.jsx(i,{children:"s"})," remains unchanged"]}),e.jsxs("li",{children:["Public key ",e.jsx(i,{children:"Y = [s]G"})," remains unchanged"]}),e.jsxs("li",{children:["New threshold ",e.jsx(i,{children:"t_2"})," may differ from"," ",e.jsx(i,{children:"t_1"})]}),e.jsx("li",{children:"New participant set may differ from original"})]})]}),e.jsx(t,{title:"Use Cases",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Adding security:"})," Upgrade from 2-of-3 to 3-of-5"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Member changes:"})," Replace departing employee's share"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Scaling:"})," Increase ",e.jsx(i,{children:"n"})," to add more participants"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Simplification:"})," Reduce threshold for easier operations"]})]})}),e.jsx("h3",{children:"The Protocol"}),e.jsxs(r,{title:"Step 1: Each Participant Reshares",children:[e.jsxs("p",{children:["Each participant ",e.jsx(i,{children:"P_i"})," with share"," ",e.jsx(i,{children:"s_i"})," creates a new polynomial:"]}),e.jsx(s,{children:"f_i(x) \\text{ with } f_i(0) = s_i \\text{ and degree } t_2 - 1"}),e.jsxs("p",{className:"mt-3",children:["This polynomial has the participant's share as its constant term and uses the"," ",e.jsx("em",{children:"new"})," threshold."]})]}),e.jsxs(t,{title:"Polynomial Construction",children:[e.jsxs("p",{children:["Participant ",e.jsx(i,{children:"P_i"})," with share"," ",e.jsx(i,{children:"s_i = 42"}),", upgrading to threshold"," ",e.jsx(i,{children:"t_2 = 3"}),":"]}),e.jsx(s,{children:"f_i(x) = 42 + a_{i1} \\cdot x + a_{i2} \\cdot x^2"}),e.jsxs("p",{className:"mt-3",children:["where ",e.jsx(i,{children:"a_{i1}, a_{i2}"})," are chosen randomly."]})]}),e.jsx(r,{title:"Step 2: Distribute to New Participants",children:e.jsxs("p",{children:["Each original participant ",e.jsx(i,{children:"P_i"})," sends"," ",e.jsx(i,{children:"f_i(j)"})," to each new participant"," ",e.jsx(i,{children:"P'_j"}),"."]})}),e.jsxs(r,{title:"Step 3: New Participants Collect Shares",children:[e.jsxs("p",{children:["Each new participant ",e.jsx(i,{children:"P'_j"})," computes their new share:"]}),e.jsx(s,{children:"s'_j = \\sum_{i=1}^{n_1} f_i(j) \\cdot \\lambda_i"}),e.jsxs("p",{className:"mt-3",children:["where ",e.jsx(i,{children:"\\lambda_i"})," are the Lagrange coefficients for the original participant set."]})]}),e.jsx("h3",{children:"Mathematical Correctness"}),e.jsxs(a,{title:"Secret Preservation",children:[e.jsx("p",{children:"The new shares reconstruct to the same secret:"}),e.jsx(s,{children:"\\sum_{j \\in S'} s'_j \\cdot \\lambda'_j = \\sum_{j \\in S'} \\left( \\sum_{i=1}^{n_1} f_i(j) \\cdot \\lambda_i \\right) \\cdot \\lambda'_j"}),e.jsx("p",{className:"mt-3",children:"Rearranging:"}),e.jsx(s,{children:"= \\sum_{i=1}^{n_1} \\lambda_i \\sum_{j \\in S'} f_i(j) \\cdot \\lambda'_j"}),e.jsx(s,{children:"= \\sum_{i=1}^{n_1} \\lambda_i \\cdot f_i(0)"}),e.jsx(s,{children:"= \\sum_{i=1}^{n_1} \\lambda_i \\cdot s_i = s \\quad \\checkmark"})]}),e.jsx("h3",{children:"Security Requirements"}),e.jsxs(n,{type:"warning",children:[e.jsx("strong",{children:"Important:"})," The redistribution requires at least"," ",e.jsx(i,{children:"t_1"})," honest original participants. If the adversary controls"," ",e.jsx(i,{children:"t_1"})," original participants, they can:",e.jsxs("ul",{className:"list-disc list-inside mt-2",children:[e.jsx("li",{children:"Reconstruct the secret directly"}),e.jsx("li",{children:"Create arbitrary new shares"})]})]}),e.jsxs(r,{title:"Security Guarantee",children:[e.jsxs("p",{children:["If at least ",e.jsx(i,{children:"t_1"})," original participants are honest:"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"Secret remains unknown to adversary"}),e.jsx("li",{children:"New shares are valid Shamir shares"}),e.jsxs("li",{children:["New threshold ",e.jsx(i,{children:"t_2"})," is enforced"]})]})]}),e.jsx("h3",{children:"Practical Considerations"}),e.jsxs(t,{title:"Verifiable Redistribution",children:[e.jsx("p",{children:"To prevent cheating during redistribution:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:["Original participants publish VSS commitments for their ",e.jsx(i,{children:"f_i"})]}),e.jsx("li",{children:"New participants verify received values against commitments"}),e.jsx("li",{children:"Complaints filed for mismatches"}),e.jsx("li",{children:"Protocol aborts if verification fails"})]})]}),e.jsxs(t,{title:"Transitional Period",children:[e.jsx("p",{children:"During redistribution, both old and new schemes are valid:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:["Old participants can still sign with ",e.jsx(i,{children:"t_1"}),"-of-",e.jsx(i,{children:"n_1"})]}),e.jsx("li",{children:"New participants can sign once they receive all shares"}),e.jsx("li",{children:"Coordinate to invalidate old shares after transition"})]})]}),e.jsx("h3",{children:"Combined with Refresh"}),e.jsxs(r,{title:"Refresh + Redistribution",children:[e.jsx("p",{children:"Threshold change can be combined with proactive refresh:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"Change threshold and refresh in a single protocol run"}),e.jsx("li",{children:"Old shares become invalid for both reasons"}),e.jsx("li",{children:"Maximum security against gradual compromise"})]})]}),e.jsx("h3",{children:"Example: 2-of-3 to 3-of-5"}),e.jsxs(t,{title:"Upgrading Security",children:[e.jsx("p",{children:"Original setup: Alice, Bob, Charlie with 2-of-3 FROST."}),e.jsx("p",{className:"mt-2",children:"New setup: Alice, Bob, Charlie, Dave, Eve with 3-of-5 FROST."}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-3",children:[e.jsx("li",{children:"Alice, Bob, Charlie each create degree-2 polynomials"}),e.jsx("li",{children:"Each sends evaluations to all five new participants"}),e.jsx("li",{children:"Dave and Eve receive shares for the first time"}),e.jsx("li",{children:"Alice, Bob, Charlie receive refreshed shares"}),e.jsx("li",{children:"All verify using VSS commitments"}),e.jsx("li",{children:"New 3-of-5 scheme is active"})]})]}),e.jsxs(n,{type:"success",children:[e.jsx("strong",{children:"The Key Invariant:"})," Through all these changes - threshold adjustments, participant additions, member removals - the public key"," ",e.jsx(i,{children:"Y = [s]G"})," remains constant. On-chain addresses don't change, and existing funds remain accessible under the new authorization structure."]})]})}export{f as default};
