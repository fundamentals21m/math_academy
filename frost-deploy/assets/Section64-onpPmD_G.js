import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as c,D as r,T as t,E as n,C as l}from"./Callout-CQOyP6I7.js";import{I as s,M as i}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-DuspoTuy.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-ySXQbKre.js";function y(){return e.jsxs(c,{sectionId:64,children:[e.jsx("h2",{children:"Threshold Decryption (FROST-like)"}),e.jsx("p",{children:"The mathematical techniques underlying FROST can be applied to threshold decryption, enabling scenarios where encrypted data can only be decrypted by a threshold of parties."}),e.jsx("h3",{children:"ElGamal Encryption"}),e.jsxs(r,{title:"ElGamal Encryption Scheme",children:[e.jsxs("p",{children:["For public key ",e.jsx(s,{children:"Y = [s]G"}),":"]}),e.jsx(i,{children:"\\text{Encrypt}(m, Y):"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2 ml-4",children:[e.jsxs("li",{children:["Sample random ",e.jsx(s,{children:"r \\leftarrow \\mathbb{Z}_q"})]}),e.jsxs("li",{children:["Compute ",e.jsx(s,{children:"C_1 = [r]G"})]}),e.jsxs("li",{children:["Compute ",e.jsx(s,{children:"C_2 = m \\cdot [r]Y"})]}),e.jsxs("li",{children:["Return ",e.jsx(s,{children:"(C_1, C_2)"})]})]}),e.jsx(i,{children:"\\text{Decrypt}(C_1, C_2, s) = C_2 / [s]C_1"})]}),e.jsx("h3",{children:"Threshold Decryption Protocol"}),e.jsx("p",{children:"Similar to FROST signing, threshold decryption uses Lagrange interpolation to combine partial decryptions:"}),e.jsxs(t,{title:"Threshold Decryption",children:[e.jsxs("p",{children:["Each participant ",e.jsx(s,{children:"i"})," with share"," ",e.jsx(s,{children:"s_i"})," computes a decryption share:"]}),e.jsx(i,{children:"D_i = [s_i \\cdot \\lambda_i]C_1"}),e.jsx("p",{className:"mt-4",children:"Combining the shares:"}),e.jsx(i,{children:"D = \\sum_i D_i = [\\sum_i s_i \\cdot \\lambda_i]C_1 = [s]C_1"}),e.jsx("p",{className:"mt-4",children:"The message is recovered as:"}),e.jsx(i,{children:"m = C_2 / D"})]}),e.jsx("h3",{children:"Verifiable Decryption"}),e.jsxs(n,{title:"DLEQ Proof",children:[e.jsx("p",{children:"Each participant proves their decryption share is correct using a discrete log equality (DLEQ) proof:"}),e.jsx(i,{children:"\\text{Prove: } \\log_G Y_i = \\log_{C_1} D_i"}),e.jsxs("p",{className:"mt-3",children:["This proves ",e.jsx(s,{children:"D_i"})," was computed using the same secret ",e.jsx(s,{children:"s_i"})," that corresponds to public share ",e.jsx(s,{children:"Y_i"}),"."]})]}),e.jsx("h3",{children:"Application: Encrypted Mempools"}),e.jsxs(r,{title:"MEV Protection via Threshold Decryption",children:[e.jsx("p",{children:"Encrypted mempools use threshold decryption to prevent frontrunning:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-4",children:[e.jsx("li",{children:"Transactions encrypted to validator FROST key"}),e.jsx("li",{children:"Only threshold of validators can decrypt"}),e.jsx("li",{children:"Decryption happens after transaction ordering is committed"}),e.jsx("li",{children:"Prevents validators from extracting MEV"})]})]}),e.jsx(n,{title:"Encrypted Mempool Flow",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[e.jsxs("li",{children:["User encrypts transaction ",e.jsx(s,{children:"tx"})," to validator threshold key"]}),e.jsx("li",{children:"Validators order encrypted transactions (cannot see contents)"}),e.jsx("li",{children:"After ordering committed, validators threshold-decrypt"}),e.jsx("li",{children:"Transactions executed in committed order"})]})}),e.jsx("h3",{children:"Time-Lock Encryption"}),e.jsxs(l,{type:"info",children:[e.jsx("strong",{children:"Future Decryption:"})," Threshold decryption enables time-lock encryption where data can only be decrypted after a specified time:",e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"Encrypt to threshold key held by time-lock committee"}),e.jsx("li",{children:"Committee commits to decrypt at specified time"}),e.jsx("li",{children:"Decryption shares released according to schedule"})]})]}),e.jsx("h3",{children:"Comparison with FROST Signing"}),e.jsxs(t,{title:"Structural Similarity",children:[e.jsx("p",{children:"Threshold decryption and FROST signing share similar structure:"}),e.jsxs("table",{className:"w-full mt-4 text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-600",children:[e.jsx("th",{className:"text-left py-2",children:"Aspect"}),e.jsx("th",{className:"text-left py-2",children:"FROST Signing"}),e.jsx("th",{className:"text-left py-2",children:"Threshold Decryption"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("td",{className:"py-2",children:"Share computation"}),e.jsx("td",{children:e.jsx(s,{children:"z_i = k_i + s_i \\lambda_i c"})}),e.jsx("td",{children:e.jsx(s,{children:"D_i = [s_i \\lambda_i]C_1"})})]}),e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("td",{className:"py-2",children:"Aggregation"}),e.jsx("td",{children:e.jsx(s,{children:"z = \\sum z_i"})}),e.jsx("td",{children:e.jsx(s,{children:"D = \\sum D_i"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"Verification"}),e.jsx("td",{children:"Schnorr equation"}),e.jsx("td",{children:"DLEQ proof"})]})]})]})]}),e.jsxs(l,{type:"warning",children:[e.jsx("strong",{children:"Key Reuse Warning:"})," While the key setup is similar, the same threshold key should generally not be used for both signing and decryption due to potential cross-protocol attacks. Use separate keys for signing and encryption."]})]})}export{y as default};
