import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as l}from"./LessonLayout-WO30R0_w.js";import{D as r,C as n,E as c}from"./Callout-D6GJ8KQY.js";import{I as s,M as i}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-CKqQQJMA.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function g(){return e.jsxs(l,{sectionId:5,children:[e.jsx("h2",{children:"Schnorr Signature - Step by Step"}),e.jsxs("p",{children:["The Schnorr signature is elegant in its simplicity. It proves knowledge of a secret",e.jsx(s,{children:"s"})," corresponding to public key ",e.jsx(s,{children:"Y = [s]G"}),"without revealing ",e.jsx(s,{children:"s"}),"."]}),e.jsx("h3",{children:"Components"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 my-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsx("h4",{className:"font-semibold text-indigo-400 mb-2",children:"Private"}),e.jsx("ul",{className:"space-y-1 text-sm",children:e.jsxs("li",{children:["Secret key: ",e.jsx(s,{children:"s \\in \\mathbb{Z}_q"})]})})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50",children:[e.jsx("h4",{className:"font-semibold text-emerald-400 mb-2",children:"Public"}),e.jsxs("ul",{className:"space-y-1 text-sm",children:[e.jsxs("li",{children:["Public key: ",e.jsx(s,{children:"Y = [s]G \\in G"})]}),e.jsxs("li",{children:["Message: ",e.jsx(s,{children:"m"})," (arbitrary bytes)"]}),e.jsxs("li",{children:["Hash: ",e.jsx(s,{children:"H: \\{0,1\\}^* \\to \\mathbb{Z}_q"})]})]})]})]}),e.jsx("h3",{children:"Signing Algorithm"}),e.jsxs(r,{title:"Schnorr Signing",children:[e.jsxs("p",{children:["To sign message ",e.jsx(s,{children:"m"}),":"]}),e.jsxs("ol",{className:"list-decimal list-inside space-y-3 mt-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Sample random nonce:"}),e.jsx(i,{children:"k \\xleftarrow{\\$} \\mathbb{Z}_q"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Compute commitment:"}),e.jsx(i,{children:"R = [k]G"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Compute challenge:"}),e.jsx(i,{children:"c = H(R \\| Y \\| m)"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Compute response:"}),e.jsx(i,{children:"z = k + s \\cdot c \\pmod{q}"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Output signature:"}),e.jsx(i,{children:"\\sigma = (R, z)"})]})]})]}),e.jsxs(n,{type:"warning",children:[e.jsx("strong",{children:"Critical:"})," The nonce ",e.jsx(s,{children:"k"})," must be truly random and must ",e.jsx("em",{children:"never"})," be reused. Reusing a nonce allows attackers to extract your private key."]}),e.jsx("h3",{children:"Verification Algorithm"}),e.jsxs(r,{title:"Schnorr Verification",children:[e.jsxs("p",{children:["To verify signature ",e.jsx(s,{children:"\\sigma = (R, z)"})," on message",e.jsx(s,{children:"m"})," with public key ",e.jsx(s,{children:"Y"}),":"]}),e.jsxs("ol",{className:"list-decimal list-inside space-y-3 mt-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Parse signature:"})," Extract ",e.jsx(s,{children:"R"})," and ",e.jsx(s,{children:"z"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Compute challenge:"}),e.jsx(i,{children:"c = H(R \\| Y \\| m)"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Compute left side:"}),e.jsx(i,{children:"L = [z]G"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Compute right side:"}),e.jsx(i,{children:"R' = R + [c]Y"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Accept if and only if:"}),e.jsx(i,{children:"L = R'"})]})]})]}),e.jsxs(c,{title:"Concrete Signing Example",children:[e.jsx("p",{children:"Let's trace through with small numbers (not cryptographically secure, just for illustration):"}),e.jsxs("div",{className:"mt-4 space-y-2 font-mono text-sm",children:[e.jsxs("p",{children:["Secret key: ",e.jsx(s,{children:"s = 7"})]}),e.jsxs("p",{children:["Random nonce: ",e.jsx(s,{children:"k = 13"})]}),e.jsxs("p",{children:["Message: ",e.jsx(s,{children:'m = \\text{"Send 1 BTC"}'})]}),e.jsxs("p",{children:["Commitment: ",e.jsx(s,{children:"R = [13]G"})]}),e.jsxs("p",{children:["Challenge (from hash): ",e.jsx(s,{children:"c = 5"})]}),e.jsxs("p",{children:["Response: ",e.jsx(s,{children:"z = 13 + 7 \\cdot 5 = 48"})]}),e.jsxs("p",{children:["Signature: ",e.jsx(s,{children:"\\sigma = (R, 48)"})]})]})]}),e.jsx("h3",{children:"The Verification Equation"}),e.jsx("p",{children:"The core verification check is:"}),e.jsx(i,{children:"[z]G \\stackrel{?}{=} R + [c]Y"}),e.jsxs("p",{children:["This single equation encapsulates the entire signature verification. Understanding",e.jsx("em",{children:"why"})," it works is the key to understanding FROST."]}),e.jsxs(n,{type:"info",children:[e.jsx("strong",{children:"Signature Structure:"})," A Schnorr signature consists of:",e.jsxs("ul",{className:"list-disc list-inside mt-2",children:[e.jsxs("li",{children:[e.jsx(s,{children:"R"}),' — A curve point (the "commitment")']}),e.jsxs("li",{children:[e.jsx(s,{children:"z"}),' — A scalar (the "response")']})]}),"Together they are ~64 bytes, the same size as a single ECDSA signature."]})]})}export{g as default};
