import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as l}from"./LessonLayout-MHc1mXdO.js";import{D as s,E as n,T as t,C as a}from"./Callout-D6GJ8KQY.js";import{I as i,M as r}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-Dwb7rnsM.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function y(){return e.jsxs(l,{sectionId:42,children:[e.jsx("h2",{children:"Rerandomization (Privacy Enhancement)"}),e.jsx("p",{children:"Rerandomization allows a FROST group to sign multiple times without linking the signatures to each other or to the original public key. This is a powerful privacy enhancement for financial applications."}),e.jsx("h3",{children:"The Goal"}),e.jsxs(s,{title:"Unlinkability",children:[e.jsxs("p",{children:["Given signatures ",e.jsx(i,{children:"\\sigma_1, \\sigma_2, \\ldots"})," from the same FROST group, an observer should not be able to determine:"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"That they came from the same group"}),e.jsx("li",{children:'The original "master" public key'}),e.jsx("li",{children:"Any relationship between the signatures"})]})]}),e.jsx("h3",{children:"Mathematical Construction"}),e.jsxs(s,{title:"Original Key Pair",children:[e.jsx("p",{children:"The FROST group has:"}),e.jsx(r,{children:"s \\in \\mathbb{Z}_q \\quad \\text{(secret, Shamir-shared)}"}),e.jsx(r,{children:"Y = [s]G \\quad \\text{(public)}"})]}),e.jsxs(s,{title:"Rerandomization",children:[e.jsxs("p",{children:["For signature ",e.jsx(i,{children:"j"}),", choose a random blinding factor"," ",e.jsx(i,{children:"r_j \\in \\mathbb{Z}_q"}),":"]}),e.jsx(r,{children:"s'_j = s + r_j"}),e.jsx(r,{children:"Y'_j = Y + [r_j]G = [s'_j]G"}),e.jsxs("p",{className:"mt-3",children:["The rerandomized key pair ",e.jsx(i,{children:"(s'_j, Y'_j)"})," is a valid key pair that is unlinkable to the original."]})]}),e.jsx("h3",{children:"Distributed Rerandomization in FROST"}),e.jsxs(n,{title:"Generating the Blinding Factor",children:[e.jsxs("p",{children:["The blinding factor ",e.jsx(i,{children:"r_j"})," is generated additively:"]}),e.jsx(r,{children:"r_j = \\sum_{i \\in S} r_{ij}"}),e.jsxs("p",{className:"mt-3",children:["where each participant ",e.jsx(i,{children:"i"})," in the signing set"," ",e.jsx(i,{children:"S"})," chooses a random ",e.jsx(i,{children:"r_{ij}"}),"."]})]}),e.jsxs(n,{title:"Updating Shares",children:[e.jsx("p",{children:"Each participant updates their secret share:"}),e.jsx(r,{children:"s'_{ij} = s_i \\cdot \\lambda_i + r_{ij}"}),e.jsxs("p",{className:"mt-3",children:["The effective secret is now ",e.jsx(i,{children:"s'_j = s + r_j"}),"."]})]}),e.jsxs(n,{title:"Public Key Update",children:[e.jsx("p",{children:"The rerandomized public key is computed:"}),e.jsx(r,{children:"Y'_j = Y + \\sum_{i \\in S} [r_{ij}]G"}),e.jsxs("p",{className:"mt-3",children:["Each participant publishes ",e.jsx(i,{children:"[r_{ij}]G"}),", so anyone can compute ",e.jsx(i,{children:"Y'_j"}),", but no one (except the group) knows"," ",e.jsx(i,{children:"r_j"}),"."]})]}),e.jsx("h3",{children:"Security Properties"}),e.jsxs(t,{title:"Unlinkability",children:[e.jsxs("p",{children:["Given ",e.jsx(i,{children:"Y'_1, Y'_2, \\ldots"}),", it is computationally infeasible to determine if they derive from the same base key"," ",e.jsx(i,{children:"Y"}),"."]}),e.jsxs("p",{className:"mt-3",children:[e.jsx("strong",{children:"Proof sketch:"})," Each ",e.jsx(i,{children:"Y'_j = Y + [r_j]G"})," ","where ",e.jsx(i,{children:"r_j"})," is uniformly random. Without knowing"," ",e.jsx(i,{children:"r_j"}),", relating ",e.jsx(i,{children:"Y'_j"})," to"," ",e.jsx(i,{children:"Y"})," requires solving the discrete log problem."]})]}),e.jsx(t,{title:"Signature Security",children:e.jsx("p",{children:"Signatures under rerandomized keys are as secure as signatures under the original key. The same unforgeability guarantees apply."})}),e.jsx("h3",{children:"Use Cases in Bitcoin"}),e.jsxs(s,{title:"Privacy-Preserving Payments",children:[e.jsx("p",{children:"A merchant using FROST custody can:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:["Generate a unique address for each customer:"," ",e.jsx(i,{children:"Y'_{\\text{customer}}"})]}),e.jsx("li",{children:"Receive payments that appear unrelated on-chain"}),e.jsx("li",{children:"Sign spending transactions with the full threshold"}),e.jsx("li",{children:"Outside observer cannot link payments to the merchant"})]})]}),e.jsxs(s,{title:"Stealth Addresses",children:[e.jsx("p",{children:"Combined with ECDH, rerandomization enables stealth addresses:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:["Receiver publishes scan key ",e.jsx(i,{children:"Y"})," (FROST key)"]}),e.jsxs("li",{children:["Sender generates ephemeral key ",e.jsx(i,{children:"e"})]}),e.jsxs("li",{children:["Computes shared secret: ",e.jsx(i,{children:"r = H(e \\cdot Y)"})]}),e.jsxs("li",{children:["Sends to rerandomized address: ",e.jsx(i,{children:"Y' = Y + [r]G"})]}),e.jsxs("li",{children:["Receiver detects payment, computes ",e.jsx(i,{children:"r"}),", updates shares"]})]})]}),e.jsxs(a,{type:"info",children:[e.jsx("strong",{children:"Key Benefit:"})," The threshold structure is preserved through rerandomization. The same ",e.jsx(i,{children:"t"})," participants are still required to sign, but each transaction uses a unique, unlinkable address."]}),e.jsx("h3",{children:"Practical Considerations"}),e.jsxs(s,{title:"State Management",children:[e.jsxs("p",{children:["Each rerandomized key requires tracking the blinding factor"," ",e.jsx(i,{children:"r_j"})," (or each participant's"," ",e.jsx(i,{children:"r_{ij}"}),"):"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:["Store ",e.jsx(i,{children:"r_{ij}"})," along with standard FROST state"]}),e.jsx("li",{children:"Or derive deterministically from master secret and counter"})]})]}),e.jsxs(s,{title:"Efficiency",children:[e.jsx("p",{children:"Rerandomization adds minimal overhead:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"One additional scalar addition per participant"}),e.jsx("li",{children:"One additional point addition for public key"}),e.jsx("li",{children:"No additional communication rounds"})]})]}),e.jsx("h3",{children:"Comparison Without Rerandomization"}),e.jsxs(n,{title:"Without Rerandomization",children:[e.jsx("p",{children:"Using the same FROST key for all transactions:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"All transactions link to the same public key"}),e.jsx("li",{children:"Transaction graph fully visible on-chain"}),e.jsx("li",{children:"Balance and payment patterns exposed"})]})]}),e.jsxs(n,{title:"With Rerandomization",children:[e.jsx("p",{children:"Using a fresh rerandomized key for each transaction:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"Each transaction uses a unique address"}),e.jsx("li",{children:"No visible linkage between transactions"}),e.jsx("li",{children:"Balance and patterns hidden from observers"})]})]}),e.jsxs(a,{type:"success",children:[e.jsx("strong",{children:"Privacy + Threshold Security:"})," Rerandomization provides the privacy benefits of fresh keys for each transaction while maintaining the threshold security properties of FROST. Best of both worlds."]})]})}export{y as default};
