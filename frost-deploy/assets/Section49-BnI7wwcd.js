import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as t}from"./LessonLayout-MHc1mXdO.js";import{D as r,E as l,C as n}from"./Callout-D6GJ8KQY.js";import{M as s,I as i}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-Dwb7rnsM.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function u(){return e.jsxs(t,{sectionId:49,children:[e.jsx("h2",{children:"Concrete Bitcoin Scenario: Cold Storage"}),e.jsx("p",{children:"Let's walk through a complete, practical example of using FROST for Bitcoin cold storage. This demonstrates how all the mathematical concepts translate into real-world security."}),e.jsx("h3",{children:"Setup"}),e.jsx(r,{title:"Cold Storage Configuration",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Threshold:"})," 3-of-5 FROST"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Participants:"})," 5 hardware security modules (HSMs) or hardware wallets"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Locations:"})," Geographically distributed (different cities/countries)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Use case:"})," Corporate treasury, exchange cold wallet, or high-value personal holdings"]})]})}),e.jsx("h3",{children:"Initial Key Generation"}),e.jsxs(l,{title:"Distributed Key Generation",children:[e.jsx("p",{children:"The 5 devices run FROST DKG:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:["Each device generates a random polynomial of degree 2:",e.jsx(s,{children:"f_i(x) = a_{i0} + a_{i1}x + a_{i2}x^2"})]}),e.jsxs("li",{children:["Each device publishes Feldman VSS commitments:",e.jsx(s,{children:"C_{i0} = [a_{i0}]G, \\quad C_{i1} = [a_{i1}]G, \\quad C_{i2} = [a_{i2}]G"})]}),e.jsxs("li",{children:["Each device sends encrypted shares to others:",e.jsx(s,{children:"f_i(j) \\text{ to device } j"})]}),e.jsx("li",{children:"Each device verifies received shares against commitments"}),e.jsxs("li",{children:["Each device computes its final share:",e.jsx(s,{children:"s_j = \\sum_{i=1}^{5} f_i(j)"})]})]})]}),e.jsxs(r,{title:"Public Key and Address",children:[e.jsx("p",{children:"The group public key is:"}),e.jsx(s,{children:"Y = \\sum_{i=1}^{5} C_{i0} = \\sum_{i=1}^{5} [a_{i0}]G"}),e.jsx("p",{className:"mt-3",children:"For Taproot, compute the tweaked key:"}),e.jsx(s,{children:"P = Y + [H(Y)]G"}),e.jsxs("p",{className:"mt-3",children:["The Bitcoin address is derived from ",e.jsx(i,{children:"P"}),": a standard bc1p... Taproot address."]})]}),e.jsx("h3",{children:"Receiving Bitcoin"}),e.jsxs(l,{title:"Deposit Process",children:[e.jsx("p",{children:"To receive funds:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:["Generate address from group public key ",e.jsx(i,{children:"P"})]}),e.jsx("li",{children:"Share address with sender"}),e.jsx("li",{children:"Sender creates transaction paying to the Taproot address"}),e.jsx("li",{children:"Transaction confirms on-chain"})]}),e.jsxs("p",{className:"mt-3",children:[e.jsx("strong",{children:"On-chain appearance:"})," Identical to any other Taproot address. No indication of 3-of-5 structure."]})]}),e.jsx("h3",{children:"Spending Bitcoin"}),e.jsxs(l,{title:"Withdrawal Process",children:[e.jsx("p",{children:"To spend the funds, select any 3 of the 5 devices:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Prepare transaction:"})," Create unsigned transaction with inputs and outputs"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Preprocessing check:"})," Ensure each device has unused commitment pairs"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Coordinator sends request:"}),e.jsx(s,{children:"(\\text{tx\\_hash}, B) \\text{ where } B = [(1, D_1, E_1), (3, D_3, E_3), (4, D_4, E_4)]"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Each device computes:"}),e.jsxs("ul",{className:"list-disc list-inside ml-4 mt-1",children:[e.jsxs("li",{children:["Binding value: ",e.jsx(i,{children:"\\rho_i = H_1(i, \\text{tx\\_hash}, B)"})]}),e.jsxs("li",{children:["Commitment: ",e.jsx(i,{children:"R_i = D_i + [\\rho_i]E_i"})]}),e.jsxs("li",{children:["Lagrange coefficient: ",e.jsx(i,{children:"\\lambda_i"})," for set ","{1,3,4}"]}),e.jsxs("li",{children:["Signature share: ",e.jsx(i,{children:"z_i = d_i + e_i \\cdot \\rho_i + \\lambda_i \\cdot s_i \\cdot c"})]})]})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Coordinator aggregates:"}),e.jsx(s,{children:"z = z_1 + z_3 + z_4"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Adjust for Taproot tweak:"}),e.jsx(s,{children:"z' = z + t \\cdot c \\text{ where } t = H(Y)"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Broadcast:"})," Submit signed transaction to Bitcoin network"]})]})]}),e.jsx("h3",{children:"Security Properties"}),e.jsxs(n,{type:"success",children:[e.jsx("strong",{children:"What This Achieves:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Compromise resilience:"})," Attacker needs 3 geographically separated devices"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Availability:"})," Any 2 devices can fail and funds are still accessible"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Privacy:"})," On-chain observers see single-sig transactions"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cost:"})," Same fees as single-sig (64-byte signature)"]})]})]}),e.jsx("h3",{children:"Operational Considerations"}),e.jsxs(r,{title:"Preprocessing Management",children:[e.jsx("p",{children:"Each device maintains a buffer of commitment pairs:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"Generate 100 pairs during quiet periods"}),e.jsx("li",{children:"Publish commitments to secure storage"}),e.jsx("li",{children:"Track usage: never reuse a pair"}),e.jsx("li",{children:"Regenerate when buffer runs low"})]})]}),e.jsxs(r,{title:"Key Refresh",children:[e.jsx("p",{children:"Periodically refresh shares (e.g., quarterly):"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"Run proactive secret sharing protocol"}),e.jsx("li",{children:"Old shares become invalid"}),e.jsx("li",{children:"Defeats mobile adversary accumulating shares over time"}),e.jsx("li",{children:"Public key and addresses unchanged"})]})]}),e.jsxs(r,{title:"Recovery Plan",children:[e.jsx("p",{children:"If a device is lost or compromised:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"Remaining devices can still sign (3 of 4 available)"}),e.jsx("li",{children:"Run threshold change protocol to add replacement device"}),e.jsx("li",{children:"Optionally increase threshold for additional security"}),e.jsx("li",{children:"Investigate compromised device"})]})]}),e.jsx("h3",{children:"Cost Comparison"}),e.jsxs(l,{title:"Transaction Costs",children:[e.jsxs("table",{className:"w-full mt-4 text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-600",children:[e.jsx("th",{className:"text-left py-2",children:"Method"}),e.jsx("th",{className:"text-left py-2",children:"Input Size"}),e.jsx("th",{className:"text-left py-2",children:"Cost at 50 sat/vB"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("td",{className:"py-2",children:"FROST (3-of-5)"}),e.jsx("td",{className:"py-2",children:"~57.5 vB"}),e.jsx("td",{className:"py-2",children:"~2,875 sats"})]}),e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("td",{className:"py-2",children:"P2WSH (3-of-5)"}),e.jsx("td",{className:"py-2",children:"~166 vB"}),e.jsx("td",{className:"py-2",children:"~8,300 sats"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"Savings"}),e.jsx("td",{className:"py-2",children:"~65%"}),e.jsx("td",{className:"py-2",children:"~5,425 sats/input"})]})]})]}),e.jsx("p",{className:"mt-3",children:"For a UTXO consolidation of 100 inputs, FROST saves ~542,500 sats in fees."})]}),e.jsx("h3",{children:"The Bottom Line"}),e.jsxs(n,{type:"info",children:[e.jsx("strong",{children:"FROST Cold Storage:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2",children:[e.jsx("li",{children:"Industrial-grade security (threshold + geographic distribution)"}),e.jsx("li",{children:"Consumer-grade fees (single signature)"}),e.jsx("li",{children:"Maximum privacy (indistinguishable from single-sig)"}),e.jsx("li",{children:"Operational flexibility (key refresh, threshold changes)"})]}),e.jsx("p",{className:"mt-2",children:"This is the future of Bitcoin custody: security without compromise."})]})]})}export{u as default};
