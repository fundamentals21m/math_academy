import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as r}from"./LessonLayout-WO30R0_w.js";import{D as s,E as n,C as t,T as a}from"./Callout-D6GJ8KQY.js";import{I as i,M as o}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-CKqQQJMA.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function f(){return e.jsxs(r,{sectionId:54,children:[e.jsx("h2",{children:"Hash Function Considerations"}),e.jsx("p",{children:"FROST uses multiple hash functions with specific roles. Proper implementation of these hash functions is essential for security, requiring domain separation and careful input serialization."}),e.jsx("h3",{children:"FROST's Hash Functions"}),e.jsxs(s,{title:"FROST Hash Functions",children:[e.jsx("p",{children:"FROST defines two distinct hash functions:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-4",children:[e.jsxs("li",{children:[e.jsx(i,{children:"H_1"}),": ",e.jsx("strong",{children:"Binding value hash"})," -"," ","computes ",e.jsx(i,{children:"\\rho_i = H_1(i, m, B)"})]}),e.jsxs("li",{children:[e.jsx(i,{children:"H_2"}),": ",e.jsx("strong",{children:"Challenge hash"})," -"," ","computes ",e.jsx(i,{children:"c = H_2(R, Y, m)"})]})]})]}),e.jsx("h3",{children:"Domain Separation"}),e.jsx("p",{children:"Domain separation prevents collisions between different hash uses. Without it, an attacker might find inputs that produce the same hash output in different contexts, potentially breaking security."}),e.jsxs(n,{title:"Domain-Separated Hash Functions",children:[e.jsx("pre",{className:"bg-gray-800 p-4 rounded text-sm overflow-x-auto",children:`H_1(x) = SHA-256("FROST-binding" || x)
H_2(x) = SHA-256("FROST-challenge" || x)`}),e.jsxs("p",{className:"mt-3",children:["The domain separation string ensures that even identical inputs to"," ",e.jsx(i,{children:"H_1"})," and ",e.jsx(i,{children:"H_2"})," produce different outputs."]})]}),e.jsxs(t,{type:"warning",children:[e.jsx("strong",{children:"Security Requirement:"})," Using the same hash function without domain separation for different purposes can lead to subtle attacks where a value computed in one context is reused in another."]}),e.jsx("h3",{children:"Input Serialization"}),e.jsx("p",{children:"Hash inputs must be serialized unambiguously. If the encoding is ambiguous, different inputs might produce the same serialization, breaking security assumptions."}),e.jsxs(n,{title:"Unambiguous Serialization",children:[e.jsx("pre",{className:"bg-gray-800 p-4 rounded text-sm overflow-x-auto",children:`# CORRECT: Length-prefixed encoding
H(length(A) || A || length(B) || B)

# WRONG: Ambiguous concatenation
H(A || B)  // Cannot distinguish where A ends and B begins`}),e.jsx("p",{className:"mt-3",children:'Without length prefixes, the inputs "AB" and "CD" could hash to the same value as "A" and "BCD" if A||B = AB||CD.'})]}),e.jsx("h3",{children:"Elliptic Curve Point Encoding"}),e.jsxs(s,{title:"Point Serialization Formats",children:[e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Compressed:"})," 33 bytes (",e.jsx("code",{children:"0x02"}),"/",e.jsx("code",{children:"0x03"})," ","prefix + x-coordinate). The prefix indicates the parity of y."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Uncompressed:"})," 65 bytes (",e.jsx("code",{children:"0x04"})," prefix + x + y coordinates)"]})]}),e.jsx("p",{className:"mt-4",children:"Compressed format is preferred for efficiency while maintaining unambiguous point representation."})]}),e.jsx("h3",{children:"Hash-to-Field"}),e.jsxs("p",{children:["When hashing to produce a scalar in ",e.jsx(i,{children:"\\mathbb{Z}_q"}),", we need the output to be uniformly distributed:"]}),e.jsxs(a,{title:"Uniform Hash Output",children:[e.jsxs("p",{children:["For a hash function ",e.jsx(i,{children:"H"})," producing"," ",e.jsx(i,{children:"n"}),"-bit output and field order"," ",e.jsx(i,{children:"q"}),":"]}),e.jsx(o,{children:"c = H(R \\| Y \\| m) \\mod q"}),e.jsxs("p",{className:"mt-4",children:["If ",e.jsx(i,{children:"n \\gg \\log_2(q)"}),", the bias from modular reduction is negligible. For secp256k1 with 256-bit hashes, the bias is cryptographically insignificant."]})]}),e.jsx("h3",{children:"Implementation Checklist"}),e.jsxs(t,{type:"info",children:[e.jsx("strong",{children:"Hash Function Implementation Requirements:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"Use domain separation strings for each hash purpose"}),e.jsx("li",{children:"Serialize all inputs with unambiguous length encoding"}),e.jsx("li",{children:"Use compressed point format for elliptic curve points"}),e.jsx("li",{children:"Ensure hash output is properly reduced to the field"}),e.jsx("li",{children:"All participants must use identical serialization"})]})]})]})}export{f as default};
