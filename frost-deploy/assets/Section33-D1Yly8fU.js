import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as t}from"./LessonLayout-MHc1mXdO.js";import{D as r,E as c,C as n,T as l}from"./Callout-D6GJ8KQY.js";import{I as i,M as s}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-Dwb7rnsM.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-DiUM9hDs.js";function g(){return e.jsxs(t,{sectionId:33,children:[e.jsx("h2",{children:"Complete Example (2-of-3 Threshold)"}),e.jsx("p",{children:"Let's walk through a complete FROST signing example with concrete numbers. This will solidify your understanding of how all the pieces fit together."}),e.jsx("h3",{children:"Setup"}),e.jsx(r,{title:"Initial Parameters",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:["Participants: ",e.jsx(i,{children:"P_1, P_2, P_3"})]}),e.jsxs("li",{children:["Threshold: ",e.jsx(i,{children:"t = 2"})]}),e.jsxs("li",{children:["Message: ",e.jsx(i,{children:"m = "}),'"Send 1 BTC to Alice"']}),e.jsxs("li",{children:["Signers: ",e.jsx(i,{children:"S = \\{1, 2\\}"})]})]})}),e.jsx("h3",{children:"After DKG (Using Small Numbers for Illustration)"}),e.jsxs(c,{title:"Key Shares",children:[e.jsx("p",{children:"After distributed key generation, each participant has:"}),e.jsx(s,{children:"s_1 = 42, \\quad Y_1 = [42]G"}),e.jsx(s,{children:"s_2 = 67, \\quad Y_2 = [67]G"}),e.jsx(s,{children:"s_3 = 31, \\quad Y_3 = [31]G"}),e.jsxs("p",{className:"mt-3",children:["The group secret is ",e.jsx(i,{children:"s = 70 = f(0)"})," and the group public key is:"]}),e.jsx(s,{children:"Y = [70]G"}),e.jsxs("p",{className:"mt-2 text-sm text-gray-400",children:["Note: The shares ",e.jsx(i,{children:"s_1, s_2, s_3"})," are points on a degree-1 polynomial where ",e.jsx(i,{children:"f(0) = 70"}),"."]})]}),e.jsx("h3",{children:"Preprocessing"}),e.jsxs(c,{title:"Nonce Generation",children:[e.jsx("p",{children:"Each signer has generated and stored commitment pairs:"}),e.jsx(s,{children:"P_1: d_1 = 100, e_1 = 50 \\quad \\rightarrow \\quad D_1 = [100]G, E_1 = [50]G"}),e.jsx(s,{children:"P_2: d_2 = 200, e_2 = 75 \\quad \\rightarrow \\quad D_2 = [200]G, E_2 = [75]G"})]}),e.jsx("h3",{children:"Signing Protocol"}),e.jsxs(r,{title:"Step 1: Coordinator Sends Signing Request",children:[e.jsx("p",{children:"Coordinator constructs and sends:"}),e.jsx(s,{children:"(m, B) \\text{ where } B = [(1, D_1, E_1), (2, D_2, E_2)]"})]}),e.jsxs(r,{title:"Step 2: Compute Binding Values",children:[e.jsx("p",{children:"Each signer computes their binding value:"}),e.jsx(s,{children:"\\rho_1 = H_1(1, m, B)"}),e.jsx(s,{children:"\\rho_2 = H_1(2, m, B)"}),e.jsxs("p",{className:"mt-2",children:["For this example, let's say ",e.jsx(i,{children:"\\rho_1 = 7"})," and"," ",e.jsx(i,{children:"\\rho_2 = 11"}),"."]})]}),e.jsxs(r,{title:"Step 3: Compute Individual Commitments",children:[e.jsx("p",{children:"Each signer computes:"}),e.jsx(s,{children:"R_1 = D_1 + [\\rho_1]E_1 = [100]G + [7 \\cdot 50]G = [100]G + [350]G = [450]G"}),e.jsx(s,{children:"R_2 = D_2 + [\\rho_2]E_2 = [200]G + [11 \\cdot 75]G = [200]G + [825]G = [1025]G"})]}),e.jsx(r,{title:"Step 4: Compute Group Commitment",children:e.jsx(s,{children:"R = R_1 + R_2 = [450]G + [1025]G = [1475]G"})}),e.jsxs(r,{title:"Step 5: Compute Challenge",children:[e.jsx(s,{children:"c = H_2(R, Y, m)"}),e.jsxs("p",{className:"mt-2",children:["For this example, let's say ",e.jsx(i,{children:"c = 13"}),"."]})]}),e.jsxs(r,{title:"Step 6: Compute Lagrange Coefficients",children:[e.jsxs("p",{children:["For signing set ",e.jsx(i,{children:"S = \\{1, 2\\}"}),":"]}),e.jsx(s,{children:"\\lambda_1 = \\frac{0 - 2}{1 - 2} = \\frac{-2}{-1} = 2"}),e.jsx(s,{children:"\\lambda_2 = \\frac{0 - 1}{2 - 1} = \\frac{-1}{1} = -1"})]}),e.jsxs(r,{title:"Step 7: Compute Signature Shares",children:[e.jsx("p",{children:"Each signer computes their signature share:"}),e.jsx(s,{children:"z_1 = d_1 + e_1 \\cdot \\rho_1 + \\lambda_1 \\cdot s_1 \\cdot c"}),e.jsx(s,{children:"z_1 = 100 + 50 \\cdot 7 + 2 \\cdot 42 \\cdot 13"}),e.jsx(s,{children:"z_1 = 100 + 350 + 1092 = 1542"}),e.jsx(s,{children:"z_2 = d_2 + e_2 \\cdot \\rho_2 + \\lambda_2 \\cdot s_2 \\cdot c"}),e.jsx(s,{children:"z_2 = 200 + 75 \\cdot 11 + (-1) \\cdot 67 \\cdot 13"}),e.jsx(s,{children:"z_2 = 200 + 825 - 871 = 154"})]}),e.jsxs(n,{type:"warning",children:[e.jsx("strong",{children:"Critical Step:"})," After computing ",e.jsx(i,{children:"z_1"})," and"," ",e.jsx(i,{children:"z_2"}),", each signer securely deletes their nonces"," ",e.jsx(i,{children:"(d_i, e_i)"}),". These must never be reused!"]}),e.jsx("h3",{children:"Aggregation"}),e.jsxs(r,{title:"Step 8: Coordinator Aggregates",children:[e.jsx(s,{children:"z = z_1 + z_2 = 1542 + 154 = 1696"}),e.jsx("p",{className:"mt-3",children:"Final signature:"}),e.jsx(s,{children:"\\sigma = (R, z) = ([1475]G, 1696)"})]}),e.jsx("h3",{children:"Verification"}),e.jsxs(l,{title:"Verifier Checks",children:[e.jsx("p",{children:"Any verifier can check:"}),e.jsx(s,{children:"[z]G \\stackrel{?}{=} R + [c]Y"}),e.jsx("p",{className:"mt-3",children:"Left side:"}),e.jsx(s,{children:"[z]G = [1696]G"}),e.jsx("p",{className:"mt-3",children:"Right side:"}),e.jsx(s,{children:"R + [c]Y = [1475]G + [13 \\cdot 70]G = [1475]G + [910]G = [2385]G"})]}),e.jsxs(n,{type:"warning",children:[e.jsx("strong",{children:"Wait - These Don't Match?"}),e.jsxs("p",{className:"mt-2",children:["Let's verify: ",e.jsx(i,{children:"1696 \\neq 2385"}),"? Actually, we need to check the underlying math more carefully. Let's trace through:"]})]}),e.jsxs(c,{title:"Correctness Check",children:[e.jsxs("p",{children:["The aggregated ",e.jsx(i,{children:"z"})," should equal"," ",e.jsx(i,{children:"k + s \\cdot c"})," where:"]}),e.jsx(s,{children:"k = k_1 + k_2 = (d_1 + e_1 \\cdot \\rho_1) + (d_2 + e_2 \\cdot \\rho_2)"}),e.jsx(s,{children:"k = (100 + 350) + (200 + 825) = 450 + 1025 = 1475"}),e.jsxs("p",{className:"mt-3",children:["And ",e.jsx(i,{children:"s = \\lambda_1 \\cdot s_1 + \\lambda_2 \\cdot s_2"}),":"]}),e.jsx(s,{children:"s = 2 \\cdot 42 + (-1) \\cdot 67 = 84 - 67 = 17"}),e.jsx("p",{className:"mt-3",children:"Hmm, this gives us a different value. Let's reconsider..."}),e.jsxs("p",{className:"mt-3",children:["Actually, the secret ",e.jsx(i,{children:"s = f(0) = 70"})," should be recovered via Lagrange interpolation. For our polynomial passing through"," ",e.jsx(i,{children:"(1, 42)"})," and ",e.jsx(i,{children:"(2, 67)"}),":"]}),e.jsx(s,{children:"f(0) = 42 \\cdot \\frac{0-2}{1-2} + 67 \\cdot \\frac{0-1}{2-1} = 42 \\cdot 2 + 67 \\cdot (-1) = 84 - 67 = 17"}),e.jsxs("p",{className:"mt-3",children:["So ",e.jsx(i,{children:"s = 17"})," (not 70 as originally stated). Let's fix our example."]})]}),e.jsxs(n,{type:"info",children:[e.jsx("strong",{children:"Corrected Values:"}),e.jsxs("p",{className:"mt-2",children:["With ",e.jsx(i,{children:"s = 17"}),":"]}),e.jsx(s,{children:"k + s \\cdot c = 1475 + 17 \\cdot 13 = 1475 + 221 = 1696"}),e.jsxs("p",{className:"mt-2",children:["This matches our computed ",e.jsx(i,{children:"z = 1696"}),"!"]}),e.jsx("p",{className:"mt-2",children:"Verification:"}),e.jsx(s,{children:"[1696]G = [1475]G + [13 \\cdot 17]G = [1475]G + [221]G = [1696]G \\quad \\checkmark"})]}),e.jsx("h3",{children:"Key Takeaways"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 my-4",children:[e.jsx("li",{children:"The Lagrange coefficients convert threshold shares to the correct weighting"}),e.jsxs("li",{children:["Binding values ",e.jsx(i,{children:"\\rho_i"})," tie each contribution to the specific signing session"]}),e.jsxs("li",{children:["The final signature ",e.jsx(i,{children:"(R, z)"})," is indistinguishable from a single-party Schnorr signature"]}),e.jsxs("li",{children:["All arithmetic happens modulo the group order ",e.jsx(i,{children:"q"})," in practice"]})]})]})}export{g as default};
