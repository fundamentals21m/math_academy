import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{L as l}from"./LessonLayout-sKo1Ukyt.js";import{D as t,E as r,C as n}from"./Callout-D6GJ8KQY.js";import{I as s,M as i}from"./MathBlock-uz1iP4cD.js";import"./vendor-react-Drj8qL0h.js";import"./index-LWQys88K.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-ySXQbKre.js";function u(){return e.jsxs(l,{sectionId:48,children:[e.jsx("h2",{children:"Scriptless Scripts with Adaptor Signatures"}),e.jsx("p",{children:"Adaptor signatures are a powerful cryptographic primitive that enable conditional payments without revealing the condition on-chain. Combined with FROST, they enable threshold-controlled atomic swaps and other advanced protocols."}),e.jsx("h3",{children:"Adaptor Signature Concept"}),e.jsxs(t,{title:"The Idea",children:[e.jsx("p",{children:'An adaptor signature encodes a "puzzle":'}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Pre-signature:"})," A signature that's almost valid, but not quite"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Adaptor point:"})," ",e.jsx(s,{children:"T = [t]G"})," (public)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Secret:"})," ",e.jsx(s,{children:"t"})," (hidden)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Completion:"})," Knowing ",e.jsx(s,{children:"t"})," converts pre-signature to valid signature"]})]})]}),e.jsx("h3",{children:"Mathematical Construction"}),e.jsxs(t,{title:"Pre-Signature Generation",children:[e.jsxs("p",{children:["Given adaptor point ",e.jsx(s,{children:"T = [t]G"}),":"]}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:["Generate nonce: ",e.jsx(s,{children:"k"}),", commitment"," ",e.jsx(s,{children:"R = [k]G"})]}),e.jsxs("li",{children:["Compute adapted commitment: ",e.jsx(s,{children:"R' = R + T"})]}),e.jsxs("li",{children:["Compute challenge: ",e.jsx(s,{children:"c' = H(R', Y, m)"})]}),e.jsxs("li",{children:["Compute pre-signature: ",e.jsx(s,{children:"z' = k + s \\cdot c'"})]})]}),e.jsxs("p",{className:"mt-3",children:["The pre-signature ",e.jsx(s,{children:"(R', z')"}),' is "offset" by the unknown'," ",e.jsx(s,{children:"t"}),"."]})]}),e.jsxs(t,{title:"Pre-Signature Verification",children:[e.jsx("p",{children:"Verifier can check the pre-signature is well-formed:"}),e.jsx(i,{children:"[z']G \\stackrel{?}{=} R' - T + [c']Y"}),e.jsx(i,{children:"= R + [c']Y \\quad \\checkmark"}),e.jsxs("p",{className:"mt-3",children:["This confirms: if someone reveals ",e.jsx(s,{children:"t"}),", the signature can be completed."]})]}),e.jsxs(t,{title:"Signature Completion",children:[e.jsxs("p",{children:["With knowledge of ",e.jsx(s,{children:"t"}),":"]}),e.jsx(i,{children:"z = z' + t"}),e.jsxs("p",{className:"mt-3",children:["The completed signature ",e.jsx(s,{children:"(R', z)"})," is valid:"]}),e.jsx(i,{children:"[z]G = [z' + t]G = [z']G + T = R + [c']Y + T = R' + [c']Y \\quad \\checkmark"})]}),e.jsx("h3",{children:"FROST Adaptor Signatures"}),e.jsxs(r,{title:"Threshold Pre-Signature",children:[e.jsx("p",{children:"Each participant in the FROST group produces a pre-signature share:"}),e.jsx(i,{children:"z'_i = k_i + s_i \\cdot \\lambda_i \\cdot c'"}),e.jsxs("p",{className:"mt-3",children:["where ",e.jsx(s,{children:"c' = H(R', Y, m)"})," uses the adapted commitment"," ",e.jsx(s,{children:"R' = R + T"}),"."]}),e.jsx("p",{className:"mt-3",children:"Aggregation:"}),e.jsx(i,{children:"z' = \\sum_{i \\in S} z'_i"})]}),e.jsxs(r,{title:"Completing the Signature",children:[e.jsxs("p",{children:["Once ",e.jsx(s,{children:"t"})," is revealed:"]}),e.jsx(i,{children:"z = z' + t"}),e.jsxs("p",{className:"mt-3",children:["Anyone can complete the signature, but completing it reveals ",e.jsx(s,{children:"t"})," to anyone watching."]})]}),e.jsx("h3",{children:"Atomic Swaps"}),e.jsxs(t,{title:"Cross-Chain Atomic Swap",children:[e.jsx("p",{children:"Alice (Bitcoin) and Bob (other chain) want to swap atomically:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:["Alice chooses secret ",e.jsx(s,{children:"t"}),", publishes"," ",e.jsx(s,{children:"T = [t]G"})]}),e.jsxs("li",{children:["Bob creates pre-signature for his coin (adapted with ",e.jsx(s,{children:"T"}),")"]}),e.jsxs("li",{children:["Alice creates pre-signature for her coin (adapted with ",e.jsx(s,{children:"T"}),")"]}),e.jsxs("li",{children:["Alice claims Bob's coin: completes his pre-signature, revealing ",e.jsx(s,{children:"t"})]}),e.jsxs("li",{children:["Bob sees ",e.jsx(s,{children:"t"})," on-chain, claims Alice's coin"]})]})]}),e.jsxs(n,{type:"success",children:[e.jsx("strong",{children:"No Hash Revelation:"})," Unlike HTLC-based atomic swaps, adaptor signature swaps don't reveal the preimage hash on-chain. The swap condition is completely hidden!"]}),e.jsx("h3",{children:"FROST + Adaptor Swaps"}),e.jsxs(r,{title:"Threshold Atomic Swap",children:[e.jsx("p",{children:"Alice's 2-of-3 FROST group swaps with Bob:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:["Alice's threshold group agrees on secret ",e.jsx(s,{children:"t"})," (can be generated via DKG or one party proposes)"]}),e.jsxs("li",{children:["Group produces FROST pre-signature adapted with ",e.jsx(s,{children:"T"})]}),e.jsxs("li",{children:["When group decides to execute swap, they reveal ",e.jsx(s,{children:"t"})]}),e.jsx("li",{children:"Swap completes atomically"})]}),e.jsx("p",{className:"mt-3",children:"The threshold security applies to both the coins and the swap decision."})]}),e.jsx("h3",{children:"Point Time-Locked Contracts (PTLCs)"}),e.jsxs(t,{title:"PTLC vs HTLC",children:[e.jsx("p",{children:"PTLCs are the adaptor signature version of HTLCs:"}),e.jsxs("table",{className:"w-full mt-4 text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-600",children:[e.jsx("th",{className:"text-left py-2",children:"Feature"}),e.jsx("th",{className:"text-left py-2",children:"HTLC"}),e.jsx("th",{className:"text-left py-2",children:"PTLC"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("td",{className:"py-2",children:"Condition"}),e.jsx("td",{className:"py-2",children:"Hash preimage"}),e.jsx("td",{className:"py-2",children:"Discrete log"})]}),e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("td",{className:"py-2",children:"On-chain visibility"}),e.jsx("td",{className:"py-2",children:"Hash revealed"}),e.jsx("td",{className:"py-2",children:"Nothing revealed"})]}),e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("td",{className:"py-2",children:"Privacy"}),e.jsx("td",{className:"py-2",children:"Same hash across hops"}),e.jsx("td",{className:"py-2",children:"Different point each hop"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"FROST compatible"}),e.jsx("td",{className:"py-2",children:"Yes (standard)"}),e.jsx("td",{className:"py-2",children:"Yes (adaptor)"})]})]})]})]}),e.jsx("h3",{children:"Lightning with PTLCs"}),e.jsxs(r,{title:"Private Multi-Hop Payments",children:[e.jsx("p",{children:"With PTLCs in Lightning:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"Each hop uses a different adaptor point"}),e.jsxs("li",{children:["Points are blinded: ",e.jsx(s,{children:"T_i = T + [r_i]G"})]}),e.jsx("li",{children:"Routing nodes learn nothing about payment path"}),e.jsx("li",{children:"Much stronger privacy than HTLC-based Lightning"})]})]}),e.jsx("h3",{children:"Security Considerations"}),e.jsxs(n,{type:"warning",children:[e.jsx("strong",{children:"Important:"})," The adaptor point ",e.jsx(s,{children:"T"})," and secret"," ",e.jsx(s,{children:"t"})," must be managed carefully:",e.jsxs("ul",{className:"list-disc list-inside mt-2",children:[e.jsxs("li",{children:["Pre-signatures commit to a specific ",e.jsx(s,{children:"T"})]}),e.jsxs("li",{children:["Revealing ",e.jsx(s,{children:"t"})," completes ALL pre-signatures using that ",e.jsx(s,{children:"T"})]}),e.jsxs("li",{children:["Use fresh ",e.jsx(s,{children:"t"})," for each independent swap"]})]})]}),e.jsx("p",{children:"Adaptor signatures combined with FROST enable a new class of protocols: threshold-controlled, privacy-preserving conditional payments. This is the future of Bitcoin scripting without scripts."})]})}export{u as default};
