import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{r}from"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-BVCiRvNU.js";import{L as B}from"./LessonLayout-CT1WdmGc.js";import{D as u,E as g,C as N}from"./Callout-4_WMx_B8.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-D6hrknZo.js";const P=[{id:1,label:"User copies address",description:"User copies merchant address from website",icon:"üìã"},{id:2,label:"Malware intercepts",description:"Clipboard hijacker detects Bitcoin address",icon:"ü¶†",isAttack:!0},{id:3,label:"Address swapped",description:"Attacker's address replaces legitimate one",icon:"üîÑ",isAttack:!0},{id:4,label:"User pastes address",description:"User pastes into wallet, unaware of swap",icon:"üìù"},{id:5,label:"Payment sent",description:"Funds sent to attacker's address",icon:"üí∏",isAttack:!0},{id:6,label:"Funds stolen",description:"Transaction irreversible, funds lost",icon:"‚ùå",isAttack:!0}],M=[{id:1,label:"User copies address",description:"User copies merchant address from website",icon:"üìã"},{id:2,label:"Malware intercepts",description:"Clipboard hijacker detects Bitcoin address",icon:"ü¶†",isAttack:!0},{id:3,label:"Address swapped",description:"Attacker's address replaces legitimate one",icon:"üîÑ",isAttack:!0},{id:4,label:"Branta verifies",description:"Guardrail checks address registration",icon:"üõ°Ô∏è",isBrantaProtection:!0},{id:5,label:"Mismatch detected",description:"Address doesn't match registered merchant",icon:"‚ö†Ô∏è",isBrantaProtection:!0},{id:6,label:"User warned",description:"Transaction blocked, attack prevented",icon:"‚úÖ",isBrantaProtection:!0}];function E(){const[t,m]=r.useState(!1),[a,i]=r.useState(0),[h,d]=r.useState(!1),n=t?M:P;r.useEffect(()=>{if(h&&a<n.length){const s=setTimeout(()=>{i(o=>o+1)},1500);return()=>clearTimeout(s)}else a>=n.length&&d(!1)},[h,a,n.length]);const x=()=>{i(0),d(!0)},l=()=>{i(0),d(!1)},p=()=>{m(!t),i(0),d(!1)};return e.jsxs("div",{className:"demo-container",children:[e.jsx("h3",{className:"text-lg font-semibold text-dark-200 mb-4",children:"Attack Flow Simulator"}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsx("button",{onClick:p,className:`px-4 py-2 rounded-lg font-medium transition-colors ${t?"bg-green-600 text-white hover:bg-green-700":"bg-red-600 text-white hover:bg-red-700"}`,children:t?"üõ°Ô∏è Branta Protected":"‚ö†Ô∏è Unprotected"}),e.jsx("button",{onClick:x,disabled:h,className:"px-4 py-2 rounded-lg bg-amber-600 text-white font-medium hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"‚ñ∂ Play Attack"}),e.jsx("button",{onClick:l,className:"px-4 py-2 rounded-lg bg-dark-700 text-dark-200 font-medium hover:bg-dark-600",children:"‚Ü∫ Reset"})]}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"flex flex-col gap-4",children:n.map((s,o)=>{const c=o<a,b=o===a-1;return e.jsxs("div",{className:`flex items-center gap-4 p-4 rounded-xl transition-all duration-500 ${c?s.isAttack?"bg-red-900/30 border border-red-700":s.isBrantaProtection?"bg-green-900/30 border border-green-700":"bg-dark-700/50 border border-dark-600":"bg-dark-800/30 border border-dark-800"} ${b?"ring-2 ring-amber-500":""}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-2xl transition-all duration-500 ${c?s.isAttack?"bg-red-600":s.isBrantaProtection?"bg-green-600":"bg-amber-600":"bg-dark-700"}`,children:s.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`font-semibold transition-colors duration-500 ${c?s.isAttack?"text-red-400":s.isBrantaProtection?"text-green-400":"text-dark-100":"text-dark-500"}`,children:s.label}),e.jsx("p",{className:`text-sm transition-colors duration-500 ${c?"text-dark-300":"text-dark-600"}`,children:s.description})]}),e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${c?"bg-dark-600 text-dark-200":"bg-dark-800 text-dark-600"}`,children:s.id})]},s.id)})})}),a>=n.length&&e.jsx("div",{className:`mt-6 p-4 rounded-xl text-center ${t?"bg-green-900/30 border border-green-700":"bg-red-900/30 border border-red-700"}`,children:e.jsx("p",{className:`text-lg font-semibold ${t?"text-green-400":"text-red-400"}`,children:t?"‚úÖ Attack Prevented! Branta detected the address mismatch.":"‚ùå Attack Successful! Funds were stolen."})})]})}const f="bc1qmerchant7x8f5kvy5l643lydnw9re59gtzzwf5mdq",v="bc1qattacker9z2m4nvy8k754mxenw0rt48htwwz6ndp";function I(){const[t,m]=r.useState(""),[a,i]=r.useState(""),[h,d]=r.useState(!1),[n,x]=r.useState(!1),[l,p]=r.useState(!1),[s,o]=r.useState(!0),[c,b]=r.useState(!1),A=()=>{m(f),i(f),d(!0),p(!1),b(!1),s&&(setTimeout(()=>{x(!0)},800),setTimeout(()=>{m(v),x(!1),p(!0)},1500))},S=()=>{i(t),l&&b(!0)},j=()=>{m(""),i(""),d(!1),x(!1),p(!1),b(!1)},C=()=>{const k=f.split(""),T=a.split("");return e.jsxs("div",{className:"font-mono text-sm space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-dark-400 w-20 shrink-0",children:"Expected:"}),e.jsx("span",{className:"text-green-400 break-all",children:f})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-dark-400 w-20 shrink-0",children:"Received:"}),e.jsx("span",{className:"break-all",children:T.map((w,y)=>e.jsx("span",{className:w!==k[y]?"text-red-400 bg-red-900/30":"text-dark-200",children:w},y))})]})]})};return e.jsxs("div",{className:"demo-container",children:[e.jsx("h3",{className:"text-lg font-semibold text-dark-200 mb-4",children:"Address Swap Detector"}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:k=>{o(k.target.checked),j()},className:"w-5 h-5 rounded accent-red-500"}),e.jsxs("span",{className:"text-dark-200",children:["Simulate Clipboard Malware ",s?"ü¶†":""]})]}),e.jsx("button",{onClick:j,className:"px-3 py-1 rounded bg-dark-700 text-dark-300 text-sm hover:bg-dark-600",children:"Reset"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"text-xl",children:"üåê"}),e.jsx("span",{className:"text-dark-200 font-semibold",children:"Merchant Website"})]}),e.jsxs("div",{className:"bg-dark-900 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 text-sm mb-2",children:"Payment Address:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-green-400 text-sm font-mono break-all flex-1",children:f}),e.jsx("button",{onClick:A,className:"px-3 py-2 rounded bg-amber-600 text-white text-sm font-medium hover:bg-amber-700 shrink-0",children:"üìã Copy"})]})]}),h&&e.jsx("div",{className:"mt-4 text-sm text-green-400",children:"‚úì Address copied to clipboard"})]}),e.jsxs("div",{className:`bg-dark-800 rounded-xl p-4 transition-all ${n?"ring-2 ring-red-500 animate-pulse":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"text-xl",children:"üìã"}),e.jsx("span",{className:"text-dark-200 font-semibold",children:"System Clipboard"}),s&&e.jsx("span",{className:"text-red-400 text-sm",children:"(Monitored by malware)"})]}),e.jsx("div",{className:"bg-dark-900 rounded-lg p-4 min-h-[80px]",children:t?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-dark-400 text-sm mb-2",children:"Current content:"}),e.jsx("code",{className:`text-sm font-mono break-all ${l?"text-red-400":"text-green-400"}`,children:t})]}):e.jsx("p",{className:"text-dark-500 text-sm italic",children:"Clipboard empty"})}),n&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-red-400",children:[e.jsx("span",{className:"animate-spin",children:"üîÑ"}),e.jsx("span",{className:"text-sm",children:"Malware swapping address..."})]}),l&&e.jsx("div",{className:"mt-4 text-sm text-red-400",children:"‚ö†Ô∏è Address has been replaced by attacker!"})]})]}),e.jsxs("div",{className:"mt-6 bg-dark-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"text-xl",children:"üëõ"}),e.jsx("span",{className:"text-dark-200 font-semibold",children:"Your Wallet"})]}),e.jsxs("div",{className:"bg-dark-900 rounded-lg p-4",children:[e.jsx("p",{className:"text-dark-400 text-sm mb-2",children:"Send to address:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-dark-800 rounded p-2 min-h-[40px]",children:a?e.jsx("code",{className:`text-sm font-mono break-all ${l&&a===v?"text-red-400":"text-dark-200"}`,children:a}):e.jsx("span",{className:"text-dark-500 text-sm italic",children:"Paste address here"})}),e.jsx("button",{onClick:S,disabled:!t,className:"px-3 py-2 rounded bg-amber-600 text-white text-sm font-medium hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed shrink-0",children:"üìù Paste"})]})]}),c&&e.jsxs("div",{className:"mt-4 p-4 bg-red-900/30 border border-red-700 rounded-lg",children:[e.jsx("p",{className:"text-red-400 font-semibold mb-3",children:"‚ö†Ô∏è Address Mismatch Detected!"}),C(),e.jsx("p",{className:"mt-4 text-dark-300 text-sm",children:"With Branta, this mismatch would be detected before you send any funds. The pasted address doesn't match the registered merchant address."})]})]})]})}function L(){return e.jsxs(B,{sectionId:2,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Address Swap Attacks"}),e.jsx("p",{className:"mb-4",children:"Address swap attacks are among the most dangerous threats in the Bitcoin ecosystem. An attacker substitutes a legitimate Bitcoin address with their own, redirecting funds without the sender's knowledge. Because the swap happens silently, victims often don't realize they've been compromised until it's too late."}),e.jsx(u,{title:"Address Swap Attack",children:"An attack where a malicious actor replaces a legitimate Bitcoin address with one they control. The swap can occur at various points: in transit, on the clipboard, in a compromised website, or through modified software."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"How Address Swaps Work"}),e.jsx("p",{className:"mb-4",children:"Address swap attacks exploit the disconnect between what you see and what your wallet actually sends to. The attack chain typically follows these steps:"}),e.jsxs("ol",{className:"list-decimal list-inside mb-6 space-y-2 text-dark-200",children:[e.jsx("li",{children:"Attacker gains access to modify addresses at some point in the process"}),e.jsx("li",{children:"Legitimate address is displayed to the user (building trust)"}),e.jsx("li",{children:"At the moment of transaction, the address is swapped"}),e.jsx("li",{children:"User confirms the transaction, believing it's correct"}),e.jsx("li",{children:"Funds go to the attacker's address"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Types of Address Swap Attacks"}),e.jsx(u,{title:"Clipboard Hijacking",children:"Malware monitors the system clipboard and automatically replaces any copied Bitcoin address with an attacker-controlled address. This is particularly effective because users expect to copy-paste addresses rather than type them manually."}),e.jsxs(g,{title:"Clipboard Hijacking in Action",children:[e.jsxs("div",{className:"space-y-2 font-mono text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-dark-400",children:"User copies:"})," bc1qar0srrr7xfkvy5l643lydnw9re59gtzzwf5mdq"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-dark-400",children:"User pastes:"})," bc1qattacker7xfkvy5l643lydnw9re59gtzzattack"]})]}),e.jsx("p",{className:"mt-2 text-dark-400",children:"Sophisticated malware can generate addresses with similar prefixes to avoid detection."})]}),e.jsx(u,{title:"Website Compromise",children:"Attackers modify the JavaScript on a legitimate website to display different addresses to different users, or to swap addresses at checkout time. This can happen through XSS attacks, compromised CDNs, or malicious browser extensions."}),e.jsx(u,{title:"Database Manipulation",children:"If an attacker gains access to a merchant's database, they can directly modify the stored payment addresses. All invoices generated afterward point to attacker addresses."}),e.jsx(u,{title:"Network Interception",children:"In a man-in-the-middle position, attackers can modify HTTP responses to replace addresses. Even HTTPS can be vulnerable if the attacker has compromised the TLS certificate or the user's trust store."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why Detection is Difficult"}),e.jsx("p",{className:"mb-4",children:"Address swap attacks are particularly insidious because:"}),e.jsxs("ul",{className:"list-disc list-inside mb-6 space-y-2 text-dark-200",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Addresses are opaque"})," - They don't contain human-readable information about the owner"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Visual similarity"})," - Attackers can generate addresses with matching prefixes (vanity addresses)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"User fatigue"})," - Nobody actually verifies all 34-62 characters of an address"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Trust in the system"})," - Users trust that what they see is what they'll send"]})]}),e.jsxs(g,{title:"The Vanity Address Problem",children:[e.jsx("p",{className:"mb-2",children:"Given enough computing power, attackers can generate addresses that match the first several characters of a target address:"}),e.jsxs("div",{className:"space-y-1 font-mono text-sm mt-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-green-400",children:"Legitimate:"})," bc1qar0srrr",e.jsx("span",{className:"text-dark-400",children:"7xfkvy5l643lydnw9re59gtzzwf5mdq"})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-red-400",children:"Attacker:"}),"¬†¬† bc1qar0srrr",e.jsx("span",{className:"text-dark-400",children:"hj8k2m9l542ktdms8jk48gtzzhacker"})]})]}),e.jsx("p",{className:"mt-2 text-dark-400",children:"Users checking only the first few characters would see a match."})]}),e.jsx(N,{type:"danger",title:"Real Attack: $68 Million Lost",children:"In one of the largest documented address swap attacks, a victim lost over $68 million in a single transaction. The attacker had studied the victim's transaction patterns and created a matching vanity address. The victim's quick verification passed because the first and last characters matched."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Common Attack Vectors"}),e.jsxs(g,{title:"Vector 1: Malicious Browser Extensions",children:[e.jsx("p",{className:"mb-2",children:'Browser extensions with broad permissions can read and modify page content. An extension advertised for "Bitcoin price tracking" could silently swap addresses on checkout pages.'}),e.jsxs("ul",{className:"list-disc list-inside text-dark-400 mt-2",children:[e.jsx("li",{children:"Often disguised as useful Bitcoin tools"}),e.jsx("li",{children:"May work correctly for months before activating"}),e.jsx("li",{children:"Can target specific high-value sites"})]})]}),e.jsxs(g,{title:"Vector 2: Email Interception",children:[e.jsx("p",{className:"mb-2",children:"Business email compromise (BEC) attacks intercept invoices sent via email and replace the payment addresses. The email arrives from the correct sender (or a spoofed address) with modified payment details."}),e.jsxs("ul",{className:"list-disc list-inside text-dark-400 mt-2",children:[e.jsx("li",{children:"Targets B2B transactions"}),e.jsx("li",{children:"Often timed to coincide with real invoices"}),e.jsx("li",{children:'May include "updated banking details" pretext'})]})]}),e.jsxs(g,{title:"Vector 3: Compromised Payment Processors",children:[e.jsx("p",{className:"mb-2",children:"If a Bitcoin payment processor is compromised, attackers can swap addresses across thousands of merchants simultaneously. This is a supply chain attack that affects all downstream users."}),e.jsxs("ul",{className:"list-disc list-inside text-dark-400 mt-2",children:[e.jsx("li",{children:"High-impact, affects many victims"}),e.jsx("li",{children:"Difficult to detect individually"}),e.jsx("li",{children:"May extract funds slowly to avoid detection"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"How Branta Prevents Address Swaps"}),e.jsx("p",{className:"mb-4",children:"Branta's Guardrail system eliminates address swap attacks through verified registration:"}),e.jsxs("ol",{className:"list-decimal list-inside mb-6 space-y-2 text-dark-200",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Recipient Registration"})," - Merchants register their addresses with Branta directly"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Independent Verification"})," - Senders query Branta to verify ownership"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Out-of-Band Confirmation"})," - Verification happens outside the potentially compromised channel"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Real-Time Checks"})," - Verification occurs at transaction time, not relying on cached data"]})]}),e.jsx(N,{type:"success",title:"The Verification Guarantee",children:"Even if an attacker swaps addresses in your clipboard, on a website, or in an email, querying Branta will reveal the mismatch. The registered address won't match the swapped address, alerting you before you send."}),e.jsxs("p",{className:"mb-4",children:["The key insight is that an attacker cannot both swap the address ",e.jsx("em",{children:"and"})," register it with Branta as belonging to the legitimate business. The verification breaks the attack chain by providing an independent source of truth."]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Interactive: Attack Flow Simulator"}),e.jsx("p",{className:"mb-4",children:"See how an address swap attack unfolds step by step, and how Branta protection changes the outcome:"}),e.jsx(E,{}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Interactive: Address Swap Detector"}),e.jsx("p",{className:"mb-4",children:"Experience how clipboard hijacking works in a safe simulation:"}),e.jsx(I,{})]})}export{L as default};
