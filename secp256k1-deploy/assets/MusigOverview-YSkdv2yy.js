import{j as e}from"./vendor-animation-0o8UKZ_1.js";import"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-ySuSmSID.js";import{T as r}from"./TranscriptLayout-CoUsWXbX.js";import{I as s,M as i}from"./MathBlock-uz1iP4cD.js";import{C as n,D as t,E as a}from"./Callout-4_WMx_B8.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./transcripts-Bj1VzTa0.js";function p(){return e.jsxs(r,{transcriptId:"musig-overview",children:[e.jsx(n,{type:"success",title:"Key Takeaways",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"MuSig enables n-of-n multi-signatures that look like single signatures"}),e.jsx("li",{children:"Key aggregation must be done carefully to prevent rogue key attacks"}),e.jsx("li",{children:"MuSig2 reduces the signing protocol from 3 rounds to 2 rounds"}),e.jsx("li",{children:"Proper nonce handling is critical for security"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Multi-Signature Problem"}),e.jsx("p",{className:"mb-4",children:"Tim Ruffing opens by explaining why naive multi-signatures don't work:"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:'"You might think multi-signatures are simple: just add public keys together and add signatures together. But this creates a devastating attack where one party can control the aggregate key."'}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Tim Ruffing"})]}),e.jsxs(t,{title:"Rogue Key Attack",children:[e.jsxs("p",{children:["If Alice has public key ",e.jsx(s,{children:"P_A"})," and Bob chooses"," ",e.jsx(s,{children:"P_B = P_B' - P_A"})," for some key he knows, then:"]}),e.jsx(i,{children:"P_{agg} = P_A + P_B = P_A + (P_B' - P_A) = P_B'"}),e.jsxs("p",{className:"mt-2",children:["Bob now fully controls the aggregate key! He can sign without Alice's participation. MuSig solves this through ",e.jsx("em",{children:"key aggregation coefficients"}),"."]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"MuSig Key Aggregation"}),e.jsx("p",{className:"mb-4",children:"Jonas Nick explains how MuSig prevents rogue key attacks:"}),e.jsxs(a,{title:"Secure Key Aggregation",children:[e.jsxs("p",{className:"mb-3",children:["For public keys ",e.jsx(s,{children:"P_1, ..., P_n"}),":"]}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[e.jsxs("li",{children:["Compute ",e.jsx(s,{children:"L = H(P_1 \\| ... \\| P_n)"})," (the key set hash)"]}),e.jsxs("li",{children:["For each key, compute coefficient ",e.jsx(s,{children:"a_i = H(L \\| P_i)"})]}),e.jsxs("li",{children:["Aggregate key: ",e.jsx(s,{children:"P_{agg} = \\sum a_i P_i"})]})]}),e.jsxs("p",{className:"mt-3 text-dark-400",children:["Now Bob can't choose ",e.jsx(s,{children:"P_B"})," to cancel Alice's key because the coefficients depend on ",e.jsx("em",{children:"all"})," keys, including ",e.jsx(s,{children:"P_B"})," itself."]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Original MuSig Protocol"}),e.jsxs("p",{className:"mb-4",children:["The original MuSig (now called MuSig1) requires ",e.jsx("strong",{children:"three rounds"})," of communication:"]}),e.jsxs("div",{className:"bg-dark-800/50 rounded-lg p-6 border border-dark-700/50 mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-dark-100 mb-4",children:"MuSig1 Signing Rounds"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-cyan-400 font-bold",children:"1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Nonce Commitment"}),e.jsxs("p",{className:"text-sm text-dark-400",children:["Each signer generates nonce ",e.jsx(s,{children:"k_i"}),", computes"," ",e.jsx(s,{children:"R_i = k_i G"}),", and broadcasts"," ",e.jsx(s,{children:"H(R_i)"})]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-cyan-400 font-bold",children:"2"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Nonce Reveal"}),e.jsxs("p",{className:"text-sm text-dark-400",children:["After receiving all commitments, each signer reveals ",e.jsx(s,{children:"R_i"}),". Others verify commitments match."]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-cyan-400 font-bold",children:"3"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Signature Share"}),e.jsxs("p",{className:"text-sm text-dark-400",children:["Compute ",e.jsx(s,{children:"R = \\sum R_i"}),", challenge"," ",e.jsxs(s,{children:["e = H(R \\| P_",agg," \\| m)"]}),", and signature share"," ",e.jsx(s,{children:"s_i = k_i + e \\cdot a_i \\cdot d_i"})]})]})]})]})]}),e.jsx(n,{type:"warning",title:"Why Three Rounds?",children:e.jsxs("p",{children:["The commitment round prevents a ",e.jsx("strong",{children:"Wagner's attack"})," where an attacker who sees other nonces first can choose their nonce to forge signatures. Committing before revealing ensures no one can manipulate the aggregate nonce."]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"MuSig2: Two Rounds"}),e.jsx("p",{className:"mb-4",children:"Tim Ruffing explains the breakthrough that enabled MuSig2:"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:`"Instead of one nonce, each signer generates multiple nonces. The final nonce is a random linear combination of all nonces, determined after they're revealed. This eliminates the commitment round while maintaining security."`}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Tim Ruffing"})]}),e.jsxs(t,{title:"MuSig2 Construction",children:[e.jsxs("p",{children:["Each signer generates ",e.jsx(s,{children:"\\nu"})," nonces"," ",e.jsx(s,{children:"R_i^{(1)}, ..., R_i^{(\\nu)}"})," (typically ",e.jsx(s,{children:"\\nu = 2"}),")."]}),e.jsx("p",{className:"mt-2",children:"After receiving all nonces, compute binding coefficient:"}),e.jsx(i,{children:"b = H(R^{(1)} \\| ... \\| R^{(\\nu)} \\| P_{agg} \\| m)"}),e.jsxs("p",{className:"mt-2",children:["Final aggregate nonce: ",e.jsx(s,{children:"R = \\sum_j b^{j-1} R^{(j)}"})]}),e.jsx("p",{className:"mt-2 text-dark-400",children:"The binding coefficient depends on the message, preventing the attacker from pre-computing how to manipulate the aggregate."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Nonce State Management"}),e.jsx("p",{className:"mb-4",children:"Jonas Nick emphasizes the critical importance of proper nonce handling:"}),e.jsxs(n,{type:"danger",title:"Nonce Reuse is Catastrophic",children:[e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{children:"Never reuse nonces across signing sessions."})," If the same nonce is used with two different messages, the private key can be extracted:"]}),e.jsx(i,{children:"d_i = \\frac{s_i^{(1)} - s_i^{(2)}}{a_i(e^{(1)} - e^{(2)})}"}),e.jsx("p",{className:"mt-2",children:"MuSig implementations must use secure state management to track which nonces have been used."})]}),e.jsx(a,{title:"Safe Nonce Generation Strategies",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Randomness:"})," Generate fresh random nonces for each session. Requires good entropy source."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Counter-based:"})," Derive nonce from private key + counter. Counter must be persisted securely."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Session-bound:"})," Include session ID in nonce derivation. Prevents cross-session reuse."]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Applications"}),e.jsx("p",{className:"mb-4",children:"The panel discusses practical applications of MuSig:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Bitcoin Multisig"}),e.jsx("p",{className:"text-sm text-dark-300",children:"n-of-n multisig that looks like a single-key output on-chain. Saves space and improves privacy."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Lightning Channels"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Two-party channels with 2-of-2 MuSig outputs. Channel opens/closes are indistinguishable from regular spends."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Taproot Key Paths"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Combined with Taproot, multiple parties can share a key-path spend with complete on-chain privacy."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Federated Sidechains"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Federation members can sign withdrawals with MuSig, presenting a single signature on the main chain."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Implementation Status"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:`"MuSig2 is now available in libsecp256k1-zkp with a stable API. We've been extremely careful about the state machine—users can't accidentally reuse nonces or skip security checks."`}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Jonas Nick"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Related Course Sections"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("a",{href:"#/section/8",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 8: Schnorr Signatures"}),e.jsx("p",{className:"text-sm text-dark-500",children:"The foundation for MuSig"})]}),e.jsxs("a",{href:"#/section/9",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 9: Advanced Topics"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Multi-party protocols and beyond"})]})]})]})}export{p as default};
