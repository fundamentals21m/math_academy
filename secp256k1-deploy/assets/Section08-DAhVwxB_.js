import{j as e}from"./vendor-animation-0o8UKZ_1.js";import"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-B7HnP1KH.js";import{L as a}from"./LessonLayout-Bb9WiYI8.js";import{I as s,M as t}from"./MathBlock-uz1iP4cD.js";import{D as i,E as n,C as r}from"./Callout-4_WMx_B8.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-B3IzoTDS.js";function g(){return e.jsxs(a,{sectionId:8,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Applications"}),e.jsx("p",{className:"mb-4",children:"secp256k1 powers far more than just Bitcoin. The same mathematical foundation enables a wide ecosystem of cryptographic applications across multiple blockchains and protocols."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Ethereum"}),e.jsx("p",{className:"mb-4",children:"Ethereum uses the same secp256k1 curve as Bitcoin, but with some key differences:"}),e.jsxs(i,{title:"ECRECOVER",children:[e.jsxs("p",{children:["Ethereum's signature verification is exposed as a precompiled contract at address"," ",e.jsx("code",{className:"text-amber-400",children:"0x01"}),". Given a message hash and signature,"," ",e.jsxs(s,{children:["\\text","{ecrecover}"]})," returns the signer's address."]}),e.jsx("div",{className:"bg-dark-800 rounded-lg p-4 mt-3 font-mono text-sm",children:e.jsx("p",{children:e.jsxs(s,{children:["\\text","{address}"," = \\text","{ecrecover}","(hash, v, r, s)"]})})}),e.jsx("p",{className:"mt-3 text-dark-400",children:"This enables on-chain signature verification without revealing the public key until the first transaction."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Bitcoin"}),e.jsxs("ul",{className:"text-sm space-y-1 text-dark-300",children:[e.jsx("li",{children:"• Address from pubkey hash"}),e.jsx("li",{children:"• Signature in transaction"}),e.jsx("li",{children:"• DER-encoded signatures (legacy)"}),e.jsx("li",{children:"• Schnorr via Taproot"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-purple-400 font-bold mb-2",children:"Ethereum"}),e.jsxs("ul",{className:"text-sm space-y-1 text-dark-300",children:[e.jsx("li",{children:"• Address from pubkey directly"}),e.jsx("li",{children:"• Recovery ID in signature"}),e.jsx("li",{children:"• Fixed 65-byte signatures"}),e.jsx("li",{children:"• ECDSA only (no Schnorr)"})]})]})]}),e.jsxs(n,{title:"Ethereum Address Derivation",children:[e.jsx("p",{children:"Unlike Bitcoin, Ethereum derives addresses directly from the public key:"}),e.jsx(t,{children:"\\text{Address} = \\text{keccak256}(Q_x || Q_y)[12..31]"}),e.jsx("p",{className:"mt-2 text-dark-400",children:"Take the last 20 bytes (160 bits) of the Keccak-256 hash of the uncompressed public key (without the 0x04 prefix)."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Lightning Network"}),e.jsx("p",{className:"mb-4",children:"The Lightning Network uses secp256k1 extensively for channel management and payment routing:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Channel funding:"})," 2-of-2 multisig between channel partners"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"HTLCs:"})," Hash Time Locked Contracts for atomic payments"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Revocation:"})," Punishment keys for dishonest channel closes"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Onion routing:"})," Point multiplication for route blinding"]})]}),e.jsx(i,{title:"Payment Channels",children:e.jsx("p",{children:"A Lightning channel is backed by a Bitcoin 2-of-2 multisig. Updates are signed off-chain, and only the final state is broadcast. This requires sophisticated cryptographic protocols built on secp256k1."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Adaptor Signatures"}),e.jsxs("p",{className:"mb-4",children:["Adaptor signatures are a powerful cryptographic primitive that enables ",e.jsx("strong",{children:"atomic swaps"})," and ",e.jsx("strong",{children:"conditional payments"}),"."]}),e.jsxs(i,{title:"Adaptor Signature",children:[e.jsxs("p",{children:["An adaptor signature ",e.jsx(s,{children:"(\\tilde R, \\tilde s)"}),' is an "incomplete" signature that can only be completed with knowledge of a secret'," ",e.jsx(s,{children:"t"}),":"]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 mt-3 font-mono text-sm space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"Create adaptor:"})}),e.jsxs("p",{children:[e.jsx(s,{children:"\\tilde R = R + T"})," (where ",e.jsx(s,{children:"T = tG"}),")"]}),e.jsx("p",{children:e.jsx(s,{children:"\\tilde s = k + H(\\tilde R, Q, m) \\cdot d"})}),e.jsx("p",{className:"mt-3",children:e.jsx("strong",{children:"Complete with secret:"})}),e.jsx("p",{children:e.jsx(s,{children:"s = \\tilde s + t"})})]})]}),e.jsxs(n,{title:"Cross-Chain Atomic Swap",children:[e.jsx("p",{children:"Alice wants to trade BTC for LTC with Bob:"}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm",children:[e.jsxs("p",{children:["1. Alice picks secret ",e.jsx(s,{children:"t"}),", publishes ",e.jsx(s,{children:"T = tG"})]}),e.jsx("p",{children:"2. Bob creates adaptor signature for his LTC payment"}),e.jsx("p",{children:"3. Alice creates adaptor signature for her BTC payment"}),e.jsxs("p",{children:["4. When Alice claims BTC, she reveals ",e.jsx(s,{children:"t"})]}),e.jsxs("p",{children:["5. Bob uses ",e.jsx(s,{children:"t"})," to complete his signature and claim LTC"]})]}),e.jsx("p",{className:"mt-3 text-dark-400",children:"Either both transactions happen, or neither does—atomic swap without hash-locking."})]}),e.jsx(r,{type:"info",title:"Scriptless Scripts",children:e.jsx("p",{children:`Adaptor signatures enable "scriptless scripts"—complex conditions enforced through cryptography rather than on-chain scripts. This improves privacy (conditions aren't visible on-chain) and efficiency (smaller transactions).`})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Message Signing"}),e.jsx("p",{className:"mb-4",children:"Beyond transactions, secp256k1 signatures are used for general message authentication:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Proof of ownership:"})," Prove you control an address without spending"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Login systems:"}),' "Sign in with Ethereum/Bitcoin"']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Data attestation:"})," Sign off-chain data (oracles, state channels)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Nostr:"})," Decentralized social protocol using secp256k1 identities"]})]}),e.jsxs(i,{title:"Bitcoin Message Signing (BIP 137)",children:[e.jsx("p",{children:"Bitcoin wallets can sign arbitrary messages using a special prefix to prevent replay attacks:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 mt-3 font-mono text-sm",children:[e.jsx("p",{children:"message_hash = SHA256(SHA256("}),e.jsx("p",{className:"pl-4",children:'"\\x18Bitcoin Signed Message:\\n" +'}),e.jsx("p",{className:"pl-4",children:"varint(len(message)) +"}),e.jsx("p",{className:"pl-4",children:"message"}),e.jsx("p",{children:"))"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Verifiable Random Functions (VRFs)"}),e.jsx("p",{className:"mb-4",children:"VRFs produce random outputs that can be verified as correctly computed from a given input and secret key:"}),e.jsx(t,{children:"\\text{VRF}_{sk}(x) = H(x, sk \\cdot H'(x))"}),e.jsx("p",{className:"mb-4",children:"Applications include:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Leader election:"})," Randomly select validators in PoS"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Lottery systems:"})," Provably fair random selection"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Private DNS:"})," NSEC5 for authenticated denial of existence"]})]}),e.jsx(r,{type:"success",title:"The secp256k1 Ecosystem",children:e.jsx("p",{children:"From Bitcoin to Ethereum to Lightning to Nostr, secp256k1 has become the de facto standard for blockchain cryptography. Its simplicity, efficiency, and extensive implementation support make it the foundation of a trillion-dollar ecosystem."})})]})}export{g as default};
