import{j as e,m as M}from"./vendor-animation-0o8UKZ_1.js";import{r as b}from"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-B1r0tPNy.js";import{L as W,C as A,D as q,E as N}from"./Callout-THmA9stJ.js";import{I as t,M as f}from"./MathBlock-uz1iP4cD.js";import"./vendor-firebase-functions-DDqfDrvm.js";import"./vendor-firebase-core-CzRQL6VN.js";import"./vendor-firebase-auth-C4l3lITM.js";import"./quizMap-B3IzoTDS.js";function O({className:z=""}){const[i,E]=b.useState(17),[a,S]=b.useState(null),[n,F]=b.useState(null),k=0,T=7,y=500,g=500,x=50,C=Math.min(y,g)-2*x,d=(s,r)=>(s%r+r)%r,R=(s,r)=>s===0?!0:v(s,(r-1)/2,r)===1,v=(s,r,c)=>{let l=1;for(s=d(s,c);r>0;)r%2===1&&(l=d(l*s,c)),r=Math.floor(r/2),s=d(s*s,c);return l},L=(s,r)=>{if(s===0)return[0];if(!R(s,r))return[];if(r%4===3){const l=v(s,(r+1)/4,r),o=d(-l,r);return l===o?[l]:[l,o].sort((p,u)=>p-u)}const c=[];for(let l=0;l<r;l++)d(l*l,r)===d(s,r)&&c.push(l);return c.sort((l,o)=>l-o)},I=b.useMemo(()=>{const s=[];for(let r=0;r<i;r++){const c=d(r*r*r+k*r+T,i),l=L(c,i);for(const o of l)s.push({x:r,y:o})}return s},[i,k,T]),h=s=>x+s/(i-1)*C,j=s=>g-x-s/(i-1)*C,_=(s,r)=>{if(s.x===r.x&&s.y!==r.y)return null;let c;if(s.x===r.x&&s.y===r.y){if(s.y===0)return null;const p=d(3*s.x*s.x+k,i),u=d(2*s.y,i),w=v(u,i-2,i);c=d(p*w,i)}else{const p=d(r.y-s.y,i),u=d(r.x-s.x,i),w=v(u,i-2,i);c=d(p*w,i)}const l=d(c*c-s.x-r.x,i),o=d(c*(s.x-l)-s.y,i);return{x:l,y:o}},m=b.useMemo(()=>n?_(n,n):null,[n,i]),$=[7,11,13,17,19,23,29,31,37,41,43,47];return e.jsxs("div",{className:`p-6 rounded-2xl bg-dark-800/50 border border-dark-700/50 ${z}`,children:[e.jsx("h3",{className:"text-xl font-bold text-dark-100 mb-2",children:"Finite Field Grid"}),e.jsxs("p",{className:"text-dark-400 text-sm mb-4",children:["See how y¬≤ = x¬≥ + 7 looks over &Zopf;",e.jsx("sub",{children:"p"}),". The smooth curve becomes scattered points!"]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-dark-300 text-sm mb-2",children:["Field size p = ",e.jsx("span",{className:"text-amber-400 font-mono",children:i}),e.jsxs("span",{className:"text-dark-500 ml-2",children:["(",I.length," points on curve)"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:$.map(s=>e.jsx("button",{onClick:()=>{E(s),F(null)},className:`px-3 py-1 rounded-lg text-sm font-mono transition-colors ${i===s?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-dark-700 text-dark-400 border border-dark-600 hover:bg-dark-600"}`,children:s},s))})]}),e.jsxs("svg",{viewBox:`0 0 ${y} ${g}`,className:"w-full h-auto bg-dark-900/50 rounded-xl",children:[Array.from({length:i},(s,r)=>e.jsxs("g",{children:[e.jsx("line",{x1:h(r),y1:x,x2:h(r),y2:g-x,stroke:"#374151",strokeWidth:"1",strokeOpacity:"0.3"}),e.jsx("line",{x1:x,y1:j(r),x2:y-x,y2:j(r),stroke:"#374151",strokeWidth:"1",strokeOpacity:"0.3"})]},r)),e.jsx("text",{x:y-x+10,y:j(0)+4,fill:"#9ca3af",fontSize:"12",children:"x"}),e.jsx("text",{x:h(0)-5,y:x-10,fill:"#9ca3af",fontSize:"12",children:"y"}),Array.from({length:i},(s,r)=>Array.from({length:i},(c,l)=>e.jsx("circle",{cx:h(r),cy:j(l),r:2,fill:"#374151",fillOpacity:"0.3"},`bg-${r}-${l}`))),I.map((s,r)=>{const c=(a==null?void 0:a.x)===s.x&&(a==null?void 0:a.y)===s.y,l=(n==null?void 0:n.x)===s.x&&(n==null?void 0:n.y)===s.y,o=m&&m.x===s.x&&m.y===s.y;return e.jsx(M.circle,{cx:h(s.x),cy:j(s.y),r:c||l?8:o?7:5,fill:o?"#8b5cf6":l?"#10b981":"#f59e0b",stroke:l||o?"#fff":"none",strokeWidth:2,className:"cursor-pointer",onMouseEnter:()=>S(s),onMouseLeave:()=>S(null),onClick:()=>F((n==null?void 0:n.x)===s.x&&(n==null?void 0:n.y)===s.y?null:s),initial:{scale:0},animate:{scale:1},transition:{delay:r*.01}},`${s.x}-${s.y}`)}),e.jsxs("g",{transform:"translate(15, 20)",children:[e.jsx("rect",{x:"0",y:"0",width:"130",height:"55",fill:"#1f2937",rx:"8",opacity:"0.9"}),e.jsx("circle",{cx:"15",cy:"18",r:"5",fill:"#f59e0b"}),e.jsx("text",{x:"28",y:"22",fill:"#d1d5db",fontSize:"11",children:"Points on curve"}),n&&e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"15",cy:"38",r:"5",fill:"#10b981"}),e.jsx("text",{x:"28",y:"42",fill:"#d1d5db",fontSize:"11",children:"Selected: P"})]})]})]}),a&&e.jsxs(M.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"mt-4 p-3 rounded-xl bg-amber-500/10 border border-amber-500/20",children:[e.jsxs("p",{className:"text-amber-400 text-sm",children:["Point: (",a.x,", ",a.y,")"]}),e.jsxs("p",{className:"text-dark-400 text-xs mt-1",children:["Verify: ",a.y,"¬≤ mod ",i," = ",d(a.y*a.y,i)," = ",a.x,"¬≥ + 7 mod ",i," ="," ",d(a.x*a.x*a.x+7,i)]})]}),n&&e.jsxs("div",{className:"mt-4 p-4 rounded-xl bg-dark-700/50 border border-dark-600/50",children:[e.jsxs("p",{className:"text-dark-300 text-sm mb-2",children:["Selected Point P = (",n.x,", ",n.y,")"]}),m?e.jsxs("p",{className:"text-purple-400 text-sm",children:["2P = (",m.x,", ",m.y,")",e.jsx("span",{className:"text-dark-500 ml-2",children:"(point doubling result)"})]}):e.jsx("p",{className:"text-dark-500 text-sm",children:"2P = ùí™ (point at infinity)"})]}),e.jsx("div",{className:"mt-4 p-4 rounded-xl bg-blue-500/10 border border-blue-500/20",children:e.jsxs("p",{className:"text-blue-400 text-sm",children:[e.jsx("strong",{children:"Key Insight:"})," Over real numbers, the curve is smooth. Over &Zopf;",e.jsx("sub",{children:"p"}),`, we get discrete scattered points. The group operations work the same way, but there's no "geometry" to help visualize the discrete log problem!`]})})]})}function J(){return e.jsxs(W,{sectionId:2,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Finite Fields"}),e.jsxs("p",{className:"mb-4",children:["Real numbers are great for building intuition, but they're useless for cryptography. Why? Computers can't represent them exactly, and there are infinitely many of them. Instead, we need ",e.jsx("strong",{children:"finite fields"}),"."]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Problem with Real Numbers"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Infinite precision:"})," Real numbers require infinite storage"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Floating-point errors:"})," Rounding accumulates and breaks security"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"No uniform distribution:"}),` Can't sample "random" real numbers`]})]}),e.jsx(A,{type:"warning",title:"Security Requirement",children:e.jsxs("p",{children:["Cryptographic operations must be ",e.jsx("strong",{children:"exact"}),`. A signature that's "close enough" is useless‚Äîit either verifies or it doesn't.`]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Modular Arithmetic"}),e.jsxs("p",{className:"mb-4",children:["The solution is ",e.jsx("strong",{children:"modular arithmetic"}),"‚Äîworking with remainders after division by some number ",e.jsx(t,{children:"p"}),". Think of a clock: after 12 comes 1, not 13."]}),e.jsxs(q,{title:"Modular Arithmetic",children:[e.jsxs("p",{children:["For integers ",e.jsx(t,{children:"a"})," and ",e.jsx(t,{children:"p"}),", we write:"]}),e.jsx(f,{children:"a \\mod p = r"}),e.jsxs("p",{className:"mt-2",children:["where ",e.jsx(t,{children:"r"})," is the remainder when ",e.jsx(t,{children:"a"})," ","is divided by ",e.jsx(t,{children:"p"}),", with ",e.jsxs(t,{children:["0 \\leq r ","<"," p"]}),"."]})]}),e.jsx(N,{title:"Arithmetic mod 7",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold mb-2",children:"Addition:"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsx("li",{children:e.jsx(t,{children:"5 + 4 = 9 \\equiv 2 \\pmod 7"})}),e.jsx("li",{children:e.jsx(t,{children:"6 + 6 = 12 \\equiv 5 \\pmod 7"})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold mb-2",children:"Multiplication:"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsx("li",{children:e.jsx(t,{children:"3 \\times 4 = 12 \\equiv 5 \\pmod 7"})}),e.jsx("li",{children:e.jsx(t,{children:"5 \\times 5 = 25 \\equiv 4 \\pmod 7"})})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Division: The Tricky Part"}),e.jsxs("p",{className:"mb-4",children:["In modular arithmetic, ",e.jsx("strong",{children:"division is multiplication by the inverse"}),". The inverse of ",e.jsx(t,{children:"a"})," mod ",e.jsx(t,{children:"p"})," is the number ",e.jsxs(t,{children:["a^","{-1}"]})," such that:"]}),e.jsx(f,{children:"a \\cdot a^{-1} \\equiv 1 \\pmod p"}),e.jsxs(q,{title:"Fermat's Little Theorem",children:[e.jsxs("p",{children:["If ",e.jsx(t,{children:"p"})," is prime and ",e.jsx(t,{children:"a \\not\\equiv 0 \\pmod p"}),":"]}),e.jsx(f,{children:"a^{p-1} \\equiv 1 \\pmod p"}),e.jsx("p",{className:"mt-2",children:"This gives us a formula for the inverse:"}),e.jsx(f,{children:"a^{-1} \\equiv a^{p-2} \\pmod p"})]}),e.jsxs(N,{title:"Finding Inverses mod 7",children:[e.jsxs("p",{children:["To find ",e.jsxs(t,{children:["3^","{-1}"," \\mod 7"]}),":"]}),e.jsx("p",{className:"mt-2",children:e.jsxs(t,{children:["3^","{-1}"," \\equiv 3^","{7-2}"," = 3^5 = 243 \\equiv 5 \\pmod 7"]})}),e.jsxs("p",{className:"mt-2",children:["Verify: ",e.jsx(t,{children:"3 \\times 5 = 15 \\equiv 1 \\pmod 7"})," ‚úì"]})]}),e.jsxs("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:["The Finite Field ",e.jsxs(t,{children:["\\mathbb","{Z}","_p"]})]}),e.jsxs(q,{title:"Prime Field",children:[e.jsxs("p",{children:["When ",e.jsx(t,{children:"p"})," is prime, the integers"," ",e.jsx(t,{children:"\\{0, 1, 2, \\ldots, p-1\\}"})," with modular arithmetic form a ",e.jsx("strong",{children:"finite field"})," denoted ",e.jsxs(t,{children:["\\mathbb","{Z}","_p"]}),"."]}),e.jsx("p",{className:"mt-2",children:"Every non-zero element has a multiplicative inverse‚Äîthis is what makes it a field."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Elliptic Curves Over Finite Fields"}),e.jsxs("p",{className:"mb-4",children:["Now we can define elliptic curves over ",e.jsxs(t,{children:["\\mathbb","{Z}","_p"]}),":"]}),e.jsx(f,{children:"y^2 \\equiv x^3 + 7 \\pmod p"}),e.jsxs("p",{className:"mb-4",children:["The curve is no longer a smooth shape‚Äîit's a ",e.jsx("strong",{children:"scattered set of points"}),". But the point addition formulas work exactly the same (just mod ",e.jsx(t,{children:"p"}),")."]}),e.jsx(O,{className:"my-8"}),e.jsxs(N,{title:"Curve mod 17",children:[e.jsxs("p",{children:["Consider ",e.jsxs(t,{children:["y^2 \\equiv x^3 + 7 \\pmod","{17}"]}),"."]}),e.jsxs("p",{className:"mt-2",children:["Let's find points with ",e.jsx(t,{children:"x = 5"}),":"]}),e.jsx("div",{className:"mt-2 space-y-1 text-sm font-mono",children:e.jsx("p",{children:e.jsxs(t,{children:["y^2 \\equiv 5^3 + 7 = 125 + 7 = 132 \\equiv 13 \\pmod","{17}"]})})}),e.jsxs("p",{className:"mt-2",children:["Is 13 a perfect square mod 17? We need ",e.jsx(t,{children:"y"})," where"," ",e.jsxs(t,{children:["y^2 \\equiv 13 \\pmod","{17}"]}),"."]}),e.jsxs("p",{className:"mt-2",children:["Checking: ",e.jsxs(t,{children:["8^2 = 64 \\equiv 13 \\pmod","{17}"]})," ‚úì"]}),e.jsxs("p",{className:"mt-2",children:["So ",e.jsx(t,{children:"(5, 8)"})," and ",e.jsx(t,{children:"(5, -8) = (5, 9)"})," are on the curve."]})]}),e.jsxs(N,{title:"Point Addition mod 17",children:[e.jsxs("p",{children:["Let ",e.jsx(t,{children:"P = (5, 8)"})," and ",e.jsx(t,{children:"Q = (6, 3)"})," on"," ",e.jsxs(t,{children:["y^2 \\equiv x^3 + 7 \\pmod","{17}"]}),"."]}),e.jsxs("div",{className:"mt-3 space-y-2 font-mono text-sm",children:[e.jsx("p",{children:e.jsxs(t,{children:["\\lambda = (3 - 8) \\cdot (6 - 5)^","{-1}"," \\mod 17"]})}),e.jsx("p",{children:e.jsxs(t,{children:["= (-5) \\cdot 1^","{-1}"," = -5 \\equiv 12 \\pmod","{17}"]})}),e.jsx("p",{children:e.jsxs(t,{children:["x_3 = 12^2 - 5 - 6 = 144 - 11 = 133 \\equiv 14 \\pmod","{17}"]})}),e.jsx("p",{children:e.jsxs(t,{children:["y_3 = 12(5 - 14) - 8 = 12(-9) - 8 = -116 \\equiv 3 \\pmod","{17}"]})})]}),e.jsxs("p",{className:"mt-3",children:["So ",e.jsx(t,{children:"P + Q = (14, 3)"}),"."]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why This Is Perfect for Cryptography"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Exact Arithmetic"}),e.jsx("p",{className:"text-sm text-dark-300",children:"No rounding errors‚Äîoperations are perfectly reproducible."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Fixed Size"}),e.jsx("p",{className:"text-sm text-dark-300",children:"All values fit in a known number of bits (256 for secp256k1)."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Uniform Sampling"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Can generate truly random field elements (important for keys)."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"ECDLP Still Hard"}),e.jsx("p",{className:"text-sm text-dark-300",children:"The discrete log problem remains computationally infeasible."})]})]}),e.jsx(A,{type:"success",title:"Ready for secp256k1",children:e.jsx("p",{children:"Now we have all the tools: elliptic curves + finite fields. Next, we'll see the specific parameters that define Bitcoin's curve."})})]})}export{J as default};
