import{j as e,A as b,m as l}from"./vendor-animation-0o8UKZ_1.js";import{r as c}from"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-AFVnRdFv.js";import{L as f}from"./LessonLayout-DKGN2TA5.js";import{I as r,M as d}from"./MathBlock-uz1iP4cD.js";import{D as a,E as o,C as m}from"./Callout-4_WMx_B8.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-B3IzoTDS.js";function N({className:x=""}){const[i,h]=c.useState("signing"),[p,n]=c.useState(null),u={ecdsa:{title:"ECDSA",steps:[{step:"1",formula:"z = H(m)",desc:"Hash message"},{step:"2",formula:"k ← random",desc:"Generate nonce"},{step:"3",formula:"R = kG",desc:"Compute nonce point"},{step:"4",formula:"r = x(R) mod n",desc:"Extract x-coordinate"},{step:"5",formula:"s = k⁻¹(z + rd) mod n",desc:"Compute s value"},{step:"6",formula:"return (r, s)",desc:"Output signature"}]},schnorr:{title:"Schnorr",steps:[{step:"1",formula:"k ← random",desc:"Generate nonce"},{step:"2",formula:"R = kG",desc:"Compute nonce point"},{step:"3",formula:"e = H(R || P || m)",desc:"Hash commitment"},{step:"4",formula:"s = k + ed",desc:"Compute s value"},{step:"5",formula:"return (R, s)",desc:"Output signature"}]}},j={ecdsa:{title:"ECDSA",steps:[{step:"1",formula:"u₁ = zs⁻¹ mod n",desc:"Compute u₁"},{step:"2",formula:"u₂ = rs⁻¹ mod n",desc:"Compute u₂"},{step:"3",formula:"P = u₁G + u₂Q",desc:"EC point ops (2 scalar mults)"},{step:"4",formula:"verify x(P) = r",desc:"Check x-coordinate"}]},schnorr:{title:"Schnorr",steps:[{step:"1",formula:"e = H(R || P || m)",desc:"Recompute hash"},{step:"2",formula:"verify sG = R + eP",desc:"Single equation check"}]}},g=[{id:"simplicity",title:"Simplicity",ecdsa:"Complex formula with modular inverse",schnorr:"Simple linear combination: s = k + ed",winner:"schnorr"},{id:"provable",title:"Provable Security",ecdsa:'Security proof requires "forking lemma"',schnorr:"Direct reduction to discrete log",winner:"schnorr"},{id:"linearity",title:"Linearity",ecdsa:"Non-linear → no native aggregation",schnorr:"Linear → signatures can be added!",winner:"schnorr"},{id:"batch",title:"Batch Verification",ecdsa:"Must verify each signature separately",schnorr:"Verify n signatures faster than n× single",winner:"schnorr"},{id:"malleability",title:"Malleability",ecdsa:"Signatures can be modified (s → n-s)",schnorr:"No malleability with proper encoding",winner:"schnorr"},{id:"patent",title:"Patent Status",ecdsa:"Always patent-free",schnorr:"Patent expired 2008",winner:"tie"}],t=i==="signing"?u:j;return e.jsxs("div",{className:`p-6 rounded-2xl bg-dark-800/50 border border-dark-700/50 ${x}`,children:[e.jsx("h3",{className:"text-xl font-bold text-dark-100 mb-2",children:"ECDSA vs Schnorr"}),e.jsx("p",{className:"text-dark-400 text-sm mb-4",children:"Compare the two signature schemes side-by-side. Schnorr was adopted in Bitcoin via BIP 340."}),e.jsx("div",{className:"flex gap-2 mb-6",children:[{id:"signing",label:"Signing"},{id:"verification",label:"Verification"},{id:"features",label:"Features"}].map(s=>e.jsx("button",{onClick:()=>h(s.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${i===s.id?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-dark-700 text-dark-400 border border-dark-600 hover:bg-dark-600"}`,children:s.label},s.id))}),e.jsx(b,{mode:"wait",children:i!=="features"?e.jsxs(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-xl bg-blue-500/5 border border-blue-500/20 p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-400 mb-4",children:t.ecdsa.title}),e.jsx("div",{className:"space-y-3",children:t.ecdsa.steps.map(s=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:"w-6 h-6 rounded bg-blue-500/20 text-blue-400 flex items-center justify-center text-xs",children:s.step}),e.jsxs("div",{children:[e.jsx("p",{className:"font-mono text-sm text-blue-300",children:s.formula}),e.jsx("p",{className:"text-xs text-dark-500",children:s.desc})]})]},s.step))}),e.jsx("div",{className:"mt-4 pt-4 border-t border-blue-500/20",children:e.jsxs("p",{className:"text-dark-500 text-xs",children:["Steps: ",t.ecdsa.steps.length]})})]}),e.jsxs("div",{className:"rounded-xl bg-amber-500/5 border border-amber-500/20 p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-amber-400 mb-4",children:t.schnorr.title}),e.jsx("div",{className:"space-y-3",children:t.schnorr.steps.map(s=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:"w-6 h-6 rounded bg-amber-500/20 text-amber-400 flex items-center justify-center text-xs",children:s.step}),e.jsxs("div",{children:[e.jsx("p",{className:"font-mono text-sm text-amber-300",children:s.formula}),e.jsx("p",{className:"text-xs text-dark-500",children:s.desc})]})]},s.step))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-amber-500/20 flex justify-between items-center",children:[e.jsxs("p",{className:"text-dark-500 text-xs",children:["Steps: ",t.schnorr.steps.length]}),e.jsx("span",{className:"px-2 py-0.5 rounded bg-emerald-500/20 text-emerald-400 text-xs",children:"Simpler!"})]})]})]},i):e.jsx(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-3",children:g.map(s=>e.jsx("div",{className:`rounded-xl border transition-colors cursor-pointer ${p===s.id?"bg-dark-700/50 border-dark-500/50":"bg-dark-700/20 border-dark-600/30 hover:bg-dark-700/30"}`,onMouseEnter:()=>n(s.id),onMouseLeave:()=>n(null),children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-dark-200",children:s.title}),s.winner!=="tie"&&e.jsxs("span",{className:`px-2 py-0.5 rounded text-xs ${s.winner==="schnorr"?"bg-amber-500/20 text-amber-400":"bg-blue-500/20 text-blue-400"}`,children:[s.winner==="schnorr"?"Schnorr":"ECDSA"," wins"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-400 mb-1",children:"ECDSA"}),e.jsx("p",{className:"text-sm text-dark-400",children:s.ecdsa})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-amber-400 mb-1",children:"Schnorr"}),e.jsx("p",{className:"text-sm text-dark-400",children:s.schnorr})]})]})]})},s.id))},"features")}),e.jsxs("div",{className:"mt-6 p-4 rounded-xl bg-purple-500/10 border border-purple-500/20",children:[e.jsx("h4",{className:"text-purple-400 font-semibold mb-2",children:"Schnorr Enables MuSig"}),e.jsx("p",{className:"text-dark-400 text-sm mb-3",children:"Because Schnorr signatures are linear (s = k + ed), multiple parties can create a combined signature that looks like a single signature:"}),e.jsxs("div",{className:"p-3 rounded-lg bg-dark-800/50 font-mono text-sm",children:[e.jsxs("p",{className:"text-purple-300",children:["P",e.jsx("sub",{children:"agg"})," = P",e.jsx("sub",{children:"1"})," + P",e.jsx("sub",{children:"2"})," + P",e.jsx("sub",{children:"3"})]}),e.jsxs("p",{className:"text-purple-300 mt-1",children:["s",e.jsx("sub",{children:"agg"})," = s",e.jsx("sub",{children:"1"})," + s",e.jsx("sub",{children:"2"})," + s",e.jsx("sub",{children:"3"})]})]}),e.jsx("p",{className:"text-dark-500 text-xs mt-2",children:"Result: 3-of-3 multisig that's indistinguishable from a single-sig (same size, same verification cost, better privacy)."})]}),e.jsx("div",{className:"mt-4 p-3 rounded-xl bg-dark-700/30",children:e.jsxs("p",{className:"text-dark-500 text-sm",children:[e.jsx("strong",{className:"text-dark-300",children:"Taproot (Nov 2021):"})," Bitcoin adopted Schnorr via BIP 340/341/342. All Taproot outputs use Schnorr signatures, enabling better privacy and cheaper multisig."]})})]})}function B(){return e.jsxs(f,{sectionId:6,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Schnorr Signatures"}),e.jsx("p",{className:"mb-4",children:"Schnorr signatures, invented by Claus Schnorr in 1989, are simpler, more efficient, and enable powerful features like signature aggregation. Bitcoin activated Schnorr support with Taproot in November 2021."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why Not ECDSA?"}),e.jsx("p",{className:"mb-4",children:"ECDSA was chosen for Bitcoin because Schnorr was patented until 2008. But ECDSA has limitations:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Complex formulas:"})," Verification requires computing inverses"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"No aggregation:"})," Cannot combine multiple signatures into one"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Malleability:"})," Both ",e.jsx(r,{children:"(r, s)"})," and ",e.jsx(r,{children:"(r, -s)"})," valid"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Harder proofs:"})," Security proofs are more complex"]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Schnorr Signing Algorithm"}),e.jsxs(a,{title:"Schnorr Signature (BIP 340)",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Input:"})," Message ",e.jsx(r,{children:"m"}),", private key ",e.jsx(r,{children:"d"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 mt-3 font-mono text-sm",children:[e.jsxs("p",{children:["1: ",e.jsxs(r,{children:["k \\leftarrow H(\\text","{aux}"," || d || m)"]})," (deterministic nonce)"]}),e.jsxs("p",{children:["2: ",e.jsx(r,{children:"R = kG"})]}),e.jsxs("p",{children:["3: ",e.jsx(r,{children:"e = H(R || Q || m)"})," (challenge)"]}),e.jsxs("p",{children:["4: ",e.jsx(r,{children:"s = k + ed \\mod n"})]}),e.jsxs("p",{children:["5: Return ",e.jsx(r,{children:"(R, s)"})]})]})]}),e.jsxs(a,{title:"Schnorr Verification",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Input:"})," Message ",e.jsx(r,{children:"m"}),", signature ",e.jsx(r,{children:"(R, s)"}),", public key ",e.jsx(r,{children:"Q"})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 mt-3 font-mono text-sm",children:[e.jsxs("p",{children:["1: ",e.jsx(r,{children:"e = H(R || Q || m)"})]}),e.jsxs("p",{children:["2: Accept if ",e.jsx(r,{children:"sG = R + eQ"})]})]})]}),e.jsx(o,{title:"Why Verification Works",children:e.jsx(d,{children:"sG = (k + ed)G = kG + edG = R + eQ \\quad \\checkmark"})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Schnorr vs ECDSA"}),e.jsx(N,{className:"my-8"}),e.jsx("div",{className:"overflow-x-auto mb-6",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"pb-2",children:"Property"}),e.jsx("th",{className:"pb-2",children:"ECDSA"}),e.jsx("th",{className:"pb-2",children:"Schnorr"})]})}),e.jsxs("tbody",{className:"text-dark-300",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"Signature size"}),e.jsx("td",{children:"64 bytes"}),e.jsx("td",{className:"text-emerald-400",children:"64 bytes"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"Sign formula"}),e.jsx("td",{children:e.jsxs(r,{children:["s = k^","{-1}","(z + rd)"]})}),e.jsx("td",{className:"text-emerald-400",children:e.jsx(r,{children:"s = k + ed"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"Verify"}),e.jsx("td",{children:"2 scalar mults + inverse"}),e.jsx("td",{className:"text-emerald-400",children:"2 scalar mults"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"Aggregation"}),e.jsx("td",{className:"text-rose-400",children:"Not possible"}),e.jsx("td",{className:"text-emerald-400",children:"Yes (MuSig)"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"Batch verify"}),e.jsx("td",{className:"text-rose-400",children:"Not efficient"}),e.jsx("td",{className:"text-emerald-400",children:"~2x speedup"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"Provably secure"}),e.jsx("td",{children:"Harder proof"}),e.jsx("td",{className:"text-emerald-400",children:"Simple proof"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"MuSig: Signature Aggregation"}),e.jsxs("p",{className:"mb-4",children:["Schnorr's most powerful feature: ",e.jsx("strong",{children:"multiple signers can produce a single signature"})," ","that's indistinguishable from a regular signature."]}),e.jsxs(a,{title:"MuSig Protocol (Simplified)",children:[e.jsx("p",{children:"Three parties (Alice, Bob, Carol) want to create a 3-of-3 multisig:"}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 mt-3 font-mono text-sm space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"Key Aggregation:"})}),e.jsx("p",{children:e.jsx(r,{children:"Q = a_A Q_A + a_B Q_B + a_C Q_C"})}),e.jsx("p",{className:"text-dark-400",children:"(weighted sum of public keys)"}),e.jsx("p",{className:"mt-3",children:e.jsx("strong",{children:"Signing:"})}),e.jsxs("p",{children:["1: Each party commits to a nonce ",e.jsx(r,{children:"R_i"})]}),e.jsxs("p",{children:["2: Aggregate: ",e.jsx(r,{children:"R = R_A + R_B + R_C"})]}),e.jsxs("p",{children:["3: Each computes partial signature ",e.jsx(r,{children:"s_i"})]}),e.jsxs("p",{children:["4: Aggregate: ",e.jsx(r,{children:"s = s_A + s_B + s_C"})]}),e.jsxs("p",{className:"mt-3",children:[e.jsx("strong",{children:"Result:"})," Single signature ",e.jsx(r,{children:"(R, s)"})]})]})]}),e.jsx(m,{type:"success",title:"Privacy Benefit",children:e.jsx("p",{children:"The aggregated signature looks exactly like a single-party signature. On-chain, no one can tell it's multisig. This is a massive privacy improvement over Bitcoin's old multisig (which exposed all public keys)."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Batch Verification"}),e.jsx("p",{className:"mb-4",children:"When verifying many Schnorr signatures at once, we can batch them:"}),e.jsx(d,{children:"\\sum_i r_i s_i G = \\sum_i r_i R_i + \\sum_i r_i e_i Q_i"}),e.jsxs("p",{className:"mb-4",children:["Where ",e.jsx(r,{children:"r_i"})," are random weights. This combines all verifications into a single multi-scalar multiplication, giving roughly ",e.jsx("strong",{children:"2x speedup"})," ","for large batches."]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Taproot Integration"}),e.jsx("p",{className:"mb-4",children:"Bitcoin's Taproot upgrade (BIP 340/341/342, activated November 2021) uses Schnorr with:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"x-only public keys:"})," 32 bytes instead of 33 (drop y-parity prefix)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Key-path spending:"})," Simple signature reveals nothing about scripts"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Script-path spending:"})," Reveal script only when needed"]})]}),e.jsxs(o,{title:"Taproot Address",children:[e.jsx("p",{children:"A Taproot address can be spent two ways:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Key path:"})," Just sign with Schnorr (looks like single-sig)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Script path:"})," Reveal hidden script (multisig, timelocks, etc.)"]})]}),e.jsx("p",{className:"mt-2 text-dark-400",children:"The common case (key path) is maximally efficient and private. Complex scripts are hidden unless needed."})]}),e.jsx(m,{type:"info",title:"Adoption",children:e.jsx("p",{children:"As of 2024, Taproot addresses represent a growing percentage of Bitcoin transactions. Exchanges, wallets, and services are progressively adopting Schnorr signatures."})})]})}export{B as default};
