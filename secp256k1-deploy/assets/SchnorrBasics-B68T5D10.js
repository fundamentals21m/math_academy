import{j as e}from"./vendor-animation-0o8UKZ_1.js";import"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-AFVnRdFv.js";import{T as n}from"./TranscriptLayout-f11_Q2qn.js";import{I as s,M as t}from"./MathBlock-uz1iP4cD.js";import{C as r,D as i,E as a}from"./Callout-4_WMx_B8.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./transcripts-oW5P3wnc.js";function u(){return e.jsxs(n,{transcriptId:"schnorr-basics",children:[e.jsx(r,{type:"success",title:"Key Takeaways",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"Schnorr signatures are simpler and more efficient than ECDSA"}),e.jsx("li",{children:"Linear signature structure enables key aggregation (MuSig)"}),e.jsx("li",{children:"Batch verification provides significant speedups for node validation"}),e.jsx("li",{children:"BIP340 defines Bitcoin's specific Schnorr implementation"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why Schnorr?"}),e.jsx("p",{className:"mb-4",children:"Pieter Wuille opens with the historical context of Schnorr signatures and why Bitcoin initially used ECDSA instead:"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:'"Schnorr signatures were patented until 2008. By the time Bitcoin launched in 2009, ECDSA was the established standard with extensive testing and deployment. But mathematically, Schnorr is the more elegant choice."'}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Pieter Wuille"})]}),e.jsxs(i,{title:"Schnorr Signature Scheme",children:[e.jsxs("p",{children:["A Schnorr signature on message ",e.jsx(s,{children:"m"})," with private key"," ",e.jsx(s,{children:"d"})," and public key ",e.jsx(s,{children:"P = dG"}),":"]}),e.jsxs("ol",{className:"list-decimal list-inside mt-3 space-y-2",children:[e.jsxs("li",{children:["Choose random nonce ",e.jsx(s,{children:"k"}),", compute ",e.jsx(s,{children:"R = kG"})]}),e.jsxs("li",{children:["Compute challenge ",e.jsx(s,{children:"e = H(R \\| P \\| m)"})]}),e.jsxs("li",{children:["Compute ",e.jsx(s,{children:"s = k + ed"})]}),e.jsxs("li",{children:["Signature is ",e.jsx(s,{children:"(R, s)"})]})]}),e.jsxs("p",{className:"mt-3",children:["Verification: check that ",e.jsx(s,{children:"sG = R + eP"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Schnorr vs ECDSA"}),e.jsxs(a,{title:"Comparing Signature Schemes",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b border-dark-700",children:[e.jsx("th",{className:"pb-2",children:"Property"}),e.jsx("th",{className:"pb-2",children:"ECDSA"}),e.jsx("th",{className:"pb-2",children:"Schnorr"})]})}),e.jsxs("tbody",{className:"text-dark-300",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-2",children:"Provable Security"}),e.jsx("td",{children:"No proof*"}),e.jsx("td",{className:"text-cyan-400",children:"Proven secure (ROM)"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-2",children:"Key Aggregation"}),e.jsx("td",{children:"Complex"}),e.jsx("td",{className:"text-cyan-400",children:"Natural (linear)"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-2",children:"Batch Verification"}),e.jsx("td",{children:"No"}),e.jsx("td",{className:"text-cyan-400",children:"Yes (~2x speedup)"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-2",children:"Signature Size"}),e.jsx("td",{children:"71-72 bytes"}),e.jsx("td",{className:"text-cyan-400",children:"64 bytes"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"Malleability"}),e.jsx("td",{children:"Malleable"}),e.jsx("td",{className:"text-cyan-400",children:"Non-malleable"})]})]})]}),e.jsx("p",{className:"mt-3 text-dark-400 text-xs",children:"*ECDSA security relies on assumptions but lacks a formal proof in standard models."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Linearity Advantage"}),e.jsxs("p",{className:"mb-4",children:["The key insight is that Schnorr signatures have a ",e.jsx("strong",{children:"linear structure"}),". Pieter explains why this matters:"]}),e.jsxs(i,{title:"Signature Linearity",children:[e.jsxs("p",{children:["For Schnorr signatures with the same ",e.jsx(s,{children:"R"}),":"]}),e.jsx(t,{children:"(s_1 + s_2)G = (k_1 + k_2)G + e(d_1 + d_2)G"}),e.jsxs("p",{className:"mt-2",children:["This means you can ",e.jsx("em",{children:"add signatures together"})," and get a valid signature for the sum of the keys. ECDSA's structure (involving modular inverse) prevents this."]})]}),e.jsx("p",{className:"mb-4",children:"This linearity enables powerful applications:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Multi-Signatures"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Multiple parties can create a single signature indistinguishable from a regular one. On-chain, this looks like a single-key spend, preserving privacy."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Adaptor Signatures"}),e.jsx("p",{className:"text-sm text-dark-300",children:'"Incomplete" signatures that can be completed by revealing a secret. Enables atomic swaps without hash time-locks.'})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Threshold Signatures"}),e.jsx("p",{className:"text-sm text-dark-300",children:"t-of-n signing where any t participants can sign, but fewer cannot. No special script needed."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Blind Signatures"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Signer can sign a message without knowing its content. Useful for privacy protocols."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Batch Verification"}),e.jsx("p",{className:"mb-4",children:"One of the most practical benefits for Bitcoin nodes is batch verification:"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:'"Instead of verifying n signatures individually with n point multiplications, we can batch them into roughly one verification. For a block with 2000 signatures, this is close to a 2x speedup in validation time."'}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Pieter Wuille"})]}),e.jsxs(i,{title:"Batch Verification",children:[e.jsxs("p",{children:["To verify ",e.jsx(s,{children:"n"})," signatures"," ",e.jsx(s,{children:"(R_1, s_1), ..., (R_n, s_n)"})," on messages"," ",e.jsx(s,{children:"m_1, ..., m_n"})," with public keys ",e.jsx(s,{children:"P_1, ..., P_n"}),":"]}),e.jsxs("ol",{className:"list-decimal list-inside mt-3 space-y-2",children:[e.jsxs("li",{children:["Choose random weights ",e.jsx(s,{children:"a_1, ..., a_n"})]}),e.jsxs("li",{children:["Compute ",e.jsx(s,{children:"\\sum a_i s_i G = \\sum a_i R_i + \\sum a_i e_i P_i"})]})]}),e.jsxs("p",{className:"mt-3",children:["If any signature is invalid, the equation fails with overwhelming probability. This requires one multi-scalar multiplication instead of ",e.jsx(s,{children:"n"})," separate ones."]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"BIP340 Design Choices"}),e.jsx("p",{className:"mb-4",children:"Pieter discusses the specific choices made for Bitcoin's Schnorr implementation:"}),e.jsx(a,{title:"BIP340 Key Decisions",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-dark-100",children:"32-byte Public Keys (x-only)"}),e.jsx("p",{className:"text-sm text-dark-300 mt-1",children:"Only store the x-coordinate. The y-coordinate is implicitly the even one, saving 1 byte per pubkey and simplifying key aggregation."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-dark-100",children:"Tagged Hashes"}),e.jsxs("p",{className:"text-sm text-dark-300 mt-1",children:[e.jsx("code",{className:"text-cyan-400",children:"H(tag || tag || data)"})," prevents cross-protocol attacks where a hash from one context is reused in another."]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-dark-100",children:"Nonce Commitment in Challenge"}),e.jsxs("p",{className:"text-sm text-dark-300 mt-1",children:["Challenge hash includes ",e.jsx(s,{children:"R"}),", ",e.jsx(s,{children:"P"}),", and ",e.jsx(s,{children:"m"}),"—stronger than textbook Schnorr which omits"," ",e.jsx(s,{children:"P"}),"."]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-dark-100",children:"No Signature Encoding Flexibility"}),e.jsx("p",{className:"text-sm text-dark-300 mt-1",children:"Unlike ECDSA's DER encoding, Schnorr signatures are always exactly 64 bytes. This eliminates malleability vectors."})]})]})}),e.jsxs(r,{type:"warning",title:"Security Considerations",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nonce reuse is fatal."})," If the same ",e.jsx(s,{children:"k"})," is used twice with different messages, the private key can be computed:"]}),e.jsx(t,{children:"d = \\frac{s_1 - s_2}{e_1 - e_2}"}),e.jsx("p",{className:"mt-2",children:"BIP340 mandates deterministic nonce generation using RFC 6979 style derivation from the private key and message."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Related Course Sections"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("a",{href:"#/section/8",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 8: Schnorr Signatures"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Deep dive into the mathematics"})]}),e.jsxs("a",{href:"#/section/6",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 6: ECDSA Signing"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Compare with the original scheme"})]})]})]})}export{u as default};
