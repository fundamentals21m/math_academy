import{j as e}from"./vendor-animation-0o8UKZ_1.js";import"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-ySuSmSID.js";import{T as r}from"./TranscriptLayout-CoUsWXbX.js";import{I as s}from"./MathBlock-uz1iP4cD.js";import{C as i,D as t,E as a}from"./Callout-4_WMx_B8.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./transcripts-Bj1VzTa0.js";function u(){return e.jsxs(r,{transcriptId:"libsec-panel",children:[e.jsx(i,{type:"success",title:"Key Takeaways",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"libsecp256k1 was created because OpenSSL had security vulnerabilities and performance issues"}),e.jsx("li",{children:"The library achieves constant-time operations to prevent timing side-channel attacks"}),e.jsx("li",{children:"Extensive testing includes differential fuzzing against other implementations"}),e.jsx("li",{children:"The codebase prioritizes auditability and formal verification potential"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why libsecp256k1 Exists"}),e.jsxs("p",{className:"mb-4",children:["The panel opens with a discussion of ",e.jsx("strong",{children:"why Bitcoin needed its own cryptographic library"}),"instead of using OpenSSL. Tim Ruffing explains the historical context:"]}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:'"OpenSSL was designed for TLS, not for cryptocurrency. It optimizes for average case performance, but Bitcoin needs consistent, constant-time operations. A single timing leak could reveal a private key."'}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Tim Ruffing"})]}),e.jsxs(t,{title:"Constant-Time Operations",children:[e.jsxs("p",{children:["A cryptographic implementation is ",e.jsx("strong",{children:"constant-time"})," when its execution time doesn't depend on secret values. This prevents ",e.jsx("em",{children:"timing side-channel attacks"})," where an attacker measures how long operations take to infer secret information."]}),e.jsx("p",{className:"mt-2",children:"For example, a naive implementation might return early when comparing signatures:"}),e.jsx("pre",{className:"mt-2 p-3 bg-dark-800 rounded-lg text-sm overflow-x-auto",children:`// VULNERABLE: Returns early on mismatch
for (int i = 0; i < 32; i++) {
    if (a[i] != b[i]) return false;  // Timing leak!
}
return true;`}),e.jsx("p",{className:"mt-2",children:"libsecp256k1 always takes the same time regardless of input values."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The OpenSSL Vulnerabilities"}),e.jsx("p",{className:"mb-4",children:"Jonas Nick details specific issues with OpenSSL that motivated the new library:"}),e.jsx(a,{title:"OpenSSL Issues That Affected Bitcoin",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"CVE-2014-3570:"})," BN_sqr function could produce incorrect results, potentially allowing signature forgery"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Non-constant-time scalar multiplication:"})," Branch instructions based on secret key bits leaked timing information"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Memory allocation patterns:"})," Dynamic memory use created observable side channels"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Complex codebase:"})," 500k+ lines made auditing nearly impossible"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Design Philosophy"}),e.jsx("p",{className:"mb-4",children:"Lloyd Fournier discusses the library's core design principles:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Simplicity"}),e.jsx("p",{className:"text-sm text-dark-300",children:"~15,000 lines of focused code vs OpenSSL's 500k+. Every line can be audited and reasoned about."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"No Dynamic Allocation"}),e.jsx("p",{className:"text-sm text-dark-300",children:"All memory is stack-allocated or provided by caller. Eliminates allocation-based side channels."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Constant-Time Everywhere"}),e.jsx("p",{className:"text-sm text-dark-300",children:"All secret-dependent operations run in constant time, verified through specialized tooling."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Formal Methods Ready"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Code structure allows for formal verification of critical properties."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Testing Infrastructure"}),e.jsx("p",{className:"mb-4",children:"Jesse Posner explains the library's comprehensive testing approach:"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:`"We differential fuzz against multiple independent implementations. If our ECDSA produces different results than reference implementations on any input, that's immediately flagged. We've found bugs in other libraries this way."`}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Jesse Posner"})]}),e.jsxs(t,{title:"Differential Fuzzing",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Differential fuzzing"})," runs the same random inputs through multiple implementations and compares outputs. Discrepancies indicate bugs in at least one implementation."]}),e.jsx("p",{className:"mt-2",children:"libsecp256k1 uses this against:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"OpenSSL's EC implementation"}),e.jsx("li",{children:"Python's ecdsa library"}),e.jsx("li",{children:"Reference test vectors from SEC standards"}),e.jsx("li",{children:"Historical Bitcoin transactions (consensus compatibility)"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Performance Optimizations"}),e.jsxs("p",{className:"mb-4",children:["Tim Ruffing discusses how the library achieves both security ",e.jsx("em",{children:"and"})," performance:"]}),e.jsx(a,{title:"Key Optimizations in libsecp256k1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-dark-100",children:"Endomorphism Optimization"}),e.jsxs("p",{className:"text-sm text-dark-300 mt-1",children:["secp256k1 has an efficiently computable endomorphism ",e.jsx(s,{children:"\\lambda"})," where"," ",e.jsx(s,{children:"\\lambda^2 + \\lambda + 1 \\equiv 0 \\pmod{n}"}),". This allows splitting scalar multiplication, achieving ~20% speedup."]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-dark-100",children:"GLV Method"}),e.jsxs("p",{className:"text-sm text-dark-300 mt-1",children:["Uses the Gallant-Lambert-Vanstone method to decompose"," ",e.jsx(s,{children:"kP"})," into"," ",e.jsx(s,{children:"k_1 P + k_2 \\lambda(P)"})," where"," ",e.jsx(s,{children:"k_1, k_2"})," are half the bit-length of ",e.jsx(s,{children:"k"}),"."]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-dark-100",children:"Precomputed Tables"}),e.jsxs("p",{className:"text-sm text-dark-300 mt-1",children:["Generator point multiples are precomputed at compile time, making"," ",e.jsx(s,{children:"kG"})," (key generation) extremely fast."]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Side-Channel Resistance"}),e.jsx("p",{className:"mb-4",children:"Jonas Nick provides a deep dive into side-channel attack prevention:"}),e.jsx(i,{type:"warning",title:"Types of Side-Channel Attacks",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Timing attacks:"})," Measuring operation duration"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cache attacks:"})," Observing memory access patterns"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Power analysis:"})," Measuring CPU power consumption"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Branch prediction:"})," Exploiting CPU speculative execution"]})]})}),e.jsx("p",{className:"mb-4",children:"libsecp256k1's mitigations include:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"No secret-dependent branches:"})," Uses conditional moves (CMOV) instead of if/else on secrets"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fixed memory access patterns:"})," All table lookups access every element, using masks to select the correct one"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Randomized projective coordinates:"})," Point representation is randomized to prevent DPA attacks"]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The MuSig Module"}),e.jsx("p",{className:"mb-4",children:"Lloyd Fournier discusses the newer MuSig support in the library:"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:`"MuSig2 is now part of libsecp256k1-zkp. It's been designed with the same security principles—constant-time, no dynamic allocation, formally verified nonce generation. The hardest part was getting nonce handling right without sacrificing usability."`}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Lloyd Fournier"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Future Directions"}),e.jsx("p",{className:"mb-4",children:"The panel concludes with discussion of upcoming developments:"}),e.jsxs("div",{className:"bg-dark-800/50 rounded-lg p-6 border border-dark-700/50",children:[e.jsx("h4",{className:"text-lg font-semibold text-dark-100 mb-4",children:"Roadmap Items"}),e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 text-sm",children:"1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"FROST Support"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Threshold signatures for multisig wallets"})]})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 text-sm",children:"2"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Batch Verification"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Verify many signatures faster than individually"})]})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 text-sm",children:"3"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Adaptor Signatures"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Enabling scriptless scripts and atomic swaps"})]})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-cyan-400 text-sm",children:"4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Formal Verification"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Mathematically proving correctness of critical paths"})]})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Related Course Sections"}),e.jsx("p",{className:"mb-4",children:"Explore these course sections to deepen your understanding of the concepts discussed:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("a",{href:"#/section/0",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 0: The Big Picture"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Introduction to secp256k1 and elliptic curves"})]}),e.jsxs("a",{href:"#/section/3",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 3: Finite Fields"}),e.jsx("p",{className:"text-sm text-dark-500",children:"The mathematical foundation of the curve"})]}),e.jsxs("a",{href:"#/section/6",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 6: ECDSA Signing"}),e.jsx("p",{className:"text-sm text-dark-500",children:"How digital signatures actually work"})]}),e.jsxs("a",{href:"#/section/8",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 8: Schnorr Signatures"}),e.jsx("p",{className:"text-sm text-dark-500",children:"The modern alternative to ECDSA"})]})]})]})}export{u as default};
