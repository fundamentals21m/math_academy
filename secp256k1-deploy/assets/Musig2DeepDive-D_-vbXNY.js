import{j as e}from"./vendor-animation-0o8UKZ_1.js";import"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-Bs7GvgJx.js";import{T as a}from"./TranscriptLayout-BlPQ7usn.js";import{I as s,M as n}from"./MathBlock-uz1iP4cD.js";import{C as r,E as t,D as i}from"./Callout-4_WMx_B8.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./transcripts-Bk5EipTb.js";function g(){return e.jsxs(a,{transcriptId:"musig2-deep-dive",children:[e.jsx(r,{type:"success",title:"Key Takeaways",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"MuSig2 reduces signing rounds from 3 to 2 compared to MuSig1"}),e.jsx("li",{children:"Uses multiple nonces per signer to prevent Wagner's attack without commitments"}),e.jsx("li",{children:"Nonces can be pre-shared, enabling non-interactive signing flows"}),e.jsx("li",{children:"Security proof in the algebraic group model"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Two-Round Breakthrough"}),e.jsx("p",{className:"mb-4",children:"Jonas Nick explains why reducing from 3 rounds to 2 rounds matters so much:"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:'"Three rounds is painful for real applications. Hardware wallets, cold storage, geographically distributed signers—every round adds latency and complexity. Two rounds is qualitatively different: you can pre-share the first round."'}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Jonas Nick"})]}),e.jsx(t,{title:"Round Comparison",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-dark-100 mb-2",children:"MuSig1 (3 rounds)"}),e.jsxs("ol",{className:"list-decimal list-inside text-sm space-y-1 text-dark-300",children:[e.jsx("li",{children:"Commit to nonce hash"}),e.jsx("li",{children:"Reveal nonce"}),e.jsx("li",{children:"Exchange signature shares"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-cyan-400 mb-2",children:"MuSig2 (2 rounds)"}),e.jsxs("ol",{className:"list-decimal list-inside text-sm space-y-1 text-dark-300",children:[e.jsx("li",{children:"Exchange nonces (can be pre-shared!)"}),e.jsx("li",{children:"Exchange signature shares"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why MuSig1 Needs Three Rounds"}),e.jsx("p",{className:"mb-4",children:"The commitment round in MuSig1 prevents a subtle attack:"}),e.jsxs(i,{title:"Wagner's Attack",children:[e.jsxs("p",{children:["If an attacker sees all other signers' nonces ",e.jsx(s,{children:"R_1, ..., R_{n-1}"})," before choosing their own ",e.jsx(s,{children:"R_n"}),", they can solve a generalized birthday problem to find ",e.jsx(s,{children:"R_n"})," that produces a forgeable aggregate signature."]}),e.jsxs("p",{className:"mt-2",children:["The attack requires ~",e.jsxs(s,{children:["2^",32]})," work for 128-bit security—feasible!"]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"MuSig2's Solution: Multiple Nonces"}),e.jsx("p",{className:"mb-4",children:"MuSig2's insight is to have each signer provide multiple nonces:"}),e.jsxs(i,{title:"MuSig2 Nonce Structure",children:[e.jsxs("p",{children:["Each signer ",e.jsx(s,{children:"i"})," generates ",e.jsx(s,{children:"\\nu"})," nonces (typically ",e.jsx(s,{children:"\\nu = 2"}),"):"]}),e.jsx(n,{children:"R_i^{(1)}, R_i^{(2)}, ..., R_i^{(\\nu)}"}),e.jsx("p",{className:"mt-2",children:"The final nonce is a linear combination determined after all nonces are revealed:"}),e.jsx(n,{children:"R = \\sum_j b^{j-1} \\left( \\sum_i R_i^{(j)} \\right)"}),e.jsxs("p",{className:"mt-2",children:["where ",e.jsx(s,{children:"b"})," is derived from all nonces, keys, and the message."]})]}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsxs("p",{children:['"The binding factor ',e.jsx(s,{children:"b"}),` depends on the message. An attacker who sees nonces can't pre-compute how to combine them maliciously because they don't yet know which message will be signed."`]}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Jonas Nick"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Pre-Sharing Nonces"}),e.jsx("p",{className:"mb-4",children:"The key practical advantage of MuSig2:"}),e.jsxs(t,{title:"Non-Interactive Signing",children:[e.jsx("p",{className:"mb-3",children:"In a 2-of-2 Lightning channel setup:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Setup:"})," Alice and Bob exchange 100 nonce pairs each"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Signing:"})," When a commitment transaction is needed, each party computes their signature share locally"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Completion:"})," Exchange signature shares (single round!)"]})]}),e.jsx("p",{className:"mt-3 text-dark-400",children:"Nonces can be exchanged during quiet periods, making signing effectively single-round when needed."})]}),e.jsx(r,{type:"warning",title:"Nonce Management is Critical",children:e.jsx("p",{children:"Pre-shared nonces must be stored securely and never reused. If the same nonce pair is used for two different messages, the private key is exposed. Implementations must use persistent, atomic nonce counters."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Security Model"}),e.jsx("p",{className:"mb-4",children:"Jonas discusses the formal security guarantees:"}),e.jsxs(i,{title:"Algebraic Group Model (AGM)",children:[e.jsx("p",{children:"MuSig2 is proven secure in the AGM, which assumes adversaries can only compute group elements by combining elements they've seen with known operations (addition, scalar multiplication)."}),e.jsx("p",{className:"mt-2",children:"This is weaker than the Random Oracle Model alone, but stronger proofs require the Generic Group Model which has known limitations."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Full Protocol"}),e.jsxs("div",{className:"bg-dark-800/50 rounded-lg p-6 border border-dark-700/50 mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-dark-100 mb-4",children:"MuSig2 Signing Protocol"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-cyan-400 font-bold",children:"1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Nonce Generation"}),e.jsxs("p",{className:"text-sm text-dark-400",children:["Each signer generates ",e.jsx(s,{children:"(k_i^{(1)}, k_i^{(2)})"})," and computes ",e.jsx(s,{children:"(R_i^{(1)}, R_i^{(2)})"})]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-cyan-400 font-bold",children:"2"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Nonce Exchange"}),e.jsx("p",{className:"text-sm text-dark-400",children:"All signers broadcast their nonce pairs (can be done ahead of time)"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-cyan-400 font-bold",children:"3"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Binding Factor"}),e.jsxs("p",{className:"text-sm text-dark-400",children:["Compute ",e.jsx(s,{children:"b = H(\\text{nonces} \\| P_{agg} \\| m)"})]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-cyan-400 font-bold",children:"4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Signature Shares"}),e.jsxs("p",{className:"text-sm text-dark-400",children:["Each signer computes ",e.jsx(s,{children:"s_i = k_i^{(1)} + b \\cdot k_i^{(2)} + e \\cdot a_i \\cdot d_i"})]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-cyan-400 font-bold",children:"5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Aggregation"}),e.jsxs("p",{className:"text-sm text-dark-400",children:["Final signature: ",e.jsx(s,{children:"(R, s = \\sum s_i)"})]})]})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Related Course Sections"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("a",{href:"#/section/8",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 8: Schnorr Signatures"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Foundation for MuSig"})]}),e.jsxs("a",{href:"#/transcript/musig-overview",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-cyan-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-cyan-400 transition-colors",children:"MuSig Overview Transcript"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Broader context on key aggregation"})]})]})]})}export{g as default};
