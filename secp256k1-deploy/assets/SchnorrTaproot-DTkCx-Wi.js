import{j as e}from"./vendor-animation-0o8UKZ_1.js";import"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-D6XsWJmY.js";import{T as l}from"./TranscriptLayout-f11_Q2qn.js";import{I as s,M as i}from"./MathBlock-uz1iP4cD.js";import{C as r,D as t,E as a}from"./Callout-4_WMx_B8.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./transcripts-oW5P3wnc.js";function u(){return e.jsxs(l,{transcriptId:"schnorr-taproot",children:[e.jsx(r,{type:"success",title:"Key Takeaways",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"BIP340 defines Schnorr signatures for Bitcoin with specific encoding choices"}),e.jsx("li",{children:"Taproot (BIP341) uses Schnorr to enable script path hiding"}),e.jsx("li",{children:"x-only public keys save 1 byte and simplify key aggregation"}),e.jsx("li",{children:"Tagged hashes prevent cross-protocol attacks"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"BIP340: Bitcoin's Schnorr Standard"}),e.jsx("p",{className:"mb-4",children:"Pieter Wuille walks through the design decisions that shaped BIP340:"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:'"We had a clean slate. Unlike ECDSA which was constrained by existing standards, we could make Schnorr exactly right for Bitcoin. Every byte, every hash—all optimized for our use case."'}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Pieter Wuille"})]}),e.jsxs(t,{title:"BIP340 Schnorr Signature",children:[e.jsxs("p",{children:["For private key ",e.jsx(s,{children:"d"}),", public key ",e.jsx(s,{children:"P = dG"}),", message ",e.jsx(s,{children:"m"}),":"]}),e.jsxs("ol",{className:"list-decimal list-inside mt-3 space-y-2",children:[e.jsxs("li",{children:["Generate deterministic nonce ",e.jsx(s,{children:"k"})," from ",e.jsx(s,{children:"d"})," and ",e.jsx(s,{children:"m"})]}),e.jsxs("li",{children:["Compute ",e.jsx(s,{children:"R = kG"}),", ensure ",e.jsx(s,{children:"R"})," has even y-coordinate"]}),e.jsxs("li",{children:["Compute ",e.jsx(s,{children:"e = H_{\\text{BIP340/challenge}}(R_x \\| P_x \\| m)"})]}),e.jsxs("li",{children:["Compute ",e.jsx(s,{children:"s = k + ed"})]}),e.jsxs("li",{children:["Signature is ",e.jsx(s,{children:"(R_x, s)"})," — exactly 64 bytes"]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"X-Only Public Keys"}),e.jsx("p",{className:"mb-4",children:"One of BIP340's innovations is using only the x-coordinate of public keys:"}),e.jsxs(a,{title:"Why X-Only Keys?",children:[e.jsx("p",{className:"mb-3",children:"For any x-coordinate on secp256k1, there are exactly two valid y-coordinates (one even, one odd). BIP340 implicitly uses the even one."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-dark-100",children:"Space Savings"}),e.jsx("p",{className:"text-sm text-dark-300 mt-1",children:"32 bytes instead of 33 (compressed) or 65 (uncompressed)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-dark-100",children:"Simpler Key Aggregation"}),e.jsx("p",{className:"text-sm text-dark-300 mt-1",children:"No need to track or communicate y-coordinate parity during MuSig"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-dark-100",children:"Implementation Clarity"}),e.jsx("p",{className:"text-sm text-dark-300 mt-1",children:'"Always even y" is a simple, consistent rule'})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Tagged Hashes"}),e.jsx("p",{className:"mb-4",children:"BIP340 introduces tagged hashes to prevent domain separation attacks:"}),e.jsxs(t,{title:"Tagged Hash Construction",children:[e.jsx(i,{children:"H_{\\text{tag}}(x) = \\text{SHA256}(\\text{SHA256}(\\text{tag}) \\| \\text{SHA256}(\\text{tag}) \\| x)"}),e.jsx("p",{className:"mt-3",children:"By including the tag hash twice, we ensure that:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Different protocols can't reuse each other's hashes"}),e.jsx("li",{children:"A signature challenge can't collide with a nonce derivation"}),e.jsx("li",{children:"The tag prefix can be precomputed for efficiency"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Taproot: Script Path Hiding"}),e.jsx("p",{className:"mb-4",children:"Pieter explains how Schnorr enables Taproot's privacy features:"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:`"The key insight is that a public key can commit to a script without revealing it. If all parties agree, they just sign with the key—the script is never exposed. Only when there's disagreement does the script appear on-chain."`}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Pieter Wuille"})]}),e.jsxs(t,{title:"Taproot Output Structure",children:[e.jsx("p",{children:"A Taproot output commits to:"}),e.jsx(i,{children:"Q = P + H_{\\text{TapTweak}}(P \\| \\text{merkle\\_root}) \\cdot G"}),e.jsx("p",{className:"mt-3",children:"Where:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx(s,{children:"P"})," is the internal public key (for key-path spend)"]}),e.jsxs("li",{children:[e.jsx(s,{children:"\\text{merkle\\_root}"})," commits to a tree of script alternatives"]}),e.jsx("li",{children:"The tweak binds the key to the scripts without revealing them"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Spending Paths"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Key Path (Happy Path)"}),e.jsx("p",{className:"text-sm text-dark-300",children:"All parties sign with the tweaked key. On-chain, this looks identical to a single-sig spend. Maximum privacy."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Script Path (Fallback)"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Reveal one script from the Merkle tree plus a proof. Used when key-path signing isn't possible (e.g., uncooperative party)."})]})]}),e.jsx(r,{type:"info",title:"Privacy Implications",children:e.jsx("p",{children:"In the common case where everyone cooperates, Taproot transactions are indistinguishable from simple single-key spends. Complex multisig setups, timelocks, and hash locks all look the same on-chain when the key path is used."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Batch Verification"}),e.jsx("p",{className:"mb-4",children:"Schnorr's linearity enables efficient batch verification of multiple signatures:"}),e.jsxs(a,{title:"Batch Verification Performance",children:[e.jsxs("p",{className:"mb-3",children:["When verifying ",e.jsx(s,{children:"n"})," signatures:"]}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b border-dark-700",children:[e.jsx("th",{className:"pb-2",children:"Method"}),e.jsx("th",{className:"pb-2",children:"Operations"}),e.jsx("th",{className:"pb-2",children:"Relative Cost"})]})}),e.jsxs("tbody",{className:"text-dark-300",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-2",children:"Individual"}),e.jsxs("td",{children:[e.jsx(s,{children:"2n"})," point multiplications"]}),e.jsx("td",{children:"1.0x"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"Batch"}),e.jsx("td",{children:"1 multi-scalar multiplication"}),e.jsxs("td",{className:"text-cyan-400",children:["~0.5x for large ",e.jsx(s,{children:"n"})]})]})]})]}),e.jsx("p",{className:"mt-3 text-dark-400",children:"For block validation with thousands of signatures, this is a major speedup."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Related Course Sections"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("a",{href:"#/section/8",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 8: Schnorr Signatures"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Mathematical foundations"})]}),e.jsxs("a",{href:"#/section/9",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 9: Advanced Topics"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Taproot and beyond"})]})]})]})}export{u as default};
