import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{u as U,s as E,i as H,g as S,h as A,a as O,v as I,R as J,b as W,L as K,f as G}from"./index-DDLKTozG.js";import{r as i}from"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./vendor-firebase-core-BXWtuYvb.js";function D({className:t="",showDisplayName:r=!0}){var u,N;const{isAuthenticated:n,isConnecting:a,npub:c,displayName:x,hasExtension:m,extensionChecked:p,error:b,connect:o,disconnect:g,clearError:f}=U();return p?n?e.jsxs("div",{className:`flex items-center gap-3 ${t}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary-500 to-purple-500 flex items-center justify-center text-white text-xs font-bold",children:((u=x==null?void 0:x[0])==null?void 0:u.toUpperCase())||((N=c==null?void 0:c[5])==null?void 0:N.toUpperCase())||"?"}),e.jsxs("div",{className:"flex flex-col",children:[r&&x&&e.jsx("span",{className:"text-sm font-medium text-dark-100",children:x}),e.jsx("span",{className:"text-xs text-dark-400 font-mono",children:c?E(c,6):"..."})]})]}),e.jsx("button",{onClick:g,className:"p-1.5 rounded-lg text-dark-400 hover:text-dark-200 hover:bg-dark-700/50 transition-colors",title:"Disconnect",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]}):e.jsxs("div",{className:`flex flex-col items-center gap-2 ${t}`,children:[e.jsx("button",{onClick:()=>{o()},disabled:a||!m,className:`
            flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm
            transition-all duration-200
            ${m?a?"bg-primary-600 text-white opacity-70 cursor-wait":"bg-primary-600 hover:bg-primary-500 text-white shadow-lg shadow-primary-600/25":"bg-dark-700 text-dark-400 cursor-not-allowed"}
          `,children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Connecting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),"Connect with Nostr"]})}),!m&&e.jsxs("p",{className:"text-xs text-dark-400 text-center max-w-xs",children:["Install a Nostr extension like"," ",e.jsx("a",{href:"https://github.com/nickytonline/nos2x",target:"_blank",rel:"noopener noreferrer",className:"text-primary-400 hover:underline",children:"nos2x"})," ","or"," ",e.jsx("a",{href:"https://getalby.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary-400 hover:underline",children:"Alby"})," ","to connect"]}),b&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-400",children:[e.jsx("span",{children:b}),e.jsx("button",{onClick:f,className:"text-dark-400 hover:text-dark-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}):e.jsxs("div",{className:`flex items-center gap-2 ${t}`,children:[e.jsx("div",{className:"w-4 h-4 border-2 border-dark-400 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-dark-400 text-sm",children:"Checking..."})]})}function X(t){switch(t){case 1:return{emoji:"1st",bgColor:"bg-yellow-500/20",textColor:"text-yellow-400",borderColor:"border-yellow-500/30"};case 2:return{emoji:"2nd",bgColor:"bg-gray-400/20",textColor:"text-gray-300",borderColor:"border-gray-400/30"};case 3:return{emoji:"3rd",bgColor:"bg-orange-500/20",textColor:"text-orange-400",borderColor:"border-orange-500/30"};default:return{emoji:`${t}`,bgColor:"bg-dark-700/50",textColor:"text-dark-300",borderColor:"border-dark-600/30"}}}function Q({entry:t,isCurrentUser:r}){var a,c,x;const n=X(t.rank);return e.jsxs("div",{className:`
        flex items-center gap-4 p-3 rounded-xl transition-colors
        ${r?"bg-primary-500/10 border border-primary-500/30":"hover:bg-dark-700/30"}
      `,children:[e.jsx("div",{className:`
          w-10 h-10 rounded-lg ${n.bgColor} ${n.borderColor} border
          flex items-center justify-center font-bold ${n.textColor}
          ${t.rank<=3?"text-lg":"text-sm"}
        `,children:n.emoji}),e.jsx("div",{className:`
          w-10 h-10 rounded-full flex items-center justify-center text-white text-sm font-bold
          ${t.rank===1?"bg-gradient-to-br from-yellow-400 to-yellow-600":t.rank===2?"bg-gradient-to-br from-gray-300 to-gray-500":t.rank===3?"bg-gradient-to-br from-orange-400 to-orange-600":"bg-gradient-to-br from-primary-500 to-purple-500"}
        `,children:((c=(a=t.displayName)==null?void 0:a[0])==null?void 0:c.toUpperCase())||((x=t.npub[5])==null?void 0:x.toUpperCase())||"?"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-medium truncate ${r?"text-primary-300":"text-dark-100"}`,children:t.displayName||E(t.npub,8)}),r&&e.jsx("span",{className:"text-xs bg-primary-500/20 text-primary-300 px-1.5 py-0.5 rounded",children:"You"})]}),t.displayName&&e.jsx("span",{className:"text-xs text-dark-500 font-mono",children:E(t.npub,6)})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-yellow-400",children:[t.xp.toLocaleString(),e.jsx("span",{className:"text-xs text-dark-400 ml-1",children:"XP"})]}),e.jsxs("div",{className:"text-xs text-dark-400",children:["Level ",t.level]})]})]})}function Z(){return e.jsx("div",{className:"space-y-2",children:[1,2,3,4,5].map(t=>e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl animate-pulse",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-dark-700"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-dark-700"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-dark-700 rounded w-32"}),e.jsx("div",{className:"h-3 bg-dark-700 rounded w-24"})]}),e.jsxs("div",{className:"space-y-2 text-right",children:[e.jsx("div",{className:"h-5 bg-dark-700 rounded w-16 ml-auto"}),e.jsx("div",{className:"h-3 bg-dark-700 rounded w-12 ml-auto"})]})]},t))})}function ee(){return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-4xl mb-3",children:"ðŸ†"}),e.jsx("p",{className:"text-dark-300 font-medium",children:"No rankings yet"}),e.jsx("p",{className:"text-dark-500 text-sm mt-1",children:"Be the first to join the leaderboard!"})]})}function te({rankings:t,currentUserNpub:r,isLoading:n=!1}){return n?e.jsx(Z,{}):t.length===0?e.jsx(ee,{}):e.jsx("div",{className:"space-y-2",children:t.map(a=>e.jsx(Q,{entry:a,isCurrentUser:r===a.npub},a.npub))})}function re({rank:t,totalXP:r,level:n,courseXP:a}){var g,f;const{npub:c,displayName:x,nip05:m}=U(),[p,b]=i.useState(!1),o=i.useCallback(()=>{c&&(navigator.clipboard.writeText(c),b(!0),setTimeout(()=>b(!1),2e3))},[c]);return c?e.jsxs("div",{className:"p-5 rounded-2xl bg-gradient-to-br from-primary-500/10 to-purple-500/10 border border-primary-500/20 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-primary-500 to-purple-500 flex items-center justify-center text-white text-xl font-bold shadow-lg shadow-primary-500/25",children:((g=x==null?void 0:x[0])==null?void 0:g.toUpperCase())||((f=c[5])==null?void 0:f.toUpperCase())||"?"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[x&&e.jsx("div",{className:"font-semibold text-dark-100 truncate text-lg",children:x}),m&&e.jsxs("div",{className:"text-sm text-dark-300 flex items-center gap-1",children:[e.jsx("span",{className:"truncate",children:m}),e.jsx("svg",{className:"w-3.5 h-3.5 text-primary-400 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),e.jsxs("button",{onClick:o,className:"text-xs text-dark-400 font-mono break-all text-left hover:text-dark-200 transition-colors group",title:"Click to copy",children:[c,e.jsx("span",{className:"ml-1.5 opacity-0 group-hover:opacity-100 transition-opacity",children:p?"âœ“":"ðŸ“‹"})]})]}),e.jsx("div",{className:"text-right",children:t!==null?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-3xl font-bold text-primary-400",children:["#",t]}),e.jsx("div",{className:"text-xs text-dark-400",children:"Global Rank"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xl font-bold text-dark-400",children:"--"}),e.jsx("div",{className:"text-xs text-dark-500",children:"Not ranked"})]})})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-700/50 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:r.toLocaleString()}),e.jsx("div",{className:"text-xs text-dark-400",children:"Total XP"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-400",children:n}),e.jsx("div",{className:"text-xs text-dark-400",children:"Level"})]})]}),a&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-700/50",children:[e.jsx("div",{className:"text-xs text-dark-400 mb-2",children:"XP by Course"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"p-2 rounded-lg bg-dark-800/50 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-blue-400",children:(a.ba||0).toLocaleString()}),e.jsx("div",{className:"text-xs text-dark-500",children:"Basic Algebra"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-dark-800/50 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-green-400",children:(a.crypto||0).toLocaleString()}),e.jsx("div",{className:"text-xs text-dark-500",children:"Cryptography"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-dark-800/50 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-purple-400",children:(a.aa||0).toLocaleString()}),e.jsx("div",{className:"text-xs text-dark-500",children:"Abstract Algebra"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-dark-800/50 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-cyan-400",children:(a.linalg||0).toLocaleString()}),e.jsx("div",{className:"text-xs text-dark-500",children:"Linear Algebra"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-dark-800/50 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-pink-400",children:(a.advlinalg||0).toLocaleString()}),e.jsx("div",{className:"text-xs text-dark-500",children:"Adv. Linear Alg."})]})]})]})]}):null}const se=O("AdminPanel");function ae({className:t=""}){const{isAdmin:r}=U(),[n,a]=i.useState(""),[c,x]=i.useState(""),[m,p]=i.useState(!1),[b,o]=i.useState(null),[g,f]=i.useState([]),[u,N]=i.useState(!1),v=i.useCallback(async()=>{if(!(!H()||!r))try{const s=S(),d=await A(s,"getAdminLogs")({limit:20});f(d.data.logs)}catch(s){se.error("Failed to load admin logs:",s)}},[r]);i.useEffect(()=>{u&&v()},[u,v]);const w=async()=>{const s=n.trim();if(!s){o({type:"error",text:"Please enter an npub"});return}const h=I(s);if(!h.valid){o({type:"error",text:h.error||"Invalid npub format"});return}p(!0),o(null);try{const d=S();await A(d,"banUser")({targetNpub:n.trim(),reason:c.trim()||void 0}),o({type:"success",text:"User banned successfully"}),a(""),x(""),u&&v()}catch(d){o({type:"error",text:d instanceof Error?d.message:"Failed to ban user"})}finally{p(!1)}},M=async()=>{const s=n.trim();if(!s){o({type:"error",text:"Please enter an npub"});return}const h=I(s);if(!h.valid){o({type:"error",text:h.error||"Invalid npub format"});return}p(!0),o(null);try{const d=S();await A(d,"unbanUser")({targetNpub:n.trim()}),o({type:"success",text:"User unbanned successfully"}),a(""),u&&v()}catch(d){o({type:"error",text:d instanceof Error?d.message:"Failed to unban user"})}finally{p(!1)}},L=async()=>{const s=n.trim();if(!s){o({type:"error",text:"Please enter an npub"});return}const h=I(s);if(!h.valid){o({type:"error",text:h.error||"Invalid npub format"});return}if(confirm("Are you sure you want to reset this user's scores? This cannot be undone.")){p(!0),o(null);try{const d=S();await A(d,"resetUserScores")({targetNpub:n.trim(),reason:c.trim()||void 0}),o({type:"success",text:"User scores reset successfully"}),a(""),x(""),u&&v()}catch(d){o({type:"error",text:d instanceof Error?d.message:"Failed to reset scores"})}finally{p(!1)}}},R=s=>new Date(s.seconds*1e3).toLocaleString();return r?e.jsxs("div",{className:`p-5 rounded-2xl bg-dark-800/60 border border-dark-700/50 ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-dark-100 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})}),"Admin Panel"]}),e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded",children:"Admin"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-dark-400 mb-1",children:"Target User (npub)"}),e.jsx("input",{type:"text",value:n,onChange:s=>a(s.target.value),placeholder:"npub1...",className:"w-full px-3 py-2 rounded-lg bg-dark-900 border border-dark-600 text-dark-100 text-sm font-mono focus:outline-none focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-dark-400 mb-1",children:"Reason (optional)"}),e.jsx("input",{type:"text",value:c,onChange:s=>x(s.target.value),placeholder:"Reason for action",className:"w-full px-3 py-2 rounded-lg bg-dark-900 border border-dark-600 text-dark-100 text-sm focus:outline-none focus:border-primary-500"})]})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:w,disabled:m,className:"flex-1 px-3 py-2 rounded-lg bg-red-600/20 border border-red-500/30 text-red-400 text-sm font-medium hover:bg-red-600/30 transition-colors disabled:opacity-50",children:"Ban User"}),e.jsx("button",{onClick:M,disabled:m,className:"flex-1 px-3 py-2 rounded-lg bg-green-600/20 border border-green-500/30 text-green-400 text-sm font-medium hover:bg-green-600/30 transition-colors disabled:opacity-50",children:"Unban User"}),e.jsx("button",{onClick:L,disabled:m,className:"flex-1 px-3 py-2 rounded-lg bg-orange-600/20 border border-orange-500/30 text-orange-400 text-sm font-medium hover:bg-orange-600/30 transition-colors disabled:opacity-50",children:"Reset Scores"})]}),b&&e.jsx("div",{className:`p-3 rounded-lg text-sm mb-4 ${b.type==="success"?"bg-green-500/10 border border-green-500/30 text-green-400":"bg-red-500/10 border border-red-500/30 text-red-400"}`,children:b.text}),e.jsxs("button",{onClick:()=>N(!u),className:"w-full text-sm text-dark-400 hover:text-dark-200 transition-colors flex items-center justify-center gap-1",children:[u?"Hide":"Show"," Admin Logs",e.jsx("svg",{className:`w-4 h-4 transition-transform ${u?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),u&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-700/50",children:[e.jsx("h4",{className:"text-sm font-medium text-dark-200 mb-2",children:"Recent Actions"}),g.length===0?e.jsx("p",{className:"text-xs text-dark-500",children:"No admin actions recorded"}):e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:g.map(s=>e.jsxs("div",{className:"p-2 rounded-lg bg-dark-900/50 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:`font-medium ${s.action==="ban"?"text-red-400":s.action==="unban"?"text-green-400":"text-orange-400"}`,children:s.action.toUpperCase()}),e.jsx("span",{className:"text-dark-500",children:R(s.timestamp)})]}),e.jsxs("div",{className:"text-dark-400",children:["Target: ",e.jsx("span",{className:"font-mono",children:E(s.targetNpub,8)})]}),s.reason&&e.jsxs("div",{className:"text-dark-500 mt-1",children:["Reason: ",s.reason]})]},s.id))})]})]}):null}const ne=O("Leaderboard"),Y="magic-internet-math-leaderboard-cache";function le(t){try{const r=localStorage.getItem(Y);if(!r)return null;const n=JSON.parse(r);return n.tab!==t||Date.now()-n.timestamp>K?null:n}catch{return null}}function oe(t,r,n){try{const a={rankings:t,userRank:r,timestamp:Date.now(),tab:n};localStorage.setItem(Y,JSON.stringify(a))}catch{}}function V(t){if(t instanceof Error){const r=t.message.toLowerCase();if(r.includes("unauthenticated")||r.includes("not authenticated"))return"Please connect your Nostr wallet to view the leaderboard.";if(r.includes("permission")||r.includes("denied"))return"You don't have permission to access this resource.";if(r.includes("not-found")||r.includes("not found"))return"The requested data was not found.";if(r.includes("network")||r.includes("fetch")||r.includes("failed to fetch"))return"Network error. Please check your connection and try again.";if(r.includes("timeout")||r.includes("deadline"))return"Request timed out. Please try again."}return"Failed to load leaderboard. Please try again."}const z=[{id:"overall",label:"Overall",shortLabel:"All"},{id:"ba",label:"Basic Algebra",shortLabel:"BA"},{id:"crypto",label:"Cryptography",shortLabel:"Crypto"},{id:"aa",label:"Abstract Algebra",shortLabel:"AA"},{id:"linalg",label:"Linear Algebra",shortLabel:"LinAlg"},{id:"advlinalg",label:"Advanced Linear Algebra",shortLabel:"AdvLinAlg"},{id:"islr",label:"Statistical Learning",shortLabel:"ISLR"},{id:"ra",label:"Real Analysis",shortLabel:"RA"},{id:"calc1",label:"Calculus I",shortLabel:"Calc1"},{id:"calc_lib_art",label:"Calculus (Liberal Arts)",shortLabel:"CalcLA"},{id:"mom",label:"Men of Mathematics",shortLabel:"MoM"},{id:"calc_easy",label:"Calculus Made Easy",shortLabel:"CalcEasy"}];function de({className:t=""}){var _;const{isAuthenticated:r,npub:n,displayName:a,setDisplayName:c,isAdmin:x}=U(),[m,p]=i.useState("overall"),[b,o]=i.useState([]),[g,f]=i.useState(null),[u,N]=i.useState(!0),[v,w]=i.useState(null),[M,L]=i.useState(!1),[R,s]=i.useState(a||""),h=i.useRef(new Map),d=i.useCallback(async()=>{if(!H()){w("Firebase not configured"),N(!1);return}N(!0),w(null);try{const l=S(),y=await A(l,"getLeaderboard")({courseId:m,limit:50});o(y.data.rankings),f(y.data.userRank),oe(y.data.rankings,y.data.userRank,m)}catch(l){ne.error("Failed to load leaderboard:",l);const j=le(m);j?(o(j.rankings),f(j.userRank),w("Showing cached data. "+V(l))):w(V(l))}finally{N(!1)}},[m]);i.useEffect(()=>{d()},[d]),i.useEffect(()=>{(async()=>{const j=b.filter(k=>!k.displayName&&!h.current.has(k.npub)).map(k=>k.npub);if(j.length===0)return;const y=await G(j);y.forEach((k,C)=>{h.current.set(C,k)}),y.size>0&&o(k=>k.map(C=>{const B=h.current.get(C.npub);return!C.displayName&&B?{...C,displayName:B.display_name||B.name||null}:C}))})()},[b]),i.useEffect(()=>{const l=setInterval(d,J);return()=>clearInterval(l)},[d]);const $=W().getLocalScores(),P=$?Object.values($).reduce((l,j)=>l+(j||0),0):0,q=Math.floor(Math.sqrt(P/100))+1,T=()=>{const l=R.trim().slice(0,30);c(l||null),L(!1)};return e.jsxs("div",{className:`max-w-2xl mx-auto ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-dark-100",children:"Leaderboard"}),e.jsx("p",{className:"text-sm text-dark-400 mt-1",children:"Compete with other learners across all courses"})]}),e.jsx(D,{showDisplayName:!1})]}),r&&e.jsxs("div",{className:"mb-6",children:[e.jsx(re,{rank:g,totalXP:P,level:q,courseXP:$||void 0}),e.jsx("div",{className:"mt-3 flex items-center gap-2",children:M?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",value:R,onChange:l=>s(l.target.value),placeholder:"Enter display name",maxLength:30,className:"flex-1 px-3 py-1.5 rounded-lg bg-dark-800 border border-dark-600 text-dark-100 text-sm focus:outline-none focus:border-primary-500",autoFocus:!0,onKeyDown:l=>{l.key==="Enter"&&T(),l.key==="Escape"&&L(!1)}}),e.jsx("button",{onClick:T,className:"px-3 py-1.5 rounded-lg bg-primary-600 text-white text-sm hover:bg-primary-500 transition-colors",children:"Save"}),e.jsx("button",{onClick:()=>L(!1),className:"px-3 py-1.5 rounded-lg bg-dark-700 text-dark-300 text-sm hover:bg-dark-600 transition-colors",children:"Cancel"})]}):e.jsx("button",{onClick:()=>{s(a||""),L(!0)},className:"text-sm text-primary-400 hover:text-primary-300 transition-colors",children:a?"Edit display name":"Set display name"})})]}),!r&&e.jsxs("div",{className:"mb-6 p-6 rounded-2xl bg-dark-800/60 border border-dark-700/50 text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"ðŸ”"}),e.jsx("h3",{className:"text-lg font-semibold text-dark-100 mb-2",children:"Connect to Join the Leaderboard"}),e.jsx("p",{className:"text-sm text-dark-400 mb-4 max-w-sm mx-auto",children:"Link your Nostr identity to sync your progress and compete with other learners."}),e.jsx(D,{})]}),e.jsx("div",{className:"flex gap-1 p-1 rounded-xl bg-dark-800/60 border border-dark-700/50 mb-4",children:z.map(l=>e.jsxs("button",{onClick:()=>p(l.id),className:`
              flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors
              ${m===l.id?"bg-primary-600 text-white shadow-lg shadow-primary-600/25":"text-dark-300 hover:text-dark-100 hover:bg-dark-700/50"}
            `,children:[e.jsx("span",{className:"hidden sm:inline",children:l.label}),e.jsx("span",{className:"sm:hidden",children:l.shortLabel})]},l.id))}),v&&e.jsxs("div",{className:"mb-4 p-3 rounded-lg bg-red-500/10 border border-red-500/30 text-red-400 text-sm",children:[v,e.jsx("button",{onClick:d,className:"ml-2 underline hover:no-underline",children:"Retry"})]}),e.jsxs("div",{className:"p-4 rounded-2xl bg-dark-800/60 border border-dark-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"font-semibold text-dark-100",children:[(_=z.find(l=>l.id===m))==null?void 0:_.label," Rankings"]}),e.jsx("button",{onClick:d,disabled:u,className:"text-xs text-dark-400 hover:text-dark-200 transition-colors disabled:opacity-50",children:u?"Loading...":"Refresh"})]}),e.jsx(te,{rankings:b,currentUserNpub:n,isLoading:u})]}),x&&e.jsx(ae,{className:"mt-6"}),e.jsx("p",{className:"mt-4 text-xs text-dark-500 text-center",children:"Scores sync automatically when you're connected. Rankings update every few minutes."})]})}function be(){return e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsx(de,{})})}export{be as default};
