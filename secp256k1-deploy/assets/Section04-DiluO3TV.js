import{j as e,m}from"./vendor-animation-0o8UKZ_1.js";import{r as d}from"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-B5nJM3q3.js";import{L as C,D as u,E as g,C as y}from"./Callout-BoWwIfEn.js";import{I as s,M as A}from"./MathBlock-uz1iP4cD.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-B3IzoTDS.js";function I({className:w=""}){const[a,R]=d.useState(23),[l,p]=d.useState(0),[x,b]=d.useState(!1),[j,G]=d.useState(1e3),f=d.useMemo(()=>a.toString(2),[a]),c=d.useMemo(()=>f.split("").map(Number),[f]),n=d.useMemo(()=>{const t=[];let r=0;t.push({bitIndex:-1,bitValue:-1,operation:"init",resultMultiple:0,description:"Start with R = O (point at infinity)"});for(let o=0;o<c.length;o++){const h=c[o];r*=2,t.push({bitIndex:o,bitValue:h,operation:"double",resultMultiple:r,description:`Double: R = 2R${r>0?` = ${r}G`:" = O"}`}),h===1&&(r+=1,t.push({bitIndex:o,bitValue:h,operation:"add",resultMultiple:r,description:`Add G: R = R + G = ${r}G`}))}return t},[c]);d.useEffect(()=>{if(!x)return;const t=setInterval(()=>{p(r=>r>=n.length-1?(b(!1),r):r+1)},j);return()=>clearInterval(t)},[x,n.length,j]);const k=d.useCallback(()=>{p(0),b(!1)},[]),B=()=>{l<n.length-1&&p(t=>t+1)},P=()=>{l>0&&p(t=>t-1)},i=n[l],v=n.filter(t=>t.operation==="double").length,N=n.filter(t=>t.operation==="add").length;return e.jsxs("div",{className:`p-6 rounded-2xl bg-dark-800/50 border border-dark-700/50 ${w}`,children:[e.jsx("h3",{className:"text-xl font-bold text-dark-100 mb-2",children:"Double-and-Add Algorithm"}),e.jsxs("p",{className:"text-dark-400 text-sm mb-4",children:["Watch how ",a,"G is computed using only ",v," doublings and ",N-1," ","additions (instead of ",a-1," additions)."]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-dark-300 text-sm mb-2",children:["Scalar n: ",e.jsx("span",{className:"text-amber-400 font-mono",children:a})]}),e.jsx("input",{type:"range",min:"2",max:"127",value:a,onChange:t=>{R(parseInt(t.target.value)),k()},className:"w-full h-2 bg-dark-700 rounded-lg appearance-none cursor-pointer accent-amber-500"})]}),e.jsxs("div",{className:"mb-4 p-4 rounded-xl bg-dark-700/50 border border-dark-600/50",children:[e.jsx("p",{className:"text-dark-400 text-sm mb-2",children:"Binary representation:"}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:c.map((t,r)=>{const o=(i==null?void 0:i.bitIndex)===r,h=(i==null?void 0:i.bitIndex)!==void 0&&r<i.bitIndex;return e.jsxs(m.div,{className:`w-10 h-10 rounded-lg flex flex-col items-center justify-center font-mono transition-colors ${o?"bg-amber-500/30 border-2 border-amber-500 text-amber-400":h?"bg-emerald-500/20 border border-emerald-500/30 text-emerald-400":"bg-dark-600/50 text-dark-400"}`,animate:{scale:o?1.1:1},children:[e.jsx("span",{className:"text-lg",children:t}),e.jsxs("span",{className:"text-[8px] text-dark-500",children:["2^",c.length-1-r]})]},r)})}),e.jsxs("p",{className:"mt-2 text-dark-500 text-xs",children:[a," = ",c.map((t,r)=>t===1?`2^${c.length-1-r}`:null).filter(Boolean).join(" + ")]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("button",{onClick:P,disabled:l===0,className:"p-2 rounded-lg bg-dark-700 text-dark-300 hover:bg-dark-600 disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M19 5v14l-14-7z",transform:"scale(-1,1) translate(-24,0)"})})}),e.jsx("button",{onClick:()=>b(!x),className:`px-4 py-2 rounded-lg font-medium transition-colors ${x?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30"}`,children:x?"Pause":"Play"}),e.jsx("button",{onClick:B,disabled:l>=n.length-1,className:"p-2 rounded-lg bg-dark-700 text-dark-300 hover:bg-dark-600 disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M5 5v14l14-7z"})})}),e.jsx("button",{onClick:k,className:"px-3 py-2 rounded-lg bg-dark-700 text-dark-300 hover:bg-dark-600 text-sm",children:"Reset"}),e.jsx("div",{className:"flex-1"}),e.jsxs("select",{value:j,onChange:t=>G(parseInt(t.target.value)),className:"px-3 py-2 rounded-lg bg-dark-700 text-dark-300 text-sm border-none",children:[e.jsx("option",{value:2e3,children:"Slow"}),e.jsx("option",{value:1e3,children:"Normal"}),e.jsx("option",{value:500,children:"Fast"})]})]}),e.jsx("div",{className:"h-2 bg-dark-700 rounded-full mb-4 overflow-hidden",children:e.jsx(m.div,{className:"h-full bg-amber-500",initial:{width:0},animate:{width:`${l/(n.length-1)*100}%`}})}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-700/50 border border-dark-600/50 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("span",{className:"text-dark-500 text-sm",children:["Step ",l+1,"/",n.length]}),i&&e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${i.operation==="double"?"bg-blue-500/20 text-blue-400":i.operation==="add"?"bg-emerald-500/20 text-emerald-400":"bg-dark-600 text-dark-400"}`,children:i.operation.toUpperCase()})]}),e.jsx("p",{className:"text-lg text-dark-200",children:i==null?void 0:i.description}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-dark-500 text-sm",children:"Result:"}),e.jsx(m.span,{className:"text-xl font-bold text-amber-400 font-mono",initial:{scale:1.2},animate:{scale:1},children:(i==null?void 0:i.resultMultiple)===0?"O":`${i==null?void 0:i.resultMultiple}G`},i==null?void 0:i.resultMultiple)]})]}),e.jsx("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:n.slice(0,l+1).map((t,r)=>e.jsxs(m.div,{className:`flex items-center gap-3 p-2 rounded-lg text-sm ${r===l?"bg-dark-700/50":""}`,initial:{opacity:0,x:-10},animate:{opacity:1,x:0},children:[e.jsx("span",{className:`w-6 h-6 rounded flex items-center justify-center text-xs ${t.operation==="double"?"bg-blue-500/20 text-blue-400":t.operation==="add"?"bg-emerald-500/20 text-emerald-400":"bg-dark-600 text-dark-400"}`,children:t.operation==="double"?"2x":t.operation==="add"?"+":"O"}),e.jsx("span",{className:"text-dark-400",children:t.description})]},r))}),l===n.length-1&&e.jsx(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4 p-4 rounded-xl bg-emerald-500/10 border border-emerald-500/20",children:e.jsxs("p",{className:"text-emerald-400 text-sm",children:[e.jsx("strong",{children:"Efficiency:"})," Computed ",a,"G in just ",v+N-1," operations (O(log n) complexity) instead of ",a-1," sequential additions. For 256-bit scalars, this means ~256 doublings + ~128 additions instead of ~2^256 operations!"]})})]})}function F(){return e.jsxs(C,{sectionId:4,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Key Generation"}),e.jsx("p",{className:"mb-4",children:"With the curve parameters defined, we can now understand how Bitcoin addresses are derived. Key generation is the process of creating a private-public key pair that forms the foundation of ownership in Bitcoin."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Key Pair Relationship"}),e.jsxs(u,{title:"Private and Public Keys",children:[e.jsx("p",{children:"A key pair consists of:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-2",children:[e.jsxs("li",{children:[e.jsxs("strong",{children:["Private key ",e.jsx(s,{children:"d"}),":"]})," A random scalar in"," ",e.jsx(s,{children:"[1, n-1]"})]}),e.jsxs("li",{children:[e.jsxs("strong",{children:["Public key ",e.jsx(s,{children:"Q"}),":"]})," The point"," ",e.jsx(s,{children:"Q = d \\cdot G"})]})]}),e.jsxs("p",{className:"mt-3",children:["This is the one-way function: computing ",e.jsx(s,{children:"Q"})," from"," ",e.jsx(s,{children:"d"})," is easy; computing ",e.jsx(s,{children:"d"})," from"," ",e.jsx(s,{children:"Q"})," is the ECDLP—believed to be computationally infeasible."]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Step 1: Generating the Private Key"}),e.jsx("p",{className:"mb-4",children:"The private key must be:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Random:"})," Generated from a cryptographically secure source"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"In range:"})," A 256-bit integer in ",e.jsx(s,{children:"[1, n-1]"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Secret:"})," Never shared or exposed"]})]}),e.jsxs(g,{title:"Private Key Example",children:[e.jsx("p",{children:"A valid secp256k1 private key (hexadecimal):"}),e.jsx("p",{className:"font-mono text-xs mt-2 break-all text-amber-400",children:"e8f32e723de6dddffcd0c9df9d0ab4a6f0e5a76a0f5c67c7d8f61d50b37b2e29"}),e.jsx("p",{className:"mt-3 text-dark-400",children:"This is 256 bits of randomness—the owner's entire Bitcoin fortune depends on keeping this secret."})]}),e.jsx(y,{type:"warning",title:"Randomness Is Critical",children:e.jsx("p",{children:"If the private key has any predictability (weak RNG, reused entropy, low-entropy seed), attackers can guess it. Wallets have been drained because of weak random number generators."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Step 2: Computing the Public Key"}),e.jsxs("p",{className:"mb-4",children:["Given private key ",e.jsx(s,{children:"d"}),", compute ",e.jsx(s,{children:"Q = dG"})," ","using the double-and-add algorithm:"]}),e.jsxs(g,{title:"Double-and-Add for d = 42",children:[e.jsxs("p",{children:[e.jsx(s,{children:"42 = 101010_2"})," (binary)"]}),e.jsxs("div",{className:"mt-3 space-y-1 text-sm font-mono",children:[e.jsxs("p",{children:["Start: ",e.jsxs(s,{children:["R = \\mathcal","{O}"]})]}),e.jsxs("p",{children:["Bit 1: ",e.jsxs(s,{children:["R = 2R = \\mathcal","{O}"]}),", ",e.jsx(s,{children:"R = R + G = G"})]}),e.jsxs("p",{children:["Bit 0: ",e.jsx(s,{children:"R = 2R = 2G"})]}),e.jsxs("p",{children:["Bit 1: ",e.jsx(s,{children:"R = 2R = 4G"}),", ",e.jsx(s,{children:"R = R + G = 5G"})]}),e.jsxs("p",{children:["Bit 0: ",e.jsx(s,{children:"R = 2R = 10G"})]}),e.jsxs("p",{children:["Bit 1: ",e.jsx(s,{children:"R = 2R = 20G"}),", ",e.jsx(s,{children:"R = R + G = 21G"})]}),e.jsxs("p",{children:["Bit 0: ",e.jsx(s,{children:"R = 2R = 42G"})]})]}),e.jsxs("p",{className:"mt-3 text-dark-400",children:["Result: ",e.jsx(s,{children:"Q = 42G"})," computed with only ~8 operations instead of 42."]})]}),e.jsx(I,{className:"my-8"}),e.jsx("p",{className:"mb-4",children:"For a 256-bit scalar, double-and-add requires at most 512 elliptic curve operations (256 doublings + up to 256 additions)—still very fast on modern computers."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Public Key Formats"}),e.jsxs("p",{className:"mb-4",children:["The public key ",e.jsx(s,{children:"Q = (x, y)"})," can be encoded in two ways:"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-amber-400 font-bold mb-2",children:"Uncompressed (65 bytes)"}),e.jsx("p",{className:"font-mono text-sm",children:"04 || x || y"}),e.jsxs("p",{className:"text-xs text-dark-400 mt-2",children:["Prefix ",e.jsx("code",{children:"04"})," followed by both coordinates (32 bytes each)."]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-emerald-400 font-bold mb-2",children:"Compressed (33 bytes)"}),e.jsx("p",{className:"font-mono text-sm",children:"02/03 || x"}),e.jsxs("p",{className:"text-xs text-dark-400 mt-2",children:["Prefix ",e.jsx("code",{children:"02"})," (even y) or ",e.jsx("code",{children:"03"})," (odd y), plus x-coordinate only."]})]})]}),e.jsxs(u,{title:"Compression Works Because...",children:[e.jsxs("p",{children:["For any ",e.jsx(s,{children:"x"})," on the curve, there are at most two valid"," ",e.jsx(s,{children:"y"})," values: ",e.jsx(s,{children:"y"})," and ",e.jsx(s,{children:"-y"}),". Since ",e.jsx(s,{children:"-y \\equiv p - y \\pmod p"}),", one is even and one is odd. The prefix encodes which one."]}),e.jsxs("p",{className:"mt-2",children:["To decompress: compute ",e.jsxs(s,{children:["y = \\sqrt","{x^3 + 7}"," \\mod p"]})," and select the root with the correct parity."]})]}),e.jsx(y,{type:"info",title:"Bitcoin Uses Compressed Keys",children:e.jsx("p",{children:"Since 2012, Bitcoin wallets default to compressed public keys, saving 32 bytes per output. This adds up: millions of transactions = gigabytes saved on the blockchain."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Security Analysis"}),e.jsx("p",{className:"mb-4",children:"How secure is a 256-bit private key?"}),e.jsxs(g,{title:"The Key Space",children:[e.jsxs("p",{children:["Total possible private keys: ",e.jsxs(s,{children:["n \\approx 2^","{256}"]})]}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Atoms in the observable universe:"})," ~",e.jsxs(s,{children:["10^","{80}"," \\approx 2^","{266}"]})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Age of universe in nanoseconds:"})," ~",e.jsxs(s,{children:["10^","{26}"," \\approx 2^","{87}"]})]})]}),e.jsx("p",{className:"mt-3 text-dark-400",children:"Even checking one key per nanosecond since the Big Bang wouldn't scratch the surface."})]}),e.jsxs(u,{title:"Birthday Attack Resistance",children:[e.jsxs("p",{children:["The best-known attack (Pollard's rho) requires ",e.jsxs(s,{children:["\\sqrt","{n}"," \\approx 2^","{128}"]})," ",'operations. This is why 256-bit keys provide "128-bit security."']}),e.jsxs("p",{className:"mt-2",children:[e.jsxs(s,{children:["2^","{128}"]})," operations at 1 trillion/second would take"," ",e.jsxs(s,{children:["10^","{19}"]})," years—longer than the age of the universe."]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"From Public Key to Address"}),e.jsx("p",{className:"mb-4",children:"Bitcoin addresses add another layer on top of public keys:"}),e.jsx(A,{children:"\\text{Address} = \\text{Base58Check}(\\text{RIPEMD160}(\\text{SHA256}(Q)))"}),e.jsx("p",{className:"mb-4",children:"Why hash the public key?"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Shorter:"})," 160 bits instead of 256"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Post-quantum hedge:"})," Hashing provides additional protection"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Privacy:"})," Public key not revealed until spending"]})]}),e.jsx(y,{type:"success",title:"Summary",children:e.jsxs("p",{children:["Key generation: pick random ",e.jsx(s,{children:"d"}),", compute ",e.jsx(s,{children:"Q = dG"}),", derive address. This simple process, secured by the ECDLP, protects billions of dollars in Bitcoin."]})})]})}export{F as default};
