import{j as e,m as S}from"./vendor-animation-0o8UKZ_1.js";import{r as c}from"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-DDLKTozG.js";import{L as B}from"./LessonLayout-B6vclJlS.js";import{M as F,I as s}from"./MathBlock-uz1iP4cD.js";import{D,C as q,E}from"./Callout-4_WMx_B8.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-B3IzoTDS.js";function I({className:z="",initialA:O=0,initialB:T=7,showControls:M=!0}){const[j,P]=c.useState(O),[b,g]=c.useState(T),[d,k]=c.useState(null),W=500,w=400,m=50,N=W-2*m,A=w-2*m,R={min:-4,max:4},p={min:-10,max:10},x=t=>m+(t-R.min)/(R.max-R.min)*N,n=t=>w-m-(t-p.min)/(p.max-p.min)*A,a=4*Math.pow(j,3)+27*Math.pow(b,2),_=a!==0,i=c.useMemo(()=>{const t=[];for(let f=R.min;f<=R.max;f+=.05){const r=Math.pow(f,3)+j*f+b;if(r>=0){const h=Math.sqrt(r);t.push({x:f,yPos:h,yNeg:-h})}}return t},[j,b]),u=c.useMemo(()=>{const t=i.filter(l=>l.yPos>=p.min&&l.yPos<=p.max);return t.length===0?"":t.map((l,f)=>`${f===0?"M":"L"} ${x(l.x)} ${n(l.yPos)}`).join(" ")},[i]),C=c.useMemo(()=>{const t=i.filter(l=>l.yNeg>=p.min&&l.yNeg<=p.max);return t.length===0?"":t.map((l,f)=>`${f===0?"M":"L"} ${x(l.x)} ${n(l.yNeg)}`).join(" ")},[i]),o=j===0&&b===7,v=c.useMemo(()=>{const t=[];for(const l of i){if(l.x>0&&Math.abs(l.x-Math.round(l.x))<.05){const f=Math.round(l.x);t.find(r=>Math.round(r.x)===f)||t.push({x:f,y:l.yPos})}if(t.length>=3)break}return t},[i]);return e.jsxs("div",{className:`p-6 rounded-2xl bg-dark-800/50 border border-dark-700/50 ${z}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-dark-100",children:"Elliptic Curve Plotter"}),o&&e.jsx("span",{className:"px-3 py-1 rounded-full bg-amber-500/20 text-amber-400 text-sm font-medium",children:"secp256k1"})]}),e.jsx("p",{className:"text-dark-400 text-sm mb-4",children:"Explore the shape of y² = x³ + ax + b by adjusting the parameters."}),M&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-dark-300 text-sm mb-2",children:["Parameter a: ",e.jsx("span",{className:"text-primary-400 font-mono",children:j})]}),e.jsx("input",{type:"range",min:"-5",max:"5",step:"0.5",value:j,onChange:t=>P(parseFloat(t.target.value)),className:"w-full h-2 bg-dark-700 rounded-lg appearance-none cursor-pointer accent-primary-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-dark-300 text-sm mb-2",children:["Parameter b: ",e.jsx("span",{className:"text-emerald-400 font-mono",children:b})]}),e.jsx("input",{type:"range",min:"-5",max:"10",step:"0.5",value:b,onChange:t=>g(parseFloat(t.target.value)),className:"w-full h-2 bg-dark-700 rounded-lg appearance-none cursor-pointer accent-emerald-500"})]})]}),M&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>{P(0),g(7)},className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${o?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-dark-700 text-dark-400 border border-dark-600 hover:bg-dark-600"}`,children:"secp256k1 (a=0, b=7)"}),e.jsx("button",{onClick:()=>{P(-3),g(3)},className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${j===-3&&b===3?"bg-primary-500/20 text-primary-400 border border-primary-500/30":"bg-dark-700 text-dark-400 border border-dark-600 hover:bg-dark-600"}`,children:"P-256 style (a=-3, b=3)"})]}),!_&&e.jsx("div",{className:"p-3 mb-4 rounded-lg bg-red-500/10 border border-red-500/30",children:e.jsxs("p",{className:"text-red-400 text-sm",children:[e.jsx("strong",{children:"Invalid curve!"})," The discriminant 4a³ + 27b² = 0 creates a singular curve (cusp or node)."]})}),e.jsxs("svg",{viewBox:`0 0 ${W} ${w}`,className:"w-full h-auto bg-dark-900/50 rounded-xl",children:[[-3,-2,-1,0,1,2,3].map(t=>e.jsx("line",{x1:x(t),y1:m,x2:x(t),y2:w-m,stroke:t===0?"#6b7280":"#374151",strokeWidth:t===0?2:1,strokeDasharray:t===0?"none":"4,4"},`vgrid-${t}`)),[-8,-4,0,4,8].map(t=>e.jsx("line",{x1:m,y1:n(t),x2:W-m,y2:n(t),stroke:t===0?"#6b7280":"#374151",strokeWidth:t===0?2:1,strokeDasharray:t===0?"none":"4,4"},`hgrid-${t}`)),e.jsx("text",{x:W-m+10,y:n(0)+4,fill:"#9ca3af",fontSize:"12",children:"x"}),e.jsx("text",{x:x(0)+5,y:m-10,fill:"#9ca3af",fontSize:"12",children:"y"}),[-3,-2,-1,1,2,3].map(t=>e.jsx("text",{x:x(t),y:n(0)+15,fill:"#6b7280",fontSize:"10",textAnchor:"middle",children:t},`xlabel-${t}`)),[-8,-4,4,8].map(t=>e.jsx("text",{x:x(0)-10,y:n(t)+4,fill:"#6b7280",fontSize:"10",textAnchor:"end",children:t},`ylabel-${t}`)),_&&e.jsxs(e.Fragment,{children:[e.jsx(S.path,{d:u,fill:"none",stroke:"#f59e0b",strokeWidth:"3",strokeLinecap:"round",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.8}}),e.jsx(S.path,{d:C,fill:"none",stroke:"#f59e0b",strokeWidth:"3",strokeLinecap:"round",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.8}})]}),v.map((t,l)=>e.jsxs("g",{children:[e.jsx(S.circle,{cx:x(t.x),cy:n(t.y),r:(d==null?void 0:d.x)===t.x&&(d==null?void 0:d.y)===t.y?8:6,fill:"#10b981",stroke:"#fff",strokeWidth:"2",className:"cursor-pointer",onMouseEnter:()=>k(t),onMouseLeave:()=>k(null),initial:{scale:0},animate:{scale:1},transition:{delay:.5+l*.1}}),e.jsx(S.circle,{cx:x(t.x),cy:n(-t.y),r:(d==null?void 0:d.x)===t.x&&(d==null?void 0:d.y)===-t.y?8:6,fill:"#10b981",stroke:"#fff",strokeWidth:"2",className:"cursor-pointer",onMouseEnter:()=>k({x:t.x,y:-t.y}),onMouseLeave:()=>k(null),initial:{scale:0},animate:{scale:1},transition:{delay:.5+l*.1}})]},l))]}),e.jsxs("div",{className:"mt-4 p-4 rounded-xl bg-dark-700/50 border border-dark-600/50 text-center",children:[e.jsx("span",{className:"text-dark-300",children:"Curve: "}),e.jsxs("span",{className:"text-xl font-mono text-amber-400",children:["y² = x³",j!==0&&` ${j>0?"+":"-"} ${Math.abs(j)}x`,b!==0&&` ${b>0?"+":"-"} ${Math.abs(b)}`]})]}),d&&e.jsxs(S.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"mt-4 p-3 rounded-xl bg-emerald-500/10 border border-emerald-500/20",children:[e.jsxs("p",{className:"text-emerald-400 text-sm",children:["Point: (",d.x.toFixed(2),", ",d.y.toFixed(3),")"]}),e.jsxs("p",{className:"text-dark-400 text-xs mt-1",children:["Verification: (",d.y.toFixed(3),")² ="," ",(d.y*d.y).toFixed(3)," ="," ",(Math.pow(d.x,3)+j*d.x+b).toFixed(3)]})]}),e.jsx("div",{className:"mt-4 p-3 rounded-xl bg-dark-700/30",children:e.jsxs("p",{className:"text-dark-400 text-sm",children:[e.jsx("span",{className:"text-dark-300",children:"Discriminant: "}),e.jsxs("span",{className:"font-mono",children:["4(",j,")³ + 27(",b,")² = ",a.toFixed(1)]}),a!==0?e.jsx("span",{className:"text-emerald-400 ml-2",children:"✓ Valid curve"}):e.jsx("span",{className:"text-red-400 ml-2",children:"✗ Singular"})]})})]})}function X({className:z=""}){const[M,j]=c.useState(2),[P,b]=c.useState(-1),[g,d]=c.useState(!0),[k,W]=c.useState(3),w=550,m=450,N=50,A=w-2*N,R=m-2*N,p={min:-3,max:4},x={min:-8,max:8},n=c.useCallback(r=>N+(r-p.min)/(p.max-p.min)*A,[]),a=c.useCallback(r=>m-N-(r-x.min)/(x.max-x.min)*R,[]),_=c.useCallback(r=>{const h=Math.pow(r,3)+0*r+7;return h>=0?Math.sqrt(h):0},[0,7]),i=c.useMemo(()=>({x:M,y:_(M)}),[M,_]),u=c.useMemo(()=>({x:P,y:_(P)}),[P,_]),{lambda:C,R:o,RPrime:v}=c.useMemo(()=>{if(i.x===u.x){if(i.y===0)return{lambda:1/0,R:null,RPrime:null};const y=(3*i.x*i.x+0)/(2*i.y),Q=y*y-i.x-u.x,$=y*(i.x-Q)-i.y;return{lambda:y,RPrime:{x:Q,y:-$},R:{x:Q,y:$}}}const r=(u.y-i.y)/(u.x-i.x),h=r*r-i.x-u.x,L=r*(i.x-h)-i.y;return{lambda:r,RPrime:{x:h,y:-L},R:{x:h,y:L}}},[i,u,0]),t=c.useMemo(()=>{const r=[],h=[];for(let y=p.min;y<=p.max;y+=.05){const Q=Math.pow(y,3)+0*y+7;if(Q>=0){const $=Math.sqrt(Q);$<=x.max&&$>=x.min&&r.push(`${r.length===0?"M":"L"} ${n(y)} ${a($)}`),-$<=x.max&&-$>=x.min&&h.push(`${h.length===0?"M":"L"} ${n(y)} ${a(-$)}`)}}return{upper:r.join(" "),lower:h.join(" ")}},[0,7,n,a]),l=c.useMemo(()=>{if(!isFinite(C))return"";const r=y=>i.y+C*(y-i.x),h=p.min,L=p.max;return`M ${n(h)} ${a(r(h))} L ${n(L)} ${a(r(L))}`},[i,C,n,a]),f=c.useMemo(()=>!v||!o?"":`M ${n(v.x)} ${a(v.y)} L ${n(o.x)} ${a(o.y)}`,[v,o,n,a]);return e.jsxs("div",{className:`p-6 rounded-2xl bg-dark-800/50 border border-dark-700/50 ${z}`,children:[e.jsx("h3",{className:"text-xl font-bold text-dark-100 mb-2",children:"Point Addition Visualizer"}),e.jsx("p",{className:"text-dark-400 text-sm mb-4",children:"Drag the sliders to move points P and Q. Watch how the geometric construction finds R = P + Q."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-dark-300 text-sm mb-2",children:["P.x: ",e.jsx("span",{className:"text-primary-400 font-mono",children:M.toFixed(1)})]}),e.jsx("input",{type:"range",min:"-2",max:"3",step:"0.1",value:M,onChange:r=>j(parseFloat(r.target.value)),className:"w-full h-2 bg-dark-700 rounded-lg appearance-none cursor-pointer accent-primary-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-dark-300 text-sm mb-2",children:["Q.x: ",e.jsx("span",{className:"text-emerald-400 font-mono",children:P.toFixed(1)})]}),e.jsx("input",{type:"range",min:"-2",max:"3",step:"0.1",value:P,onChange:r=>b(parseFloat(r.target.value)),className:"w-full h-2 bg-dark-700 rounded-lg appearance-none cursor-pointer accent-emerald-500"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("button",{onClick:()=>d(!g),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${g?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-dark-700 text-dark-400 border border-dark-600"}`,children:[g?"Hide":"Show"," Construction"]}),g&&e.jsx("div",{className:"flex gap-1",children:[1,2,3].map(r=>e.jsx("button",{onClick:()=>W(r),className:`w-8 h-8 rounded-lg text-sm font-medium transition-colors ${k>=r?"bg-primary-500/20 text-primary-400 border border-primary-500/30":"bg-dark-700 text-dark-400 border border-dark-600"}`,children:r},r))})]}),e.jsxs("svg",{viewBox:`0 0 ${w} ${m}`,className:"w-full h-auto bg-dark-900/50 rounded-xl",children:[[-2,-1,0,1,2,3].map(r=>e.jsx("line",{x1:n(r),y1:N,x2:n(r),y2:m-N,stroke:r===0?"#6b7280":"#374151",strokeWidth:r===0?2:1,strokeDasharray:r===0?"none":"4,4"},`vgrid-${r}`)),[-6,-4,-2,0,2,4,6].map(r=>e.jsx("line",{x1:N,y1:a(r),x2:w-N,y2:a(r),stroke:r===0?"#6b7280":"#374151",strokeWidth:r===0?2:1,strokeDasharray:r===0?"none":"4,4"},`hgrid-${r}`)),e.jsx("text",{x:w-N+10,y:a(0)+4,fill:"#9ca3af",fontSize:"12",children:"x"}),e.jsx("text",{x:n(0)+5,y:N-10,fill:"#9ca3af",fontSize:"12",children:"y"}),e.jsx("path",{d:t.upper,fill:"none",stroke:"#f59e0b",strokeWidth:"3"}),e.jsx("path",{d:t.lower,fill:"none",stroke:"#f59e0b",strokeWidth:"3"}),g&&k>=1&&e.jsx(S.path,{d:l,fill:"none",stroke:"#3b82f6",strokeWidth:"2",strokeDasharray:"6,4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.3}}),g&&k>=2&&v&&e.jsxs(e.Fragment,{children:[e.jsx(S.path,{d:f,fill:"none",stroke:"#ef4444",strokeWidth:"2",strokeDasharray:"4,4",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.3}}),e.jsx(S.circle,{cx:n(v.x),cy:a(v.y),r:6,fill:"#ef4444",stroke:"#fff",strokeWidth:"2",initial:{scale:0},animate:{scale:1}}),e.jsx("text",{x:n(v.x)+12,y:a(v.y)+5,fill:"#ef4444",fontSize:"14",fontWeight:"bold",children:"R'"})]}),g&&k>=3&&o&&e.jsxs(e.Fragment,{children:[e.jsx(S.circle,{cx:n(o.x),cy:a(o.y),r:8,fill:"#8b5cf6",stroke:"#fff",strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{type:"spring"}}),e.jsx("text",{x:n(o.x)+12,y:a(o.y)+5,fill:"#8b5cf6",fontSize:"14",fontWeight:"bold",children:"R = P + Q"})]}),e.jsx("circle",{cx:n(i.x),cy:a(i.y),r:8,fill:"#3b82f6",stroke:"#fff",strokeWidth:"2"}),e.jsx("text",{x:n(i.x)-20,y:a(i.y)-12,fill:"#3b82f6",fontSize:"14",fontWeight:"bold",children:"P"}),e.jsx("circle",{cx:n(u.x),cy:a(u.y),r:8,fill:"#10b981",stroke:"#fff",strokeWidth:"2"}),e.jsx("text",{x:n(u.x)+12,y:a(u.y)-8,fill:"#10b981",fontSize:"14",fontWeight:"bold",children:"Q"}),e.jsxs("g",{transform:"translate(15, 20)",children:[e.jsx("rect",{x:"0",y:"0",width:"120",height:"75",fill:"#1f2937",rx:"8",opacity:"0.9"}),e.jsx("circle",{cx:"15",cy:"18",r:"5",fill:"#3b82f6"}),e.jsxs("text",{x:"28",y:"22",fill:"#d1d5db",fontSize:"11",children:["P = (",i.x.toFixed(1),", ",i.y.toFixed(2),")"]}),e.jsx("circle",{cx:"15",cy:"38",r:"5",fill:"#10b981"}),e.jsxs("text",{x:"28",y:"42",fill:"#d1d5db",fontSize:"11",children:["Q = (",u.x.toFixed(1),", ",u.y.toFixed(2),")"]}),o&&e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"15",cy:"58",r:"5",fill:"#8b5cf6"}),e.jsxs("text",{x:"28",y:"62",fill:"#d1d5db",fontSize:"11",children:["R = (",o.x.toFixed(1),", ",o.y.toFixed(2),")"]})]})]})]}),g&&e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:`p-3 rounded-lg ${k>=1?"bg-blue-500/10 border border-blue-500/30":"bg-dark-700/50"}`,children:[e.jsx("p",{className:"text-sm font-medium text-blue-400",children:"Step 1"}),e.jsx("p",{className:"text-xs text-dark-400",children:"Draw line through P and Q"})]}),e.jsxs("div",{className:`p-3 rounded-lg ${k>=2?"bg-red-500/10 border border-red-500/30":"bg-dark-700/50"}`,children:[e.jsx("p",{className:"text-sm font-medium text-red-400",children:"Step 2"}),e.jsx("p",{className:"text-xs text-dark-400",children:"Find third intersection R'"})]}),e.jsxs("div",{className:`p-3 rounded-lg ${k>=3?"bg-purple-500/10 border border-purple-500/30":"bg-dark-700/50"}`,children:[e.jsx("p",{className:"text-sm font-medium text-purple-400",children:"Step 3"}),e.jsx("p",{className:"text-xs text-dark-400",children:"Reflect R' to get R = P + Q"})]})]}),o&&e.jsxs("div",{className:"mt-4 p-4 rounded-xl bg-dark-700/50 border border-dark-600/50",children:[e.jsx("p",{className:"text-dark-300 text-sm mb-2",children:"Calculation:"}),e.jsxs("div",{className:"space-y-1 font-mono text-xs",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-dark-400",children:"λ = (y₂ - y₁) / (x₂ - x₁) = "}),e.jsx("span",{className:"text-amber-400",children:C.toFixed(4)})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-dark-400",children:"x₃ = λ² - x₁ - x₂ = "}),e.jsx("span",{className:"text-amber-400",children:o.x.toFixed(4)})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-dark-400",children:"y₃ = λ(x₁ - x₃) - y₁ = "}),e.jsx("span",{className:"text-amber-400",children:o.y.toFixed(4)})]})]})]})]})}function se(){return e.jsxs(B,{sectionId:1,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Curves Over Real Numbers"}),e.jsx("p",{className:"mb-4",children:"Before diving into finite fields (where cryptography actually lives), let's build geometric intuition by working with elliptic curves over the real numbers. The operations work the same way—they're just easier to visualize."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Curve Equation"}),e.jsxs(D,{title:"Weierstrass Form",children:[e.jsxs("p",{children:["An elliptic curve in ",e.jsx("strong",{children:"short Weierstrass form"})," is defined by:"]}),e.jsx(F,{children:"y^2 = x^3 + ax + b"}),e.jsxs("p",{className:"mt-2",children:["For secp256k1: ",e.jsx(s,{children:"a = 0"}),", ",e.jsx(s,{children:"b = 7"}),", giving:"]}),e.jsx(F,{children:"y^2 = x^3 + 7"})]}),e.jsx(q,{type:"info",title:"Non-Singular Condition",children:e.jsxs("p",{children:["For a valid elliptic curve, we need ",e.jsx(s,{children:"4a^3 + 27b^2 \\neq 0"}),". This ensures the curve has no cusps or self-intersections. For secp256k1:"," ",e.jsx(s,{children:"4(0)^3 + 27(7)^2 = 1323 \\neq 0"}),"."]})}),e.jsx(I,{className:"my-8"}),e.jsxs(E,{title:"Points on secp256k1",children:[e.jsxs("p",{children:["Let's verify some points on ",e.jsx(s,{children:"y^2 = x^3 + 7"}),":"]}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx(s,{children:"x = 2"}),": ",e.jsx(s,{children:"y^2 = 8 + 7 = 15"}),", so ",e.jsx(s,{children:"y \\approx \\pm 3.873"})]}),e.jsxs("li",{children:[e.jsx(s,{children:"x = -1"}),": ",e.jsx(s,{children:"y^2 = -1 + 7 = 6"}),", so ",e.jsx(s,{children:"y \\approx \\pm 2.449"})]}),e.jsxs("li",{children:[e.jsx(s,{children:"x = 1"}),": ",e.jsx(s,{children:"y^2 = 1 + 7 = 8"}),", so ",e.jsx(s,{children:"y \\approx \\pm 2.828"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Point Addition: Geometric Construction"}),e.jsxs("p",{className:"mb-4",children:["The key operation on elliptic curves is ",e.jsx("strong",{children:"point addition"}),". Given two points ",e.jsx(s,{children:"P"})," and ",e.jsx(s,{children:"Q"}),", we compute"," ",e.jsx(s,{children:"P + Q"})," geometrically:"]}),e.jsx("div",{className:"bg-dark-800 rounded-lg p-6 mb-6",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-3",children:[e.jsxs("li",{children:["Draw a line through ",e.jsx(s,{children:"P"})," and ",e.jsx(s,{children:"Q"})]}),e.jsxs("li",{children:["Find the third intersection point with the curve (call it ",e.jsx(s,{children:"R'"}),")"]}),e.jsxs("li",{children:["Reflect ",e.jsx(s,{children:"R'"})," across the x-axis to get ",e.jsx(s,{children:"R = P + Q"})]})]})}),e.jsxs(D,{title:"Point Addition Formula",children:[e.jsxs("p",{children:["For ",e.jsx(s,{children:"P = (x_1, y_1)"})," and ",e.jsx(s,{children:"Q = (x_2, y_2)"}),"with ",e.jsx(s,{children:"P \\neq Q"}),":"]}),e.jsx(F,{children:"\\lambda = \\frac{y_2 - y_1}{x_2 - x_1}"}),e.jsx(F,{children:"x_3 = \\lambda^2 - x_1 - x_2"}),e.jsx(F,{children:"y_3 = \\lambda(x_1 - x_3) - y_1"}),e.jsxs("p",{className:"mt-2",children:["Then ",e.jsx(s,{children:"P + Q = (x_3, y_3)"}),"."]})]}),e.jsx(X,{className:"my-8"}),e.jsxs(E,{title:"Worked Example: Point Addition",children:[e.jsxs("p",{children:["Let ",e.jsx(s,{children:"P = (2, 3.873)"})," and ",e.jsx(s,{children:"Q = (-1, 2.449)"}),"."]}),e.jsxs("div",{className:"mt-3 space-y-2 font-mono text-sm",children:[e.jsx("p",{children:e.jsx(s,{children:"\\lambda = \\frac{2.449 - 3.873}{-1 - 2} = \\frac{-1.424}{-3} = 0.475"})}),e.jsx("p",{children:e.jsx(s,{children:"x_3 = 0.475^2 - 2 - (-1) = 0.226 - 1 = -0.774"})}),e.jsx("p",{children:e.jsx(s,{children:"y_3 = 0.475(2 - (-0.774)) - 3.873 = 1.317 - 3.873 = -2.556"})})]}),e.jsxs("p",{className:"mt-3",children:["So ",e.jsx(s,{children:"P + Q \\approx (-0.774, -2.556)"}),"."]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Point Doubling"}),e.jsxs("p",{className:"mb-4",children:["When ",e.jsx(s,{children:"P = Q"}),", we can't draw a line through two points. Instead, we use the ",e.jsx("strong",{children:"tangent line"})," at ",e.jsx(s,{children:"P"}),"."]}),e.jsxs(D,{title:"Point Doubling Formula",children:[e.jsxs("p",{children:["For ",e.jsx(s,{children:"P = (x_1, y_1)"})," with ",e.jsx(s,{children:"y_1 \\neq 0"}),":"]}),e.jsx(F,{children:"\\lambda = \\frac{3x_1^2 + a}{2y_1}"}),e.jsxs("p",{className:"mt-2",children:["For secp256k1 (",e.jsx(s,{children:"a = 0"}),"):"]}),e.jsx(F,{children:"\\lambda = \\frac{3x_1^2}{2y_1}"}),e.jsxs("p",{className:"mt-2",children:["Then ",e.jsx(s,{children:"x_3"})," and ",e.jsx(s,{children:"y_3"})," are computed the same way as point addition."]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Point at Infinity"}),e.jsxs("p",{className:"mb-4",children:["What happens when the line is vertical (no third intersection)? We need an",e.jsx("strong",{children:"identity element"}),", called the ",e.jsx("strong",{children:"point at infinity"})," ",e.jsxs(s,{children:["\\mathcal","{O}"]}),"."]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 mb-6",children:[e.jsxs("p",{className:"text-amber-400 font-bold mb-2",children:["Properties of ",e.jsxs(s,{children:["\\mathcal","{O}"]})]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-dark-300",children:[e.jsxs("li",{children:[e.jsxs(s,{children:["P + \\mathcal","{O}"," = P"]})," (identity)"]}),e.jsxs("li",{children:[e.jsxs(s,{children:["P + (-P) = \\mathcal","{O}"]})," where ",e.jsx(s,{children:"-P = (x, -y)"})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Scalar Multiplication"}),e.jsxs("p",{className:"mb-4",children:[e.jsx("strong",{children:"Scalar multiplication"})," means adding a point to itself repeatedly:"]}),e.jsx(F,{children:"nP = \\underbrace{P + P + \\cdots + P}_{n \\text{ times}}"}),e.jsxs(D,{title:"Double-and-Add Algorithm",children:[e.jsxs("p",{children:["To compute ",e.jsx(s,{children:"nP"})," efficiently (in ",e.jsx(s,{children:"O(\\log n)"})," operations):"]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4 mt-3 font-mono text-sm",children:[e.jsxs("p",{children:["1: Write ",e.jsx(s,{children:"n"})," in binary: ",e.jsxs(s,{children:["n = (b_k b_","{k-1}"," \\ldots b_1 b_0)_2"]})]}),e.jsxs("p",{children:["2: Start with ",e.jsxs(s,{children:["R = \\mathcal","{O}"]})]}),e.jsxs("p",{children:["3: For ",e.jsx(s,{children:"i = k"})," down to ",e.jsx(s,{children:"0"}),":"]}),e.jsxs("p",{className:"pl-4",children:["- Double: ",e.jsx(s,{children:"R = 2R"})]}),e.jsxs("p",{className:"pl-4",children:["- If ",e.jsx(s,{children:"b_i = 1"}),": Add: ",e.jsx(s,{children:"R = R + P"})]}),e.jsxs("p",{children:["4: Return ",e.jsx(s,{children:"R"})]})]})]}),e.jsxs(E,{title:"Computing 5P",children:[e.jsxs("p",{children:[e.jsx(s,{children:"5 = 101_2"})," (binary), so:"]}),e.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[e.jsxs("p",{children:["Start: ",e.jsxs(s,{children:["R = \\mathcal","{O}"]})]}),e.jsxs("p",{children:["Bit 1: Double (",e.jsxs(s,{children:["\\mathcal","{O}"]}),"), Add P → ",e.jsx(s,{children:"R = P"})]}),e.jsxs("p",{children:["Bit 0: Double → ",e.jsx(s,{children:"R = 2P"}),", no add"]}),e.jsxs("p",{children:["Bit 1: Double → ",e.jsx(s,{children:"R = 4P"}),", Add P → ",e.jsx(s,{children:"R = 5P"})]})]}),e.jsx("p",{className:"mt-2 text-dark-400",children:"Only 4 operations instead of 5 additions!"})]}),e.jsx(q,{type:"success",title:"The One-Way Property Emerges",children:e.jsxs("p",{children:["Given ",e.jsx(s,{children:"G"})," and ",e.jsx(s,{children:"Q = nG"}),", computing"," ",e.jsx(s,{children:"n"})," requires trying all possibilities—there's no shortcut. This is the ",e.jsx("strong",{children:"discrete logarithm problem"})," on elliptic curves."]})})]})}export{se as default};
