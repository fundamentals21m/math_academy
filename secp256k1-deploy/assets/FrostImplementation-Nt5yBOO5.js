import{j as e}from"./vendor-animation-0o8UKZ_1.js";import"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-ySuSmSID.js";import{T as i}from"./TranscriptLayout-CoUsWXbX.js";import{I as s}from"./MathBlock-uz1iP4cD.js";import{C as t,D as a,E as r}from"./Callout-4_WMx_B8.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./transcripts-Bj1VzTa0.js";function g(){return e.jsxs(i,{transcriptId:"frost-implementation",children:[e.jsx(t,{type:"success",title:"Key Takeaways",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"FROST is being implemented in libsecp256k1-zkp"}),e.jsx("li",{children:"Distributed key generation is the most complex part"}),e.jsx("li",{children:"State management is critical for nonce safety"}),e.jsx("li",{children:"Hardware wallet integration requires careful protocol design"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Implementation Status"}),e.jsx("p",{className:"mb-4",children:"Jesse Posner and Tim Ruffing discuss bringing FROST to Bitcoin:"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:'"FROST has been a long road. The theory was published in 2020, but getting a production-ready implementation with the same security guarantees as our MuSig2 code has taken years of careful work."'}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Jesse Posner"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Architecture Decisions"}),e.jsx("p",{className:"mb-4",children:"Key architectural choices for the libsecp256k1-zkp implementation:"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Modular DKG"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Key generation is separate from signing. Supports multiple DKG protocols including Pedersen DKG and FROST DKG."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Share Format"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Standardized share serialization for interoperability between wallets and custody solutions."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Coordinator Mode"}),e.jsx("p",{className:"text-sm text-dark-300",children:"Optional coordinator for message routing. Coordinator learns nothing about the key or signatures."})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-cyan-400 font-bold mb-2",children:"Constant-Time"}),e.jsx("p",{className:"text-sm text-dark-300",children:"All secret-dependent operations are constant-time, following libsecp256k1 security principles."})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Distributed Key Generation"}),e.jsx("p",{className:"mb-4",children:"Tim Ruffing explains the DKG challenges:"}),e.jsxs(a,{title:"FROST DKG Protocol",children:[e.jsxs("p",{children:["Each party ",e.jsx(s,{children:"i"})," in a ",e.jsx(s,{children:"t"}),"-of-",e.jsx(s,{children:"n"})," setup:"]}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-2",children:[e.jsxs("li",{children:["Generates random polynomial ",e.jsx(s,{children:"f_i(x)"})," of degree ",e.jsx(s,{children:"t-1"})]}),e.jsxs("li",{children:["Broadcasts commitments to coefficients: ",e.jsx(s,{children:"A_{ik} = a_{ik} G"})]}),e.jsxs("li",{children:["Sends share ",e.jsx(s,{children:"f_i(j)"})," privately to each party ",e.jsx(s,{children:"j"})]}),e.jsx("li",{children:"Verifies received shares against commitments"}),e.jsx("li",{children:"Computes final share as sum of received shares"})]}),e.jsxs("p",{className:"mt-3",children:["The group public key is ",e.jsx(s,{children:"P = \\sum_i A_{i0}"}),"."]})]}),e.jsx(t,{type:"warning",title:"DKG Security",children:e.jsx("p",{children:"DKG requires a secure broadcast channel to prevent equivocation attacks where a malicious party sends different values to different participants. In practice, this often means committing messages to a bulletin board."})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Nonce Management"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:'"Like MuSig2, FROST signing is stateful. You generate nonce commitments, then you must use exactly those nonces exactly once. Our API makes it impossible to accidentally reuse or skip nonces."'}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Tim Ruffing"})]}),e.jsx(r,{title:"FROST Signing API",children:e.jsx("pre",{className:"text-sm bg-dark-800 p-4 rounded-lg overflow-x-auto",children:`// Pseudocode for FROST signing

// Step 1: Generate nonces (can be done ahead of time)
FrostNonce nonce = frost_nonce_gen(share, session_id);
FrostNonceCommitment commit = frost_nonce_commitment(nonce);
// Share commit with coordinator...

// Step 2: Receive all commitments, create signature share
FrostSigningSession session = frost_sign_init(
    share,
    all_commitments,
    message,
    participant_list
);
FrostPartialSig psig = frost_partial_sign(session, nonce);
// nonce is now consumed!

// Step 3: Coordinator aggregates
FrostSignature sig = frost_partial_sig_agg(
    partial_sigs,
    session
);`})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Hardware Wallet Support"}),e.jsx("p",{className:"mb-4",children:"Supporting FROST on hardware wallets presents unique challenges:"}),e.jsxs("div",{className:"bg-dark-800/50 rounded-lg p-6 border border-dark-700/50 mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-dark-100 mb-4",children:"Hardware Wallet Considerations"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-cyan-500 mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"State Encryption"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Signing state must be encrypted by the hardware wallet and stored on the host. Only the HW can decrypt and use it."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-cyan-500 mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Share Backup"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Key shares need secure backup, potentially using existing seed phrase infrastructure with derivation paths."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-cyan-500 mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"Verification Display"}),e.jsx("p",{className:"text-sm text-dark-400",children:"HW must display participant set and message clearly—users need to verify they're signing with the expected group."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-cyan-500 mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"DKG Participation"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Hardware wallets may need to participate in DKG, requiring multiple interaction rounds during setup."})]})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Testing and Verification"}),e.jsx("p",{className:"mb-4",children:"The implementation undergoes rigorous testing:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6 text-dark-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Test vectors:"})," From the FROST specification and IETF draft"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cross-implementation:"})," Testing against ZCash's FROST implementation"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fuzzing:"})," Random participant configurations, message orderings"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Failure injection:"})," Simulating malicious or failing participants"]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Future Work"}),e.jsxs("blockquote",{className:"border-l-4 border-cyan-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:`"We're also looking at FROST with adaptor signatures—threshold adaptor signatures for DLCs with distributed key management. And proactive secret sharing for rotating shares without changing the public key."`}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Jesse Posner"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Related Resources"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("a",{href:"#/transcript/frost-intro",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-cyan-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-cyan-400 transition-colors",children:"FROST Introduction"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Protocol overview and theory"})]}),e.jsxs("a",{href:"#/transcript/musig-implementations",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-cyan-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-cyan-400 transition-colors",children:"Implementing MuSig"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Related implementation patterns"})]})]})]})}export{g as default};
