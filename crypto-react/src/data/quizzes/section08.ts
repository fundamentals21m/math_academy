import type { QuizQuestion } from './types';

export const section08Quiz = {
  easy: [
    {
      id: 's08-e01',
      type: 'multiple-choice',
      question: 'What makes square-and-multiply efficient for modular exponentiation?',
      options: [
        'It skips the mod operation',
        'It only works with small numbers',
        'It uses the binary representation of the exponent',
        'It uses floating point arithmetic'
      ],
      correctIndex: 2,
      difficulty: 'easy',
      explanation: 'Square-and-multiply reduces $O(n)$ multiplications to $O(\\log n)$ by using the binary representation of the exponent.',
    },
    {
      id: 's08-e02',
      type: 'numeric',
      question: 'What is $2^5 \\bmod 7$?',
      correctAnswer: 4,
      numericRange: { min: 0, max: 7 },
      difficulty: 'easy',
      explanation: '$2^5 = 32$. $32 = 4 \\times 7 + 4$, so $32 \\bmod 7 = 4$.',
    },
    {
      id: 's08-e03',
      type: 'multiple-choice',
      question: 'Why do we take mod at each step in modular exponentiation?',
      options: [
      'It\'s not necessary',
      'To make the result prime',
      'To keep numbers small and prevent overflow',
      'To speed up division',
    ],
      correctIndex: 2,
      difficulty: 'easy',
      explanation: 'Taking mod at each step keeps intermediate results small, preventing integer overflow and maintaining efficiency.',
    },
    {
      id: 's08-e04',
      type: 'numeric',
      question: 'Calculate $3^4 \\bmod 5$.',
      correctAnswer: 1,
      numericRange: { min: 0, max: 5 },
      difficulty: 'easy',
      explanation: '$3^4 = 81$. $81 = 16 \\times 5 + 1$, so $81 \\bmod 5 = 1$.',
    },
    {
      id: 's08-e05',
      type: 'multiple-choice',
      question: 'What is $5^2 \\bmod 11$?',
      options: [
      '$5
      correctIndex: 1,
      difficulty: 'easy',
      explanation: '$5^2 = 25 = 2 \\times 11 + 3$, so $25 \\bmod 11 = 3$.',
    },
      '$3
      correctIndex: 0,
      difficulty: 'easy',
      explanation: '$5^2 = 25 = 2 \\times 11 + 3$, so $25 \\bmod 11 = 3$.',
    },
      '$25
      correctIndex: 0,
      difficulty: 'easy',
      explanation: '$5^2 = 25 = 2 \\times 11 + 3$, so $25 \\bmod 11 = 3$.',
    },
      '$14
      correctIndex: 0,
      difficulty: 'easy',
      explanation: '$5^2 = 25 = 2 \\times 11 + 3$, so $25 \\bmod 11 = 3$.',
    },
    ],
      correctIndex: 0,
      difficulty: 'easy',
      explanation: '$5^2 = 25 = 2 \\times 11 + 3$, so $25 \\bmod 11 = 3$.',
    },
    {
      id: 's08-e06',
      type: 'numeric',
      question: 'What is $2^{10} \\bmod 1000$?',
      correctAnswer: 24,
      numericRange: { min: 0, max: 1000 },
      difficulty: 'easy',
      explanation: '$2^{10} = 1024$. $1024 \\bmod 1000 = 24$.',
    },
    {
      id: 's08-e07',
      type: 'multiple-choice',
      question: 'In the expression $a^b \\bmod n$, which value is called the exponent?',
      options: [
      '$a
      correctIndex: 3,
      difficulty: 'easy',
      explanation: 'In $a^b \\bmod n$, $a$ is the base, $b$ is the exponent, and $n$ is the modulus.',
    },
      '$n
      correctIndex: 0,
      difficulty: 'easy',
      explanation: 'In $a^b \\bmod n$, $a$ is the base, $b$ is the exponent, and $n$ is the modulus.',
    },
      '$a^b
      correctIndex: 0,
      difficulty: 'easy',
      explanation: 'In $a^b \\bmod n$, $a$ is the base, $b$ is the exponent, and $n$ is the modulus.',
    },
      '$b
      correctIndex: 0,
      difficulty: 'easy',
      explanation: 'In $a^b \\bmod n$, $a$ is the base, $b$ is the exponent, and $n$ is the modulus.',
    },
    ],
      correctIndex: 0,
      difficulty: 'easy',
      explanation: 'In $a^b \\bmod n$, $a$ is the base, $b$ is the exponent, and $n$ is the modulus.',
    },
    {
      id: 's08-e08',
      type: 'numeric',
      question: 'Compute $4^3 \\bmod 9$.',
      correctAnswer: 1,
      numericRange: { min: 0, max: 9 },
      difficulty: 'easy',
      explanation: '$4^3 = 64 = 7 \\times 9 + 1$, so $64 \\bmod 9 = 1$.',
    },
    {
      id: 's08-e09',
      type: 'multiple-choice',
      question: 'What is $a^0 \\bmod n$ for any $a$ coprime to $n$?',
      options: [
      '$0
      correctIndex: 1,
      difficulty: 'easy',
      explanation: '$a^0 = 1$ by definition, so $a^0 \\bmod n = 1$ for any $n > 1$.',
    },
      '$1
      correctIndex: 0,
      difficulty: 'easy',
      explanation: '$a^0 = 1$ by definition, so $a^0 \\bmod n = 1$ for any $n > 1$.',
    },
      '$a
      correctIndex: 0,
      difficulty: 'easy',
      explanation: '$a^0 = 1$ by definition, so $a^0 \\bmod n = 1$ for any $n > 1$.',
    },
      '$n
      correctIndex: 0,
      difficulty: 'easy',
      explanation: '$a^0 = 1$ by definition, so $a^0 \\bmod n = 1$ for any $n > 1$.',
    },
    ],
      correctIndex: 0,
      difficulty: 'easy',
      explanation: '$a^0 = 1$ by definition, so $a^0 \\bmod n = 1$ for any $n > 1$.',
    },
    {
      id: 's08-e10',
      type: 'numeric',
      question: 'Find $7^2 \\bmod 10$.',
      correctAnswer: 9,
      numericRange: { min: 0, max: 10 },
      difficulty: 'easy',
      explanation: '$7^2 = 49 = 4 \\times 10 + 9$, so $49 \\bmod 10 = 9$.',
    },
  ] as QuizQuestion[],

  medium: [
    {
      id: 's08-m01',
      type: 'numeric',
      question: 'Calculate $7^{13} \\bmod 11$ using the fact that $7^{10} \\equiv 1 \\pmod{11}$.',
      correctAnswer: 2,
      numericRange: { min: 0, max: 11 },
      difficulty: 'medium',
      explanation: '$7^{13} = 7^{10} \\cdot 7^3 \\equiv 1 \\cdot 343 \\pmod{11}$. $343 = 31 \\times 11 + 2$, so $7^{13} \\equiv 2 \\pmod{11}$.',
    },
    {
      id: 's08-m02',
      type: 'multiple-choice',
      question: 'To compute $a^{13} \\bmod n$ using square-and-multiply, since $13 = 1101_2$, we compute:',
      options: [
      '$a^{13}$ directly',
      '$a \\cdot 13$ times',
      '$a^2 \\cdot a^{11}
      correctIndex: 3,
      difficulty: 'medium',
      explanation: 'Following binary $1101$: start with $a$, square to $a^2$, multiply by $a$ to get $a^3$, square to $a^6$, square to $a^{12}$, multiply by $a$ to get $a^{13}$.',
    },
      '$a \\to a^2 \\to a^3 \\to a^6 \\to a^{12} \\to a^{13}
      correctIndex: 0,
      difficulty: 'medium',
      explanation: 'Following binary $1101$: start with $a$, square to $a^2$, multiply by $a$ to get $a^3$, square to $a^6$, square to $a^{12}$, multiply by $a$ to get $a^{13}$.',
    },
    ],
      correctIndex: 0,
      difficulty: 'medium',
      explanation: 'Following binary $1101$: start with $a$, square to $a^2$, multiply by $a$ to get $a^3$, square to $a^6$, square to $a^{12}$, multiply by $a$ to get $a^{13}$.',
    },
    {
      id: 's08-m03',
      type: 'numeric',
      question: 'What is $3^{20} \\bmod 7$?',
      correctAnswer: 2,
      numericRange: { min: 0, max: 7 },
      difficulty: 'medium',
      explanation: '$\\varphi(7) = 6$. $3^6 \\equiv 1 \\pmod{7}$. $20 = 6 \\times 3 + 2$. So $3^{20} \\equiv 3^2 = 9 \\equiv 2 \\pmod{7}$.',
    },
    {
      id: 's08-m04',
      type: 'multiple-choice',
      question: 'What is the time complexity of square-and-multiply for $a^b \\bmod n$?',
      options: [
      '$O(b)$ multiplications',
      '$O(b^2)$ multiplications',
      '$O(n)$ multiplications',
      '$O(\\log b)$ multiplications',
    ],
      correctIndex: 3,
      difficulty: 'medium',
      explanation: 'Square-and-multiply processes each bit of $b$, requiring $O(\\log b)$ squarings and at most $O(\\log b)$ multiplications.',
    },
    {
      id: 's08-m05',
      type: 'numeric',
      question: 'Compute $5^{17} \\bmod 13$.',
      correctAnswer: 5,
      numericRange: { min: 0, max: 13 },
      difficulty: 'medium',
      explanation: "$\\varphi(13) = 12$. By Fermat's Little Theorem, $5^{12} \\equiv 1 \\pmod{13}$. $17 = 12 + 5$. $5^{17} \\equiv 5^5 \\pmod{13}$. $5^2 = 25 \\equiv 12$, $5^4 \\equiv 144 \\equiv 1$, $5^5 \\equiv 5 \\pmod{13}$.",
    },
    {
      id: 's08-m06',
      type: 'multiple-choice',
      question: 'In RSA encryption, to compute $m^e \\bmod n$ efficiently when $e = 65537 = 2^{16} + 1$:',
      options: [
      'Use trial and error',
      'Square $m$ sixteen times, then multiply by $m$ once',
      'Multiply $m$ by itself $65537$ times',
      'Compute $m^{65537}$ first, then take mod',
    ],
      correctIndex: 1,
      difficulty: 'medium',
      explanation: '$65537 = 10000000000000001_2$. We compute $m^{2^{16}}$ by squaring $16$ times, then multiply by $m$ once.',
    },
    {
      id: 's08-m07',
      type: 'numeric',
      question: 'Calculate $2^{100} \\bmod 13$.',
      correctAnswer: 3,
      numericRange: { min: 0, max: 13 },
      difficulty: 'medium',
      explanation: '$\\varphi(13) = 12$. $100 = 12 \\times 8 + 4$. $2^{100} \\equiv 2^4 = 16 \\equiv 3 \\pmod{13}$.',
    },
    {
      id: 's08-m08',
      type: 'multiple-choice',
      question: 'If $a^k \\equiv 1 \\pmod{n}$, then $a^{mk} \\bmod n$ equals:',
      options: [
      '$a
      correctIndex: 1,
      difficulty: 'medium',
      explanation: '$a^{mk} = (a^k)^m \\equiv 1^m = 1 \\pmod{n}$.',
    },
      '$1
      correctIndex: 0,
      difficulty: 'medium',
      explanation: '$a^{mk} = (a^k)^m \\equiv 1^m = 1 \\pmod{n}$.',
    },
      '$k
      correctIndex: 0,
      difficulty: 'medium',
      explanation: '$a^{mk} = (a^k)^m \\equiv 1^m = 1 \\pmod{n}$.',
    },
      '$m
      correctIndex: 0,
      difficulty: 'medium',
      explanation: '$a^{mk} = (a^k)^m \\equiv 1^m = 1 \\pmod{n}$.',
    },
    ],
      correctIndex: 0,
      difficulty: 'medium',
      explanation: '$a^{mk} = (a^k)^m \\equiv 1^m = 1 \\pmod{n}$.',
    },
    {
      id: 's08-m09',
      type: 'numeric',
      question: 'What is $11^{23} \\bmod 17$?',
      correctAnswer: 3,
      numericRange: { min: 0, max: 17 },
      difficulty: 'medium',
      explanation: "$\\varphi(17) = 16$. $23 = 16 + 7$. $11^{23} \\equiv 11^7 \\pmod{17}$. $11^2 = 121 \\equiv 2$, $11^4 \\equiv 4$, $11^7 = 11^4 \\cdot 11^2 \\cdot 11 \\equiv 4 \\cdot 2 \\cdot 11 = 88 \\equiv 3 \\pmod{17}$.",
    },
    {
      id: 's08-m10',
      type: 'multiple-choice',
      question: 'The property $(a \\cdot b) \\bmod n = ((a \\bmod n) \\cdot (b \\bmod n)) \\bmod n$ is used in modular exponentiation to:',
      options: [
      'Keep intermediate values small',
      'Convert to binary',
      'Speed up addition',
      'Avoid using exponents',
    ],
      correctIndex: 0,
      difficulty: 'medium',
      explanation: 'This property allows us to reduce mod $n$ after each operation, keeping all intermediate results less than $n$.',
    },
  ] as QuizQuestion[],

  hard: [
    {
      id: 's08-h01',
      type: 'numeric',
      question: 'Calculate $7^{256} \\bmod 13$.',
      correctAnswer: 9,
      numericRange: { min: 0, max: 13 },
      difficulty: 'hard',
      explanation: '$\\varphi(13) = 12$. $256 = 12 \\times 21 + 4$. $7^{256} \\equiv 7^4 \\pmod{13}$. $7^2 = 49 \\equiv 10 \\equiv -3$, $7^4 \\equiv 9 \\pmod{13}$.',
    },
    {
      id: 's08-h02',
      type: 'multiple-choice',
      question: 'Using the Chinese Remainder Theorem, to compute $a^b \\bmod pq$ where $p, q$ are primes:',
      options: [
      'Compute $a^b$ directly, then take mod $pq
      correctIndex: 1,
      difficulty: 'hard',
      explanation: 'CRT allows us to split the computation into smaller moduli $p$ and $q$, then combine the results. This is how RSA decryption is optimized.',
    },
      'Compute $a^b \\bmod p$ and $a^b \\bmod q$ separately, then combine',
      'Factor $a^b$ first',
      'This cannot be done',
    ],
      correctIndex: 0,
      difficulty: 'hard',
      explanation: 'CRT allows us to split the computation into smaller moduli $p$ and $q$, then combine the results. This is how RSA decryption is optimized.',
    },
    {
      id: 's08-h03',
      type: 'numeric',
      question: 'What is $3^{1000} \\bmod 35$?',
      correctAnswer: 11,
      numericRange: { min: 0, max: 35 },
      difficulty: 'hard',
      explanation: '$35 = 5 \\times 7$. By CRT: $3^{1000} \\bmod 5$: $\\varphi(5) = 4$, $1000 \\equiv 0 \\pmod{4}$, so $3^{1000} \\equiv 1 \\pmod{5}$. $3^{1000} \\bmod 7$: $\\varphi(7) = 6$, $1000 \\equiv 4 \\pmod{6}$, $3^4 = 81 \\equiv 4 \\pmod{7}$. Using CRT: $x \\equiv 1 \\pmod{5}$, $x \\equiv 4 \\pmod{7}$. $x = 5k + 1$, $5k \\equiv 3 \\pmod{7}$, $k \\equiv 2 \\pmod{7}$. So $x = 11$.',
    },
    {
      id: 's08-h04',
      type: 'multiple-choice',
      question: "To decrypt RSA ciphertext $c$ when $d$ is large, we use CRT with precomputed values $d_p = d \\bmod (p-1)$ and $d_q = d \\bmod (q-1)$. This is called:",
      options: [
      'Montgomery multiplication',
      'Karatsuba algorithm',
      'CRT-RSA optimization',
      'Barrett reduction',
    ],
      correctIndex: 2,
      difficulty: 'hard',
      explanation: 'CRT-RSA (or CRT speedup) computes $m_p = c^{d_p} \\bmod p$ and $m_q = c^{d_q} \\bmod q$, then combines them. This is about 4x faster.',
    },
    {
      id: 's08-h05',
      type: 'numeric',
      question: 'Find the last two digits of $7^{999}$ (i.e., $7^{999} \\bmod 100$).',
      correctAnswer: 43,
      numericRange: { min: 0, max: 100 },
      difficulty: 'hard',
      explanation: '$\\varphi(100) = 40$. $999 = 40 \\times 24 + 39$. $7^{999} \\equiv 7^{39} \\pmod{100}$. Computing: $7^2 = 49$, $7^4 = 2401 \\equiv 1$, $7^{39} = 7^{36} \\cdot 7^3 = (7^4)^9 \\cdot 343 \\equiv 1 \\cdot 43 = 43 \\pmod{100}$.',
    },
    {
      id: 's08-h06',
      type: 'multiple-choice',
      question: 'The order of $a$ modulo $n$ is defined as:',
      options: [
      '$\\varphi(n)
      correctIndex: 3,
      difficulty: 'hard',
      explanation: 'The multiplicative order of $a$ modulo $n$ is the smallest positive integer $k$ where $a^k \\equiv 1 \\pmod{n}$. It always divides $\\varphi(n)$.',
    },
      '$\\gcd(a, n)
      correctIndex: 2,
      difficulty: 'hard',
      explanation: 'The multiplicative order of $a$ modulo $n$ is the smallest positive integer $k$ where $a^k \\equiv 1 \\pmod{n}$. It always divides $\\varphi(n)$.',
    },
      '$a^{-1} \\bmod n
      correctIndex: 2,
      difficulty: 'hard',
      explanation: 'The multiplicative order of $a$ modulo $n$ is the smallest positive integer $k$ where $a^k \\equiv 1 \\pmod{n}$. It always divides $\\varphi(n)$.',
    },
      'The smallest positive $k$ such that $a^k \\equiv 1 \\pmod{n}
      correctIndex: 2,
      difficulty: 'hard',
      explanation: 'The multiplicative order of $a$ modulo $n$ is the smallest positive integer $k$ where $a^k \\equiv 1 \\pmod{n}$. It always divides $\\varphi(n)$.',
    },
    ],
      correctIndex: 2,
      difficulty: 'hard',
      explanation: 'The multiplicative order of $a$ modulo $n$ is the smallest positive integer $k$ where $a^k \\equiv 1 \\pmod{n}$. It always divides $\\varphi(n)$.',
    },
    {
      id: 's08-h07',
      type: 'numeric',
      question: 'Calculate $2^{340} \\bmod 341$, where $341 = 11 \\times 31$.',
      correctAnswer: 1,
      numericRange: { min: 0, max: 341 },
      difficulty: 'hard',
      explanation: '$\\varphi(341) = 10 \\times 30 = 300$. $340 = 300 + 40$. But actually, $341$ is a Fermat pseudoprime to base $2$: $2^{340} \\equiv 1 \\pmod{341}$ by CRT since $2^{10} \\equiv 1 \\pmod{11}$ and $2^{30} \\equiv 1 \\pmod{31}$, and $340$ is divisible by both $10$ and $30$.',
    },
    {
      id: 's08-h08',
      type: 'multiple-choice',
      question: 'Montgomery multiplication is used in modular exponentiation to:',
      options: [
      'Generate random primes',
      'Avoid expensive division operations',
      'Compute discrete logarithms',
      'Factor large numbers',
    ],
      correctIndex: 1,
      difficulty: 'hard',
      explanation: 'Montgomery multiplication replaces division by $n$ with division by a power of $2$, which is just bit shifting, making it much faster in hardware.',
    },
    {
      id: 's08-h09',
      type: 'numeric',
      question: 'What is $123^{456} \\bmod 789$?',
      correctAnswer: 699,
      numericRange: { min: 0, max: 789 },
      difficulty: 'hard',
      explanation: '$789 = 3 \\times 263$. $\\varphi(789) = 2 \\times 262 = 524$. $456 \\bmod 524 = 456$. Computing $123^{456} \\bmod 789$ using repeated squaring gives $699$.',
    },
    {
      id: 's08-h10',
      type: 'multiple-choice',
      question: 'A timing attack on RSA exploits the fact that:',
      options: [
      'Square-and-multiply takes different time for 0 vs 1 bits in the exponent',
      'Prime generation is slow',
      'Key generation uses random numbers',
      'Encryption is faster than decryption',
    ],
      correctIndex: 0,
      difficulty: 'hard',
      explanation: 'In naive implementations, multiply operations only occur for 1-bits. By measuring timing, an attacker can deduce the private exponent bit by bit.',
    },
  ] as QuizQuestion[],
};
