import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{T as i}from"./TranscriptLayout-Dmq9At4E.js";import"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import{C as s,D as r,E as t}from"./Callout-BvJhqaqq.js";import"./transcripts-V844WpId.js";function h(){return e.jsxs(i,{transcriptId:"security-analysis",children:[e.jsx(s,{type:"success",title:"Key Takeaways",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"Brontide protocol provides encrypted, authenticated P2P communications"}),e.jsx("li",{children:"Sphinx onion routing hides payment paths from intermediate nodes"}),e.jsx("li",{children:"Hash-lock correlation remains a challenge for multi-hop privacy"}),e.jsx("li",{children:'On-chain congestion can trigger "thundering herd" failures'})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Transport Layer Security"}),e.jsx("p",{className:"mb-4",children:"Olaoluwa Osuntokun (roasbeef) explains the encryption layer:"}),e.jsxs("blockquote",{className:"border-l-4 border-amber-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:`"Brontide is our variant of the Noise protocol framework. Every Lightning connection is encrypted and authenticated from the first byte. There's no plaintext handshake phase—passive observers can't even tell it's Lightning."`}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Olaoluwa Osuntokun"})]}),e.jsx(r,{title:"Brontide Properties",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Forward secrecy:"})," Compromised keys don't reveal past sessions"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Identity hiding:"})," Node IDs aren't revealed to passive observers"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Replay protection:"})," Messages can't be captured and replayed"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Onion Routing with Sphinx"}),e.jsx("p",{className:"mb-4",children:"Payment privacy comes from layered encryption:"}),e.jsx(t,{title:"Sphinx Packet Properties",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Fixed size (1366 bytes):"})," Packet doesn't shrink as it traverses hops, hiding route length"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Per-hop encryption:"})," Each node decrypts only their layer"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Error wrapping:"})," Errors are re-encrypted at each hop back, only the sender can read them"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Known Vulnerabilities"}),e.jsx(s,{type:"warning",title:"Security Concerns",children:e.jsx("p",{className:"mb-2",children:"Roasbeef identifies several attack vectors:"})}),e.jsxs(r,{title:"Hash-Lock Correlation",children:[e.jsx("p",{children:"The same payment hash is used across all hops in a payment path. Colluding nodes at different positions can correlate they're part of the same payment:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Node A sees payment hash H going to Node B"}),e.jsx("li",{children:"Node C (much later in path) sees same hash H"}),e.jsx("li",{children:"A and C can conclude they're on the same payment route"})]})]}),e.jsxs("blockquote",{className:"border-l-4 border-amber-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:'"PTLCs fix this. Instead of hash locks, you use point locks where each hop has a different adaptor. No correlation possible. But it requires Schnorr signatures, so we waited for Taproot."'}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Olaoluwa Osuntokun"})]}),e.jsxs(r,{title:"Thundering Herd Attack",children:[e.jsx("p",{children:"If blockchain fees spike during network stress:"}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"HTLCs approach their timeouts"}),e.jsx("li",{children:"Nodes must close channels to claim funds"}),e.jsx("li",{children:"Mass channel closures create more on-chain congestion"}),e.jsx("li",{children:"Fees spike further, more closures cascade"})]}),e.jsx("p",{className:"mt-2 text-amber-400",children:"Mitigation: Anchor outputs allow fee bumping after broadcast."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Channel Announcement Security"}),e.jsx("p",{className:"mb-4",children:"Gossip messages require cryptographic proof:"}),e.jsxs(t,{title:"Four-Way Signature",children:[e.jsx("p",{className:"mb-2",children:"A channel_announcement must be signed by four keys:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Both node identity keys (proves nodes exist)"}),e.jsx("li",{children:"Both funding keys (proves they control the channel)"})]}),e.jsx("p",{className:"mt-2 text-sm text-dark-500",children:"This prevents announcing fake channels or impersonating other nodes."})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Future Improvements"}),e.jsx(s,{type:"info",title:"Proposed Solutions",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"PTLCs:"})," Point time-locked contracts for decorrelated payments"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Trampoline routing:"})," Outsource pathfinding to reduce probing"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Blinded paths:"})," Hide receiver identity in invoices"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Related Sections"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("a",{href:"#/section/2",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 2: BOLT #8 Transport"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Noise protocol encryption"})]}),e.jsxs("a",{href:"#/section/18",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 18: BOLT #4 Onion Routing"}),e.jsx("p",{className:"text-sm text-dark-500",children:"Sphinx packet construction"})]})]})]})}export{h as default};
