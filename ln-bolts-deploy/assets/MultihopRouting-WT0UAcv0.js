import{j as e}from"./vendor-animation-0o8UKZ_1.js";import{T as i}from"./TranscriptLayout-Dmq9At4E.js";import"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import{C as s,D as t,E as r}from"./Callout-BvJhqaqq.js";import"./transcripts-V844WpId.js";function m(){return e.jsxs(i,{transcriptId:"multihop-routing",children:[e.jsx(s,{type:"success",title:"Key Takeaways",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"HTLCs enable trustless multi-hop payments"}),e.jsx("li",{children:"SPHINX provides source-based onion routing"}),e.jsx("li",{children:"Five stages are required for HTLC validity"}),e.jsx("li",{children:"Lightning routing is NOT unsolvable (despite myths)"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Trustless Multi-Hop Architecture"}),e.jsx("p",{className:"mb-4",children:"Rene Pickhardt debunks common misconceptions:"}),e.jsxs("blockquote",{className:"border-l-4 border-amber-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:`"People say Lightning routing is unsolvable, that we need big hubs. That's wrong. We have source routing—the sender picks the entire path. There's no central coordinator. It's not easy, but it's definitely solvable."`}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Rene Pickhardt"})]}),e.jsxs(t,{title:"Hash Time-Locked Contracts",children:[e.jsx("p",{children:"HTLCs are the atomic building blocks of Lightning:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Hash lock:"})," Requires preimage of hash H to claim"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Time lock:"})," Refund after timeout T if unclaimed"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Atomicity:"})," Either all HTLCs in a payment resolve, or none do"]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"SPHINX Onion Routing"}),e.jsx("p",{className:"mb-4",children:"Pickhardt explains the privacy layer:"}),e.jsx(r,{title:"Onion Encryption Process",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Sender builds layers:"})," Starting from recipient, encrypt instructions for each hop using ephemeral Diffie-Hellman"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Key blinding:"})," Each hop multiplies the ephemeral public key by a blinding factor, unlinking packets"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Fixed packet size:"})," After decryption, filler is added to maintain 1300 bytes"]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Five Stages of HTLC Validity"}),e.jsx("p",{className:"mb-4",children:"For an HTLC to be considered valid and committed:"}),e.jsx("div",{className:"bg-dark-800/50 rounded-lg p-6 border border-dark-700/50 mb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-amber-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-amber-400 font-bold",children:"1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"update_add_htlc"}),e.jsx("p",{className:"text-sm text-dark-400",children:"One party proposes the HTLC"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-amber-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-amber-400 font-bold",children:"2"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"commitment_signed"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Proposer signs the new commitment including the HTLC"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-amber-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-amber-400 font-bold",children:"3"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"revoke_and_ack"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Receiver revokes their old state and acknowledges"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-amber-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-amber-400 font-bold",children:"4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"commitment_signed"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Receiver signs their version with the HTLC"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-amber-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-amber-400 font-bold",children:"5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-dark-200 font-medium",children:"revoke_and_ack"}),e.jsx("p",{className:"text-sm text-dark-400",children:"Proposer revokes their old state—HTLC now irrevocably committed"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Fee Encoding"}),e.jsx("p",{className:"mb-4",children:"Routing fees are implicit in the forwarding amounts:"}),e.jsxs("blockquote",{className:"border-l-4 border-amber-500/50 pl-4 py-2 my-6 text-dark-300 italic bg-dark-800/30 rounded-r-lg",children:[e.jsx("p",{children:`"There's no explicit fee field in the HTLC. Instead, each hop receives more than it forwards. The difference is the fee. So if I receive 1010 sats and my payload says forward 1000, I keep 10 as my fee."`}),e.jsx("cite",{className:"block text-sm text-dark-500 mt-2 not-italic",children:"— Rene Pickhardt"})]}),e.jsxs(t,{title:"Fee Calculation",children:[e.jsx("p",{children:"Total fees for a route:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Base fee:"})," Fixed amount per forwarded HTLC"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Proportional fee:"})," Percentage of amount forwarded"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Formula:"})," fee = base_fee + (amount × fee_rate / 1,000,000)"]})]})]}),e.jsx(s,{type:"info",title:"Routing Myths Debunked",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Myth:"}),' "Lightning needs centralized hubs" — False, source routing is decentralized']}),e.jsxs("li",{children:[e.jsx("strong",{children:"Myth:"}),` "Large payments can't route" — AMPs allow splitting across paths`]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Myth:"}),' "You need all network state" — Trampoline routing delegates pathfinding']})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Related Sections"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("a",{href:"#/section/7",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 7: Channel Operations"}),e.jsx("p",{className:"text-sm text-dark-500",children:"HTLC update flow"})]}),e.jsxs("a",{href:"#/section/18",className:"p-4 rounded-xl bg-dark-800/50 border border-dark-700/50 hover:border-amber-500/30 transition-colors group",children:[e.jsx("p",{className:"text-dark-200 font-medium group-hover:text-amber-400 transition-colors",children:"Section 18: Onion Routing"}),e.jsx("p",{className:"text-sm text-dark-500",children:"SPHINX packet details"})]})]})]})}export{m as default};
