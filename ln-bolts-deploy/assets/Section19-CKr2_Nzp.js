import{j as e}from"./vendor-animation-0o8UKZ_1.js";import"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-BbBpzejs.js";import{L as l}from"./LessonLayout-Bq4tucEw.js";import{E as i,D as n,T as s,C as t}from"./Callout-BvJhqaqq.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-C4dST7Re.js";function m(){return e.jsxs(l,{sectionId:19,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Blinded Paths"}),e.jsx("p",{className:"mb-4",children:"Blinded paths (route blinding) allow a recipient to hide their node identity and the final portion of the payment route. This provides strong privacy for merchants and recipients who don't want to reveal their network position."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Why Blinded Paths?"}),e.jsx("p",{className:"mb-4",children:"Standard Lightning payments require knowing the recipient's node ID and finding a route to them. This reveals:"}),e.jsx(i,{title:"Privacy Concerns Without Blinding",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Recipient Identity:"})," Their public node ID is exposed"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Network Position:"})," Which channels lead to them"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Channel Partners:"})," Who they have channels with"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Capacity Info:"})," Details about their channels"]})]})}),e.jsx(n,{title:"Blinded Path",children:'A path where node IDs are replaced with "blinded" identifiers and routing instructions are encrypted. Only the introduction point (first hop of the blinded portion) knows the real identity of the next hop.'}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Blinded Path Structure"}),e.jsx("p",{className:"mb-4",children:"A blinded path consists of:"}),e.jsx(i,{title:"Blinded Path Components",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left py-2",children:"Field"}),e.jsx("th",{className:"text-left py-2",children:"Description"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-2 font-mono",children:"introduction_node_id"}),e.jsx("td",{className:"py-2",children:"Real node ID of the entry point"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-2 font-mono",children:"blinding_point"}),e.jsx("td",{className:"py-2",children:"Initial ephemeral key for blinding"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 font-mono",children:"blinded_hops[]"}),e.jsx("td",{className:"py-2",children:"List of (blinded_node_id, encrypted_data) pairs"})]})]})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Creating Blinded Paths"}),e.jsx("p",{className:"mb-4",children:"The recipient creates blinded paths they include in invoices or offers:"}),e.jsxs(s,{title:"Blinded Node ID Creation",children:["For each hop in the blinded portion:",e.jsxs("ol",{className:"list-decimal list-inside space-y-2 mt-2",children:[e.jsx("li",{children:"Compute shared secret with the hop's real node ID"}),e.jsx("li",{children:"Derive blinding factor from shared secret"}),e.jsx("li",{children:"Multiply real node ID by blinding factor to get blinded ID"}),e.jsx("li",{children:"Encrypt routing data for that hop"}),e.jsx("li",{children:"Derive next blinding point for the following hop"})]})]}),e.jsxs(n,{title:"Encrypted Data Payload",children:["Each hop's encrypted_data contains:",e.jsxs("ul",{className:"mt-2 list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"short_channel_id:"})," Which channel to forward on"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"next_blinding_override:"})," Optional new blinding point"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"payment_relay:"})," Fee and CLTV delta info"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"payment_constraints:"})," Max CLTV, min amount"]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Processing Blinded Hops"}),e.jsx("p",{className:"mb-4",children:"When a node receives a payment for a blinded path:"}),e.jsx(i,{title:"Blinded Hop Processing",children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[e.jsx("li",{children:"Receive blinding_point from onion payload"}),e.jsx("li",{children:"Compute shared secret: ECDH(blinding_point, node_privkey)"}),e.jsx("li",{children:"Derive decryption key from shared secret"}),e.jsx("li",{children:"Decrypt the encrypted_data to get routing instructions"}),e.jsx("li",{children:"Compute next_blinding_point for the next hop"}),e.jsx("li",{children:"Forward with the next blinded_node_id"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Security Properties"}),e.jsx(s,{title:"Blinded Path Privacy",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 mt-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Recipient Hidden:"})," Only the final hop knows it's the recipient"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Path Hidden:"})," Intermediate hops only see blinded IDs"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Introduction Point:"})," The only public node in the blinded portion"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Correlation Resistant:"})," Same path can use different blinding points"]})]})}),e.jsx(t,{type:"info",title:"Multiple Blinded Paths",children:"Recipients often provide multiple blinded paths with different introduction points. This improves reliability (if one path fails) and privacy (sender chooses randomly)."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Use Cases"}),e.jsx(i,{title:"Blinded Path Applications",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Private Merchants:"})," Accept payments without revealing node identity"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Mobile Wallets:"})," Receive payments without public channels"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"BOLT #12 Offers:"})," Include blinded paths for invoice requests"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Async Payments:"})," Pre-generate paths for offline receiving"]})]})}),e.jsx(t,{type:"warning",title:"Trade-offs",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Longer paths = higher fees and more potential failures"}),e.jsx("li",{children:"Introduction point knows it's an introduction point"}),e.jsx("li",{children:"Path must be regenerated if channels change"}),e.jsx("li",{children:"Sender doesn't know actual path cost until they try"})]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Compact Blinded Paths"}),e.jsx("p",{className:"mb-4",children:"To reduce invoice size, blinded paths can be compacted:"}),e.jsx(n,{title:"Path Compaction",children:e.jsxs("ul",{className:"mt-2 list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Use short_channel_id instead of full 33-byte node IDs where possible"}),e.jsx("li",{children:"Omit optional fields with default values"}),e.jsx("li",{children:"Aggregate fees for entire blinded portion"})]})})]})}export{m as default};
