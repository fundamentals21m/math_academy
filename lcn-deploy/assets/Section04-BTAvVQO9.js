import{j as e,m as n,A as f}from"./vendor-animation-0o8UKZ_1.js";import{r as o}from"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-ClrsR7XR.js";import{L as b,D as u}from"./ContentBlocks-BLSOaBh_.js";import{I as s,M as d}from"./MathBlock-uz1iP4cD.js";import{C as c}from"./Callout-Dt8juvZK.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-Bnq9ppQi.js";function j({className:m=""}){const[a,h]=o.useState("full"),[i,x]=o.useState(!1),l={full:{name:"Full Protocol",missing:"None",consequence:"All blinding factors present. Transcript values are uniformly distributed.",isPSHVZK:!0},A:{name:"Variant A",missing:"s_a (blinding for a)",consequence:"The response l = a + s_a·x becomes l = a + 0·x = a, directly revealing a!",isPSHVZK:!1},B:{name:"Variant B",missing:"s_S (blinding for S)",consequence:"The commitment S loses its randomness, and μ reveals s_C.",isPSHVZK:!1},C:{name:"Variant C",missing:"τ₂ (blinding for T₂)",consequence:"T₂ = s_a·s_b·G₀ reveals information about the product of blinding factors.",isPSHVZK:!1}},r=l[a],p=[{name:"S",formula:"s_a·G₀ + s_b·G₁ + s_S·H",affected:a==="B"},{name:"T₁",formula:"s_a·b·G₀ + s_b·a·G₀ + τ₁·H",affected:!1},{name:"T₂",formula:"s_a·s_b·G₀ + τ₂·H",affected:a==="C"},{name:"l",formula:"a + s_a·x",affected:a==="A"},{name:"r",formula:"b + s_b·x",affected:!1},{name:"μ",formula:"s_S + (s_a·s_b + τ₁)·x + τ₂·x²",affected:a==="B"||a==="C"},{name:"τ_x",formula:"s_V + τ₁·x + τ₂·x²",affected:a==="C"}];return e.jsxs("div",{className:`p-6 rounded-2xl bg-dark-800/50 border border-dark-700/50 ${m}`,children:[e.jsx("h3",{className:"text-xl font-bold text-dark-100 mb-2",children:"PSHVZK Variant Comparison"}),e.jsx("p",{className:"text-dark-400 text-sm mb-4",children:"See what happens when we remove blinding factors from the multiplication protocol."}),e.jsx("div",{className:"flex gap-2 mb-6 flex-wrap",children:Object.keys(l).map(t=>e.jsx(n.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>h(t),className:`px-4 py-2 rounded-xl text-sm font-medium transition-colors ${a===t?l[t].isPSHVZK?"bg-emerald-500 text-white":"bg-red-500 text-white":"bg-dark-700 text-dark-400 hover:bg-dark-600"}`,children:t==="full"?"Full Protocol":`Variant ${t}`},t))}),e.jsxs(n.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`p-4 rounded-xl mb-6 ${r.isPSHVZK?"bg-emerald-500/10 border border-emerald-500/30":"bg-red-500/10 border border-red-500/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:`text-2xl ${r.isPSHVZK?"":"animate-pulse"}`,children:r.isPSHVZK?"✓":"✗"}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-bold ${r.isPSHVZK?"text-emerald-400":"text-red-400"}`,children:r.name}),e.jsx("p",{className:`text-sm ${r.isPSHVZK?"text-emerald-300":"text-red-300"}`,children:r.isPSHVZK?"PSHVZK holds":"PSHVZK broken"})]})]}),a!=="full"&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-600/50",children:[e.jsxs("p",{className:"text-dark-400 text-sm",children:[e.jsx("span",{className:"text-red-400 font-mono",children:"Missing:"})," ",r.missing]}),e.jsxs("p",{className:"text-dark-400 text-sm mt-1",children:[e.jsx("span",{className:"text-amber-400 font-mono",children:"Consequence:"})," ",r.consequence]})]})]},a),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-dark-200 font-medium mb-3",children:"Protocol Transcript"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:p.map(t=>e.jsxs(n.div,{animate:{backgroundColor:t.affected?"rgba(239, 68, 68, 0.15)":"rgba(55, 65, 81, 0.3)",borderColor:t.affected?"rgba(239, 68, 68, 0.5)":"rgba(75, 85, 99, 0.5)"},className:"p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-mono font-bold ${t.affected?"text-red-400":"text-primary-400"}`,children:t.name}),t.affected&&e.jsx(n.span,{initial:{scale:0},animate:{scale:1},className:"text-red-400 text-xs bg-red-500/20 px-2 py-0.5 rounded",children:"LEAKS INFO"})]}),e.jsxs("p",{className:`text-xs font-mono mt-1 ${t.affected?"text-red-300 line-through":"text-dark-400"}`,children:["= ",t.formula]})]},t.name))})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("button",{onClick:()=>x(!i),className:`px-4 py-2 rounded-xl text-sm font-medium transition-colors ${i?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-dark-700 text-dark-400 hover:bg-dark-600"}`,children:[i?"Hide":"Show"," Distinguisher Attack"]})}),e.jsx(f,{children:i&&!r.isPSHVZK&&e.jsx(n.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:e.jsxs("div",{className:"p-4 rounded-xl bg-amber-500/10 border border-amber-500/20",children:[e.jsx("h4",{className:"text-amber-400 font-medium mb-2",children:"How an Adversary Distinguishes"}),e.jsxs("div",{className:"space-y-2 text-sm text-dark-300",children:[a==="A"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["1. Receive transcript with ",e.jsx("code",{className:"text-red-400",children:"l = a"})," (no blinding)"]}),e.jsxs("p",{children:["2. Check if ",e.jsx("code",{className:"text-primary-400",children:"l·G₀ + r·G₁ = C"})," gives l that divides commitment"]}),e.jsx("p",{children:"3. In real protocol: l contains the actual witness value a!"}),e.jsx("p",{children:"4. Simulator cannot produce this since it doesn't know a"})]}),a==="B"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["1. S has no blinding: ",e.jsx("code",{className:"text-red-400",children:"S = s_a·G₀ + s_b·G₁"})]}),e.jsx("p",{children:"2. Adversary can extract relationship between s_a, s_b from S"}),e.jsx("p",{children:"3. Combined with μ, this reveals s_C"}),e.jsx("p",{children:"4. Simulator's S would have different distribution"})]}),a==="C"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["1. T₂ becomes ",e.jsx("code",{className:"text-red-400",children:"T₂ = s_a·s_b·G₀"})," (no τ₂)"]}),e.jsx("p",{children:"2. This is a deterministic function of blinding factors"}),e.jsx("p",{children:"3. Adversary can verify T₂ against other transcript values"}),e.jsx("p",{children:"4. Simulator cannot fake this relationship"})]})]})]})})}),i&&r.isPSHVZK&&e.jsx("div",{className:"p-4 rounded-xl bg-emerald-500/10 border border-emerald-500/20",children:e.jsxs("p",{className:"text-emerald-400 text-sm",children:[e.jsx("strong",{children:"No distinguisher exists!"})," With all blinding factors, every transcript value is uniformly distributed. A simulator can produce identically distributed transcripts without knowing the witness."]})}),e.jsx("div",{className:"mt-4 p-4 rounded-xl bg-dark-700/30 border border-dark-600/30",children:e.jsxs("p",{className:"text-dark-400 text-sm",children:[e.jsx("strong",{className:"text-primary-400",children:"Key Insight:"})," Each blinding factor serves a specific purpose. Remove any one, and the transcript leaks information that allows distinguishing real proofs from simulated ones."]})})]})}function _(){return e.jsxs(b,{sectionId:4,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Perfect Special Honest Verifier Zero Knowledge"}),e.jsx("p",{className:"mb-4",children:"Perfect Special Honest Verifier Zero Knowledge (PSHVZK) is a specific and important variant of zero-knowledge. Understanding this definition precisely is crucial for proving the security of cryptographic protocols."}),e.jsxs(u,{title:"Perfect Special Honest Verifier Zero-Knowledge (PSHVZK)",children:[e.jsxs("p",{children:["The protocol ",e.jsxs(s,{children:["(\\text","{Setup}",", \\mathsf","{P}",", \\mathsf","{V}",")"]})," has"," ",e.jsx("strong",{children:"perfect Special Honest Verifier Zero-Knowledge (PSHVZK)"})," if there exists a probabilistic polynomial time (PPT) simulator ",e.jsxs(s,{children:["\\mathcal","{S}"]})," such that for all pairs of adversaries ",e.jsxs(s,{children:["(\\mathcal","{A}","_1, \\mathcal","{A}","_2)"]}),":"]}),e.jsx(d,{children:"\\Pr\\left[\\begin{array}{c} (\\sigma, x, w) \\in \\mathcal{R} \\\\ \\land\\; \\mathcal{A}_2(\\sigma, \\pi) = 1 \\end{array} \\;\\middle|\\; \\begin{array}{l} \\sigma \\leftarrow \\text{Setup}(1^\\lambda) \\\\ (x, w, \\rho) \\leftarrow \\mathcal{A}_1(\\sigma) \\\\ \\pi \\leftarrow \\langle \\mathsf{P}(\\sigma, x, w), \\mathsf{V}(\\sigma, x; \\rho) \\rangle \\end{array}\\right]"}),e.jsx(d,{children:"= \\Pr\\left[\\begin{array}{c} (\\sigma, x, w) \\in \\mathcal{R} \\\\ \\land\\; \\mathcal{A}_2(\\sigma, \\pi) = 1 \\end{array} \\;\\middle|\\; \\begin{array}{l} \\sigma \\leftarrow \\text{Setup}(1^\\lambda) \\\\ (x, w, \\rho) \\leftarrow \\mathcal{A}_1(\\sigma) \\\\ \\pi \\leftarrow \\mathcal{S}(x, \\rho) \\end{array}\\right]"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Understanding the Definition"}),e.jsx("p",{className:"mb-4",children:"Let's unpack the key aspects of this definition:"}),e.jsx(c,{type:"info",title:"The Randomness Parameter",children:e.jsxs("p",{children:["Note that ",e.jsxs(s,{children:["\\mathsf","{V}","(\\sigma, x; \\rho)"]})," means that"," ",e.jsxs(s,{children:["\\mathsf","{V}"]})," is run on randomness ",e.jsx(s,{children:"\\rho"}),". The word ",e.jsx("strong",{children:'"special"'})," in PSHVZK refers to the fact that the simulator gets access to the ",e.jsx("em",{children:"same randomness"})," ",e.jsx(s,{children:"\\rho"})," as the verifier."]})}),e.jsx("h4",{className:"text-lg font-semibold text-dark-100 mt-6 mb-3",children:'Why "Honest Verifier"?'}),e.jsxs("p",{className:"mb-4",children:["The definition assumes the verifier follows the protocol honestly (uses truly random"," ",e.jsx(s,{children:"\\rho"}),"). This is a weaker guarantee than full zero-knowledge, which must hold against arbitrary verifier strategies."]}),e.jsx("h4",{className:"text-lg font-semibold text-dark-100 mt-6 mb-3",children:'Why "Perfect"?'}),e.jsxs("p",{className:"mb-4",children:["The equality of probabilities is ",e.jsx("em",{children:"exact"}),", not just computationally indistinguishable. The simulated transcripts are distributed identically to real transcripts, providing ",e.jsx("strong",{children:"information-theoretic"})," (not just computational) zero-knowledge."]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"When is a Protocol NOT PSHVZK?"}),e.jsxs("p",{className:"mb-4",children:["It follows that a protocol is ",e.jsx("strong",{children:"not SHVZK"})," if there exist adversaries"," ",e.jsxs(s,{children:["(\\mathcal","{A}","_1, \\mathcal","{A}","_2)"]})," which can distinguish between:"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 mb-6",children:[e.jsxs("li",{children:["A transcript ",e.jsx(s,{children:"\\pi"})," generated by real interaction between prover and verifier"]}),e.jsxs("li",{children:["A simulated transcript produced by a simulator ",e.jsxs("em",{children:["without access to the witness"," ",e.jsx(s,{children:"w"})]})]})]}),e.jsx(c,{type:"warning",title:"Adversary Power",children:e.jsxs("p",{children:["Importantly, in the PSHVZK definition, the adversary is ",e.jsx("strong",{children:"not restricted to polynomial time"})," and comes up with the statement and the witness. This means the distinguisher ",e.jsxs(s,{children:["\\mathcal","{A}","_2"]})," can solve the discrete logarithm problem and knows witnesses like ",e.jsx(s,{children:"a"})," and"," ",e.jsx(s,{children:"s_C"}),"."]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Simulator's Challenge"}),e.jsx("p",{className:"mb-4",children:"The simulator must produce transcripts that look real without knowing the witness. It has access to:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:["The statement ",e.jsx(s,{children:"x"})]}),e.jsxs("li",{children:["The verifier's randomness ",e.jsx(s,{children:"\\rho"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"NOT"})," the witness ",e.jsx(s,{children:"w"})]})]}),e.jsx("p",{className:"mt-4",children:"The next sections will demonstrate how to construct such simulators for specific protocols."}),e.jsx(j,{className:"my-8"})]})}export{_ as default};
