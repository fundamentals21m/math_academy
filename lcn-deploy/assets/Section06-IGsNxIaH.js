import{j as e,m as t,A as f}from"./vendor-animation-0o8UKZ_1.js";import{r as h}from"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-ClrsR7XR.js";import{L as g,T as v}from"./ContentBlocks-BLSOaBh_.js";import{I as s,M as d}from"./MathBlock-uz1iP4cD.js";import{C as o}from"./Callout-Dt8juvZK.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-Bnq9ppQi.js";function y({className:p=""}){const[i,c]=h.useState("intro"),[a,u]=h.useState({x:7,l:23,r:41,mu:19,tau_x:31,T2:"T‚ÇÇ"}),l=["intro","sample","derive_S","derive_T1","compare"],n=l.indexOf(i),x=()=>{u({x:Math.floor(Math.random()*100)+1,l:Math.floor(Math.random()*100)+1,r:Math.floor(Math.random()*100)+1,mu:Math.floor(Math.random()*100)+1,tau_x:Math.floor(Math.random()*100)+1,T2:"T‚ÇÇ"})},j=()=>{const r=l[Math.min(n+1,l.length-1)];r==="sample"&&x(),c(r)},b=()=>{c(l[Math.max(n-1,0)])};return e.jsxs("div",{className:`p-6 rounded-2xl bg-dark-800/50 border border-dark-700/50 ${p}`,children:[e.jsx("h3",{className:"text-xl font-bold text-dark-100 mb-2",children:"PSHVZK Simulator Construction"}),e.jsx("p",{className:"text-dark-400 text-sm mb-4",children:"See how the simulator produces valid transcripts without knowing the witness."}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:b,disabled:n===0,className:"px-3 py-1.5 rounded-lg bg-dark-600 hover:bg-dark-500 disabled:opacity-30 text-dark-200 text-sm",children:"‚Üê Back"}),e.jsx(t.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:j,disabled:n===l.length-1,className:"px-4 py-1.5 rounded-lg bg-primary-500 hover:bg-primary-600 disabled:opacity-50 text-white text-sm font-medium",children:"Next ‚Üí"}),e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"flex gap-1",children:l.map((r,m)=>e.jsx("button",{onClick:()=>c(r),className:`w-8 h-8 rounded-lg text-xs font-medium transition-colors ${n===m?"bg-primary-500 text-white":n>m?"bg-emerald-500/30 text-emerald-400":"bg-dark-700 text-dark-500"}`,children:m+1},r))})]}),e.jsxs(f,{mode:"wait",children:[i==="intro"&&e.jsxs(t.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-purple-500/10 border border-purple-500/20",children:[e.jsx("h4",{className:"text-purple-400 font-bold mb-2",children:"The Simulator's Challenge"}),e.jsxs("p",{className:"text-dark-300 text-sm",children:["The simulator must produce a transcript that looks identical to a real proof, but ",e.jsx("strong",{className:"text-purple-400",children:"without knowing the witness"})," (a, b, and their blinding factors)."]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-700/30",children:[e.jsx("h4",{className:"text-dark-200 font-medium mb-2",children:"Key Insight"}),e.jsxs("p",{className:"text-dark-400 text-sm",children:["The simulator receives the verifier's randomness (challenge x) in advance. It works ",e.jsx("strong",{className:"text-amber-400",children:"backwards"})," from the verification equations to derive commitments S and T‚ÇÅ."]})]})]},"intro"),i==="sample"&&e.jsx(t.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:e.jsxs("div",{className:"p-4 rounded-xl bg-cyan-500/10 border border-cyan-500/20",children:[e.jsx("h4",{className:"text-cyan-400 font-bold mb-2",children:"Step 1: Sample Random Values"}),e.jsx("p",{className:"text-dark-300 text-sm mb-3",children:"The simulator samples the transcript values uniformly at random:"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{name:"x",value:a.x,desc:"challenge (from verifier)"},{name:"l",value:a.l,desc:"left response"},{name:"r",value:a.r,desc:"right response"},{name:"Œº",value:a.mu,desc:"blinding response"},{name:"œÑ_x",value:a.tau_x,desc:"value blinding"},{name:"T‚ÇÇ",value:"(random point)",desc:"quadratic commitment"}].map(r=>e.jsxs(t.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"p-3 rounded-lg bg-dark-700/50",children:[e.jsx("span",{className:"text-cyan-400 font-mono font-bold",children:r.name}),e.jsx("span",{className:"text-dark-400",children:" = "}),e.jsx("span",{className:"text-dark-100 font-mono",children:(typeof r.value=="number",r.value)}),e.jsx("p",{className:"text-dark-500 text-xs mt-1",children:r.desc})]},r.name))}),e.jsx(t.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:x,className:"mt-3 px-4 py-2 rounded-lg bg-cyan-500/20 text-cyan-400 text-sm hover:bg-cyan-500/30",children:"üé≤ Resample Values"})]})},"sample"),i==="derive_S"&&e.jsx(t.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:e.jsxs("div",{className:"p-4 rounded-xl bg-emerald-500/10 border border-emerald-500/20",children:[e.jsx("h4",{className:"text-emerald-400 font-bold mb-2",children:"Step 2: Derive S from Verification Equation 1"}),e.jsx("p",{className:"text-dark-300 text-sm mb-3",children:"Rearrange the first verification equation to solve for S:"}),e.jsxs("div",{className:"space-y-3 font-mono text-sm",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-dark-800/50",children:[e.jsx("p",{className:"text-dark-400",children:"Original equation:"}),e.jsx("p",{className:"text-emerald-300",children:"l¬∑G‚ÇÄ + r¬∑G‚ÇÅ + Œº¬∑H = C + x¬∑S"})]}),e.jsx("div",{className:"text-center text-dark-500",children:"‚Üì solve for S"}),e.jsxs("div",{className:"p-3 rounded-lg bg-emerald-500/20 border border-emerald-500/30",children:[e.jsx("p",{className:"text-dark-400",children:"Simulator computes:"}),e.jsx("p",{className:"text-emerald-400 font-bold",children:"S = (1/x)(l¬∑G‚ÇÄ + r¬∑G‚ÇÅ + Œº¬∑H - C)"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-dark-700/50",children:[e.jsx("p",{className:"text-dark-400 text-xs",children:"With sampled values:"}),e.jsxs("p",{className:"text-dark-300",children:["S = (1/",a.x,")(",a.l,"¬∑G‚ÇÄ + ",a.r,"¬∑G‚ÇÅ + ",a.mu,"¬∑H - C)"]})]})]})]})},"derive_S"),i==="derive_T1"&&e.jsx(t.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:e.jsxs("div",{className:"p-4 rounded-xl bg-amber-500/10 border border-amber-500/20",children:[e.jsx("h4",{className:"text-amber-400 font-bold mb-2",children:"Step 3: Derive T‚ÇÅ from Verification Equation 2"}),e.jsx("p",{className:"text-dark-300 text-sm mb-3",children:"Rearrange the second verification equation to solve for T‚ÇÅ:"}),e.jsxs("div",{className:"space-y-3 font-mono text-sm",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-dark-800/50",children:[e.jsx("p",{className:"text-dark-400",children:"Original equation:"}),e.jsx("p",{className:"text-amber-300",children:"l¬∑r¬∑G‚ÇÄ + œÑ_x¬∑H = V + x¬∑T‚ÇÅ + x¬≤¬∑T‚ÇÇ"})]}),e.jsx("div",{className:"text-center text-dark-500",children:"‚Üì solve for T‚ÇÅ"}),e.jsxs("div",{className:"p-3 rounded-lg bg-amber-500/20 border border-amber-500/30",children:[e.jsx("p",{className:"text-dark-400",children:"Simulator computes:"}),e.jsx("p",{className:"text-amber-400 font-bold",children:"T‚ÇÅ = (1/x)(l¬∑r¬∑G‚ÇÄ + œÑ_x¬∑H - V - x¬≤¬∑T‚ÇÇ)"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-dark-700/50",children:[e.jsx("p",{className:"text-dark-400 text-xs",children:"With sampled values:"}),e.jsxs("p",{className:"text-dark-300",children:["T‚ÇÅ = (1/",a.x,")(",a.l,"¬∑",a.r,"¬∑G‚ÇÄ + ",a.tau_x,"¬∑H - V - ",a.x,"¬≤¬∑T‚ÇÇ)"]})]})]})]})},"derive_T1"),i==="compare"&&e.jsxs(t.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-purple-500/10 border border-purple-500/20",children:[e.jsx("h4",{className:"text-purple-400 font-bold mb-2",children:"Result: Identical Distributions!"}),e.jsx("p",{className:"text-dark-300 text-sm mb-4",children:"The simulated transcript is indistinguishable from a real transcript:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/20",children:[e.jsx("h5",{className:"text-emerald-400 font-medium text-sm mb-2",children:"Real Transcript"}),e.jsx("p",{className:"text-dark-400 text-xs",children:"Generated using actual witness (a, b) and random blinding factors. Values are distributed uniformly due to blinding."})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-purple-500/10 border border-purple-500/20",children:[e.jsx("h5",{className:"text-purple-400 font-medium text-sm mb-2",children:"Simulated Transcript"}),e.jsx("p",{className:"text-dark-400 text-xs",children:"Generated by sampling uniformly and deriving commitments. Values are distributed uniformly by construction."})]})]}),e.jsxs("div",{className:"mt-4 p-3 rounded-lg bg-dark-700/50 text-center",children:[e.jsxs("p",{className:"text-dark-300 text-sm",children:[e.jsx("span",{className:"text-emerald-400 font-mono",children:"Real"}),e.jsx("span",{className:"text-dark-500 mx-2",children:"‚â°"}),e.jsx("span",{className:"text-purple-400 font-mono",children:"Simulated"})]}),e.jsx("p",{className:"text-dark-500 text-xs mt-1",children:"(identical probability distributions)"})]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-700/30",children:[e.jsx("h4",{className:"text-dark-200 font-medium mb-2",children:"Why This Proves Zero-Knowledge"}),e.jsxs("p",{className:"text-dark-400 text-sm",children:["If a simulator can produce transcripts that look exactly like real ones",e.jsx("strong",{className:"text-purple-400",children:" without the witness"}),", then the verifier learns nothing from a real transcript that they couldn't compute themselves. The proof reveals no information about a or b!"]})]})]},"compare")]})]})}function C(){return e.jsxs(g,{sectionId:6,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"PSHVZK Proof for Multiplication"}),e.jsx("p",{className:"mb-4",children:"This section provides a rigorous proof that the multiplication protocol from the previous section has Perfect Special Honest Verifier Zero Knowledge. We'll also examine variants that break PSHVZK to build intuition."}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-6 mb-4",children:"Variants That Break PSHVZK"}),e.jsxs(o,{type:"warning",title:"Variant A: Removing Blinding Factor",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Variant A:"})," ",e.jsx(s,{children:"s_a"})," is removed from the protocol, i.e., the prover sends ",e.jsx(s,{children:"l = l(x) = a"}),"."]}),e.jsxs("p",{className:"mt-2",children:["This is ",e.jsx("strong",{children:"not PSHVZK"})," as it's impossible to build a simulator. The adversary knows witness ",e.jsx(s,{children:"a"})," and can therefore easily notice if ",e.jsx(s,{children:"l"})," obtained from the transcript is not equal to"," ",e.jsx(s,{children:"a"}),". The simulator doesn't have access to the witness. To produce a transcript with an indistinguishable ",e.jsx(s,{children:"l"}),", it would have to guess ",e.jsx(s,{children:"a"})," or break the hiding property."]})]}),e.jsxs(o,{type:"warning",title:"Variant B: Removing Commitment Blinding",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Variant B:"})," ",e.jsx(s,{children:"s_S"})," is removed from the protocol, i.e., the prover sends ",e.jsx(s,{children:"\\mu = s_C"}),"."]}),e.jsxs("p",{className:"mt-2",children:["This is ",e.jsx("strong",{children:"not PSHVZK"})," for the same reason. The adversary knows witness ",e.jsx(s,{children:"s_C"})," and could compare it with"," ",e.jsx(s,{children:"\\mu"})," to distinguish simulated from real transcripts."]})]}),e.jsxs(o,{type:"warning",title:"Variant C: Removing Polynomial Blinding",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Variant C:"})," ",e.jsx(s,{children:"\\tau_2"})," is removed from the protocol, i.e., the prover sends ",e.jsx(s,{children:"T_2 = s_a s_b G_0"}),"."]}),e.jsxs("p",{className:"mt-2",children:["This is ",e.jsx("strong",{children:"probably not PSHVZK"})," as it seems impossible to build a simulator. The adversary, knowing ",e.jsx(s,{children:"a"}),","," ",e.jsx(s,{children:"b"}),", and ",e.jsx(s,{children:"x"}),", can compute"," ",e.jsx(s,{children:"s_a"})," and ",e.jsx(s,{children:"s_b"})," from polynomials"," ",e.jsx(s,{children:"l(x)"})," and ",e.jsx(s,{children:"r(x)"}),". The adversary could then check whether ",e.jsx(s,{children:"s_a s_b G_0"})," equals"," ",e.jsx(s,{children:"T_2"})," from the transcript."]})]}),e.jsx(v,{title:"Theorem 1: PSHVZK for Multiplication Protocol",proof:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"1."})," It suffices to describe a PPT simulator that, on input of the statement, outputs a transcript"," ",e.jsx(s,{children:"\\pi = (x, l, r, \\mu, \\tau_x, S, T_1, T_2)"})," such that the probability distribution is equal to that of a real transcript."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"2."})," Let ",e.jsxs(s,{children:["\\mathcal","{S}"]})," be a simulator which draws ",e.jsx(s,{children:"x, l, r, \\mu, \\tau_x, T_2"})," uniformly at random and sets:"]}),e.jsx(d,{children:"S := \\frac{1}{x}(lG_0 + rG_1 + \\mu H - C)"}),e.jsx(d,{children:"T_1 := \\frac{1}{x}(lrG_0 + \\tau_x H - V - x^2 T_2)"}),e.jsx("p",{children:"The simulator runs in polynomial time."}),e.jsxs("p",{children:[e.jsx("strong",{children:"3."})," The distribution of transcript output by the simulator is:"]}),e.jsx(d,{children:"\\Pr(\\pi) = \\Pr(x, l, r, \\mu, \\tau_x, S, T_1, T_2)"}),e.jsx(d,{children:"= \\begin{cases} 0 & \\text{if } S \\neq \\frac{1}{x}(lG_0 + rG_1 + \\mu H - C) \\\\ & \\text{or } T_1 \\neq \\frac{1}{x}(lrG_0 + \\tau_x H - V - x^2 T_2) \\\\[0.5em] \\Pr(x)\\Pr(l)\\Pr(r)\\Pr(\\mu)\\Pr(\\tau_x)\\Pr(T_2) & \\text{otherwise} \\end{cases}"}),e.jsx("p",{children:"where all marginal distributions are uniform."}),e.jsxs("p",{children:[e.jsx("strong",{children:"4."})," The distribution of transcript in a real interaction can be rewritten (by substituting hidden random variables) as:"]}),e.jsx(d,{children:"\\Pr(\\pi) = \\Pr(x)\\Pr(S|x,l,r,\\mu)\\Pr(T_1|x,l,r,\\tau_x,T_2)\\Pr(l)\\Pr(r)\\Pr(\\mu)\\Pr(\\tau_x)\\Pr(T_2)"}),e.jsxs("p",{children:[e.jsx("strong",{children:"5."})," We can verify that ",e.jsx(s,{children:"S"})," in a real transcript equals:"]}),e.jsx(d,{children:"S = \\frac{1}{x}(lG_0 + rG_1 + s_C H - C)"}),e.jsxs("p",{children:["which simplifies to ",e.jsx(s,{children:"\\frac{1}{x}(lG_0 + rG_1 + s_C H - C)"})," ","because the prover has a valid witness."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"6."})," Similarly, ",e.jsx(s,{children:"T_1"})," can be shown to equal the simulated form. Therefore, both distributions are equal. QED."]})]}),children:e.jsxs("p",{children:["The multiplication protocol for ",e.jsxs(s,{children:["\\mathcal","{R}","_","{mult}"]})," has perfect special HVZK."]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Key Insight"}),e.jsx("p",{className:"mb-4",children:"The proof works because:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:["All values ",e.jsx(s,{children:"l, r, \\mu, \\tau_x, T_2"})," in the transcript are uniformly distributed (thanks to the blinding factors)"]}),e.jsxs("li",{children:[e.jsx(s,{children:"S"})," and ",e.jsx(s,{children:"T_1"})," are fully determined by the verification equations"]}),e.jsxs("li",{children:["The simulator can compute ",e.jsx(s,{children:"S"})," and ",e.jsx(s,{children:"T_1"})," ","from the verification equations without knowing the witness"]})]}),e.jsx(o,{type:"info",title:"Why Each Blinding Factor Matters",children:e.jsxs("p",{children:["Each blinding factor (",e.jsx(s,{children:"s_a, s_b, s_S, \\tau_1, \\tau_2"}),") serves a specific purpose in making its corresponding value uniformly distributed. Removing any of them creates a value that depends on the witness, which the simulator cannot produce."]})}),e.jsx(y,{className:"my-8"})]})}export{C as default};
