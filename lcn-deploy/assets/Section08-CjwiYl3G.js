import{j as e,m as l,A as b}from"./vendor-animation-0o8UKZ_1.js";import{r as h}from"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-0SKjYqk6.js";import{L as N,D as y,T as k}from"./ContentBlocks-B8Bxhv2f.js";import{I as s,M as m}from"./MathBlock-uz1iP4cD.js";import{C as v}from"./Callout-Dt8juvZK.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-Bnq9ppQi.js";function S({className:x=""}){const[r,d]=h.useState([{name:"G",coefficient:3},{name:"X*",coefficient:2},{name:"R₁",coefficient:1}]),[i,p]=h.useState("Z"),[o,j]=h.useState(!0),u=()=>{const t=`R_${r.length}`;d([...r,{name:t,coefficient:1}])},f=t=>{r.length>1&&d(r.filter((a,n)=>n!==t))},g=(t,a)=>{d(r.map((n,c)=>c===t?{...n,coefficient:a}:n))};return e.jsxs("div",{className:`p-6 rounded-2xl bg-dark-800/50 border border-dark-700/50 ${x}`,children:[e.jsx("h3",{className:"text-xl font-bold text-dark-100 mb-2",children:"AGM Representation Visualizer"}),e.jsx("p",{className:"text-dark-400 text-sm mb-4",children:"In the Algebraic Group Model, adversaries must provide linear representations for every group element they output."}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-dark-300 text-sm mb-2",children:"Output Element Name:"}),e.jsx("input",{type:"text",value:i,onChange:t=>p(t.target.value),className:"w-32 px-3 py-2 rounded-lg bg-dark-700 border border-dark-600 text-primary-400 font-mono font-bold focus:outline-none focus:border-primary-500"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-dark-300 text-sm",children:"Base Elements (received so far):"}),e.jsx(l.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:u,className:"px-3 py-1 rounded-lg bg-emerald-500/20 text-emerald-400 text-sm hover:bg-emerald-500/30",children:"+ Add Element"})]}),e.jsx("div",{className:"space-y-2",children:r.map((t,a)=>e.jsxs(l.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"flex items-center gap-3 p-3 rounded-lg bg-dark-700/30",children:[e.jsx("span",{className:"text-cyan-400 font-mono font-bold w-12",children:t.name}),e.jsx("span",{className:"text-dark-500",children:"×"}),e.jsx("input",{type:"range",min:"-5",max:"10",value:t.coefficient,onChange:n=>g(a,parseInt(n.target.value)),className:"flex-1 h-2 bg-dark-600 rounded-lg appearance-none cursor-pointer accent-primary-500"}),e.jsx("span",{className:"text-primary-400 font-mono w-8 text-right",children:t.coefficient}),r.length>1&&e.jsx(l.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>f(a),className:"text-red-400 hover:text-red-300 text-sm",children:"✕"})]},a))})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-900/50 mb-4",children:[e.jsx("h4",{className:"text-dark-300 text-sm mb-3",children:"Linear Combination:"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1 font-mono text-lg mb-4",children:[e.jsx("span",{className:"text-primary-400 font-bold",children:i}),e.jsx("span",{className:"text-dark-500",children:"="}),r.map((t,a)=>e.jsxs("span",{className:"flex items-center",children:[a>0&&e.jsx("span",{className:"text-dark-500 mx-1",children:t.coefficient>=0?"+":""}),e.jsx(l.span,{initial:{scale:1.2,color:"#6366f1"},animate:{scale:1,color:"#d1d5db"},className:"text-dark-200",children:t.coefficient},`${t.name}-${t.coefficient}`),e.jsx("span",{className:"text-dark-500",children:"·"}),e.jsx("span",{className:"text-cyan-400",children:t.name})]},a))]}),e.jsxs("button",{onClick:()=>j(!o),className:`px-3 py-1 rounded-lg text-sm mb-3 ${o?"bg-purple-500/20 text-purple-400":"bg-dark-700 text-dark-400"}`,children:[o?"Hide":"Show"," Bracket Notation"]}),e.jsx(b,{children:o&&e.jsx(l.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:e.jsxs("div",{className:"p-3 rounded-lg bg-purple-500/10 border border-purple-500/20",children:[e.jsx("p",{className:"text-dark-400 text-sm mb-2",children:"AGM Representation:"}),e.jsxs("p",{className:"font-mono text-purple-400",children:["[",i,"] = (",i,", ",r.map(t=>`α_${t.name}`).join(", "),")"]}),e.jsxs("p",{className:"font-mono text-purple-300 text-sm mt-1",children:["[",i,"] = (",i,", ",r.map(t=>t.coefficient).join(", "),")"]})]})})})]}),e.jsxs("svg",{viewBox:"0 0 400 150",className:"w-full h-auto bg-dark-900/30 rounded-xl mb-4",children:[r.map((t,a)=>{const n=50+a*100%300,c=30+Math.floor(a/3)*40;return e.jsxs("g",{children:[e.jsx(l.circle,{cx:n,cy:c,r:"15",fill:"#06b6d420",stroke:"#06b6d4",strokeWidth:"2",initial:{scale:0},animate:{scale:1}}),e.jsx("text",{x:n,y:c+5,fill:"#06b6d4",fontSize:"10",textAnchor:"middle",fontFamily:"monospace",children:t.name}),e.jsx(l.line,{x1:n,y1:c+18,x2:"200",y2:"110",stroke:"#4b5563",strokeWidth:"1",strokeDasharray:"3,3",initial:{pathLength:0},animate:{pathLength:1},transition:{delay:a*.1}}),e.jsxs("text",{x:n,y:c+35,fill:"#6b7280",fontSize:"9",textAnchor:"middle",children:["×",t.coefficient]})]},a)}),e.jsxs(l.g,{initial:{scale:0},animate:{scale:1},transition:{delay:.3},children:[e.jsx("circle",{cx:"200",cy:"120",r:"20",fill:"#6366f120",stroke:"#6366f1",strokeWidth:"3"}),e.jsx("text",{x:"200",y:"125",fill:"#6366f1",fontSize:"14",fontWeight:"bold",textAnchor:"middle",fontFamily:"monospace",children:i})]}),e.jsx("text",{x:"200",y:"85",fill:"#9ca3af",fontSize:"16",textAnchor:"middle",children:"Σ"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-dark-700/30",children:[e.jsx("h4",{className:"text-dark-200 font-medium mb-2",children:"Why AGM Matters"}),e.jsxs("p",{className:"text-dark-400 text-sm",children:["In the AGM, when an adversary outputs a group element ",e.jsx("span",{className:"text-primary-400 font-mono",children:i}),", they must also output coefficients showing how ",e.jsx("span",{className:"text-primary-400 font-mono",children:i}),` is a linear combination of all previously received elements. This constraint allows reductions to "track" the adversary's computation, enabling proofs of security for schemes like SeqMuSig.`]})]})]})}function R(){return e.jsxs(N,{sectionId:8,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"SeqMuSig Security Proof"}),e.jsx("p",{className:"mb-4",children:"This section presents the security proof for SeqMuSig (Sequential MuSig) in the Algebraic Group Model (AGM). This is an advanced topic that shows how to reduce multi-signature security to regular blind signature security."}),e.jsxs(y,{title:"Algebraic Group Model (AGM)",children:[e.jsxs("p",{children:["In the AGM, adversaries are assumed to be ",e.jsx("strong",{children:"algebraic"}),". An algorithm"," ",e.jsxs(s,{children:["\\mathcal","{A}"]})," is algebraic w.r.t. some group description"," ",e.jsxs(s,{children:["(\\mathbb","{G}",", p, g)"]})," if for all group elements"," ",e.jsx(s,{children:"Z"})," that it outputs, it also provides a"," ",e.jsx("strong",{children:"representation"})," of ",e.jsx(s,{children:"Z"})," relative to all previously received group elements."]}),e.jsxs("p",{className:"mt-3",children:["Formally: if ",e.jsxs(s,{children:["\\mathcal","{A}"]})," has received"," ",e.jsxs(s,{children:["(Y_1, \\ldots, Y_n) \\in \\mathbb","{G}","^n"]}),", then"," ",e.jsxs(s,{children:["\\mathcal","{A}"]})," must output ",e.jsx(s,{children:"Z"})," ","together with ",e.jsxs(s,{children:["(\\alpha_1, \\ldots, \\alpha_n) \\in (\\mathbb","{Z}","_p)^n"]})," ","such that:"]}),e.jsx(m,{children:"Z = \\sum_{i=1}^n \\alpha_i Y_i"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Notation"}),e.jsxs("p",{className:"mb-4",children:["We write ",e.jsx(s,{children:"[Z]"})," for a group element ",e.jsx(s,{children:"Z"})," ","augmented with its representation:"]}),e.jsx(m,{children:"[Z] = (Z, \\alpha_1, \\ldots, \\alpha_n)"}),e.jsxs("p",{className:"mt-4 mb-4",children:["When the adversary returns a multiset of group elements ",e.jsx(s,{children:"L"}),", we write ",e.jsx(s,{children:"[L]"})," for the multiset of augmented group elements."]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Core Algorithms"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-indigo-400 font-bold mb-2",children:"KeyGen()"}),e.jsxs("p",{className:"font-mono text-sm",children:[e.jsxs(s,{children:["x \\leftarrow\\!\\!\\$ \\mathbb","{Z}","_p"]}),";"," ",e.jsx(s,{children:"X \\leftarrow xG"})]}),e.jsxs("p",{className:"font-mono text-sm",children:[e.jsx(s,{children:"sk \\leftarrow x"}),";"," ",e.jsx(s,{children:"pk \\leftarrow X"})]}),e.jsxs("p",{className:"font-mono text-sm",children:[e.jsx("strong",{children:"return"})," ",e.jsx(s,{children:"(sk, pk)"})]})]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-indigo-400 font-bold mb-2",children:"Ver(pk, m, σ)"}),e.jsxs("p",{className:"font-mono text-sm",children:[e.jsx(s,{children:"X \\leftarrow pk"}),";"," ",e.jsx(s,{children:"(R, s) \\leftarrow \\sigma"})]}),e.jsx("p",{className:"font-mono text-sm",children:e.jsxs(s,{children:["c \\leftarrow H_","{sig}","(X, R, m)"]})}),e.jsxs("p",{className:"font-mono text-sm",children:[e.jsx("strong",{children:"return"})," ",e.jsx(s,{children:"(sG = R + cX)"})]})]})]}),e.jsxs(k,{title:"Lemma 2: MSUNF Reduction",proof:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:e.jsx("strong",{children:"Proof sketch:"})}),e.jsxs("p",{children:["1. Let ",e.jsxs(s,{children:["\\mathcal","{A}"]})," be an adversary against"," ",e.jsxs(s,{children:["\\text","{SeqMuSig}","[\\text","{GrGen}","]"]}),"."]}),e.jsxs("p",{children:["2. We construct ",e.jsxs(s,{children:["\\mathcal","{B}"]})," that simulates"," ",e.jsxs(s,{children:["\\text","{Game}","_1"]})," to ",e.jsxs(s,{children:["\\mathcal","{A}"]})," ","while using SUNF oracles."]}),e.jsxs("p",{children:["3. ",e.jsxs(s,{children:["\\mathcal","{B}"]})," receives"," ",e.jsxs(s,{children:["(\\mathbb","{G}",", p, g)"]})," and ",e.jsx(s,{children:"X^*"})," ","and runs ",e.jsxs(s,{children:["\\mathcal","{A}"]})," on input ",e.jsx(s,{children:"X^*"}),"."]}),e.jsxs("p",{children:["4. Each Sign/Sign' query from ",e.jsxs(s,{children:["\\mathcal","{A}"]})," is relayed to SUNF's oracles."]}),e.jsxs("p",{children:["5. Upon receiving ",e.jsx(s,{children:"(L_i, m_i, \\sigma_i)"})," for"," ",e.jsx(s,{children:"i = 1..n"})," from ",e.jsxs(s,{children:["\\mathcal","{A}"]}),","," ",e.jsxs(s,{children:["\\mathcal","{B}"]})," transforms them into SUNF forgeries."]}),e.jsxs("p",{children:["6. The key aggregation representation"," ",e.jsxs(s,{children:["\\tilde","{X}","_i = \\text","{KeyAgg}","(L_i)"]})," with"," ",e.jsxs(s,{children:["(\\alpha_i, \\beta_i) = T_","{akey}","(\\tilde","{X}","_i)"]})," ","allows computing transformed signatures."]})]}),children:[e.jsxs("p",{children:["Let ",e.jsxs(s,{children:["\\text","{GrGen}"]})," be a group generation algorithm such that ",e.jsxs(s,{children:["\\text","{BlSch}"]})," is SUNF. Then"," ",e.jsxs(s,{children:["\\text","{SeqMuSig}"]})," is MSUNF. Precisely, for any algebraic adversary ",e.jsxs(s,{children:["\\mathcal","{A}"]})," against"," ",e.jsxs(s,{children:["\\text","{SeqMuSig}","[\\text","{GrGen}","]"]}),", there exists an adversary ",e.jsxs(s,{children:["\\mathcal","{B}"]})," such that:"]}),e.jsx(m,{children:"\\text{Adv}^{\\text{SUNF}}_{\\mathcal{B},\\text{BlSch}[\\text{GrGen}]}(\\lambda) \\geq \\text{Adv}^{\\text{MSUNF}}_{\\mathcal{A},\\text{SeqMuSig}[\\text{GrGen}]}(\\lambda) + \\epsilon"})]}),e.jsxs(v,{type:"warning",title:"Open Problem",children:[e.jsxs("p",{children:["The proof has a subtle issue: the representation of ",e.jsx(s,{children:"[X]"})," ","is not only in bases ",e.jsx(s,{children:"G"})," and ",e.jsx(s,{children:"X^*"})," ","but also all the ",e.jsx(s,{children:"R"}),"'s. This breaks the proof idea as it prevents programming ",e.jsxs(s,{children:["H_","{sig}"]})," such that a forgery in MSUNF is also a forgery in SUNF."]}),e.jsxs("p",{className:"mt-2",children:["Possible approaches include: using the sequential property (at most one"," ",e.jsx(s,{children:"R_k"})," base at a time), ensuring the"," ",e.jsx(s,{children:"X^*"}),"-component conditions hold, or reducing to OMDL instead."]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"References"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-dark-300",children:[e.jsxs("li",{children:["Bünz et al. ",e.jsx("em",{children:"Bulletproofs: Short Proofs for Confidential Transactions and More."})," ","2017."]}),e.jsxs("li",{children:["Fuchsbauer, Plouviez, Seurin. ",e.jsx("em",{children:"Blind Schnorr Signatures and Signed ElGamal Encryption in the Algebraic Group Model."})]}),e.jsxs("li",{children:["Fuchsbauer, Kiltz, Loss. ",e.jsx("em",{children:"The Algebraic Group Model and its Applications."})]})]}),e.jsx(S,{className:"my-8"})]})}export{R as default};
