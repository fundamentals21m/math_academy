import{j as e,m as i,A as m}from"./vendor-animation-0o8UKZ_1.js";import{r as x}from"./vendor-react-Drj8qL0h.js";import"./vendor-math-p018AHG0.js";import"./index-0SKjYqk6.js";import{L as _,D as g,E as p}from"./ContentBlocks-B8Bxhv2f.js";import{I as l,M as s}from"./MathBlock-uz1iP4cD.js";import{C as b}from"./Callout-Dt8juvZK.js";import"./vendor-firebase-core-BXWtuYvb.js";import"./quizMap-Bnq9ppQi.js";function y({className:f=""}){const[t,n]=x.useState(0),[r,h]=x.useState(!1),[c,u]=x.useState(!0),o={a:3,b:5,challenge:7};x.useEffect(()=>{if(!r)return;const a=setTimeout(()=>{t<3?n(t+1):h(!1)},2500);return()=>clearTimeout(a)},[r,t]);const d=[{title:"Prover Commits",subtitle:"Generate random blinding factors and compute commitments",proverAction:"Computes S, T₁, T₂",verifierAction:"Waits...",details:[{name:"S",value:"s_a·G₀ + s_b·G₁ + s_S·H",desc:"Blinded commitment"},{name:"T₁",value:"Cross-term commitment",desc:"For l(x)·r(x) evaluation"},{name:"T₂",value:"s_a·s_b·G₀ + τ₂·H",desc:"Quadratic term"}]},{title:"Verifier Challenges",subtitle:"Send a random challenge value x",proverAction:"Receives x",verifierAction:"Sends x ← random",details:[{name:"x",value:`${o.challenge}`,desc:"Random field element"}]},{title:"Prover Responds",subtitle:"Compute opening values using the challenge",proverAction:"Computes l, r, μ, τ_x",verifierAction:"Waits...",details:[{name:"l",value:`a + s_a·x = ${o.a} + s_a·${o.challenge}`,desc:"Opened left poly"},{name:"r",value:`b + s_b·x = ${o.b} + s_b·${o.challenge}`,desc:"Opened right poly"},{name:"μ",value:"s_S + ... + τ₂·x²",desc:"Blinding opening"},{name:"τ_x",value:"s_V + τ₁·x + τ₂·x²",desc:"Value blinding"}]},{title:"Verifier Checks",subtitle:"Verify the two main equations",proverAction:"Done",verifierAction:"Checks equations",details:[{name:"Check 1",value:"l·G₀ + r·G₁ + μ·H = C + x·S",desc:"Commitment consistency"},{name:"Check 2",value:"l·r·G₀ + τ_x·H = V + x·T₁ + x²·T₂",desc:"Multiplication correctness"}]}][t];return e.jsxs("div",{className:`p-6 rounded-2xl bg-dark-800/50 border border-dark-700/50 ${f}`,children:[e.jsx("h3",{className:"text-xl font-bold text-dark-100 mb-2",children:"ZK Multiplication Protocol"}),e.jsx("p",{className:"text-dark-400 text-sm mb-4",children:"Proving knowledge of a, b such that V commits to a·b, without revealing a or b."}),e.jsxs("div",{className:"flex gap-2 mb-4 flex-wrap",children:[e.jsx(i.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>n(Math.max(0,t-1)),disabled:t===0,className:"px-3 py-1.5 rounded-lg bg-dark-600 hover:bg-dark-500 disabled:opacity-30 text-dark-200 text-sm",children:"← Prev"}),e.jsx(i.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{r?h(!1):(n(0),h(!0))},className:`px-4 py-1.5 rounded-lg text-sm font-medium ${r?"bg-amber-500 hover:bg-amber-600 text-white":"bg-primary-500 hover:bg-primary-600 text-white"}`,children:r?"Pause":"Play All"}),e.jsx(i.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>n(Math.min(3,t+1)),disabled:t===3,className:"px-3 py-1.5 rounded-lg bg-dark-600 hover:bg-dark-500 disabled:opacity-30 text-dark-200 text-sm",children:"Next →"}),e.jsx("div",{className:"flex-1"}),e.jsxs("button",{onClick:()=>u(!c),className:`px-3 py-1.5 rounded-lg text-sm ${c?"bg-primary-500/20 text-primary-400":"bg-dark-700 text-dark-400"}`,children:[c?"Hide":"Show"," Details"]})]}),e.jsx("div",{className:"flex gap-1 mb-4",children:[0,1,2,3].map(a=>e.jsxs("button",{onClick:()=>n(a),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-all ${t===a?"bg-primary-500 text-white":t>a?"bg-emerald-500/20 text-emerald-400":"bg-dark-700 text-dark-500"}`,children:[a+1,". ",["Commit","Challenge","Response","Verify"][a]]},a))}),e.jsxs("svg",{viewBox:"0 0 500 280",className:"w-full h-auto bg-dark-900/50 rounded-xl mb-4",children:[e.jsx("rect",{x:"30",y:"30",width:"150",height:"200",rx:"12",fill:"#1e293b",stroke:"#374151",strokeWidth:"2"}),e.jsx("text",{x:"105",y:"55",fill:"#10b981",fontSize:"14",fontWeight:"bold",textAnchor:"middle",children:"Prover"}),e.jsx("text",{x:"105",y:"75",fill:"#6b7280",fontSize:"10",textAnchor:"middle",children:"knows (a, b, ab)"}),e.jsxs(i.g,{initial:{opacity:0},animate:{opacity:1},children:[e.jsx("rect",{x:"45",y:"90",width:"120",height:"50",rx:"6",fill:t===0||t===2?"#10b98120":"#37415150"}),e.jsx("text",{x:"105",y:"115",fill:t===0||t===2?"#10b981":"#6b7280",fontSize:"10",textAnchor:"middle",children:d.proverAction}),(t===0||t===2)&&e.jsx(i.circle,{cx:"155",cy:"115",r:"4",fill:"#10b981",initial:{scale:0},animate:{scale:[1,1.3,1]},transition:{repeat:1/0,duration:1}})]},`prover-${t}`),e.jsx("rect",{x:"320",y:"30",width:"150",height:"200",rx:"12",fill:"#1e293b",stroke:"#374151",strokeWidth:"2"}),e.jsx("text",{x:"395",y:"55",fill:"#6366f1",fontSize:"14",fontWeight:"bold",textAnchor:"middle",children:"Verifier"}),e.jsx("text",{x:"395",y:"75",fill:"#6b7280",fontSize:"10",textAnchor:"middle",children:"checks proof"}),e.jsxs(i.g,{initial:{opacity:0},animate:{opacity:1},children:[e.jsx("rect",{x:"335",y:"90",width:"120",height:"50",rx:"6",fill:t===1||t===3?"#6366f120":"#37415150"}),e.jsx("text",{x:"395",y:"115",fill:t===1||t===3?"#6366f1":"#6b7280",fontSize:"10",textAnchor:"middle",children:d.verifierAction}),(t===1||t===3)&&e.jsx(i.circle,{cx:"445",cy:"115",r:"4",fill:"#6366f1",initial:{scale:0},animate:{scale:[1,1.3,1]},transition:{repeat:1/0,duration:1}})]},`verifier-${t}`),e.jsxs(m,{children:[t>=0&&e.jsxs(i.g,{initial:{opacity:0},animate:{opacity:t===0?1:.4},children:[e.jsx(i.line,{x1:"180",y1:"160",x2:"320",y2:"160",stroke:"#10b981",strokeWidth:"2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.5}}),e.jsx("polygon",{points:"315,155 325,160 315,165",fill:"#10b981"}),e.jsx("text",{x:"250",y:"152",fill:"#10b981",fontSize:"10",textAnchor:"middle",children:"S, T₁, T₂"})]}),t>=1&&e.jsxs(i.g,{initial:{opacity:0},animate:{opacity:t===1?1:.4},children:[e.jsx(i.line,{x1:"320",y1:"185",x2:"180",y2:"185",stroke:"#6366f1",strokeWidth:"2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.5}}),e.jsx("polygon",{points:"185,180 175,185 185,190",fill:"#6366f1"}),e.jsx("text",{x:"250",y:"200",fill:"#6366f1",fontSize:"10",textAnchor:"middle",children:"x (challenge)"})]}),t>=2&&e.jsxs(i.g,{initial:{opacity:0},animate:{opacity:t===2?1:.4},children:[e.jsx(i.line,{x1:"180",y1:"210",x2:"320",y2:"210",stroke:"#10b981",strokeWidth:"2",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.5}}),e.jsx("polygon",{points:"315,205 325,210 315,215",fill:"#10b981"}),e.jsx("text",{x:"250",y:"225",fill:"#10b981",fontSize:"10",textAnchor:"middle",children:"l, r, μ, τ_x"})]}),t===3&&e.jsxs(i.g,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.3},children:[e.jsx("rect",{x:"335",y:"150",width:"120",height:"70",rx:"8",fill:"#10b98120",stroke:"#10b981",strokeWidth:"2"}),e.jsx("text",{x:"395",y:"175",fill:"#10b981",fontSize:"12",fontWeight:"bold",textAnchor:"middle",children:"✓ Valid Proof"}),e.jsx("text",{x:"395",y:"195",fill:"#6b7280",fontSize:"9",textAnchor:"middle",children:"Both equations"}),e.jsx("text",{x:"395",y:"208",fill:"#6b7280",fontSize:"9",textAnchor:"middle",children:"verified!"})]})]})]}),e.jsxs(i.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"p-4 rounded-xl bg-dark-700/30 border border-dark-600/30 mb-4",children:[e.jsxs("h4",{className:"text-primary-400 font-bold mb-1",children:["Step ",t+1,": ",d.title]}),e.jsx("p",{className:"text-dark-400 text-sm",children:d.subtitle})]},t),e.jsx(m,{children:c&&e.jsx(i.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:d.details.map((a,j)=>e.jsxs(i.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:j*.1},className:"p-3 rounded-lg bg-dark-700/50 border border-dark-600/30",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"text-primary-400 font-mono font-bold text-sm",children:a.name})}),e.jsx("p",{className:"text-dark-300 text-xs font-mono",children:a.value}),e.jsx("p",{className:"text-dark-500 text-xs mt-1",children:a.desc})]},a.name))})})})]})}function z(){return e.jsxs(_,{sectionId:5,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Prove Multiplication in ZK"}),e.jsx("p",{className:"mb-4",children:"This section demonstrates a non-trivial proof of Zero-Knowledge that aims to be more rigorous than the proofs commonly encountered in academic literature. The toy protocol we explore is a heavily simplified variant of Bulletproofs range proofs."}),e.jsx(b,{type:"info",title:"Motivation",children:e.jsx("p",{children:"The motivation is the belief that following a detailed proof enhances understanding of Zero-Knowledge and helps build intuition. In short, this protocol proves that a committed value is the product of two other committed values."})}),e.jsxs(g,{title:"The Multiplication Relation",children:[e.jsxs("p",{children:["The relation ",e.jsxs(l,{children:["\\mathcal","{R}","_","{mult}"]})," describes two commitments:"," ",e.jsx(l,{children:"C"})," commits to values ",e.jsx(l,{children:"a"})," and"," ",e.jsx(l,{children:"b"}),", and ",e.jsx(l,{children:"V"})," commits to their product:"]}),e.jsx(s,{children:"\\mathcal{R}_{\\text{mult}} = \\left\\{\\begin{array}{l} ((G_0, G_1, H \\in \\mathbb{G}), (V, C \\in \\mathbb{G})), (a, b, s_C, s_V \\in \\mathbb{Z}_p)) \\\\[0.5em] \\mid V = ab \\cdot G_0 + s_V H, \\quad C = a G_0 + b G_1 + s_C H \\end{array}\\right\\}"})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Protocol"}),e.jsxs("p",{className:"mb-4",children:["The following protocol is a zero-knowledge argument of knowledge for"," ",e.jsxs(l,{children:["\\mathcal","{R}","_","{mult}"]}),":"]}),e.jsxs("div",{className:"bg-dark-800 rounded-lg p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-400 font-bold mb-2",children:"Step 1: Prover Commitment"}),e.jsxs("p",{className:"mb-2",children:["Prover draws ",e.jsx(l,{children:"s_a, s_b, s_S, \\tau_1, \\tau_2"})," and sends:"]}),e.jsx(s,{children:"S = s_a G_0 + s_b G_1 + s_S H"}),e.jsx(s,{children:"T_1 = (a s_b + b s_a) G_0 + \\tau_1 H"}),e.jsx(s,{children:"T_2 = s_a s_b G_0 + \\tau_2 H"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-400 font-bold mb-2",children:"Step 2: Verifier Challenge"}),e.jsxs("p",{children:["Verifier sends random challenge ",e.jsx(l,{children:"x"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-400 font-bold mb-2",children:"Step 3: Prover Response"}),e.jsx("p",{className:"mb-2",children:"Prover sends:"}),e.jsx(s,{children:"l = l(x) = a + s_a x"}),e.jsx(s,{children:"r = r(x) = b + s_b x"}),e.jsx(s,{children:"\\mu = s_C + x s_S"}),e.jsx(s,{children:"\\tau_x = s_V + x\\tau_1 + x^2 \\tau_2"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-400 font-bold mb-2",children:"Step 4: Verifier Checks"}),e.jsx("p",{className:"mb-2",children:"Verifier checks:"}),e.jsx(s,{children:"C + xS = lG_0 + rG_1 + \\mu H"}),e.jsx(s,{children:"V + xT_1 + x^2 T_2 = lr G_0 + \\tau_x H"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Completeness"}),e.jsx("p",{className:"mb-4",children:"We verify that an honest prover with a valid witness passes the verification."}),e.jsxs(p,{title:"First Verification Equation",children:[e.jsx(s,{children:"C + xS = aG_0 + bG_1 + s_C H + x(s_a G_0 + s_b G_1 + s_S H)"}),e.jsx(s,{children:"= (a + xs_a)G_0 + (b + xs_b)G_1 + (s_C + xs_S)H"}),e.jsx(s,{children:"= lG_0 + rG_1 + \\mu H \\quad \\checkmark"})]}),e.jsxs(p,{title:"Second Verification Equation",children:[e.jsx(s,{children:"V + xT_1 + x^2 T_2 = abG_0 + s_V H + x(as_b + bs_a)G_0 + x\\tau_1 H + x^2 s_a s_b G_0 + x^2 \\tau_2 H"}),e.jsx(s,{children:"= (ab + x(as_b + bs_a) + x^2 s_a s_b)G_0 + (s_V + x\\tau_1 + x^2 \\tau_2)H"}),e.jsx(s,{children:"= lrG_0 + \\tau_x H \\quad \\checkmark"})]}),e.jsx(b,{type:"success",title:"Key Observation",children:e.jsxs("p",{children:["Notice how the polynomial structure emerges: ",e.jsx(l,{children:"lr = (a + s_a x)(b + s_b x)"})," ","expands to exactly match the left side when combined with the"," ",e.jsx(l,{children:"T_1"})," and ",e.jsx(l,{children:"T_2"})," terms."]})}),e.jsx(y,{className:"my-8"})]})}export{z as default};
