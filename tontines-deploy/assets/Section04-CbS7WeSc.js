import{j as e}from"./vendor-animation-CmxkKU9r.js";import{r as m}from"./vendor-react-DamxDR2H.js";import"./vendor-math-p018AHG0.js";import"./index-BEX5KAIZ.js";import{L as X}from"./LessonLayout-ybNAPjcf.js";import{I as f,M as F}from"./MathBlock-fCav0pL3.js";import{D as N,E as O}from"./ContentBlocks-DZ6IdIC2.js";import{C as Y}from"./Callout-CP2-VZ-C.js";import"./quizMap-DVBi0JFt.js";const u={male:{A:2e-4,B:3e-5,c:.085},female:{A:15e-5,B:2e-5,c:.083}};function q({className:T="",initialAge:W=30,initialSex:$="male",showControls:D=!0}){const[i,P]=m.useState(W),[a,k]=m.useState($),[h,y]=m.useState(null),b=600,o=400,r={top:30,right:30,bottom:50,left:60},z=b-r.left-r.right,B=o-r.top-r.bottom,p={min:0,max:110},d=t=>r.left+(t-p.min)/(p.max-p.min)*z,x=t=>o-r.bottom-t*B,E=(t,s)=>{const{A:n,B:l,c}=s;return n*t+l/c*(Math.exp(c*t)-1)},S=(t,s)=>Math.exp(-E(t,s)),v=(t,s,n)=>{if(t<s)return 1;const l=S(s,n);return S(t,n)/l},M=m.useMemo(()=>{const t=u[a],s=[],n=.5;for(let l=i;l<=p.max;l+=n){const c=v(l,i,t);s.push({age:l,survival:c})}return s},[a,i]),A=m.useMemo(()=>{const s=u[a==="male"?"female":"male"],n=[],l=.5;for(let c=i;c<=p.max;c+=l){const H=v(c,i,s);n.push({age:c,survival:H})}return n},[a,i]),w=t=>t.length===0?"":t.map((s,n)=>`${n===0?"M":"L"} ${d(s.age)} ${x(s.survival)}`).join(" "),L=m.useMemo(()=>w(M),[M]),C=m.useMemo(()=>w(A),[A]),I=m.useMemo(()=>{const t=u[a];let s=0;const n=.1;for(let l=i;l<=120;l+=n)s+=v(l,i,t)*n;return s+i},[a,i]),j=m.useMemo(()=>{const t=u[a];for(let s=i;s<=120;s+=.1)if(v(s,i,t)<=.5)return s;return 120},[a,i]),R=m.useMemo(()=>{const t=u[a];for(let s=i;s<=120;s+=.1)if(v(s,i,t)<=.25)return s;return 120},[a,i]),g=h!==null?v(h,i,u[a]):null,G=t=>{const s=t.currentTarget.getBoundingClientRect(),l=(t.clientX-s.left)/s.width*b,c=p.min+(l-r.left)/z*(p.max-p.min);c>=i&&c<=p.max?y(Math.round(c*10)/10):y(null)};return e.jsxs("div",{className:`p-6 rounded-2xl bg-zinc-900/50 border border-zinc-800/50 ${T}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-zinc-100",children:"Survival Curve Explorer"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${a==="male"?"bg-blue-500/20 text-blue-400":"bg-pink-500/20 text-pink-400"}`,children:a==="male"?"Male":"Female"})]}),e.jsx("p",{className:"text-zinc-400 text-sm mb-4",children:"Explore survival probability S(t) using the Gompertz-Makeham mortality model."}),D&&e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-zinc-300 text-sm mb-2",children:["Starting Age: ",e.jsx("span",{className:"text-emerald-400 font-mono",children:i})]}),e.jsx("input",{type:"range",min:"0",max:"100",step:"1",value:i,onChange:t=>P(parseInt(t.target.value)),className:"w-full h-2 bg-zinc-700 rounded-lg appearance-none cursor-pointer accent-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-zinc-300 text-sm mb-2",children:"Sex:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>k("male"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${a==="male"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-zinc-700 text-zinc-400 border border-zinc-600 hover:bg-zinc-600"}`,children:"Male"}),e.jsx("button",{onClick:()=>k("female"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${a==="female"?"bg-pink-500/20 text-pink-400 border border-pink-500/30":"bg-zinc-700 text-zinc-400 border border-zinc-600 hover:bg-zinc-600"}`,children:"Female"})]})]})]}),e.jsxs("svg",{viewBox:`0 0 ${b} ${o}`,className:"w-full h-auto bg-zinc-950/50 rounded-xl cursor-crosshair",onMouseMove:G,onMouseLeave:()=>y(null),children:[[0,20,40,60,80,100].map(t=>e.jsx("line",{x1:d(t),y1:r.top,x2:d(t),y2:o-r.bottom,stroke:"#3f3f46",strokeWidth:1,strokeDasharray:"4,4"},`vgrid-${t}`)),[0,.25,.5,.75,1].map(t=>e.jsx("line",{x1:r.left,y1:x(t),x2:b-r.right,y2:x(t),stroke:t===.5?"#6b7280":"#3f3f46",strokeWidth:t===.5?1.5:1,strokeDasharray:t===.5?"none":"4,4"},`hgrid-${t}`)),e.jsx("line",{x1:r.left,y1:o-r.bottom,x2:b-r.right,y2:o-r.bottom,stroke:"#71717a",strokeWidth:2}),e.jsx("line",{x1:r.left,y1:r.top,x2:r.left,y2:o-r.bottom,stroke:"#71717a",strokeWidth:2}),[0,20,40,60,80,100].map(t=>e.jsx("text",{x:d(t),y:o-r.bottom+20,fill:"#a1a1aa",fontSize:"12",textAnchor:"middle",children:t},`xlabel-${t}`)),e.jsx("text",{x:b/2,y:o-10,fill:"#a1a1aa",fontSize:"14",textAnchor:"middle",children:"Age (years)"}),[0,.25,.5,.75,1].map(t=>e.jsxs("text",{x:r.left-10,y:x(t)+4,fill:"#a1a1aa",fontSize:"11",textAnchor:"end",children:[(t*100).toFixed(0),"%"]},`ylabel-${t}`)),e.jsx("text",{x:15,y:o/2,fill:"#a1a1aa",fontSize:"14",textAnchor:"middle",transform:`rotate(-90, 15, ${o/2})`,children:"Survival Probability S(t)"}),e.jsx("path",{d:C,fill:"none",stroke:a==="male"?"#ec4899":"#3b82f6",strokeWidth:"2",strokeOpacity:"0.3",strokeDasharray:"6,4"}),e.jsx("path",{d:L,fill:"none",stroke:a==="male"?"#3b82f6":"#ec4899",strokeWidth:"3",strokeLinecap:"round"}),e.jsx("circle",{cx:d(i),cy:x(1),r:6,fill:"#10b981",stroke:"#fff",strokeWidth:"2"}),j<=110&&e.jsxs(e.Fragment,{children:[e.jsx("line",{x1:d(j),y1:x(.5),x2:d(j),y2:o-r.bottom,stroke:"#f59e0b",strokeWidth:"2",strokeDasharray:"4,2"}),e.jsx("circle",{cx:d(j),cy:x(.5),r:6,fill:"#f59e0b",stroke:"#fff",strokeWidth:"2"}),e.jsxs("text",{x:d(j),y:o-r.bottom+35,fill:"#f59e0b",fontSize:"11",textAnchor:"middle",children:["Median: ",j.toFixed(1)]})]}),h!==null&&g!==null&&e.jsxs(e.Fragment,{children:[e.jsx("line",{x1:d(h),y1:r.top,x2:d(h),y2:o-r.bottom,stroke:"#10b981",strokeWidth:"1",strokeDasharray:"2,2"}),e.jsx("line",{x1:r.left,y1:x(g),x2:b-r.right,y2:x(g),stroke:"#10b981",strokeWidth:"1",strokeDasharray:"2,2"}),e.jsx("circle",{cx:d(h),cy:x(g),r:8,fill:"#10b981",stroke:"#fff",strokeWidth:"2"})]})]}),e.jsxs("div",{className:"mt-4 flex gap-6 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-1 rounded ${a==="male"?"bg-blue-500":"bg-pink-500"}`}),e.jsx("span",{className:"text-zinc-400",children:a==="male"?"Male":"Female"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-1 rounded opacity-30 ${a==="male"?"bg-pink-500":"bg-blue-500"}`}),e.jsx("span",{className:"text-zinc-500",children:a==="male"?"Female (comparison)":"Male (comparison)"})]})]}),h!==null&&g!==null&&e.jsxs("div",{className:"mt-4 p-4 rounded-xl bg-emerald-500/10 border border-emerald-500/20",children:[e.jsxs("p",{className:"text-emerald-400",children:[e.jsxs("span",{className:"font-semibold",children:["Age ",h.toFixed(1),":"]})," ",(g*100).toFixed(1),"% survival probability"]}),e.jsxs("p",{className:"text-zinc-400 text-sm mt-1",children:["Given survival to age ",i,", probability of reaching age ",h.toFixed(0)]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-xl bg-zinc-800/50 border border-zinc-700/50",children:[e.jsx("p",{className:"text-zinc-500 text-xs uppercase tracking-wider",children:"Starting Age"}),e.jsx("p",{className:"text-xl font-mono text-emerald-400",children:i})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-zinc-800/50 border border-zinc-700/50",children:[e.jsx("p",{className:"text-zinc-500 text-xs uppercase tracking-wider",children:"Life Expectancy"}),e.jsx("p",{className:"text-xl font-mono text-blue-400",children:I.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-zinc-800/50 border border-zinc-700/50",children:[e.jsx("p",{className:"text-zinc-500 text-xs uppercase tracking-wider",children:"Median Age"}),e.jsx("p",{className:"text-xl font-mono text-amber-400",children:j.toFixed(1)})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-zinc-800/50 border border-zinc-700/50",children:[e.jsx("p",{className:"text-zinc-500 text-xs uppercase tracking-wider",children:"75th Percentile"}),e.jsx("p",{className:"text-xl font-mono text-pink-400",children:R.toFixed(1)})]})]}),e.jsxs("div",{className:"mt-4 p-4 rounded-xl bg-zinc-800/30 border border-zinc-700/30",children:[e.jsxs("p",{className:"text-zinc-400 text-sm",children:[e.jsx("span",{className:"text-zinc-300",children:"Gompertz-Makeham Model:"})," ",e.jsx("span",{className:"font-mono",children:"mu(t) = A + B*e^(ct)"})]}),e.jsxs("p",{className:"text-zinc-500 text-xs mt-2",children:[a==="male"?"Male":"Female"," parameters: A=",u[a].A,", B=",u[a].B,", c=",u[a].c]}),e.jsx("p",{className:"text-zinc-500 text-xs mt-1",children:"Survival: S(t) = exp(-integral of mu(s) ds from 0 to t)"})]})]})}function se(){return e.jsxs(X,{sectionId:4,children:[e.jsx("h2",{className:"text-2xl font-bold text-dark-100 mb-6",children:"Survival Probability Basics"}),e.jsx("p",{className:"mb-4",children:'"How long will I live?" No one knows the answer for any individual. But for populations, we have remarkably precise statistics. This is enough to pool risk effectively.'}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Fundamental Question"}),e.jsx(N,{title:"Random Lifetime",children:e.jsxs("p",{children:["Let ",e.jsx(f,{children:"T"})," be a random variable representing the time of death (measured from birth). We can ask: what's the probability of surviving to various ages?"]})}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Survival Function"}),e.jsxs(N,{title:"Survival Function S(t)",children:[e.jsxs("p",{children:["The probability of surviving to at least age ",e.jsx(f,{children:"t"}),":"]}),e.jsx(F,{children:"S(t) = P(T > t) = \\text{Probability of surviving to age } t"}),e.jsx("p",{className:"mt-2",children:"Properties:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsxs("li",{children:[e.jsx(f,{children:"S(0) = 1"})," (everyone is alive at birth)"]}),e.jsxs("li",{children:[e.jsx(f,{children:"S(t)"})," decreases as ",e.jsx(f,{children:"t"})," increases"]}),e.jsxs("li",{children:[e.jsx(f,{children:"S(\\infty) = 0"})," (everyone eventually dies)"]})]})]}),e.jsxs(O,{title:"Typical Survival Probabilities",children:[e.jsx("p",{className:"mb-3",children:"For a general population:"}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b border-dark-700",children:[e.jsx("th",{className:"pb-2",children:"Age"}),e.jsx("th",{className:"pb-2",children:"S(t)"}),e.jsx("th",{className:"pb-2",children:"Interpretation"})]})}),e.jsxs("tbody",{className:"text-dark-300",children:[e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-2",children:"0"}),e.jsx("td",{className:"py-2",children:"1.000"}),e.jsx("td",{className:"py-2",children:"100% alive at birth"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-2",children:"30"}),e.jsx("td",{className:"py-2",children:"0.99"}),e.jsx("td",{className:"py-2",children:"99% survive to 30"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-2",children:"65"}),e.jsx("td",{className:"py-2",children:"0.85"}),e.jsx("td",{className:"py-2",children:"85% survive to 65"})]}),e.jsxs("tr",{className:"border-b border-dark-800",children:[e.jsx("td",{className:"py-2",children:"85"}),e.jsx("td",{className:"py-2",children:"0.40"}),e.jsx("td",{className:"py-2",children:"40% survive to 85"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2",children:"110"}),e.jsx("td",{className:"py-2",children:"~0.0000001"}),e.jsx("td",{className:"py-2",children:"Virtually nobody"})]})]})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"Interactive Explorer"}),e.jsx("p",{className:"mb-4",children:"Explore survival curves using the Gompertz-Makeham mortality model. Adjust the starting age and compare male versus female survival probabilities."}),e.jsx(q,{}),e.jsx("h3",{className:"text-xl font-semibold text-dark-100 mt-8 mb-4",children:"The Death Distribution"}),e.jsxs(N,{title:"Cumulative Death Probability F(t)",children:[e.jsxs("p",{children:["The probability of dying by age ",e.jsx(f,{children:"t"}),":"]}),e.jsx(F,{children:"F(t) = P(T \\leq t) = 1 - S(t)"})]}),e.jsx(Y,{type:"info",title:"Why These Functions Matter",children:e.jsx("p",{children:'Every tontine calculation depends on survival probabilities. When we ask "how much should person X receive?", the answer depends on how likely they are to be alive to receive it.'})}),e.jsxs("p",{className:"text-dark-400 italic",children:["The survival function tells us probability from birth. But for retirement planning, we need something more: the probability of surviving ",e.jsx("em",{children:"additional"})," years given that you're already a certain age. That's next."]})]})}export{se as default};
